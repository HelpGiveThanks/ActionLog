<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title></title>
<link href="Styles.css" type="text/css" rel="stylesheet">
</head>
<body>
<p>
<span class="partheading"><a name="valFileOptionOverviewSectionAnchor_"/>ActionLog.fp7</span>
</p>
<table width="100%" border="1">
<tbody>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Overview</td><td class="chartsubheads" width="1%">&nbsp;</td><td class="chartsubheads" colSpan="2">File Options</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg" width="32%">Tables</td><td class="regularcharttext" width="8%"><a href="#valTablesSectionAnchor_">1</a></td><td class="regularcharttext">&nbsp;</td><td class="chartheadersnobg" width="%26">Default custom menu set</td><td class="regularcharttext" width="33%">BrainstateConversationManager</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Relationships</td><td class="regularcharttext">0</td><td class="regularcharttext">&nbsp;</td><td class="chartsubheads" colSpan="2">When opening file</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts</td><td class="regularcharttext">0</td><td class="regularcharttext">&nbsp;</td><td class="chartheadersnobg" width="%26">Login using</td><td class="regularcharttext" width="33%">Account Name; Account= normal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts</td><td class="regularcharttext"><a href="#valScriptsSectionAnchor_">256</a></td><td class="regularcharttext">&nbsp;</td><td class="chartheadersnobg">Switch to layout</td><td class="regularcharttext">01Main</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Value Lists</td><td class="regularcharttext">0</td><td class="regularcharttext">&nbsp;</td><td class="chartheadersnobg">Perform script</td><td class="regularcharttext"><a href="#115ScriptAnchor_">start</a></td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions</td><td class="regularcharttext">0</td><td class="regularcharttext">&nbsp;</td><td class="chartsubheads" colSpan="2">When closing file</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Accounts</td><td class="regularcharttext">0</td><td class="regularcharttext">&nbsp;</td><td class="chartheadersnobg">Perform script</td><td class="regularcharttext"><a href="#32978ScriptAnchor_">close</a></td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Privilege Sets</td><td class="regularcharttext">0</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Extended Privileges</td><td class="regularcharttext">0</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">FileMaker Data Sources</td><td class="regularcharttext">0</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">ODBC Data Sources</td><td class="regularcharttext">0</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Menu Sets</td><td class="regularcharttext">0</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Menus</td><td class="regularcharttext">0</td>
</tr>
</tbody>
</table>

<p>
<span class="partheading"><a name="valTablesSectionAnchor_"/>Tables</span>
</p>
<table width="95%" border="1">
<tbody>
<tr class="chartheaders" vAlign="top">
<td width="15%">Table Name</td><td width="29%">
<div align="left">Statistics</div>
</td><td width="29%">Occurrences in Relationship Graph</td>
</tr>
<tr class="regularcharttext" vAlign="top">
<td><a href="#32785BaseTableAnchor_">Recovered Library</a></td><td>
<div align="left"><a href="#32785BaseTableAnchor_">2 fields</a> defined, 3 records</div>
</td><td></td>
</tr>
</tbody>
</table>
<p>
<span class="partheading"><a name="valFieldsSectionAnchor_"/>Fields</span>
</p>
		<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td colSpan="9">Table Name: <a name="32785BaseTableAnchor_"/>Recovered Library - 2 Fields</td>
</tr>
<tr class="chartheaders" vAlign="top">
<td width="8%">Field Name</td><td width="7%">Type</td><td width="14%">Options</td><td width="10%">Comments</td><td width="13%">On Layouts</td><td width="15%">In Relationships</td><td width="22%">In Scripts</td><td width="11%">In Value Lists</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327851FieldAnchor_"/>Recovered Blob</td><td>Normal, Binary</td><td><strong>Auto-Enter:</strong>
<ul>
<li>Allow editing</li>
</ul>
<strong>Validation:</strong>
<ul>
<li>Only during data entry</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Repetitions: 1</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
			<tr class="regularcharttext" vAlign="top">
<td><a name="327852FieldAnchor_"/>test</td><td>Calculated, Text</td><td><strong>Calculation:</strong>
<ul>
<li>Context table: <em>Recovered Library</em>
</li>
<li>
<strong>Get</strong> ( <strong>RecordNumber</strong> )</li>
</ul>
<strong>Storage:</strong>
<ul>
<li>Global</li>
<li>Repetitions: 3</li>
<li>Index Language: English</li>
</ul>
</td><td></td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td><td>
<ul></ul>
</td>
</tr>
		</tbody>
</table>
	
<p>
<span class="partheading"><a name="valScriptsSectionAnchor_"/>Script Hierarchy</span>
</p>
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="32772ScriptAnchor_toc"></a><a href="#32772ScriptAnchor_">start close</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="115ScriptAnchor_toc"></a><a href="#115ScriptAnchor_">start</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32978ScriptAnchor_toc"></a><a href="#32978ScriptAnchor_">close</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="32774ScriptAnchor_toc"></a><a href="#32774ScriptAnchor_">total</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="32811ScriptAnchor_toc"></a><a href="#32811ScriptAnchor_">showLinkedRecords</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32941ScriptAnchor_toc"></a><a href="#32941ScriptAnchor_">CHUNK_recalculateTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32939ScriptAnchor_toc"></a><a href="#32939ScriptAnchor_">CHUNK_recalculateGrandTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32964ScriptAnchor_toc"></a><a href="#32964ScriptAnchor_">triggered scripts</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="32769ScriptAnchor_toc"></a><a href="#32769ScriptAnchor_">linkDeny</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32890ScriptAnchor_toc"></a><a href="#32890ScriptAnchor_">linkGrandDeny</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32930ScriptAnchor_toc"></a><a href="#32930ScriptAnchor_">addToLinkDeny</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32972ScriptAnchor_toc"></a><a href="#32972ScriptAnchor_">addToGrandtotalDeny</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="32966ScriptAnchor_toc"></a><a href="#32966ScriptAnchor_">action buttons</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="119ScriptAnchor_toc"></a><a href="#119ScriptAnchor_">total</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33017ScriptAnchor_toc"></a><a href="#33017ScriptAnchor_">newTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32891ScriptAnchor_toc"></a><a href="#32891ScriptAnchor_">grandTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32931ScriptAnchor_toc"></a><a href="#32931ScriptAnchor_">addToTotalPart1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32929ScriptAnchor_toc"></a><a href="#32929ScriptAnchor_">addToTotalPart2</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32970ScriptAnchor_toc"></a><a href="#32970ScriptAnchor_">addToTotalPart2 CHUNK</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="32936ScriptAnchor_toc"></a><a href="#32936ScriptAnchor_">CHUNK addToTotalPart3</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="32949ScriptAnchor_toc"></a><a href="#32949ScriptAnchor_">addToGrandtotalPart1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32950ScriptAnchor_toc"></a><a href="#32950ScriptAnchor_">addToGrandtotalPart2</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32953ScriptAnchor_toc"></a><a href="#32953ScriptAnchor_">cancelTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32935ScriptAnchor_toc"></a><a href="#32935ScriptAnchor_">cancelAddToTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32952ScriptAnchor_toc"></a><a href="#32952ScriptAnchor_">cancelAddToGrandtotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32832ScriptAnchor_toc"></a><a href="#32832ScriptAnchor_">seperateFromTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32928ScriptAnchor_toc"></a><a href="#32928ScriptAnchor_">seperateFromGrandtotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32831ScriptAnchor_toc"></a><a href="#32831ScriptAnchor_">newLinkedRecord</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="32968ScriptAnchor_toc"></a><a href="#32968ScriptAnchor_">falsified ideas</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="32932ScriptAnchor_toc"></a><a href="#32932ScriptAnchor_">updateTimeAfterSeperate (OLD)</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32948ScriptAnchor_toc"></a><a href="#32948ScriptAnchor_">CHUNK_deleteRecordsTimeFromGrandtotal</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="32874ScriptAnchor_toc"></a><a href="#32874ScriptAnchor_">navigation</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="33217ScriptAnchor_toc"></a><a href="#33217ScriptAnchor_">moreInfo</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33154ScriptAnchor_toc"></a><a href="#33154ScriptAnchor_">gotoLibraryDatabase</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33216ScriptAnchor_toc"></a><a href="#33216ScriptAnchor_">gotoWebsite</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33187ScriptAnchor_toc"></a><a href="#33187ScriptAnchor_">gotoLibraryDatabaseUsingGoButton</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33193ScriptAnchor_toc"></a><a href="#33193ScriptAnchor_">gotoHelp </a></td>
</tr>
<tr>
<td class="script_hier"><a name="33185ScriptAnchor_toc"></a><a href="#33185ScriptAnchor_">gotoOtherDatabase</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33189ScriptAnchor_toc"></a><a href="#33189ScriptAnchor_">gotoDatabaseHeartWhisperer</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33188ScriptAnchor_toc"></a><a href="#33188ScriptAnchor_">gotoDatabaseBudget</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33196ScriptAnchor_toc"></a><a href="#33196ScriptAnchor_">gotoTimer</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33197ScriptAnchor_toc"></a><a href="#33197ScriptAnchor_">gotoSpecificAction</a></td>
</tr>
<tr>
<td class="script_hier"><a name="104ScriptAnchor_toc"></a><a href="#104ScriptAnchor_">goDay</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33056ScriptAnchor_toc"></a><a href="#33056ScriptAnchor_">goDayLastDayUsed</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33018ScriptAnchor_toc"></a><a href="#33018ScriptAnchor_">goPlus1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33033ScriptAnchor_toc"></a><a href="#33033ScriptAnchor_">goPlus1iphone</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33019ScriptAnchor_toc"></a><a href="#33019ScriptAnchor_">goMinus1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33032ScriptAnchor_toc"></a><a href="#33032ScriptAnchor_">goMinus1iphone</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32843ScriptAnchor_toc"></a><a href="#32843ScriptAnchor_">goWeekPlus1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33156ScriptAnchor_toc"></a><a href="#33156ScriptAnchor_">goWeekMinus1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32907ScriptAnchor_toc"></a><a href="#32907ScriptAnchor_">goMonthPlus</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33157ScriptAnchor_toc"></a><a href="#33157ScriptAnchor_">goMonthMinus</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32903ScriptAnchor_toc"></a><a href="#32903ScriptAnchor_">goToFarmer</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32921ScriptAnchor_toc"></a><a href="#32921ScriptAnchor_">calendarDayCalc</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33034ScriptAnchor_toc"></a><a href="#33034ScriptAnchor_">calendarDayCalciphone</a></td>
</tr>
<tr>
<td class="script_hier"><a name="118ScriptAnchor_toc"></a><a href="#118ScriptAnchor_">calendarWeekCalc</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32846ScriptAnchor_toc"></a><a href="#32846ScriptAnchor_">calendarMonthCalc</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32915ScriptAnchor_toc"></a><a href="#32915ScriptAnchor_">calendarMonthCalcChartSortN</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32839ScriptAnchor_toc"></a><a href="#32839ScriptAnchor_">to 1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32919ScriptAnchor_toc"></a><a href="#32919ScriptAnchor_">to 1 chart</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32908ScriptAnchor_toc"></a><a href="#32908ScriptAnchor_">to 7</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32918ScriptAnchor_toc"></a><a href="#32918ScriptAnchor_">to 7 chart</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32910ScriptAnchor_toc"></a><a href="#32910ScriptAnchor_">to 31</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32913ScriptAnchor_toc"></a><a href="#32913ScriptAnchor_">to 31 chart</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33098ScriptAnchor_toc"></a><a href="#33098ScriptAnchor_">iphoneModegotoSort</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33099ScriptAnchor_toc"></a><a href="#33099ScriptAnchor_">iphoneModegotoSortBack</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33100ScriptAnchor_toc"></a><a href="#33100ScriptAnchor_">iphoneModegotoSortTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33102ScriptAnchor_toc"></a><a href="#33102ScriptAnchor_">iphoneModegotoSortBackTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33105ScriptAnchor_toc"></a><a href="#33105ScriptAnchor_">editTimePart1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33106ScriptAnchor_toc"></a><a href="#33106ScriptAnchor_">editTimePart2</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32844ScriptAnchor_toc"></a><a href="#32844ScriptAnchor_">goAndComeBackPart1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32916ScriptAnchor_toc"></a><a href="#32916ScriptAnchor_">goAndComeBackPart2</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32934ScriptAnchor_toc"></a><a href="#32934ScriptAnchor_">goBackButton</a></td>
</tr>
<tr>
<td class="script_hier"><a name="99ScriptAnchor_toc"></a><a href="#99ScriptAnchor_">closeWindowHaltScript</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32943ScriptAnchor_toc"></a><a href="#32943ScriptAnchor_">CHUNK_createRecordsForNewUsers</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32979ScriptAnchor_toc"></a><a href="#32979ScriptAnchor_">total</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="32994ScriptAnchor_toc"></a><a href="#32994ScriptAnchor_">goDayTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32995ScriptAnchor_toc"></a><a href="#32995ScriptAnchor_">goWeekTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32996ScriptAnchor_toc"></a><a href="#32996ScriptAnchor_">goMonthTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32987ScriptAnchor_toc"></a><a href="#32987ScriptAnchor_">calendarDayCalcTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32991ScriptAnchor_toc"></a><a href="#32991ScriptAnchor_">calendarWeekCalcTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32989ScriptAnchor_toc"></a><a href="#32989ScriptAnchor_">calendarMonthCalcTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32990ScriptAnchor_toc"></a><a href="#32990ScriptAnchor_">calendarMonthCalcChartTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32981ScriptAnchor_toc"></a><a href="#32981ScriptAnchor_">to 1 Total</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32982ScriptAnchor_toc"></a><a href="#32982ScriptAnchor_">to 1 chart Total</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32983ScriptAnchor_toc"></a><a href="#32983ScriptAnchor_">to 7 Total</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32984ScriptAnchor_toc"></a><a href="#32984ScriptAnchor_">to 7 chart Total</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32985ScriptAnchor_toc"></a><a href="#32985ScriptAnchor_">to 32 Total</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32986ScriptAnchor_toc"></a><a href="#32986ScriptAnchor_">to 31 chart Total</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32992ScriptAnchor_toc"></a><a href="#32992ScriptAnchor_">goAndComeBackPart1Total</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32993ScriptAnchor_toc"></a><a href="#32993ScriptAnchor_">goAndComeBackPart2Total</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="32879ScriptAnchor_toc"></a><a href="#32879ScriptAnchor_">log</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="32923ScriptAnchor_toc"></a><a href="#32923ScriptAnchor_">logShowAll</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32833ScriptAnchor_toc"></a><a href="#32833ScriptAnchor_">gotoSpecificIssuesLog</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33167ScriptAnchor_toc"></a><a href="#33167ScriptAnchor_">openSpecificAction</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33171ScriptAnchor_toc"></a><a href="#33171ScriptAnchor_">gotoLogs</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33168ScriptAnchor_toc"></a><a href="#33168ScriptAnchor_">changeLogs Copy</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33162ScriptAnchor_toc"></a><a href="#33162ScriptAnchor_">gotoIssueLog</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33044ScriptAnchor_toc"></a><a href="#33044ScriptAnchor_">logOpen</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33046ScriptAnchor_toc"></a><a href="#33046ScriptAnchor_">logClose</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33041ScriptAnchor_toc"></a><a href="#33041ScriptAnchor_">logViewByDate</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33043ScriptAnchor_toc"></a><a href="#33043ScriptAnchor_">logViewByAction</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33040ScriptAnchor_toc"></a><a href="#33040ScriptAnchor_">logHideBlanks</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33015ScriptAnchor_toc"></a><a href="#33015ScriptAnchor_">removeTextFormatting</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33199ScriptAnchor_toc"></a><a href="#33199ScriptAnchor_">resetRememberTags</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="32881ScriptAnchor_toc"></a><a href="#32881ScriptAnchor_">action buttons</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="102ScriptAnchor_toc"></a><a href="#102ScriptAnchor_">note veto view</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33047ScriptAnchor_toc"></a><a href="#33047ScriptAnchor_">note veto view (old: opened things in new windows)</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33010ScriptAnchor_toc"></a><a href="#33010ScriptAnchor_">timerCloseWindow</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32829ScriptAnchor_toc"></a><a href="#32829ScriptAnchor_">updateTime</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33055ScriptAnchor_toc"></a><a href="#33055ScriptAnchor_">daysSinceLastUseToggle</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33054ScriptAnchor_toc"></a><a href="#33054ScriptAnchor_">updateNumberOfDaysSince</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33053ScriptAnchor_toc"></a><a href="#33053ScriptAnchor_">CHUNK_lastDayUsed</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33048ScriptAnchor_toc"></a><a href="#33048ScriptAnchor_">updateTime (old: opened things in new windows)</a></td>
</tr>
<tr>
<td class="script_hier"><a name="117ScriptAnchor_toc"></a><a href="#117ScriptAnchor_">updatePauseTotals</a></td>
</tr>
<tr>
<td class="script_hier"><a name="87ScriptAnchor_toc"></a><a href="#87ScriptAnchor_">clearPart1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33058ScriptAnchor_toc"></a><a href="#33058ScriptAnchor_">clearPart2</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33049ScriptAnchor_toc"></a><a href="#33049ScriptAnchor_">clear (old: opens windows to perform)</a></td>
</tr>
<tr>
<td class="script_hier"><a name="107ScriptAnchor_toc"></a><a href="#107ScriptAnchor_">newBrainstateOnTotalLayouts</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33029ScriptAnchor_toc"></a><a href="#33029ScriptAnchor_">newBrainstateOnMainLayouts</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32905ScriptAnchor_toc"></a><a href="#32905ScriptAnchor_">newFarmer</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32900ScriptAnchor_toc"></a><a href="#32900ScriptAnchor_">info</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33175ScriptAnchor_toc"></a><a href="#33175ScriptAnchor_">iphoneCut</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33200ScriptAnchor_toc"></a><a href="#33200ScriptAnchor_">findSpecificAction</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33202ScriptAnchor_toc"></a><a href="#33202ScriptAnchor_">findSpecificActionCancel</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33178ScriptAnchor_toc"></a><a href="#33178ScriptAnchor_">iphoneCopy</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33176ScriptAnchor_toc"></a><a href="#33176ScriptAnchor_">iphonePaste</a></td>
</tr>
<tr>
<td class="script_hier"><a name="110ScriptAnchor_toc"></a><a href="#110ScriptAnchor_">deleteBrainstate</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33023ScriptAnchor_toc"></a><a href="#33023ScriptAnchor_">deleteBrainstateFromTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32904ScriptAnchor_toc"></a><a href="#32904ScriptAnchor_">deleteFarmer</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32860ScriptAnchor_toc"></a><a href="#32860ScriptAnchor_">editFarmer</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33195ScriptAnchor_toc"></a><a href="#33195ScriptAnchor_">allSolutionsMenu</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32861ScriptAnchor_toc"></a><a href="#32861ScriptAnchor_">switchFarmer</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32870ScriptAnchor_toc"></a><a href="#32870ScriptAnchor_">time</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32942ScriptAnchor_toc"></a><a href="#32942ScriptAnchor_">CHUNK_deleteTotalOrGrandtotalRecord</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32940ScriptAnchor_toc"></a><a href="#32940ScriptAnchor_">CHUNK_deleteRecordsTimeFromTotal</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="32883ScriptAnchor_toc"></a><a href="#32883ScriptAnchor_">show/hide buttons and checkboxes</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="32865ScriptAnchor_toc"></a><a href="#32865ScriptAnchor_">retireButton</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33060ScriptAnchor_toc"></a><a href="#33060ScriptAnchor_">CHUNK_retire</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33024ScriptAnchor_toc"></a><a href="#33024ScriptAnchor_">retireButtonOnViewLayout</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32806ScriptAnchor_toc"></a><a href="#32806ScriptAnchor_">retireCheckbox</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32836ScriptAnchor_toc"></a><a href="#32836ScriptAnchor_">HideButton</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33030ScriptAnchor_toc"></a><a href="#33030ScriptAnchor_">goBackButton_FindRecordsChunk</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32862ScriptAnchor_toc"></a><a href="#32862ScriptAnchor_">ShowButton</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="33214ScriptAnchor_toc"></a><a href="#33214ScriptAnchor_">action sort checkboxes</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="33203ScriptAnchor_toc"></a><a href="#33203ScriptAnchor_">orderTagsA</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33204ScriptAnchor_toc"></a><a href="#33204ScriptAnchor_">orderTagsB</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33205ScriptAnchor_toc"></a><a href="#33205ScriptAnchor_">orderTagsC</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33206ScriptAnchor_toc"></a><a href="#33206ScriptAnchor_">orderTagsD</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33020ScriptAnchor_toc"></a><a href="#33020ScriptAnchor_">checkRepeatDates</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33021ScriptAnchor_toc"></a><a href="#33021ScriptAnchor_">checkRepeatDatesMonth</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33022ScriptAnchor_toc"></a><a href="#33022ScriptAnchor_">markAllDays</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33028ScriptAnchor_toc"></a><a href="#33028ScriptAnchor_">hideCheckbox</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="32778ScriptAnchor_toc"></a><a href="#32778ScriptAnchor_">sorts</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="32830ScriptAnchor_toc"></a><a href="#32830ScriptAnchor_">sortRestoreAfterScript</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32902ScriptAnchor_toc"></a><a href="#32902ScriptAnchor_">DaySelectSortThenSort</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33052ScriptAnchor_toc"></a><a href="#33052ScriptAnchor_">CHUNK_DaySelectSortThenSort</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32909ScriptAnchor_toc"></a><a href="#32909ScriptAnchor_">WeekMonthSelectSortThenSort</a></td>
</tr>
<tr>
<td class="script_hier"><a name="105ScriptAnchor_toc"></a><a href="#105ScriptAnchor_">sortBrainstate</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32906ScriptAnchor_toc"></a><a href="#32906ScriptAnchor_">sortBrainstateWeekMonth</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32791ScriptAnchor_toc"></a><a href="#32791ScriptAnchor_">sortNumbers</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32867ScriptAnchor_toc"></a><a href="#32867ScriptAnchor_">sortMergeTo</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32795ScriptAnchor_toc"></a><a href="#32795ScriptAnchor_">sortAlpha</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32869ScriptAnchor_toc"></a><a href="#32869ScriptAnchor_">sortSubNumbers</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32796ScriptAnchor_toc"></a><a href="#32796ScriptAnchor_">sortSubAlpha</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32799ScriptAnchor_toc"></a><a href="#32799ScriptAnchor_">sortStart</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32800ScriptAnchor_toc"></a><a href="#32800ScriptAnchor_">sortStop</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32803ScriptAnchor_toc"></a><a href="#32803ScriptAnchor_">sortActivity</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32840ScriptAnchor_toc"></a><a href="#32840ScriptAnchor_">sortActivityWeek</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32805ScriptAnchor_toc"></a><a href="#32805ScriptAnchor_">sortID</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33085ScriptAnchor_toc"></a><a href="#33085ScriptAnchor_">sortBrainstateTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33087ScriptAnchor_toc"></a><a href="#33087ScriptAnchor_">sortNumbersTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33089ScriptAnchor_toc"></a><a href="#33089ScriptAnchor_">sortAlphaTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33090ScriptAnchor_toc"></a><a href="#33090ScriptAnchor_">sortSubNumbersTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33091ScriptAnchor_toc"></a><a href="#33091ScriptAnchor_">sortSubAlphaTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33092ScriptAnchor_toc"></a><a href="#33092ScriptAnchor_">sortStartTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33093ScriptAnchor_toc"></a><a href="#33093ScriptAnchor_">sortStopTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33094ScriptAnchor_toc"></a><a href="#33094ScriptAnchor_">sortActivityTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33095ScriptAnchor_toc"></a><a href="#33095ScriptAnchor_">sortActivityWeekTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33096ScriptAnchor_toc"></a><a href="#33096ScriptAnchor_">sortIDTotal</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33159ScriptAnchor_toc"></a><a href="#33159ScriptAnchor_">issueSortCategory</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33160ScriptAnchor_toc"></a><a href="#33160ScriptAnchor_">issueSortStatus</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33164ScriptAnchor_toc"></a><a href="#33164ScriptAnchor_">issueSortOrderNumber</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33161ScriptAnchor_toc"></a><a href="#33161ScriptAnchor_">issueSortDate</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="32960ScriptAnchor_toc"></a><a href="#32960ScriptAnchor_">backup</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="32946ScriptAnchor_toc"></a><a href="#32946ScriptAnchor_">backup</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32947ScriptAnchor_toc"></a><a href="#32947ScriptAnchor_">restoreBackup</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="32962ScriptAnchor_toc"></a><a href="#32962ScriptAnchor_">triggered scripts</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="121ScriptAnchor_toc"></a><a href="#121ScriptAnchor_">clear</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32895ScriptAnchor_toc"></a><a href="#32895ScriptAnchor_">layoutStatus</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33186ScriptAnchor_toc"></a><a href="#33186ScriptAnchor_">sortByNumber</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33103ScriptAnchor_toc"></a><a href="#33103ScriptAnchor_">layoutExit</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33059ScriptAnchor_toc"></a><a href="#33059ScriptAnchor_">xpLayout</a></td>
</tr>
<tr>
<td class="script_hier"><a name="124ScriptAnchor_toc"></a><a href="#124ScriptAnchor_">exitField</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33228ScriptAnchor_toc"></a><a href="#33228ScriptAnchor_">exitFieldSortCatTags</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32855ScriptAnchor_toc"></a><a href="#32855ScriptAnchor_">goToField</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="32782ScriptAnchor_toc"></a><a href="#32782ScriptAnchor_">not sure if these are being used</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="32868ScriptAnchor_toc"></a><a href="#32868ScriptAnchor_">clearAndExit</a></td>
</tr>
<tr>
<td class="script_hier"><a name="78ScriptAnchor_toc"></a><a href="#78ScriptAnchor_">showInactiveToo????</a></td>
</tr>
<tr>
<td class="script_hier"><a name="32819ScriptAnchor_toc"></a><a href="#32819ScriptAnchor_">chartTime???</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33000ScriptAnchor_toc"></a><a href="#33000ScriptAnchor_">to 31 Copy</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33016ScriptAnchor_toc"></a><a href="#33016ScriptAnchor_">zoom150</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33013ScriptAnchor_toc"></a><a href="#33013ScriptAnchor_">moveToNewDayPart2</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33027ScriptAnchor_toc"></a><a href="#33027ScriptAnchor_">folderStopwatchCheck</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="33208ScriptAnchor_toc"></a><a href="#33208ScriptAnchor_">specific action log</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="33035ScriptAnchor_toc"></a><a href="#33035ScriptAnchor_">recordLoad</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33115ScriptAnchor_toc"></a><a href="#33115ScriptAnchor_">loadIssuerecordID</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33124ScriptAnchor_toc"></a><a href="#33124ScriptAnchor_">loadLogrecordID</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33050ScriptAnchor_toc"></a><a href="#33050ScriptAnchor_">checkForChanges</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33123ScriptAnchor_toc"></a><a href="#33123ScriptAnchor_">deleteIssue</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33129ScriptAnchor_toc"></a><a href="#33129ScriptAnchor_">deletePrefix</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33118ScriptAnchor_toc"></a><a href="#33118ScriptAnchor_">deleteStatus</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33119ScriptAnchor_toc"></a><a href="#33119ScriptAnchor_">deleteTag</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33125ScriptAnchor_toc"></a><a href="#33125ScriptAnchor_">PHASEDOUTgotoIssueResolution</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33126ScriptAnchor_toc"></a><a href="#33126ScriptAnchor_">gotoDayOnMainScreen</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33130ScriptAnchor_toc"></a><a href="#33130ScriptAnchor_">linkActionToDay</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33131ScriptAnchor_toc"></a><a href="#33131ScriptAnchor_">viewLogIssues</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33132ScriptAnchor_toc"></a><a href="#33132ScriptAnchor_">viewAllLogIssues</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33133ScriptAnchor_toc"></a><a href="#33133ScriptAnchor_">dateStampIssue</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33135ScriptAnchor_toc"></a><a href="#33135ScriptAnchor_">timeStampIssue</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33136ScriptAnchor_toc"></a><a href="#33136ScriptAnchor_">addTimeSegmentToIssue</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33134ScriptAnchor_toc"></a><a href="#33134ScriptAnchor_">activityLog!!!!findAllBrainstateLogs</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33138ScriptAnchor_toc"></a><a href="#33138ScriptAnchor_">CHUNK_updateIssueCategoryTime</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33146ScriptAnchor_toc"></a><a href="#33146ScriptAnchor_">gotoIssuesLog</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33147ScriptAnchor_toc"></a><a href="#33147ScriptAnchor_">gotoTagMenus</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33148ScriptAnchor_toc"></a><a href="#33148ScriptAnchor_">zoomLogIN_DELETE!!!!!!</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33150ScriptAnchor_toc"></a><a href="#33150ScriptAnchor_">zoomMainIN</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33149ScriptAnchor_toc"></a><a href="#33149ScriptAnchor_">zoomLogOUT_DELETE!!!!!!</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33151ScriptAnchor_toc"></a><a href="#33151ScriptAnchor_">zoomMainOUT</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33163ScriptAnchor_toc"></a><a href="#33163ScriptAnchor_">goToIssueFromAssignedTimeSegment</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33174ScriptAnchor_toc"></a><a href="#33174ScriptAnchor_">stopSortWhileReviewChangingStatusAndGroup</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33109ScriptAnchor_toc"></a><a href="#33109ScriptAnchor_">newActPart1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33172ScriptAnchor_toc"></a><a href="#33172ScriptAnchor_">newActPart2</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33194ScriptAnchor_toc"></a><a href="#33194ScriptAnchor_">newActPart2cancel</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33121ScriptAnchor_toc"></a><a href="#33121ScriptAnchor_">newTag</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33120ScriptAnchor_toc"></a><a href="#33120ScriptAnchor_">newItem</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33144ScriptAnchor_toc"></a><a href="#33144ScriptAnchor_">uniqueTagNameRequired</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33145ScriptAnchor_toc"></a><a href="#33145ScriptAnchor_">uniqueStatusNameRequired</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33226ScriptAnchor_toc"></a><a href="#33226ScriptAnchor_">uniqueTagGroupNameRequired</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33234ScriptAnchor_toc"></a><a href="#33234ScriptAnchor_">TagNameRequired</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33114ScriptAnchor_toc"></a><a href="#33114ScriptAnchor_">issueCancelNewIssueScript</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33107ScriptAnchor_toc"></a><a href="#33107ScriptAnchor_">statusChangeDate</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33112ScriptAnchor_toc"></a><a href="#33112ScriptAnchor_">TsubtotalTimeByGroup</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33239ScriptAnchor_toc"></a><a href="#33239ScriptAnchor_">addTagToSpecificActionRecord</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33173ScriptAnchor_toc"></a><a href="#33173ScriptAnchor_">TsubtotalTimeByGroupForStatus</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33166ScriptAnchor_toc"></a><a href="#33166ScriptAnchor_">TsubtotalTimeByOrder</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33113ScriptAnchor_toc"></a><a href="#33113ScriptAnchor_">Tstatus</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33170ScriptAnchor_toc"></a><a href="#33170ScriptAnchor_">findGroupPart1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33169ScriptAnchor_toc"></a><a href="#33169ScriptAnchor_">findGroupPart2</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33152ScriptAnchor_toc"></a><a href="#33152ScriptAnchor_">gotoIssueOrder</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33143ScriptAnchor_toc"></a><a href="#33143ScriptAnchor_">gotoFieldItemPart3a</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33110ScriptAnchor_toc"></a><a href="#33110ScriptAnchor_">gotoIssues</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33235ScriptAnchor_toc"></a><a href="#33235ScriptAnchor_">gotoStatus</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33236ScriptAnchor_toc"></a><a href="#33236ScriptAnchor_">gotoStatusFIND</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33230ScriptAnchor_toc"></a><a href="#33230ScriptAnchor_">gotoTimer</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33233ScriptAnchor_toc"></a><a href="#33233ScriptAnchor_">tagSort</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33231ScriptAnchor_toc"></a><a href="#33231ScriptAnchor_">gotoDay</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33237ScriptAnchor_toc"></a><a href="#33237ScriptAnchor_">updateModifyDate</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33116ScriptAnchor_toc"></a><a href="#33116ScriptAnchor_">keepblankstatusrecord</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33165ScriptAnchor_toc"></a><a href="#33165ScriptAnchor_">keepBlankGroupRecord</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33223ScriptAnchor_toc"></a><a href="#33223ScriptAnchor_">newTagGroup</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33117ScriptAnchor_toc"></a><a href="#33117ScriptAnchor_">deleteObservation</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33219ScriptAnchor_toc"></a><a href="#33219ScriptAnchor_">startTimerAssignTimeSegmentToSpecificAction</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33220ScriptAnchor_toc"></a><a href="#33220ScriptAnchor_">stopTimerAssignedToSpecificAction</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33221ScriptAnchor_toc"></a><a href="#33221ScriptAnchor_">toggleViewToSeeAllWindows</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33222ScriptAnchor_toc"></a><a href="#33222ScriptAnchor_">openSpecificActionWebLink</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33229ScriptAnchor_toc"></a><a href="#33229ScriptAnchor_">updateTimerTotalTimeInTagWindow</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="33212ScriptAnchor_toc"></a><a href="#33212ScriptAnchor_">alarm</a></td>
</tr>
<tr>
<td class="script_hier">
<table class="script_hier">
<tbody>
<tr class="script_hier_guide">
<td class="script_hier_spacer"></td><td class="script_hier">
<table class="script_hier">
<tbody>
<tr>
<td class="script_hier"><a name="33012ScriptAnchor_toc"></a><a href="#33012ScriptAnchor_">timerPart1</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33011ScriptAnchor_toc"></a><a href="#33011ScriptAnchor_">timerPart2</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33014ScriptAnchor_toc"></a><a href="#33014ScriptAnchor_">timerRepeatAlarm</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td class="script_hier"><a name="33036ScriptAnchor_toc"></a><a href="#33036ScriptAnchor_">iphoneFitToScreen</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33108ScriptAnchor_toc"></a><a href="#33108ScriptAnchor_">refreshWindow</a></td>
</tr>
<tr>
<td class="script_hier"><a name="33238ScriptAnchor_toc"></a><a href="#33238ScriptAnchor_">DLETE!!!!!!</a></td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33036ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"></td><td class="script_navbar"><a href="#33108ScriptAnchor_"><span>Next Script: [refreshWindow]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">iphoneFitToScreen</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Zoom Level
[ 150% ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33108ScriptAnchor_"></a><td class="script_navbar"><a href="#33036ScriptAnchor_"><span>Previous Script: [iphoneFitToScreen]</span></a></td><td class="script_navbar"></td><td class="script_navbar"><a href="#33238ScriptAnchor_"><span>Next Script: [DLETE!!!!!!]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">refreshWindow</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33238ScriptAnchor_"></a><td class="script_navbar"><a href="#33108ScriptAnchor_"><span>Previous Script: [refreshWindow]</span></a></td><td class="script_navbar"></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">DLETE!!!!!!</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="32772ScriptAnchor_"></a><a href="#32772ScriptAnchor_toc">start close</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="115ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#32772ScriptAnchor_"><span>Parent Folder: [start close]</span></a></td><td class="script_navbar"><a href="#32978ScriptAnchor_"><span>Next Script: [close]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">start</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE save out graphic objects to external folder for reference in graphs and then go to the user layout</li>
<li>#</li>
<li>#test</li>
<li>#</li>
<li>#1 save out graphic objects to external folder for reference in graphs</li>
<li>//  Set Variable [ $path; Value:"file:" &amp; Get(TemporaryPath) &amp; "1.gif" ]</li>
<li>//  Export Field Contents [ reference::gResources; &ldquo;$path&rdquo; ]</li>
<li>//  Set Variable [ $path; Value:"file:" &amp; Get(TemporaryPath) &amp; "2.gif" ]</li>
<li>//  Export Field Contents [ reference::gResources[3]; &ldquo;$path&rdquo; ]</li>
<li>#</li>
<li>#2 go to the user layout</li>
<li>Go to Layout [ &ldquo;users&rdquo; (steward) ]</li>
<li>Show All Records</li>
<li>Sort Records [ Specified Sort Order: steward::FirstName; ascending
steward::LastName; ascending ]
[ Restore; No dialog ]</li>
<li>If [ steward::windowZoom = 150 ]</li>
<li>Set Zoom Level
[ 100% ]</li>
<li>Else If [ steward::windowZoom = 200 ]</li>
<li>Set Zoom Level
[ 100% ]</li>
<li>Else If [ steward::windowZoom = 300 ]</li>
<li>Set Zoom Level
[ 100% ]</li>
<li>Else If [ steward::windowZoom = 400 ]</li>
<li>Set Zoom Level
[ 100% ]</li>
<li>End If</li>
<li>//  Adjust Window
[ Maximize ]</li>
<li>Adjust Window
[ Resize to Fit ]</li>
<li>Move/Resize Window [ Current Window; Width:  Get (ScreenWidth)  * .8; Top: Get (ScreenHeight)  * .05; Left:  Get (ScreenWidth)  * .1 ]</li>
<li>Set Window Title [ Current Window; New Title: "HelpGiveThanks Solutions" ]</li>
<li>#</li>
<li>#Show regular menus if Admin logs in only.</li>
<li>Show/Hide Text Ruler
[ Hide ]</li>
<li>If [ Get ( AccountName ) = "Admin" ]</li>
<li>Show/Hide Status Area
[ Hide ]</li>
<li>Install Menu Set [ &ldquo;[Standard FileMaker Menus]&rdquo; ]</li>
<li>Else</li>
<li>Show/Hide Status Area
[ Lock; Hide ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::gResources</li>
<li>
<em>steward</em>::FirstName</li>
<li>
<em>steward</em>::LastName</li>
<li>
<em>steward</em>::windowZoom</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>users</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul>
<li>[Standard FileMaker Menus]</li>
</ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32978ScriptAnchor_"></a><td class="script_navbar"><a href="#115ScriptAnchor_"><span>Previous Script: [start]</span></a></td><td class="script_navbar"><a href="#32772ScriptAnchor_"><span>Parent Folder: [start close]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">close</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE save out graphic objects to external folder for reference in graphs and then go to the user layout</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>//  #2 flag/unflag active stopwatch field for conditional formatting on main screen if current screen is total layout</li>
<li>//  If [ Left ( Get ( LayoutName ) ; 5 ) = "total" or Left ( Get ( LayoutName ) ; 5 )  =  "grand" ]</li>
<li>//  Perform Script [ &ldquo;folderStopwatchCheck&rdquo; ]</li>
<li>//  End If</li>
<li>#</li>
<li>#1 set the layout status field</li>
<li>//  If [ Get ( SystemPlatform )  &ne;  3 and steward::iPhoneLayout  =  "" ]</li>
<li>//  Set Field [ steward::windowSizeAndPlace; Get ( WindowHeight ) ]</li>
<li>//  Set Field [ steward::windowSizeAndPlace[2]; Get ( WindowWidth ) ]</li>
<li>//  Set Field [ steward::windowSizeAndPlace[3]; Get ( WindowTop ) ]</li>
<li>//  Set Field [ steward::windowSizeAndPlace[4]; Get ( WindowLeft ) ]</li>
<li>//  Exit Script [  ]</li>
<li>//  End If</li>
<li>//  Set Field [ steward::windowSizeAndPlace[5]; Get ( WindowHeight ) ]</li>
<li>//  Set Field [ steward::windowSizeAndPlace[6]; Get ( WindowWidth ) ]</li>
<li>//  Set Field [ steward::windowSizeAndPlace[7]; Get ( WindowTop ) ]</li>
<li>//  Set Field [ steward::windowSizeAndPlace[8]; Get ( WindowLeft ) ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::iPhoneLayout</li>
<li>
<em>steward</em>::windowSizeAndPlace</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33027ScriptAnchor_">folderStopwatchCheck</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="32774ScriptAnchor_"></a><a href="#32774ScriptAnchor_toc">total</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32811ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#32774ScriptAnchor_"><span>Parent Folder: [total]</span></a></td><td class="script_navbar"><a href="#32941ScriptAnchor_"><span>Next Script: [CHUNK_recalculateTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">showLinkedRecords</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#102ScriptAnchor_">note veto view</a></li>
<li><a href="#33047ScriptAnchor_">note veto view (old: opened things in new windows)</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE on the normal record view layouts the user is shown a total linkID number underlined to indicated that it is a button and a view button for all total and grand total records.  These two buttons -- linkID number and view -- activate this script whose purpose is to 1) navigate from the current layout to the totalview layout, and 2) find and display the linked records.  For example, the user may have several leg exercises they do each tracked by separate record and all of them totaled in one leg exercise total record.  Clicking on the view button for the total record or the linkID number of this total record displayed next all the leg exercise records will activitate this script with result being the display of just these leg exercise records and the leg exercise total record.  The user could take advantage of this feature to hide the leg exercise records displaying only the total record and when they wish to record leg exercise time, the user could click the view button see all the associated records, update them and then return to the main screen in which once again only the total record (now updated with new time) would be shown (along with all the other records the user wants to see.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 check to insure the record is linked and if not stop the script.  (This is neccessary because filemaker allows the link button that activitates this script to be hidden but not deactivited, and it should not run if there are no records for it to find and display.)</li>
<li>If [ brainstate::groupID = "" and brainstate::groupOfGroupID = "" ]</li>
<li>Halt Script</li>
<li>#</li>
<li>#2 if the record is part of total (or is the total record) find and display all linked records and set the users choosen day field.</li>
<li>Else If [ brainstate::groupID  &ne;  "" ]</li>
<li>Set Variable [ $mergeID; Value:brainstate::groupID ]</li>
<li>Set Field [ steward::chosenDayTotal; brainstate::day1 ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupID; $mergeID ]</li>
<li>Set Field [ brainstate::sortRetired; "=" ]</li>
<li>Perform Find [  ]</li>
<li>#NOT TESTED</li>
<li>If [ Get ( SystemPlatform ) = 3 or steward::iPhoneLayout &ne; "" ]</li>
<li>Go to Layout [ &ldquo;TotalMainiPhone&rdquo; (brainstate) ]</li>
<li>Else If [ Get ( SystemPlatform )  &ne; 3 or steward::iPhoneLayout  =  "" ]</li>
<li>Go to Layout [ &ldquo;TotalMain&rdquo; (brainstate) ]</li>
<li>End If</li>
<li>#END NOT TESTED</li>
<li>#set the retired status to r (assume the user always only wants to show current set of records minus the ones they have retired) </li>
<li>Set Field [ steward::retiredStatus; "r" ]</li>
<li>#future developement: omit retired records if the retired button is on</li>
<li>//  Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>//  Sort Records [ Specified Sort Order: brainstate::groupType; based on value list: &ldquo;MergeSort&rdquo;
brainstate::_lockBrainstateID; descending ]
[ Restore; No dialog ]</li>
<li>#save the recordnumber which will now be erased by the next script</li>
<li>Set Variable [ $$recordnumber2; Value:$$recordnumber ]</li>
<li>Perform Script [ &ldquo;DaySelectSortThenSort&rdquo; ]</li>
<li>Halt Script</li>
<li>#</li>
<li>#3 if the record is part of a grand total (or is the grand total record) find and display all linked records.</li>
<li>Else If [ brainstate::groupOfGroupID  &ne;  "" ]</li>
<li>Set Variable [ $mergeGrandID; Value:brainstate::groupOfGroupID ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupOfGroupID; $mergeGrandID ]</li>
<li>Perform Find [  ]</li>
<li>#future developement: omit retired records if the retired button is on</li>
<li>//  Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>Go to Layout [ &ldquo;GrandTotal&rdquo; (brainstate) ]</li>
<li>//  Sort Records [ Specified Sort Order: brainstate::groupType; based on value list: &ldquo;MergeSort&rdquo;
brainstate::_lockBrainstateID; descending ]
[ Restore; No dialog ]</li>
<li>Perform Script [ &ldquo;DaySelectSortThenSort&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>brainstate</em>::groupOfGroupID</li>
<li>
<em>brainstate</em>::day1</li>
<li>
<em>steward</em>::chosenDayTotal</li>
<li>
<em>brainstate</em>::sortRetired</li>
<li>
<em>steward</em>::iPhoneLayout</li>
<li>
<em>steward</em>::retiredStatus</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32902ScriptAnchor_">DaySelectSortThenSort</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>TotalMainiPhone</li>
<li>TotalMain</li>
<li>GrandTotal</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32941ScriptAnchor_"></a><td class="script_navbar"><a href="#32811ScriptAnchor_"><span>Previous Script: [showLinkedRecords]</span></a></td><td class="script_navbar"><a href="#32774ScriptAnchor_"><span>Parent Folder: [total]</span></a></td><td class="script_navbar"><a href="#32939ScriptAnchor_"><span>Next Script: [CHUNK_recalculateGrandTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNK_recalculateTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32832ScriptAnchor_">seperateFromTotal</a></li>
<li><a href="#32940ScriptAnchor_">CHUNK_deleteRecordsTimeFromTotal</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE recalculate the total time for each day for the given set of records</li>
<li>#CHUNK USED BY DeleteBrainstate Script</li>
<li>#CHUNK USED BY seperateFromTotal Script</li>
<li>#</li>
<li>#</li>
<li>#NOTE: the three # symbols set apart chunks of script.  </li>
<li>#NOTE: the finish and error script chunks are almost identical (the error message differ in telling where in the script they occur).  For this reason, they are not numbered as part of a particular chuck of the script, and are separated by three # symbols to set them apart.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>Set Variable [ $brainstateID; Value:brainstate::groupID ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#A) BEGIN delete total's day records</li>
<li>#</li>
<li>#1 delete all the total's day records, which will include some of the time from the just separated or soon to be deleted record.  (Now we are ready to create new total records for the records that remain.)</li>
<li>Enter Find Mode [  ]</li>
<li>Go to Layout [ &ldquo;calcTotalNewRecord&rdquo; (day2) ]</li>
<li>Set Field [ day2::_keyBrainstate; $brainstateID ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#2 double check to insure records to be deleted are the right records.  (During testing all 900+ records where deleted from my database.  I think what happened is the find came up with zero records and then displayed all the records in the database and the next step deleted them.  This If check will prevent that from happening again if that is what happened.  I have been unable to duplicate this massive error, so this might not be reason why all the records where deleted, but this is the only time when the database is told to delete all found records, rather than just one record, so I figure it must have been caused here.)</li>
<li>If [ day2::_keyBrainstate = $brainstateID ]</li>
<li>Delete All Records
[ No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#A) END delete total's day records</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Loop</li>
<li>#B) BEGIN check if there are records to be totaled</li>
<li>#</li>
<li>#1 make sure there is a record to be totaled (this step will be important when this loop is repeated after the first record to be totaled is omitted).</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#If all records are empty then the total is complete and now the user needs to be shown the new total record and all the records that will feed into it until they are separated.</li>
<li>If [ brainstate::_lockBrainstateID = brainstate::groupID ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#B) END check if there are records to be totaled</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#C BEGIN find total record's related day records</li>
<li>#</li>
<li>#1 make a list of the first brainstate's day records in a new window</li>
<li>Set Variable [ $CurrentBrainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ day1::_keyBrainstate; $CurrentBrainstateID ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#C END find total record's related day records</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#D BEGIN no records found loop (this loop will either complete the total process or find a record with related day records to be added to the total record)
</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#1 if records are found exit loop</li>
<li>Exit Loop If [ Get ( LastError )  = 0 ]</li>
<li>#</li>
<li>#2 clear the merge field (the big X in the box on the ToBeMerged layout) and omit this record</li>
<li>If [ Get ( LastError )  = 401 ]</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>Set Field [ brainstate::groupAddCheckbox; "" ]</li>
<li>Omit Record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#If all records are empty then the total is complete and now the user needs to be shown the new total record and all the records that will feed into it until they are separated.</li>
<li>If [ brainstate::_lockBrainstateID = brainstate::groupID ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#BEGIN find error 2</li>
<li>Else If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming merge script part D2."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#Find all records user had showing when they clicked the merge button</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>If [ steward::retiredStatus = "r" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>If [ steward::hideStatus = "" and steward::showORhide = "hide" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::hide: &ldquo;t&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::showStatus  &ne;  "" and steward::showORhide = "show" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::Show: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END find error 2
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#3 make a list of this record's day records in a new window.</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ day1::_keyBrainstate; $CurrentBrainstateID ]</li>
<li>Perform Find [  ]</li>
<li>End Loop</li>
<li>#</li>
<li>#D END no records found loop (this loop will either complete the total process or find a record with related day records to be added to the total record)
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#E BEGIN create new related day records and add selected record's time to them</li>
<li>#</li>
<li>Loop</li>
<li>#1 find any day records for the new brainstate that match the kfDay of the first merge record.  If this new record already has data in it, then we want to add new data to the old data; not replace the old data with new data.</li>
<li>Set Variable [ $mergeDay; Value:day1::_keyDay ]</li>
<li>Enter Find Mode [  ]</li>
<li>Go to Layout [ &ldquo;calcTotalNewRecord&rdquo; (day2) ]</li>
<li>Set Field [ day2::_keyBrainstate; $brainstateID ]</li>
<li>Set Field [ day2::_keyDay; $mergeDay ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#2 if no matches are found, create a new day record and put in the time of the first the current day record</li>
<li>If [ Get ( LastError )  = 401 ]</li>
<li>New Record/Request</li>
<li>Set Field [ day2::_keyBrainstate; $brainstateID ]</li>
<li>Set Field [ day2::_keyDay; $mergeDay ]</li>
<li>Set Field [ day2::swStart; day2::_keyDay &amp; " 0:00:00" ]</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Set Variable [ $TotalActivity; Value:day1::swTotalActivity ]</li>
<li>Go to Layout [ &ldquo;calcTotalNewRecord&rdquo; (day2) ]</li>
<li>Set Field [ day2::swPause; Case ( 

$TotalActivity    &gt;   Time ( 23 ; 59 ; 59 )  ; day2::_keyDay &amp;  " 24:00:00" ; 

$TotalActivity     &lt;   Time ( 0 ; 0 ; 0 )  ; day2::_keyDay &amp;  " 00:00:00" ; 

day2::_keyDay &amp; " "  &amp; $TotalActivity )

//insures that no more than 24 hours will be put into a day and that a day with negative time does not cause an error. ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN find error 3</li>
<li>Else If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error" &amp; Get ( LastError )  &amp;  "peforming merge script part E2."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#Find all records user had showing when they clicked the merge button.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>If [ steward::retiredStatus = "r" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>If [ steward::hideStatus = "" and steward::showORhide = "hide" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::hide: &ldquo;t&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::showStatus  &ne;  "" and steward::showORhide = "show" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::Show: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>#END find error 3
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#3 if a match is found, then add the current day's time to this day's time.</li>
<li>Else If [ Get ( LastError )  = 0 ]</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Set Variable [ $TotalActivity; Value:day1::swTotalActivity ]</li>
<li>Go to Layout [ &ldquo;calcTotalNewRecord&rdquo; (day2) ]</li>
<li>Set Field [ day2::swPause; Case ( 

$TotalActivity +  day2::swTotalActivity    &gt;   Time ( 23 ; 59 ; 59 )  ; day2::_keyDay &amp;  " 24:00:00" ; 

$TotalActivity +  day2::swTotalActivity    &lt;   Time ( 0 ; 0 ; 0 )  ; day2::_keyDay &amp;  " 00:00:00" ; 

day2::_keyDay &amp; " "  &amp; ($TotalActivity +  day2::swTotalActivity)  )

//insures that no more than 24 hours will be put into a day and that a day with negative time does not cause an error. ]</li>
<li>End If</li>
<li>#</li>
<li>#4 repeat loop for found record's next related day record.</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#E END create new related day records and add selected record's time to them</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#F BEGIN go to next record with related day records to be added to the new total record.</li>
<li>#</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>#Clear the merge field (the big X in the box on the ToBeMerged layout).</li>
<li>Set Field [ brainstate::groupAddCheckbox; "" ]</li>
<li>Omit Record</li>
<li>#</li>
<li>#F END go to next record with related day records to be added to the new total record.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>End Loop</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>day2</em>::_keyBrainstate</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>day1</em>::_keyBrainstate</li>
<li>
<em>brainstate</em>::groupAddCheckbox</li>
<li>
<em>steward</em>::retiredStatus</li>
<li>
<em>brainstate</em>::sortRetired</li>
<li>
<em>steward</em>::hideStatus</li>
<li>
<em>steward</em>::showORhide</li>
<li>
<em>brainstate</em>::hide</li>
<li>
<em>steward</em>::showStatus</li>
<li>
<em>brainstate</em>::Show</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>day2</em>::_keyDay</li>
<li>
<em>day2</em>::swStart</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swPause</li>
<li>
<em>day2</em>::swTotalActivity</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>calcTotalNewRecord</li>
<li>calcBrainstateTable</li>
<li>calcTotalSelectedList</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32939ScriptAnchor_"></a><td class="script_navbar"><a href="#32941ScriptAnchor_"><span>Previous Script: [CHUNK_recalculateTotal]</span></a></td><td class="script_navbar"><a href="#32774ScriptAnchor_"><span>Parent Folder: [total]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNK_recalculateGrandTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32832ScriptAnchor_">seperateFromTotal</a></li>
<li><a href="#32928ScriptAnchor_">seperateFromGrandtotal</a></li>
<li><a href="#32948ScriptAnchor_">CHUNK_deleteRecordsTimeFromGrandtotal</a></li>
<li><a href="#110ScriptAnchor_">deleteBrainstate</a></li>
<li><a href="#33023ScriptAnchor_">deleteBrainstateFromTotal</a></li>
<li><a href="#32942ScriptAnchor_">CHUNK_deleteTotalOrGrandtotalRecord</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE add selected record's time data to an existing grand total record</li>
<li>#CHUNK USED BY DeleteBrainstate Script</li>
<li>#CHUNK USED BY seperateFromTotal Script</li>
<li>#CHUNK USED BY CHUNK_deleteRecordsTimeFromGrandtotal Script</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#NOTE: the three # symbols set apart chunks of script.  </li>
<li>#NOTE: the finish and error script chunks are almost identical (the error message differ in telling where in the script they occur).  For this reason, they are not numbered as part of a particular chuck of the script, and are separated by three # symbols to set them apart.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#A) BEGIN prepare records for update</li>
<li>#</li>
<li>#1 capture total record's ID number</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupAddCheckbox; descending
brainstate::groupType; based on value list: &ldquo;MergeSort&rdquo; ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $brainstateID; Value:brainstate::groupOfGroupID ]</li>
<li>Set Variable [ $totalbrainstateID; Value:brainstate::groupID ]</li>
<li>#</li>
<li>#2 unflag grand total update</li>
<li>Set Field [ brainstate::groupOfGroupUpdate; "" ]</li>
<li>#</li>
<li>#3 delete all its records which will include some of the time from the just separated record.  (Now we are ready to create new grandtotal day records.)</li>
<li>Enter Find Mode [  ]</li>
<li>Go to Layout [ &ldquo;calcTotalNewRecord&rdquo; (day2) ]</li>
<li>Set Field [ day2::_keyBrainstate; $brainstateID ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#4 double check to insure records to be deleted are the right records.  (During testing all 900+ records where deleted from my database.  I think what happened is the find came up with zero records and then displayed all the records in the database and the next step deleted them.  This If check will prevent that from happening again if that is what happened.  I have been unable to duplicate this massive error, so this might not be reason why all the records where deleted, but this is the only time when the database is told to delete all found records, rather than just one record, so I figure it must have been caused here.)</li>
<li>If [ day2::_keyBrainstate = $brainstateID ]</li>
<li>Delete All Records
[ No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#5 make a list of only the records to be added and the total record</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupOfGroupID; $brainstateID ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#BEGIN find error 1</li>
<li>If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number.
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming CHUNK_recalculateGrandTotal script part A1."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#Find all records user had showing when they clicked the merge button</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>If [ steward::retiredStatus = "r" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>If [ steward::hideStatus = "" and steward::showORhide = "hide" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::hide: &ldquo;t&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::showStatus  &ne;  "" and steward::showORhide = "show" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::Show: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END find error 1
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#6 link all records</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupType; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>Set Variable [ $brainstateDisplayID; Value:brainstate::_Number ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::groupOfGroupID; $brainstateID ]</li>
<li>Set Field [ brainstate::groupOfGroupDisplayID; $brainstateDisplayID ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#A) END prepare records for update</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#B) BEGIN add a merge record's ID# to the description of the new GRAND total record.</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#1 make sure there is a record to be merged (this step will be important when this loop is repeated after the first record to be merged is omitted).</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>If [ brainstate::_lockBrainstateID  &ne;  brainstate::groupOfGroupID ]</li>
<li>#</li>
<li>#2 capture merged ID number for GRAND total's linkinfo field: total of: ID, ID, ID, etc.</li>
<li>Set Variable [ $CurrentBrainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $CurrentBrainstateDisplayID; Value:brainstate::_Number ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN finish</li>
<li>Else If [ brainstate::_lockBrainstateID = brainstate::groupOfGroupID ]</li>
<li>#If all records are empty then the merge is complete and now the user needs to be shown the new GRAND total record and all the records that will feed into it until they are separated.</li>
<li>Exit Script [  ]</li>
<li>#END finish</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#B) END add a merge record's ID# to the description of the new total record.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#C) BEGIN find merge record's related day records</li>
<li>#</li>
<li>#1 make a list of the first brainstate's day records in a new window</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ day1::_keyBrainstate; $CurrentBrainstateID ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#C) END find merge record's related day records</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#D BEGIN no records found loop (this loop will either complete the merge process or find a merge record with related day records)
</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#1 if records are found exit loop</li>
<li>Exit Loop If [ Get ( LastError )  = 0 ]</li>
<li>#</li>
<li>#2 clear the merge field (the big X in the box on the ToBeMerged layout) and omit this record</li>
<li>If [ Get ( LastError )  = 401 ]</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>Set Field [ brainstate::groupOfGroupAddCheckbox; "" ]</li>
<li>Omit Record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN finish</li>
<li>If [ brainstate::_lockBrainstateID = brainstate::groupOfGroupID ]</li>
<li>#If all records are empty then the merge is complete and now the user needs to be shown the new GRAND total record and all the records that will feed into it until they are separated.</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#END finish</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN find error 2</li>
<li>Else If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming CHUNK_recalculateGrandTotal script part D2."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#Find all records user had showing when they clicked the merge button</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>If [ steward::retiredStatus = "r" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>If [ steward::hideStatus = "" and steward::showORhide = "hide" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::hide: &ldquo;t&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::showStatus  &ne;  "" and steward::showORhide = "show" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::Show: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END find error 2
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#3 capture next records ID number for total's linkinfo field: total of: ID, ID, ID, etc.</li>
<li>Set Variable [ $CurrentBrainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $CurrentBrainstateDisplayID; Value:brainstate::_Number ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#4 make a list of this record's day records in a new window.</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ day1::_keyBrainstate; $CurrentBrainstateID ]</li>
<li>Perform Find [  ]</li>
<li>End Loop</li>
<li>#</li>
<li>#D END no records found loop 
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#E BEGIN create new related day records and add selected record's time to them</li>
<li>#</li>
<li>Loop</li>
<li>#1 find any day records for the new brainstate that match the kfDay of the first merge record.  If this new record already has data in it, then we want to add new data to the old data; not replace the old data with new data.</li>
<li>Set Variable [ $mergeDay; Value:day1::_keyDay ]</li>
<li>Enter Find Mode [  ]</li>
<li>Go to Layout [ &ldquo;calcTotalNewRecord&rdquo; (day2) ]</li>
<li>Set Field [ day2::_keyBrainstate; $brainstateID ]</li>
<li>Set Field [ day2::_keyDay; $mergeDay ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#2 if no matches are found, create a new day record and put in the time of the first the current day record</li>
<li>If [ Get ( LastError )  = 401 ]</li>
<li>New Record/Request</li>
<li>Set Field [ day2::_keyBrainstate; $brainstateID ]</li>
<li>Set Field [ day2::_keyDay; $mergeDay ]</li>
<li>Set Field [ day2::swStart; day2::_keyDay &amp; " 0:00:00" ]</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Set Variable [ $TotalActivity; Value:day1::swTotalActivity ]</li>
<li>Go to Layout [ &ldquo;calcTotalNewRecord&rdquo; (day2) ]</li>
<li>Set Field [ day2::swPause; Case ( 

$TotalActivity    &gt;   Time ( 23 ; 59 ; 59 )  ; day2::_keyDay &amp;  " 24:00:00" ; 

$TotalActivity     &lt;   Time ( 0 ; 0 ; 0 )  ; day2::_keyDay &amp;  " 00:00:00" ; 

day2::_keyDay &amp; " "  &amp; $TotalActivity )

//insures that no more than 24 hours will be put into a day and that a day with negative time does not cause an error. ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN find error 3</li>
<li>Else If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error" &amp; Get ( LastError )  &amp;  "peforming CHUNK_recalculateGrandTotal script part E2."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#Find all records user had showing when they clicked the merge button.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>If [ steward::retiredStatus = "r" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>If [ steward::hideStatus = "" and steward::showORhide = "hide" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::hide: &ldquo;t&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::showStatus  &ne;  "" and steward::showORhide = "show" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::Show: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>#END find error 3
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#3 if a match is found, then add the current day's time to this day's time.</li>
<li>Else If [ Get ( LastError )  = 0 ]</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Set Variable [ $TotalActivity; Value:day1::swTotalActivity ]</li>
<li>Go to Layout [ &ldquo;calcTotalNewRecord&rdquo; (day2) ]</li>
<li>Set Field [ day2::swPause; Case ( 

$TotalActivity +  day2::swTotalActivity    &gt;   Time ( 23 ; 59 ; 59 )  ; day2::_keyDay &amp;  " 24:00:00" ; 

$TotalActivity +  day2::swTotalActivity    &lt;   Time ( 0 ; 0 ; 0 )  ; day2::_keyDay &amp;  " 00:00:00" ; 

day2::_keyDay &amp; " "  &amp; ($TotalActivity +  day2::swTotalActivity)  )

//insures that no more than 24 hours will be put into a day and that a day with negative time does not cause an error. ]</li>
<li>End If</li>
<li>#</li>
<li>#4 repeat loop for found record's next related day record.</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#E END create new related day records and add selected record's time to them</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#F BEGIN go to next record with related day records to be added to the new total record.</li>
<li>#</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>#Clear the merge field (the big X in the box on the ToBeMerged layout).</li>
<li>Set Field [ brainstate::groupOfGroupAddCheckbox; "" ]</li>
<li>Omit Record</li>
<li>#</li>
<li>#F END go to next record with related day records to be added to the new total record.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>End Loop</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>brainstate</em>::groupAddCheckbox</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::groupOfGroupID</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>brainstate</em>::groupOfGroupUpdate</li>
<li>
<em>day2</em>::_keyBrainstate</li>
<li>
<em>steward</em>::retiredStatus</li>
<li>
<em>brainstate</em>::sortRetired</li>
<li>
<em>steward</em>::hideStatus</li>
<li>
<em>steward</em>::showORhide</li>
<li>
<em>brainstate</em>::hide</li>
<li>
<em>steward</em>::showStatus</li>
<li>
<em>brainstate</em>::Show</li>
<li>
<em>brainstate</em>::_Number</li>
<li>
<em>brainstate</em>::groupOfGroupDisplayID</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>day1</em>::_keyBrainstate</li>
<li>
<em>brainstate</em>::groupOfGroupAddCheckbox</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>day2</em>::_keyDay</li>
<li>
<em>day2</em>::swStart</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swPause</li>
<li>
<em>day2</em>::swTotalActivity</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>calcTotalNewRecord</li>
<li>calcBrainstateTable</li>
<li>calcTotalSelectedList</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="32964ScriptAnchor_"></a><a href="#32964ScriptAnchor_toc">triggered scripts</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32769ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#32964ScriptAnchor_"><span>Parent Folder: [triggered scripts]</span></a></td><td class="script_navbar"><a href="#32890ScriptAnchor_"><span>Next Script: [linkGrandDeny]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">linkDeny</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE on the total up layout there is a box for the user to click into to choose a record to be part of a new total record.  This script runs a test to see if the user may include the record chosen.  The reason behind this test is to prevent the user from replacing an already linked-to-a-total-record's link information in the form of that total record's ID currently in this linked record's linkID field.  While it might be nice to allow the user to count one record as part of several totals, the current design does not allow this.  </li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 check to insure record is not itself a total record.  (Replacing the linkID would turn this record into a normal record and stop it from functioning as a total of it's currently linked records time.)</li>
<li>If [ brainstate::_lockBrainstateID  = brainstate::groupID ]</li>
<li>Clear [  ]
[ Select ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "This is a total record.  You may create a grand total of two or more totals, or you can click the underlined number to the far right to open the screen that will allow you to make this total record a non-total record."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#2 check to insure record is not linked to a total record.  (Replacing the linkID would route all future time changes to be summed in the new total record the user is trying to create.)</li>
<li>If [ brainstate::groupID &ne; "" ]</li>
<li>Clear [  ]
[ Select ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "This record is part of another total record and cannot be included in this total unless you click on the underlined button to the far left that opens up a new screen, and then click on the separate button on that new screen."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::groupID</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32890ScriptAnchor_"></a><td class="script_navbar"><a href="#32769ScriptAnchor_"><span>Previous Script: [linkDeny]</span></a></td><td class="script_navbar"><a href="#32964ScriptAnchor_"><span>Parent Folder: [triggered scripts]</span></a></td><td class="script_navbar"><a href="#32930ScriptAnchor_"><span>Next Script: [addToLinkDeny]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">linkGrandDeny</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE on the total up layout there is a box for the user to click into to choose a record to be part of a new grand total record.  This script runs a test to see if the user may include the record chosen.  The reason behind this test is to prevent the user from replacing an already linked-to-a-grand-total-record's link information in the form of that grand total record's ID currently in this linked record's linkID field.  While it might be nice to allow the user to count one record as part of several grand totals, the current design does not allow this.  So until it is changed, the user must be prevented from unlinking a record while creating a new total record.  

The second purpose is to insure that only total records are included in grand totals.  This insures that no normal record is part of a total and part of the same grand total that its total record is a part of, which cause double counting the normal record's time in the grand total.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 check to insure that the record is not part of another grand total record.</li>
<li>If [ brainstate::groupOfGroupID &ne; "" ]</li>
<li>Clear [  ]
[ Select ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "This record is part of another grand total record (or is one) and cannot be included in another grand total."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>#</li>
<li>#2 check to insure that the record is a total record.</li>
<li>If [ brainstate::_lockBrainstateID   &ne;  brainstate::groupID ]</li>
<li>Clear [  ]
[ Select ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Only total records may be selected to create a grand total record."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::groupOfGroupID</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::groupID</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32930ScriptAnchor_"></a><td class="script_navbar"><a href="#32890ScriptAnchor_"><span>Previous Script: [linkGrandDeny]</span></a></td><td class="script_navbar"><a href="#32964ScriptAnchor_"><span>Parent Folder: [triggered scripts]</span></a></td><td class="script_navbar"><a href="#32972ScriptAnchor_"><span>Next Script: [addToGrandtotalDeny]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addToLinkDeny</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE on the add2total layout there is a box for the user to click into to choose a record to be part of a total record.  This script runs a test to see if the user may include the record chosen.  The reason behind this test is to prevent the user from replacing an already linked-to-a-total-record's link information in the form of that total record's ID currently in this linked record's linkID field.  While it might be nice to allow the user to count one record as part of several totals, the current design does not allow this.  </li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 check to insure record is not the total record being add to. </li>
<li>If [ brainstate::groupAddCheckbox  = "" and brainstate::groupType &ne; "" ]</li>
<li>Set Field [ brainstate::groupAddCheckbox; "t" ]</li>
<li>Go to Field [  ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Select available records to add to this total record or click the cancel button."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#2 check to insure record is not itself a total record.  (Replacing the linkID would turn this record into a normal record and stop it from functioning as a total of it's currently linked records time.)</li>
<li>If [ brainstate::_lockBrainstateID  = brainstate::groupID ]</li>
<li>Clear [  ]
[ Select ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "This is a total record.  You may not make it part of the currently selected total record."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#3 check to insure record is not linked to another total record.  (Replacing the linkID would route all future time changes to be summed in the new total record the user is trying to create.)</li>
<li>If [ brainstate::groupID &ne; "" ]</li>
<li>Clear [  ]
[ Select ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "This record is part of another total record and cannot be made part of this total record (unless you separate it from its total record)."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::groupAddCheckbox</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::groupID</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32972ScriptAnchor_"></a><td class="script_navbar"><a href="#32930ScriptAnchor_"><span>Previous Script: [addToLinkDeny]</span></a></td><td class="script_navbar"><a href="#32964ScriptAnchor_"><span>Parent Folder: [triggered scripts]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addToGrandtotalDeny</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE on the add2grandtotal layout there is a box for the user to click into to choose a record to be part of a total record.  This script runs a test to see if the user may include the record chosen.  The reason behind this test is to prevent the user from replacing an already linked-to-a-total-record's link information in the form of that total record's ID currently in this linked record's linkID field.  While it might be nice to allow the user to count one record as part of several totals, the current design does not allow this.  </li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 check to insure record is not the total record being add to. </li>
<li>If [ brainstate::groupOfGroupAddCheckbox  = "" and brainstate::_lockBrainstateID = brainstate::groupOfGroupID ]</li>
<li>Set Field [ brainstate::groupOfGroupAddCheckbox; "t" ]</li>
<li>Go to Field [  ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Select available records to add to this grandtotal record or click the cancel button."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#2 check to insure record is not itself a grandtotal record.  (Replacing the linkID would turn this record into a normal record and stop it from functioning as a total of it's currently linked records time.)</li>
<li>If [ brainstate::_lockBrainstateID  = brainstate::groupOfGroupID ]</li>
<li>Clear [  ]
[ Select ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "This is a grandtotal record.  You may not make it part of the currently selected grandtotal record."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#3 check to insure record is not linked to another total record.  (Replacing the linkID would route all future time changes to be summed in the new total record the user is trying to create.)</li>
<li>If [ brainstate::groupOfGroupID &ne; "" ]</li>
<li>Clear [  ]
[ Select ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "This record is part of another grandtotal record and cannot be made part of this grandtotal record (unless you separate it from its current grandtotal record first)."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::groupOfGroupAddCheckbox</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::groupOfGroupID</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="32966ScriptAnchor_"></a><a href="#32966ScriptAnchor_toc">action buttons</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="119ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#32966ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#33017ScriptAnchor_"><span>Next Script: [newTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">total</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE merge selected record's time data into </li>
<li>#one total record and then link these records so </li>
<li>#that time added in the future to any of the merge </li>
<li>#records will be automatically added to the one </li>
<li>#total record.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#NOTE: the three # symbols set apart chunks of script.  </li>
<li>#</li>
<li>#NOTE: the finish and error script chunks are almost</li>
<li>#identical (the error message differ in telling where </li>
<li>#in the script they occur).  For this reason, they are </li>
<li>#not numbered as part of a particular chuck of the</li>
<li>#script, and are separated by three # symbols to set</li>
<li>#them apart.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#A) BEGIN find selected merge records and create new total record and link all records together</li>
<li>#</li>
<li>#1 check if there are 1 or more records to merge and if not halt the script.  (Can't merge if zero records are selected.  1 record can be merged which is really making a copy of that record for instances where the user has been tracking 2 things with one brainstate but now wants to separate the tracking of these with 2 separate brainstate records.)</li>
<li>If [ brainstate::groupAddCheckboxCount &lt; 1 ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "At least 1 brainstates must be selected for a merge."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#2 make a list of only the records to be merged</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Set Field [ brainstate::groupAddCheckbox; "t" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN find error 1</li>
<li>If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number.
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming merge script part A2."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#Find all records user had showing when they clicked the merge button</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>If [ steward::retiredStatus = "r" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>If [ steward::hideStatus = "" and steward::showORhide = "hide" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::hide: &ldquo;t&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::showStatus  &ne;  "" and steward::showORhide = "show" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::Show: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END find error 1
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#3 create the new total record</li>
<li>Go to Layout [ &ldquo;01SortAndSchedule&rdquo; (brainstate) ]</li>
<li>New Record/Request</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Set Field [ brainstate::linkinfo; "total of: " ]</li>
<li>Set Field [ brainstate::description; "NEW TOTAL RECORD the ID numbers of the records totaled by this record can be seen by either clicking or hovering over the i at the far right of this description field." ]</li>
<li>Set Field [ brainstate::groupType; "merge" ]</li>
<li>#</li>
<li>#4 link all records</li>
<li>Set Variable [ $brainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $brainstateDisplayID; Value:brainstate::_Number ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::groupID; $brainstateID ]</li>
<li>Set Field [ brainstate::groupDisplayID; $brainstateDisplayID ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#A) END find selected merge records and create new total record and link all records together</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Loop</li>
<li>#B) BEGIN add a merge record's ID# to the description of the new total record.</li>
<li>#</li>
<li>#1 make sure there is a record to be merged (this step will be important when this loop is repeated after the first record to be merged is omitted).</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>If [ brainstate::_lockBrainstateID  &ne;  brainstate::groupID ]</li>
<li>#</li>
<li>#2 capture merged ID number for total's linkinfo field: total of: ID, ID, ID, etc.</li>
<li>Set Variable [ $CurrentBrainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $CurrentBrainstateDisplayID; Value:brainstate::_Number ]</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>Set Field [ brainstate::linkinfo; If ( WordCount ( brainstate::linkinfo )  = 2 ; 

brainstate::linkinfo &amp; $CurrentBrainstateDisplayID  ; 

brainstate::linkinfo &amp; ", "  &amp; $CurrentBrainstateDisplayID  ) ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN finish</li>
<li>Else If [ brainstate::_lockBrainstateID = brainstate::groupID ]</li>
<li>#If all records are empty then the merge is complete and now the user needs to be shown the new total record and all the records that will feed into it until they are separated.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupID; $brainstateID ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Layout [ &ldquo;TotalSort&rdquo; (brainstate) ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>#END finish</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#B) END add a merge record's ID# to the description of the new total record.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#C BEGIN find merge record's related day records</li>
<li>#</li>
<li>#1 make a list of the first brainstate's day records in a new window</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ day1::_keyBrainstate; $CurrentBrainstateID ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#C END find merge record's related day records</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#D BEGIN no records found loop (this loop will either complete the merge process or find a merge record with related day records)
</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#1 if records are found exit loop</li>
<li>Exit Loop If [ Get ( LastError )  = 0 ]</li>
<li>#</li>
<li>#2 clear the merge field (the big X in the box on the ToBeMerged layout) and omit this record</li>
<li>If [ Get ( LastError )  = 401 ]</li>
<li>Go to Layout [ &ldquo;01SortAndSchedule&rdquo; (brainstate) ]</li>
<li>Set Field [ brainstate::groupAddCheckbox; "" ]</li>
<li>Omit Record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN finish</li>
<li>If [ brainstate::_lockBrainstateID = brainstate::groupID ]</li>
<li>#If all records are empty then the merge is complete and now the user needs to be shown the new total record and all the records that will feed into it until they are separated.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupID; $brainstateID ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Layout [ &ldquo;TotalSort&rdquo; (brainstate) ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END finish</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN find error 2</li>
<li>Else If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming merge script part D2."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#Find all records user had showing when they clicked the merge button</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>If [ steward::retiredStatus = "r" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>If [ steward::hideStatus = "" and steward::showORhide = "hide" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::hide: &ldquo;t&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::showStatus  &ne;  "" and steward::showORhide = "show" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::Show: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END find error 2
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#3 capture next records ID number for total's linkinfo field: total of: ID, ID, ID, etc.</li>
<li>Set Variable [ $CurrentBrainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $CurrentBrainstateDisplayID; Value:brainstate::_Number ]</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>Set Field [ brainstate::linkinfo; If ( WordCount ( brainstate::linkinfo )  = 2 ; 

brainstate::linkinfo &amp; $CurrentBrainstateDisplayID  ; 

brainstate::linkinfo &amp; ", "  &amp; $CurrentBrainstateDisplayID  ) ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#4 make a list of this record's day records in a new window.</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ day1::_keyBrainstate; $CurrentBrainstateID ]</li>
<li>Perform Find [  ]</li>
<li>End Loop</li>
<li>#</li>
<li>#D END no records found loop 
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#E BEGIN create new related day records and add selected record's time to them</li>
<li>#</li>
<li>Loop</li>
<li>#1 find any day records for the new brainstate that match the kfDay of the first merge record.  If this new record already has data in it, then we want to add new data to the old data; not replace the old data with new data.</li>
<li>Set Variable [ $mergeDay; Value:day1::_keyDay ]</li>
<li>Enter Find Mode [  ]</li>
<li>Go to Layout [ &ldquo;calcTotalNewRecord&rdquo; (day2) ]</li>
<li>Set Field [ day2::_keyBrainstate; $brainstateID ]</li>
<li>Set Field [ day2::_keyDay; $mergeDay ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#2 if no matches are found, create a new day record and put in the time of the first the current day record</li>
<li>If [ Get ( LastError )  = 401 ]</li>
<li>New Record/Request</li>
<li>Set Field [ day2::_keyBrainstate; $brainstateID ]</li>
<li>Set Field [ day2::_keyDay; $mergeDay ]</li>
<li>Set Field [ day2::swStart; day2::_keyDay &amp; " 0:00:00" ]</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Set Variable [ $TotalActivity; Value:day1::swTotalActivity ]</li>
<li>Go to Layout [ &ldquo;calcTotalNewRecord&rdquo; (day2) ]</li>
<li>Set Field [ day2::swPause; Case ( 

$TotalActivity    &gt;   Time ( 23 ; 59 ; 59 )  ; day2::_keyDay &amp;  " 24:00:00" ; 

$TotalActivity     &lt;   Time ( 0 ; 0 ; 0 )  ; day2::_keyDay &amp;  " 00:00:00" ; 

day2::_keyDay &amp; " "  &amp; $TotalActivity )

//insures that no more than 24 hours will be put into a day and that a day with negative time does not cause an error. ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN find error 3</li>
<li>Else If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error" &amp; Get ( LastError )  &amp;  "peforming merge script part E2."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#Find all records user had showing when they clicked the merge button.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>If [ steward::retiredStatus = "r" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>If [ steward::hideStatus = "" and steward::showORhide = "hide" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::hide: &ldquo;t&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::showStatus  &ne;  "" and steward::showORhide = "show" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::Show: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>#END find error 3
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#3 if a match is found, then add the current day's time to this day's time.</li>
<li>Else If [ Get ( LastError )  = 0 ]</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Set Variable [ $TotalActivity; Value:day1::swTotalActivity ]</li>
<li>Go to Layout [ &ldquo;calcTotalNewRecord&rdquo; (day2) ]</li>
<li>Set Field [ day2::swPause; Case ( 

$TotalActivity +  day2::swTotalActivity    &gt;   Time ( 23 ; 59 ; 59 )  ; day2::_keyDay &amp;  " 24:00:00" ; 

$TotalActivity +  day2::swTotalActivity    &lt;   Time ( 0 ; 0 ; 0 )  ; day2::_keyDay &amp;  " 00:00:00" ; 

day2::_keyDay &amp; " "  &amp; ($TotalActivity +  day2::swTotalActivity)  )

//insures that no more than 24 hours will be put into a day and that a day with negative time does not cause an error. ]</li>
<li>End If</li>
<li>#</li>
<li>#4 repeat loop for found record's next related day record.</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#E END create new related day records and add selected record's time to them</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#F BEGIN go to next record with related day records to be added to the new total record.</li>
<li>#</li>
<li>Go to Layout [ &ldquo;01SortAndSchedule&rdquo; (brainstate) ]</li>
<li>#Clear the merge field (the big X in the box on the ToBeMerged layout).</li>
<li>Set Field [ brainstate::groupAddCheckbox; "" ]</li>
<li>Omit Record</li>
<li>#</li>
<li>#F END go to next record with related day records to be added to the new total record.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>End Loop</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>brainstate</em>::groupAddCheckboxCount</li>
<li>
<em>brainstate</em>::_keyUser</li>
<li>
<em>brainstate</em>::groupAddCheckbox</li>
<li>
<em>steward</em>::retiredStatus</li>
<li>
<em>brainstate</em>::sortRetired</li>
<li>
<em>steward</em>::hideStatus</li>
<li>
<em>steward</em>::showORhide</li>
<li>
<em>brainstate</em>::hide</li>
<li>
<em>steward</em>::showStatus</li>
<li>
<em>brainstate</em>::Show</li>
<li>
<em>brainstate</em>::linkinfo</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::_Number</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>brainstate</em>::groupDisplayID</li>
<li>
<em>day1</em>::_keyBrainstate</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>day2</em>::_keyBrainstate</li>
<li>
<em>day2</em>::_keyDay</li>
<li>
<em>day2</em>::swStart</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swPause</li>
<li>
<em>day2</em>::swTotalActivity</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>01SortAndSchedule</li>
<li>TotalSort</li>
<li>calcTotalSelectedList</li>
<li>calcTotalNewRecord</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33017ScriptAnchor_"></a><td class="script_navbar"><a href="#119ScriptAnchor_"><span>Previous Script: [total]</span></a></td><td class="script_navbar"><a href="#32966ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#32891ScriptAnchor_"><span>Next Script: [grandTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE create a new total record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 create the new total record</li>
<li>#NOT TESTED</li>
<li>If [ Get ( SystemPlatform ) = 3 or steward::iPhoneLayout &ne; "" ]</li>
<li>Go to Layout [ &ldquo;TotalSortAndScheduleiPhone&rdquo; (brainstate) ]</li>
<li>Else If [ Get ( SystemPlatform )  &ne; 3 or steward::iPhoneLayout  =  "" ]</li>
<li>Go to Layout [ &ldquo;TotalSort&rdquo; (brainstate) ]</li>
<li>End If</li>
<li>#END NOT TESTED</li>
<li>New Record/Request</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Set Field [ brainstate::linkinfo; "total of: " ]</li>
<li>Set Field [ brainstate::description; "new total record / folder name" ]</li>
<li>Set Field [ brainstate::groupType; "merge" ]</li>
<li>Set Field [ brainstate::groupDisplayID; brainstate::_Number ]</li>
<li>Set Field [ brainstate::Show; "t" ]</li>
<li>Set Field [ brainstate::hide; "t" ]</li>
<li>Set Field [ brainstate::groupID; brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $mergeID; Value:brainstate::_lockBrainstateID ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupID; $mergeID ]</li>
<li>Perform Find [  ]</li>
<li>Go to Field [ brainstate::description ]
[ Select/perform ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>steward</em>::iPhoneLayout</li>
<li>
<em>brainstate</em>::_keyUser</li>
<li>
<em>brainstate</em>::linkinfo</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::_Number</li>
<li>
<em>brainstate</em>::groupDisplayID</li>
<li>
<em>brainstate</em>::Show</li>
<li>
<em>brainstate</em>::hide</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::groupID</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>TotalSortAndScheduleiPhone</li>
<li>TotalSort</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32891ScriptAnchor_"></a><td class="script_navbar"><a href="#33017ScriptAnchor_"><span>Previous Script: [newTotal]</span></a></td><td class="script_navbar"><a href="#32966ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#32931ScriptAnchor_"><span>Next Script: [addToTotalPart1]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">grandTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE merge selected record's time data into one GRAND total record and then link these records so that time added in the future to any of the merge records will be automatically added to the one total record.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#NOTE: the three # symbols set apart chunks of script.  </li>
<li>#NOTE: the finish and error script chunks are almost identical (the error message differ in telling where in the script they occur).  For this reason, they are not numbered as part of a particular chuck of the script, and are separated by three # symbols to set them apart.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#A) BEGIN find selected GRAND total records and create new total record and link all records together</li>
<li>#</li>
<li>#1 check if there are 2 or more records to merge and if not halt the script.  (Can't merge if zero or 1 records are selected.  </li>
<li>If [ brainstate::groupOfGroupAddCheckboxCount &lt; 2 ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "At least 2 total records must be selected to create a grand total record."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#2 make a list of only the records to be merged</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Set Field [ brainstate::groupOfGroupAddCheckbox; "t" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN find error 1</li>
<li>If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number.
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming grand total merge script part A2."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#Find all records user had showing when they clicked the merge button</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>If [ steward::retiredStatus = "r" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>If [ steward::hideStatus = "" and steward::showORhide = "hide" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::hide: &ldquo;t&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::showStatus  &ne;  "" and steward::showORhide = "show" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::Show: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END find error 1
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#3 create the new total record</li>
<li>Go to Layout [ &ldquo;01SortAndSchedule&rdquo; (brainstate) ]</li>
<li>New Record/Request</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Set Field [ brainstate::description; "NEW GRAND TOTAL RECORD the ID numbers of the records totaled by this record can be seen by either clicking or hovering over the i at the far right of this description field." ]</li>
<li>Set Field [ brainstate::linkinfo; "grand total of: " ]</li>
<li>Set Field [ brainstate::groupType; "mergeGrand" ]</li>
<li>#</li>
<li>#4 link all records</li>
<li>Set Variable [ $brainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $brainstateDisplayID; Value:brainstate::_Number ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::groupOfGroupID; $brainstateID ]</li>
<li>Set Field [ brainstate::groupOfGroupDisplayID; $brainstateDisplayID ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#A) END find selected merge records and create new GRAND total record and link all records together</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Loop</li>
<li>#B) BEGIN add a merge record's ID# to the description of the new GRAND total record.</li>
<li>#</li>
<li>#1 make sure there is a record to be merged (this step will be important when this loop is repeated after the first record to be merged is omitted).</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>If [ brainstate::_lockBrainstateID  &ne;  brainstate::groupOfGroupID ]</li>
<li>#</li>
<li>#2 capture merged ID number for GRAND total's linkinfo field: total of: ID, ID, ID, etc.</li>
<li>Set Variable [ $CurrentBrainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $CurrentBrainstateDisplayID; Value:brainstate::_Number ]</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>Set Field [ brainstate::linkinfo; If ( WordCount ( brainstate::linkinfo )  = 3 ; 

brainstate::linkinfo &amp; $CurrentBrainstateDisplayID  ; 

brainstate::linkinfo &amp; ", "  &amp; $CurrentBrainstateDisplayID  ) ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN finish</li>
<li>Else If [ brainstate::_lockBrainstateID = brainstate::groupOfGroupID ]</li>
<li>#If all records are empty then the merge is complete and now the user needs to be shown the new GRAND total record and all the records that will feed into it until they are separated.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupOfGroupID; $brainstateID ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Layout [ &ldquo;GrandTotal&rdquo; (brainstate) ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>#END finish</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#B) END add a merge record's ID# to the description of the new total record.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#C BEGIN find merge record's related day records</li>
<li>#</li>
<li>#1 make a list of the first brainstate's day records in a new window</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ day1::_keyBrainstate; $CurrentBrainstateID ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#C END find merge record's related day records</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#D BEGIN no records found loop (this loop will either complete the merge process or find a merge record with related day records)
</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#1 if records are found exit loop</li>
<li>Exit Loop If [ Get ( LastError )  = 0 ]</li>
<li>#</li>
<li>#2 clear the merge field (the big X in the box on the ToBeMerged layout) and omit this record</li>
<li>If [ Get ( LastError )  = 401 ]</li>
<li>Go to Layout [ &ldquo;01SortAndSchedule&rdquo; (brainstate) ]</li>
<li>Set Field [ brainstate::groupOfGroupAddCheckbox; "" ]</li>
<li>Omit Record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN finish</li>
<li>If [ brainstate::_lockBrainstateID = brainstate::groupOfGroupID ]</li>
<li>#If all records are empty then the merge is complete and now the user needs to be shown the new GRAND total record and all the records that will feed into it until they are separated.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupOfGroupID; $brainstateID ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Layout [ &ldquo;GrandTotal&rdquo; (brainstate) ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END finish</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN find error 2</li>
<li>Else If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming grand total merge script part D2."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#Find all records user had showing when they clicked the merge button</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>If [ steward::retiredStatus = "r" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>If [ steward::hideStatus = "" and steward::showORhide = "hide" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::hide: &ldquo;t&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::showStatus  &ne;  "" and steward::showORhide = "show" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::Show: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END find error 2
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#3 capture next records ID number for total's linkinfo field: total of: ID, ID, ID, etc.</li>
<li>Set Variable [ $CurrentBrainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $CurrentBrainstateDisplayID; Value:brainstate::_Number ]</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>Set Field [ brainstate::linkinfo; If ( WordCount ( brainstate::linkinfo )  = 3 ; 

brainstate::linkinfo &amp; $CurrentBrainstateDisplayID  ; 

brainstate::linkinfo &amp; ", "  &amp; $CurrentBrainstateDisplayID  ) ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#4 make a list of this record's day records in a new window.</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ day1::_keyBrainstate; $CurrentBrainstateID ]</li>
<li>Perform Find [  ]</li>
<li>End Loop</li>
<li>#</li>
<li>#D END no records found loop 
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#E BEGIN create new related day records and add selected record's time to them</li>
<li>#</li>
<li>Loop</li>
<li>#1 find any day records for the new brainstate that match the kfDay of the first merge record.  If this new record already has data in it, then we want to add new data to the old data; not replace the old data with new data.</li>
<li>Set Variable [ $mergeDay; Value:day1::_keyDay ]</li>
<li>Enter Find Mode [  ]</li>
<li>Go to Layout [ &ldquo;calcTotalNewRecord&rdquo; (day2) ]</li>
<li>Set Field [ day2::_keyBrainstate; $brainstateID ]</li>
<li>Set Field [ day2::_keyDay; $mergeDay ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#2 if no matches are found, create a new day record and put in the time of the first the current day record</li>
<li>If [ Get ( LastError )  = 401 ]</li>
<li>New Record/Request</li>
<li>Set Field [ day2::_keyBrainstate; $brainstateID ]</li>
<li>Set Field [ day2::_keyDay; $mergeDay ]</li>
<li>Set Field [ day2::swStart; day2::_keyDay &amp; " 0:00:00" ]</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Set Variable [ $TotalActivity; Value:day1::swTotalActivity ]</li>
<li>Go to Layout [ &ldquo;calcTotalNewRecord&rdquo; (day2) ]</li>
<li>Set Field [ day2::swPause; Case ( 

$TotalActivity    &gt;   Time ( 23 ; 59 ; 59 )  ; day2::_keyDay &amp;  " 24:00:00" ; 

$TotalActivity     &lt;   Time ( 0 ; 0 ; 0 )  ; day2::_keyDay &amp;  " 00:00:00" ; 

day2::_keyDay &amp; " "  &amp; $TotalActivity )

//insures that no more than 24 hours will be put into a day and that a day with negative time does not cause an error. ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN find error 3</li>
<li>Else If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error" &amp; Get ( LastError )  &amp;  "peforming grand total merge script part E2."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#Find all records user had showing when they clicked the merge button.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>If [ steward::retiredStatus = "r" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>If [ steward::hideStatus = "" and steward::showORhide = "hide" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::hide: &ldquo;t&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::showStatus  &ne;  "" and steward::showORhide = "show" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::Show: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>#END find error 3
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#3 if a match is found, then add the current day's time to this day's time.</li>
<li>Else If [ Get ( LastError )  = 0 ]</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Set Variable [ $TotalActivity; Value:day1::swTotalActivity ]</li>
<li>Go to Layout [ &ldquo;calcTotalNewRecord&rdquo; (day2) ]</li>
<li>Set Field [ day2::swPause; Case ( 

$TotalActivity +  day2::swTotalActivity    &gt;   Time ( 23 ; 59 ; 59 )  ; day2::_keyDay &amp;  " 24:00:00" ; 

$TotalActivity +  day2::swTotalActivity    &lt;   Time ( 0 ; 0 ; 0 )  ; day2::_keyDay &amp;  " 00:00:00" ; 

day2::_keyDay &amp; " "  &amp; ($TotalActivity +  day2::swTotalActivity)  )

//insures that no more than 24 hours will be put into a day and that a day with negative time does not cause an error. ]</li>
<li>End If</li>
<li>#</li>
<li>#4 repeat loop for found record's next related day record.</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#E END create new related day records and add selected record's time to them</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#F BEGIN go to next record with related day records to be added to the new total record.</li>
<li>#</li>
<li>Go to Layout [ &ldquo;01SortAndSchedule&rdquo; (brainstate) ]</li>
<li>#Clear the merge field (the big X in the box on the ToBeMerged layout).</li>
<li>Set Field [ brainstate::groupOfGroupAddCheckbox; "" ]</li>
<li>Omit Record</li>
<li>#</li>
<li>#F END go to next record with related day records to be added to the new total record.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>End Loop</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>brainstate</em>::groupOfGroupAddCheckboxCount</li>
<li>
<em>brainstate</em>::_keyUser</li>
<li>
<em>brainstate</em>::groupOfGroupAddCheckbox</li>
<li>
<em>steward</em>::retiredStatus</li>
<li>
<em>brainstate</em>::sortRetired</li>
<li>
<em>steward</em>::hideStatus</li>
<li>
<em>steward</em>::showORhide</li>
<li>
<em>brainstate</em>::hide</li>
<li>
<em>steward</em>::showStatus</li>
<li>
<em>brainstate</em>::Show</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>brainstate</em>::linkinfo</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::_Number</li>
<li>
<em>brainstate</em>::groupOfGroupID</li>
<li>
<em>brainstate</em>::groupOfGroupDisplayID</li>
<li>
<em>day1</em>::_keyBrainstate</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>day2</em>::_keyBrainstate</li>
<li>
<em>day2</em>::_keyDay</li>
<li>
<em>day2</em>::swStart</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swPause</li>
<li>
<em>day2</em>::swTotalActivity</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>01SortAndSchedule</li>
<li>GrandTotal</li>
<li>calcTotalSelectedList</li>
<li>calcTotalNewRecord</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32931ScriptAnchor_"></a><td class="script_navbar"><a href="#32891ScriptAnchor_"><span>Previous Script: [grandTotal]</span></a></td><td class="script_navbar"><a href="#32966ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#32929ScriptAnchor_"><span>Next Script: [addToTotalPart2]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addToTotalPart1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE create list of records that can be added to the current total record.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 constrain the current records being viewed to just the total record and mark it for adding. (This finding of the record to be marked could also be done with a sort.)</li>
<li>Constrain Found Set [ Specified Find Requests: Find Records; Criteria: brainstate::groupType: &ldquo;merge&rdquo; ]
[ Restore ]</li>
<li>Set Field [ brainstate::groupAddCheckbox; "t" ]</li>
<li>#</li>
<li>#2 go to the add2total layout and find all the users records excluding total and grandtotal records.  (The list should include only records that could be added to the total.)</li>
<li>Go to Layout [ &ldquo;add2total&rdquo; (brainstate) ]</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::groupType: &ldquo;merge&rdquo; ]
[ Restore ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::groupID: &ldquo;&gt;1&rdquo; ]
[ Restore ]</li>
<li>Extend Found Set [ Specified Find Requests: Find Records; Criteria: brainstate::groupAddCheckbox: &ldquo;t&rdquo; ]
[ Restore ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::description: &ldquo;=&rdquo; ]
[ Restore ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::groupAddCheckbox</li>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>brainstate</em>::_keyUser</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>add2total</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32929ScriptAnchor_"></a><td class="script_navbar"><a href="#32931ScriptAnchor_"><span>Previous Script: [addToTotalPart1]</span></a></td><td class="script_navbar"><a href="#32966ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#32949ScriptAnchor_"><span>Next Script: [addToGrandtotalPart1]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addToTotalPart2</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE add selected records' time data into current total record and then link these records so that time added in the future to any of them will be automatically added to this total record.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#NOTE: the three # symbols set apart chunks of script.  </li>
<li>#NOTE: the finish and error script chunks are almost identical (the error message differ in telling where in the script they occur).  For this reason, they are not numbered as part of a particular chuck of the script, and are separated by three # symbols to set them apart.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#A) BEGIN find selected records to add and link to total record</li>
<li>#</li>
<li>#1 check if there are 1 or more records to merge and if not halt the script.  (Can't merge if zero records are selected.  1 record can be merged which is really making a copy of that record for instances where the user has been tracking 2 things with one brainstate but now wants to separate the tracking of these with 2 separate brainstate records.)</li>
<li>If [ brainstate::groupAddCheckboxCount &lt; 2 ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "At least 1 brainstates must be selected to add to the total record (highlighted light blue)."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#2 capture total record's ID number</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupAddCheckbox; descending
brainstate::groupType; based on value list: &ldquo;MergeSort&rdquo; ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $mergeto; Value:brainstate::groupID ]</li>
<li>#</li>
<li>#3 flag for grand total update</li>
<li>Set Field [ brainstate::groupOfGroupUpdate; If ( brainstate::groupOfGroupID &ne; "" ; "u" ; "" ) ]</li>
<li>#</li>
<li>#4 make a list of only the records to be added and the total record</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Set Field [ brainstate::groupAddCheckbox; "t" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#BEGIN find error 1</li>
<li>If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number.
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming add to total part 2 script part A2."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#Find all records user had showing when they clicked the merge button</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>If [ steward::retiredStatus = "r" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>If [ steward::hideStatus = "" and steward::showORhide = "hide" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::hide: &ldquo;t&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::showStatus  &ne;  "" and steward::showORhide = "show" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::Show: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END find error 1
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#5 link all records and remove t's from merge fields clear the merge field (the big X in the box on the ToBeMerged layout)</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupType; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>Set Variable [ $brainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $brainstateDisplayID; Value:brainstate::_Number ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::groupID; $brainstateID ]</li>
<li>Set Field [ brainstate::groupDisplayID; $brainstateDisplayID ]</li>
<li>Set Field [ brainstate::groupAddCheckbox; "" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#A) END find selected records to add and link to total record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Loop</li>
<li>#B) BEGIN add a merge record's ID# to the description of the new total record.</li>
<li>#</li>
<li>#1 make sure there is a record to be merged (this step will be important when this loop is repeated after the first record to be merged is omitted).</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>If [ brainstate::_lockBrainstateID  &ne;  brainstate::groupID ]</li>
<li>#</li>
<li>#2 capture merged ID number for total's linkinfo field: total of: ID, ID, ID, etc.</li>
<li>Set Variable [ $CurrentBrainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $CurrentBrainstateDisplayID; Value:brainstate::_Number ]</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>Set Field [ brainstate::linkinfo; brainstate::linkinfo &amp; "&para;&para;" &amp; Get ( CurrentDate ) &amp;  " added: "  &amp; $CurrentBrainstateDisplayID ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN finish</li>
<li>Else If [ brainstate::_lockBrainstateID = brainstate::groupID ]</li>
<li>#If all records are empty then the merge is complete and now the user needs to be shown the new total record and all the records that will feed into it until they are separated.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupID; $brainstateID ]</li>
<li>Perform Find [  ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Layout [ &ldquo;TotalEditTime&rdquo; (brainstate) ]</li>
<li>#NOT TESTED</li>
<li>If [ Get ( SystemPlatform ) = 3 ]</li>
<li>Go to Layout [ &ldquo;TotalMainiPhone&rdquo; (brainstate) ]</li>
<li>End If</li>
<li>#END NOT TESTED</li>
<li>Go to Field [  ]</li>
<li>If [ brainstate::groupOfGroupUpdate = "u" ]</li>
<li>Perform Script [ &ldquo;CHUNK addToTotalPart3&rdquo; ]</li>
<li>End If</li>
<li>Perform Script [ &ldquo;DaySelectSortThenSort&rdquo; ]</li>
<li>Halt Script</li>
<li>#END finish</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#B) END add a merge record's ID# to the description of the new total record.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#C BEGIN find merge record's related day records</li>
<li>#</li>
<li>#1 make a list of the first brainstate's day records in a new window</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ day1::_keyBrainstate; $CurrentBrainstateID ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#C END find merge record's related day records</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#D BEGIN no records found loop (this loop will either complete the merge process or find a merge record with related day records)
</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#1 if records are found exit loop</li>
<li>Exit Loop If [ Get ( LastError )  = 0 ]</li>
<li>#</li>
<li>#2 omit this record</li>
<li>If [ Get ( LastError )  = 401 ]</li>
<li>Go to Layout [ &ldquo;01SortAndSchedule&rdquo; (brainstate) ]</li>
<li>Omit Record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN finish</li>
<li>If [ brainstate::_lockBrainstateID = brainstate::groupID ]</li>
<li>#If all records are empty then the merge is complete and now the user needs to be shown the new total record and all the records that will feed into it until they are separated.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupID; $brainstateID ]</li>
<li>Perform Find [  ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Layout [ &ldquo;TotalSort&rdquo; (brainstate) ]</li>
<li>#NOT TESTED</li>
<li>If [ Get ( SystemPlatform ) = 3 ]</li>
<li>Go to Layout [ &ldquo;TotalMainiPhone&rdquo; (brainstate) ]</li>
<li>End If</li>
<li>#END NOT TESTED</li>
<li>Go to Field [  ]</li>
<li>If [ brainstate::groupOfGroupUpdate = "u" ]</li>
<li>Perform Script [ &ldquo;CHUNK addToTotalPart3&rdquo; ]</li>
<li>End If</li>
<li>Perform Script [ &ldquo;DaySelectSortThenSort&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END finish</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN find error 2</li>
<li>Else If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming merge script part D2."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#Find all records user had showing when they clicked the merge button</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>If [ steward::retiredStatus = "r" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>If [ steward::hideStatus = "" and steward::showORhide = "hide" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::hide: &ldquo;t&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::showStatus  &ne;  "" and steward::showORhide = "show" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::Show: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END find error 2
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#3 capture next records ID number for total's linkinfo field: total of: ID, ID, ID, etc.</li>
<li>Set Variable [ $CurrentBrainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $CurrentBrainstateDisplayID; Value:brainstate::_Number ]</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>Set Field [ brainstate::linkinfo; "&para;&para;" &amp; 
Get ( CurrentDate ) &amp;  " added: "  &amp; $CurrentBrainstateDisplayID ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#4 make a list of this record's day records in a new window.</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ day1::_keyBrainstate; $CurrentBrainstateID ]</li>
<li>Perform Find [  ]</li>
<li>End Loop</li>
<li>#</li>
<li>#D END no records found loop 
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#E BEGIN create new related day records and add selected record's time to them</li>
<li>#</li>
<li>Loop</li>
<li>#1 find any day records for the new brainstate that match the kfDay of the first merge record.  If this new record already has data in it, then we want to add new data to the old data; not replace the old data with new data.</li>
<li>Set Variable [ $mergeDay; Value:day1::_keyDay ]</li>
<li>Enter Find Mode [  ]</li>
<li>Go to Layout [ &ldquo;calcTotalNewRecord&rdquo; (day2) ]</li>
<li>Set Field [ day2::_keyBrainstate; $brainstateID ]</li>
<li>Set Field [ day2::_keyDay; $mergeDay ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#2 if no matches are found, create a new day record and put in the time of the first the current day record</li>
<li>If [ Get ( LastError )  = 401 ]</li>
<li>New Record/Request</li>
<li>Set Field [ day2::_keyBrainstate; $brainstateID ]</li>
<li>Set Field [ day2::_keyDay; $mergeDay ]</li>
<li>Set Field [ day2::swStart; day2::_keyDay &amp; " 0:00:00" ]</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Set Variable [ $TotalActivity; Value:day1::swTotalActivity ]</li>
<li>Go to Layout [ &ldquo;calcTotalNewRecord&rdquo; (day2) ]</li>
<li>Set Field [ day2::swPause; Case ( 

$TotalActivity    &gt;   Time ( 23 ; 59 ; 59 )  ; day2::_keyDay &amp;  " 24:00:00" ; 

$TotalActivity     &lt;   Time ( 0 ; 0 ; 0 )  ; day2::_keyDay &amp;  " 00:00:00" ; 

day2::_keyDay &amp; " "  &amp; $TotalActivity )

//insures that no more than 24 hours will be put into a day and that a day with negative time does not cause an error. ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN find error 3</li>
<li>Else If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error" &amp; Get ( LastError )  &amp;  "peforming merge script part E2."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#Find all records user had showing when they clicked the merge button.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>If [ steward::retiredStatus = "r" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>If [ steward::hideStatus = "" and steward::showORhide = "hide" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::hide: &ldquo;t&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::showStatus  &ne;  "" and steward::showORhide = "show" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::Show: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>#END find error 3
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#3 if a match is found, then add the current day's time to this day's time.</li>
<li>Else If [ Get ( LastError )  = 0 ]</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Set Variable [ $TotalActivity; Value:day1::swTotalActivity ]</li>
<li>Go to Layout [ &ldquo;calcTotalNewRecord&rdquo; (day2) ]</li>
<li>Set Field [ day2::swPause; Case ( 

$TotalActivity +  day2::swTotalActivity    &gt;   Time ( 23 ; 59 ; 59 )  ; day2::_keyDay &amp;  " 24:00:00" ; 

$TotalActivity +  day2::swTotalActivity    &lt;   Time ( 0 ; 0 ; 0 )  ; day2::_keyDay &amp;  " 00:00:00" ; 

day2::_keyDay &amp; " "  &amp; ($TotalActivity +  day2::swTotalActivity)  )

//insures that no more than 24 hours will be put into a day and that a day with negative time does not cause an error. ]</li>
<li>End If</li>
<li>#</li>
<li>#4 repeat loop for found record's next related day record.</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#E END create new related day records and add selected record's time to them</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#F BEGIN go to next record with related day records to be added to the new total record.</li>
<li>#</li>
<li>Go to Layout [ &ldquo;TotalSort&rdquo; (brainstate) ]</li>
<li>#Clear the merge field (the big X in the box on the ToBeMerged layout).</li>
<li>Set Field [ brainstate::groupAddCheckbox; "" ]</li>
<li>Omit Record</li>
<li>#</li>
<li>#F END go to next record with related day records to be added to the new total record.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>End Loop</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>brainstate</em>::groupAddCheckboxCount</li>
<li>
<em>brainstate</em>::groupAddCheckbox</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>brainstate</em>::groupOfGroupID</li>
<li>
<em>brainstate</em>::groupOfGroupUpdate</li>
<li>
<em>brainstate</em>::_keyUser</li>
<li>
<em>steward</em>::retiredStatus</li>
<li>
<em>brainstate</em>::sortRetired</li>
<li>
<em>steward</em>::hideStatus</li>
<li>
<em>steward</em>::showORhide</li>
<li>
<em>brainstate</em>::hide</li>
<li>
<em>steward</em>::showStatus</li>
<li>
<em>brainstate</em>::Show</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::_Number</li>
<li>
<em>brainstate</em>::groupDisplayID</li>
<li>
<em>brainstate</em>::linkinfo</li>
<li>
<em>day1</em>::_keyBrainstate</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>day2</em>::_keyBrainstate</li>
<li>
<em>day2</em>::_keyDay</li>
<li>
<em>day2</em>::swStart</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swPause</li>
<li>
<em>day2</em>::swTotalActivity</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32936ScriptAnchor_">CHUNK addToTotalPart3</a></li>
<li><a href="#32902ScriptAnchor_">DaySelectSortThenSort</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>TotalEditTime</li>
<li>TotalMainiPhone</li>
<li>calcTotalSelectedList</li>
<li>01SortAndSchedule</li>
<li>TotalSort</li>
<li>calcTotalNewRecord</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32949ScriptAnchor_"></a><td class="script_navbar"><a href="#32929ScriptAnchor_"><span>Previous Script: [addToTotalPart2]</span></a></td><td class="script_navbar"><a href="#32966ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#32950ScriptAnchor_"><span>Next Script: [addToGrandtotalPart2]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addToGrandtotalPart1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE create list of records that can be added to the current grandtotal record.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 constrain the current records being viewed to just the grandtotal record and mark it for adding. (This finding of the record to be marked could also be done with a sort.)</li>
<li>Constrain Found Set [ Specified Find Requests: Find Records; Criteria: brainstate::groupType: &ldquo;mergeGrand&rdquo; ]
[ Restore ]</li>
<li>Set Field [ brainstate::groupOfGroupAddCheckbox; "t" ]</li>
<li>#</li>
<li>#2 go to the add2total layout and find all the users total records.  (The list should inlcude only records that could be added to the grandtotal.)</li>
<li>Go to Layout [ &ldquo;add2grandtotal&rdquo; (brainstate) ]</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Set Field [ brainstate::groupType; "merge" ]</li>
<li>Perform Find [  ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::groupType: &ldquo;mergeGrand&rdquo; ]
[ Restore ]</li>
<li>Extend Found Set [ Specified Find Requests: Find Records; Criteria: brainstate::groupOfGroupAddCheckbox: &ldquo;t&rdquo; ]
[ Restore ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::groupOfGroupAddCheckbox</li>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>brainstate</em>::_keyUser</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>add2grandtotal</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32950ScriptAnchor_"></a><td class="script_navbar"><a href="#32949ScriptAnchor_"><span>Previous Script: [addToGrandtotalPart1]</span></a></td><td class="script_navbar"><a href="#32966ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#32953ScriptAnchor_"><span>Next Script: [cancelTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addToGrandtotalPart2</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE add selected records' time data into current grandtotal record and then link these records so that time added in the future to any of them will be automatically added to this grandtotal record.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#NOTE: the three # symbols set apart chunks of script.  </li>
<li>#NOTE: the finish and error script chunks are almost identical (the error message differ in telling where in the script they occur).  For this reason, they are not numbered as part of a particular chuck of the script, and are separated by three # symbols to set them apart.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#A) BEGIN find selected records to add and link to total record</li>
<li>#</li>
<li>#1 check if there are 1 or more records to merge and if not halt the script.  (Can't merge if zero records are selected.  1 record can be merged which is really making a copy of that record for instances where the user has been tracking 2 things with one brainstate but now wants to separate the tracking of these with 2 separate brainstate records.)</li>
<li>If [ brainstate::groupOfGroupAddCheckboxCount &lt; 2 ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "At least 1 brainstate must be selected to add to the grandtotal record (highlighted light blue)."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#2 capture total record's ID number</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupAddCheckbox; descending
brainstate::groupType; based on value list: &ldquo;MergeSort&rdquo; ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $mergeto; Value:brainstate::groupOfGroupID ]</li>
<li>#</li>
<li>#4 make a list of only the records to be added and the total record</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Set Field [ brainstate::groupOfGroupAddCheckbox; "t" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#BEGIN find error 1</li>
<li>If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number.
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming add to total part 2 script part A2."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#Find all records user had showing when they clicked the merge button</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>If [ steward::retiredStatus = "r" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>If [ steward::hideStatus = "" and steward::showORhide = "hide" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::hide: &ldquo;t&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::showStatus  &ne;  "" and steward::showORhide = "show" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::Show: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END find error 1
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#5 link all records and remove t's from merge fields clear the merge field (the big X in the box on the ToBeMerged layout)</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupType; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>Set Variable [ $brainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $brainstateDisplayID; Value:brainstate::_Number ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::groupOfGroupID; $brainstateID ]</li>
<li>Set Field [ brainstate::groupOfGroupDisplayID; $brainstateDisplayID ]</li>
<li>Set Field [ brainstate::groupOfGroupAddCheckbox; "" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#A) END find selected records to add and link to total record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Loop</li>
<li>#B) BEGIN add a merge record's ID# to the description of the new GRAND total record.</li>
<li>#</li>
<li>#1 make sure there is a record to be merged (this step will be important when this loop is repeated after the first record to be merged is omitted).</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>If [ brainstate::_lockBrainstateID  &ne;  brainstate::groupOfGroupID ]</li>
<li>#</li>
<li>#2 capture merged ID number for GRAND total's linkinfo field: total of: ID, ID, ID, etc.</li>
<li>Set Variable [ $CurrentBrainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $CurrentBrainstateDisplayID; Value:brainstate::_Number ]</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>Set Field [ brainstate::linkinfo; brainstate::linkinfo &amp; "&para;&para;"  &amp; Get ( CurrentTimeStamp ) &amp; " Added: " &amp; $CurrentBrainstateDisplayID ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN finish</li>
<li>Else If [ brainstate::_lockBrainstateID = brainstate::groupOfGroupID ]</li>
<li>#If all records are empty then the merge is complete and now the user needs to be shown the new GRAND total record and all the records that will feed into it until they are separated.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupOfGroupID; $brainstateID ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Layout [ &ldquo;GrandTotal&rdquo; (brainstate) ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>#END finish</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#B) END add a merge record's ID# to the description of the new total record.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#C BEGIN find merge record's related day records</li>
<li>#</li>
<li>#1 make a list of the first brainstate's day records in a new window</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ day1::_keyBrainstate; $CurrentBrainstateID ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#C END find merge record's related day records</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#D BEGIN no records found loop (this loop will either complete the merge process or find a merge record with related day records)
</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#1 if records are found exit loop</li>
<li>Exit Loop If [ Get ( LastError )  = 0 ]</li>
<li>#</li>
<li>#2 clear the merge field (the big X in the box on the ToBeMerged layout) and omit this record</li>
<li>If [ Get ( LastError )  = 401 ]</li>
<li>Go to Layout [ &ldquo;01SortAndSchedule&rdquo; (brainstate) ]</li>
<li>Set Field [ brainstate::groupOfGroupAddCheckbox; "" ]</li>
<li>Omit Record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN finish</li>
<li>If [ brainstate::_lockBrainstateID = brainstate::groupOfGroupID ]</li>
<li>#If all records are empty then the merge is complete and now the user needs to be shown the new GRAND total record and all the records that will feed into it until they are separated.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupOfGroupID; $brainstateID ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Layout [ &ldquo;GrandTotal&rdquo; (brainstate) ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END finish</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN find error 2</li>
<li>Else If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming grand total merge script part D2."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#Find all records user had showing when they clicked the merge button</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>If [ steward::retiredStatus = "r" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>If [ steward::hideStatus = "" and steward::showORhide = "hide" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::hide: &ldquo;t&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::showStatus  &ne;  "" and steward::showORhide = "show" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::Show: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END find error 2
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#3 capture next records ID number for total's linkinfo field: total of: ID, ID, ID, etc.</li>
<li>Set Variable [ $CurrentBrainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $CurrentBrainstateDisplayID; Value:brainstate::_Number ]</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>Set Field [ brainstate::linkinfo; brainstate::linkinfo &amp; "&para;&para;"  &amp; Get ( CurrentTimeStamp ) &amp; " Added: " &amp; $CurrentBrainstateDisplayID ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#4 make a list of this record's day records in a new window.</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ day1::_keyBrainstate; $CurrentBrainstateID ]</li>
<li>Perform Find [  ]</li>
<li>End Loop</li>
<li>#</li>
<li>#D END no records found loop 
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#E BEGIN create new related day records and add selected record's time to them</li>
<li>#</li>
<li>Loop</li>
<li>#1 find any day records for the new brainstate that match the kfDay of the first merge record.  If this new record already has data in it, then we want to add new data to the old data; not replace the old data with new data.</li>
<li>Set Variable [ $mergeDay; Value:day1::_keyDay ]</li>
<li>Enter Find Mode [  ]</li>
<li>Go to Layout [ &ldquo;calcTotalNewRecord&rdquo; (day2) ]</li>
<li>Set Field [ day2::_keyBrainstate; $brainstateID ]</li>
<li>Set Field [ day2::_keyDay; $mergeDay ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#2 if no matches are found, create a new day record and put in the time of the first the current day record</li>
<li>If [ Get ( LastError )  = 401 ]</li>
<li>New Record/Request</li>
<li>Set Field [ day2::_keyBrainstate; $brainstateID ]</li>
<li>Set Field [ day2::_keyDay; $mergeDay ]</li>
<li>Set Field [ day2::swStart; day2::_keyDay &amp; " 0:00:00" ]</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Set Variable [ $TotalActivity; Value:day1::swTotalActivity ]</li>
<li>Go to Layout [ &ldquo;calcTotalNewRecord&rdquo; (day2) ]</li>
<li>Set Field [ day2::swPause; Case ( 

$TotalActivity    &gt;   Time ( 23 ; 59 ; 59 )  ; day2::_keyDay &amp;  " 24:00:00" ; 

$TotalActivity     &lt;   Time ( 0 ; 0 ; 0 )  ; day2::_keyDay &amp;  " 00:00:00" ; 

day2::_keyDay &amp; " "  &amp; $TotalActivity )

//insures that no more than 24 hours will be put into a day and that a day with negative time does not cause an error. ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN find error 3</li>
<li>Else If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error" &amp; Get ( LastError )  &amp;  "peforming grand total merge script part E2."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#Find all records user had showing when they clicked the merge button.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>If [ steward::retiredStatus = "r" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>If [ steward::hideStatus = "" and steward::showORhide = "hide" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::hide: &ldquo;t&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::showStatus  &ne;  "" and steward::showORhide = "show" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::Show: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>#END find error 3
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#3 if a match is found, then add the current day's time to this day's time.</li>
<li>Else If [ Get ( LastError )  = 0 ]</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Set Variable [ $TotalActivity; Value:day1::swTotalActivity ]</li>
<li>Go to Layout [ &ldquo;calcTotalNewRecord&rdquo; (day2) ]</li>
<li>Set Field [ day2::swPause; Case ( 

$TotalActivity +  day2::swTotalActivity    &gt;   Time ( 23 ; 59 ; 59 )  ; day2::_keyDay &amp;  " 24:00:00" ; 

$TotalActivity +  day2::swTotalActivity    &lt;   Time ( 0 ; 0 ; 0 )  ; day2::_keyDay &amp;  " 00:00:00" ; 

day2::_keyDay &amp; " "  &amp; ($TotalActivity +  day2::swTotalActivity)  )

//insures that no more than 24 hours will be put into a day and that a day with negative time does not cause an error. ]</li>
<li>End If</li>
<li>#</li>
<li>#4 repeat loop for found record's next related day record.</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#E END create new related day records and add selected record's time to them</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#F BEGIN go to next record with related day records to be added to the new total record.</li>
<li>#</li>
<li>Go to Layout [ &ldquo;01SortAndSchedule&rdquo; (brainstate) ]</li>
<li>#Clear the merge field (the big X in the box on the ToBeMerged layout).</li>
<li>Set Field [ brainstate::groupOfGroupAddCheckbox; "" ]</li>
<li>Omit Record</li>
<li>#</li>
<li>#F END go to next record with related day records to be added to the new total record.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>End Loop</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>brainstate</em>::groupOfGroupAddCheckboxCount</li>
<li>
<em>brainstate</em>::groupAddCheckbox</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::groupOfGroupID</li>
<li>
<em>brainstate</em>::_keyUser</li>
<li>
<em>brainstate</em>::groupOfGroupAddCheckbox</li>
<li>
<em>steward</em>::retiredStatus</li>
<li>
<em>brainstate</em>::sortRetired</li>
<li>
<em>steward</em>::hideStatus</li>
<li>
<em>steward</em>::showORhide</li>
<li>
<em>brainstate</em>::hide</li>
<li>
<em>steward</em>::showStatus</li>
<li>
<em>brainstate</em>::Show</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::_Number</li>
<li>
<em>brainstate</em>::groupOfGroupDisplayID</li>
<li>
<em>brainstate</em>::linkinfo</li>
<li>
<em>day1</em>::_keyBrainstate</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>day2</em>::_keyBrainstate</li>
<li>
<em>day2</em>::_keyDay</li>
<li>
<em>day2</em>::swStart</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swPause</li>
<li>
<em>day2</em>::swTotalActivity</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>GrandTotal</li>
<li>calcTotalSelectedList</li>
<li>01SortAndSchedule</li>
<li>calcTotalNewRecord</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32953ScriptAnchor_"></a><td class="script_navbar"><a href="#32950ScriptAnchor_"><span>Previous Script: [addToGrandtotalPart2]</span></a></td><td class="script_navbar"><a href="#32966ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#32935ScriptAnchor_"><span>Next Script: [cancelAddToTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">cancelTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE clear the Xs from the boxes on the add2total layout and then return to the layout they where on</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 clear the Xs from the boxes on the add2total layout and then return to the layout they were on</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::groupAddCheckbox; "" ]</li>
<li>Set Field [ brainstate::groupOfGroupAddCheckbox; "" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Perform Script [ &ldquo;goBackButton&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::groupAddCheckbox</li>
<li>
<em>brainstate</em>::groupOfGroupAddCheckbox</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32934ScriptAnchor_">goBackButton</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32935ScriptAnchor_"></a><td class="script_navbar"><a href="#32953ScriptAnchor_"><span>Previous Script: [cancelTotal]</span></a></td><td class="script_navbar"><a href="#32966ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#32952ScriptAnchor_"><span>Next Script: [cancelAddToGrandtotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">cancelAddToTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE clear the Xs from the boxes on the add2total layout and then return to the totalview layout</li>
<li>#</li>
<li>#</li>
<li>If [ Get ( WindowMode ) = 1 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#1 capture total record's ID</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupAddCheckbox; descending
brainstate::groupType; based on value list: &ldquo;MergeSort&rdquo; ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $brainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>#</li>
<li>#2 clear the Xs from the boxes on the add2total layout</li>
<li>Loop</li>
<li>Set Field [ brainstate::groupAddCheckbox; "" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#3 return to viewtotal layout</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupID; $brainstateID ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Layout [ &ldquo;TotalSort&rdquo; (brainstate) ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::groupAddCheckbox</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::groupID</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>TotalSort</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32952ScriptAnchor_"></a><td class="script_navbar"><a href="#32935ScriptAnchor_"><span>Previous Script: [cancelAddToTotal]</span></a></td><td class="script_navbar"><a href="#32966ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#32832ScriptAnchor_"><span>Next Script: [seperateFromTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">cancelAddToGrandtotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE clear the Xs from the boxes on the add2grandtotal layout and then return to the grandtotalview layout</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 capture total record's ID</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupOfGroupAddCheckbox; descending
brainstate::groupType; based on value list: &ldquo;MergeSort&rdquo; ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $brainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>#</li>
<li>#2 clear the Xs from the boxes on the add2grandtotal layout</li>
<li>Loop</li>
<li>Set Field [ brainstate::groupOfGroupAddCheckbox; "" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#3 return to viewgrandtotal layout</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupOfGroupID; $brainstateID ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Layout [ &ldquo;GrandTotal&rdquo; (brainstate) ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::groupOfGroupAddCheckbox</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::groupOfGroupID</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>GrandTotal</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32832ScriptAnchor_"></a><td class="script_navbar"><a href="#32952ScriptAnchor_"><span>Previous Script: [cancelAddToGrandtotal]</span></a></td><td class="script_navbar"><a href="#32966ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#32928ScriptAnchor_"><span>Next Script: [seperateFromGrandtotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">seperateFromTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE check to insure the record is linked and then delete this link, thus separating it.  </li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 check to if record is the total record and if so stop the script. </li>
<li>If [ brainstate::groupID = brainstate::_lockBrainstateID ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#2 delete the link, capture recordID and description (to update total info) and omit the record from the set of linked records currently being viewed.</li>
<li>Set Field [ brainstate::groupID; "" ]</li>
<li>Set Field [ brainstate::groupDisplayID; "" ]</li>
<li>Set Field [ brainstate::hide; "t" ]</li>
<li>Set Variable [ $separateID; Value:brainstate::_Number ]</li>
<li>Set Variable [ $description; Value:brainstate::description ]</li>
<li>Set Variable [ $layout; Value:Get ( LayoutName ) ]</li>
<li>Omit Record</li>
<li>#</li>
<li>#DISABLE: I thought this was a good idea to delete total records that nothing to total for the user.  But after thinking about it, I now think I should allow the user to do this.  There is no harm in having a non-working total record.  It can always be used again by adding records to it to total, or by turning it into a regular record.</li>
<li>//  #3 determine if user has deleted all records to total</li>
<li>//  If [ Get ( FoundCount )  = 1 and brainstate::_lockBrainstateID = brainstate::groupID ]</li>
<li>//  #</li>
<li>//  #4 capture total record's mergeID</li>
<li>//  Set Variable [ $brainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>//  #</li>
<li>//  #5 flag for grand total update</li>
<li>//  Perform Script [ &ldquo;CHUNK_deleteRecordsTimeFromGrandtotal&rdquo; ]</li>
<li>//  If [ brainstate::groupOfGroupID &ne; "" ]</li>
<li>//  Set Field [ brainstate::groupOfGroupUpdate; "u" ]</li>
<li>//  End If</li>
<li>//  #</li>
<li>//  #6 tell user this record is being deleted and why.  </li>
<li>//  Go to Layout [ &lt;unknown&gt; ]</li>
<li>//  Show Custom Dialog [ Title: "!"; Message: "This total record has no more records to total and so it is being deleted.  You can always re-create it by clicking the total button."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>//  Delete Record/Request
[ No dialog ]</li>
<li>//  Perform Script [ &ldquo;goBackButton&rdquo; ]</li>
<li>//  Halt Script</li>
<li>//  End If</li>
<li>#</li>
<li>#3 note in the info box which record was separated and when and then capture the ID so the linked records be found at the end of the script</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupType; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>Set Field [ brainstate::linkinfo; brainstate::linkinfo &amp; "&para;&para;"  &amp; Get ( CurrentTimeStamp ) &amp; " Separated: " &amp; $separateID  &amp; " " &amp; $description ]</li>
<li>Set Variable [ $brainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>#</li>
<li>#4 flag for grand total update</li>
<li>Set Field [ brainstate::groupOfGroupUpdate; If ( brainstate::groupOfGroupID &ne; "" ; "u" ; "" ) ]</li>
<li>#</li>
<li>#5 recalculate total to subtract the separated record's time from it</li>
<li>Perform Script [ &ldquo;CHUNK_recalculateTotal&rdquo; ]</li>
<li>#</li>
<li>#6 update grandtotal if this record was also part of a grandtotal</li>
<li>If [ brainstate::groupOfGroupUpdate = "u" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupOfGroupUpdate; "u" ]</li>
<li>Perform Find [  ]</li>
<li>Perform Script [ &ldquo;CHUNK_recalculateGrandTotal&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#7 return user to viewtotal layout and show remaining linked records</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupID; $brainstateID ]</li>
<li>Perform Find [  ]</li>
<li>Go to Layout [ $layout ]</li>
<li>Perform Script [ &ldquo;DaySelectSortThenSort&rdquo; ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::groupDisplayID</li>
<li>
<em>brainstate</em>::hide</li>
<li>
<em>brainstate</em>::_Number</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>brainstate</em>::groupOfGroupID</li>
<li>
<em>brainstate</em>::groupOfGroupUpdate</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::linkinfo</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32948ScriptAnchor_">CHUNK_deleteRecordsTimeFromGrandtotal</a></li>
<li><a href="#32934ScriptAnchor_">goBackButton</a></li>
<li><a href="#32941ScriptAnchor_">CHUNK_recalculateTotal</a></li>
<li><a href="#32939ScriptAnchor_">CHUNK_recalculateGrandTotal</a></li>
<li><a href="#32902ScriptAnchor_">DaySelectSortThenSort</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Layout&gt;</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32928ScriptAnchor_"></a><td class="script_navbar"><a href="#32832ScriptAnchor_"><span>Previous Script: [seperateFromTotal]</span></a></td><td class="script_navbar"><a href="#32966ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#32831ScriptAnchor_"><span>Next Script: [newLinkedRecord]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">seperateFromGrandtotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE check to insure the record is linked and then delete this link.  If it is not linked stop the script.  This check is neccessary because filemaker allows the link button that activitates this script to be hidden but not deactivited, and it should not run if there are no records for it to find and display.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 check to if record is the grandtotal record and if so stop the script. </li>
<li>If [ brainstate::groupOfGroupID = brainstate::_lockBrainstateID ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#2 delete the link and omit the record from the set of linked records currently being viewed.</li>
<li>Set Variable [ $separateID; Value:brainstate::_Number ]</li>
<li>Set Variable [ $description; Value:brainstate::description ]</li>
<li>Set Field [ brainstate::groupOfGroupID; "" ]</li>
<li>Set Field [ brainstate::groupOfGroupDisplayID; "" ]</li>
<li>Omit Record</li>
<li>#</li>
<li>#3 note in the info box which record was separated and when and then capture the ID so the linked records be found at the end of the script</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupType; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>Set Field [ brainstate::linkinfo; brainstate::linkinfo &amp; "&para;&para;"  &amp; Get ( CurrentTimeStamp ) &amp; " Separated: " &amp; $separateID  &amp; " " &amp; $description ]</li>
<li>Set Variable [ $grandID; Value:brainstate::_lockBrainstateID ]</li>
<li>#</li>
<li>#5 recalculate grandtotal to subtract the separated record's time from it</li>
<li>Perform Script [ &ldquo;CHUNK_recalculateGrandTotal&rdquo; ]</li>
<li>#</li>
<li>#6 return user to viewgrandtotal layout and show remaining linked records</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupOfGroupID; $grandID ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupType; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Layout [ &ldquo;GrandTotal&rdquo; (brainstate) ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::groupOfGroupID</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::_Number</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>brainstate</em>::groupOfGroupDisplayID</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::linkinfo</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32939ScriptAnchor_">CHUNK_recalculateGrandTotal</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>GrandTotal</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32831ScriptAnchor_"></a><td class="script_navbar"><a href="#32928ScriptAnchor_"><span>Previous Script: [seperateFromGrandtotal]</span></a></td><td class="script_navbar"><a href="#32966ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newLinkedRecord</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE create a new record and link it to an existing total record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 capture the user's and total record's ID numbers</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupType; based on value list: &ldquo;MergeSort&rdquo; ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>Set Variable [ $MergeID; Value:brainstate::groupID ]</li>
<li>Set Variable [ $MergeDisplayID; Value:brainstate::groupDisplayID ]</li>
<li>#</li>
<li>#2 create new record</li>
<li>New Record/Request</li>
<li>#</li>
<li>#3 assign record to the user</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>#</li>
<li>#4 link record to the total record</li>
<li>Set Field [ brainstate::groupID; $MergeID ]</li>
<li>Set Field [ brainstate::groupDisplayID; $MergeDisplayID ]</li>
<li>Commit Records/Requests
[ Skip data entry validation; No dialog ]</li>
<li>#</li>
<li>#5 records must be sorted by ID number, otherwise as soon as the brainstate name field is exited the database sorts the brainstate list by whatever current sort is selected, and the user will see their newly created record disappear.  Step 1 of sorting by ID number is to clear the reference::sort field which is used to conditionally format the label of the currnt sort.  2 sort the records so the new record is the first record, and 3 make sure the sort layout is showing so user can decide to show or hide the new record on the main screens, and finally 4 go to that first record's  description field.</li>
<li>Sort Records [ Specified Sort Order: day1::swSymbols; based on value list: &ldquo;MergeSort&rdquo;
brainstate::_lockBrainstateID; descending ]
[ Restore; No dialog ]</li>
<li>Clear [ reference::sort ]
[ Select ]</li>
<li>If [ Get ( SystemPlatform ) = 3 or steward::iPhoneLayout &ne; "" ]</li>
<li>Go to Layout [ &ldquo;TotalSortAndScheduleiPhone&rdquo; (brainstate) ]</li>
<li>Else If [  ]</li>
<li>Go to Layout [ &ldquo;TotalSort&rdquo; (brainstate) ]</li>
<li>End If</li>
<li>Go to Field [ brainstate::description ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>brainstate</em>::groupDisplayID</li>
<li>
<em>brainstate</em>::_keyUser</li>
<li>
<em>day1</em>::swSymbols</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>reference</em>::sort</li>
<li>
<em>steward</em>::iPhoneLayout</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>TotalSortAndScheduleiPhone</li>
<li>TotalSort</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="32970ScriptAnchor_"></a><a href="#32970ScriptAnchor_toc">addToTotalPart2 CHUNK</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32936ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#32970ScriptAnchor_"><span>Parent Folder: [addToTotalPart2 CHUNK]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNK addToTotalPart3</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32929ScriptAnchor_">addToTotalPart2</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE add selected record's time data to an existing grand total record.  (This will essentially involve deleting all the grand total's day records first because we are not adding the brainstate time for a particular day to the grand total for that day; we are instead adding the total of a day to the grand total which may include time from another brainstate day record that is already included in the grand total.  For example: if on a particular day the current total is 1 hour and the grand total is 1 hour and we are adding to the total (not the grand total) 1 hour from another brainstate, if we did not delete the current grand total which is already 1, adding the new total of 2 hours (1 hour from each of the days it now accounts for) would make it 3 hours!  Thus we first delete the old grand total records so that the updated total records are properly accounted for by it.</li>
<li>#USED BY addToTotalPart2</li>
<li>#</li>
<li>#</li>
<li>#NOTE: the three # symbols set apart chunks of script.  </li>
<li>#NOTE: the finish and error script chunks are almost identical (the error message differ in telling where in the script they occur).  For this reason, they are not numbered as part of a particular chuck of the script, and are separated by three # symbols to set them apart.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#A) BEGIN find selected records to add and link to total record</li>
<li>#</li>
<li>#1 capture total record's ID number</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupAddCheckbox; descending
brainstate::groupType; based on value list: &ldquo;MergeSort&rdquo; ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $brainstateID; Value:brainstate::groupOfGroupID ]</li>
<li>Set Variable [ $totalbrainstateID; Value:brainstate::groupID ]</li>
<li>#</li>
<li>#2 unflag grand total update</li>
<li>Set Field [ brainstate::groupOfGroupUpdate; "" ]</li>
<li>#</li>
<li>#3 delete all its records which will include some of the time from the just separated record.  (Now we are ready to create new total records for the records that remain.)</li>
<li>Enter Find Mode [  ]</li>
<li>Go to Layout [ &ldquo;calcTotalNewRecord&rdquo; (day2) ]</li>
<li>Set Field [ day2::_keyBrainstate; $brainstateID ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#4 double check to insure records to be deleted are the right records.  (During testing all 900+ records where deleted from my database.  I think what happened is the find came up with zero records and then displayed all the records in the database and the next step deleted them.  This If check will prevent that from happening again if that is what happened.  I have been unable to duplicate this massive error, so this might not be reason why all the records where deleted, but this is the only time when the database is told to delete all found records, rather than just one record, so I figure it must have been caused here.)</li>
<li>If [ day2::_keyBrainstate = $brainstateID ]</li>
<li>Delete All Records
[ No dialog ]</li>
<li>End If</li>
<li>#5 make a list of only the records to be added and the total record</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupOfGroupID; $brainstateID ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#BEGIN find error 1</li>
<li>If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number.
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming add to total part 2 script part A2."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#Find all records user had showing when they clicked the merge button</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>If [ steward::retiredStatus = "r" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>If [ steward::hideStatus = "" and steward::showORhide = "hide" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::hide: &ldquo;t&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::showStatus  &ne;  "" and steward::showORhide = "show" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::Show: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END find error 1
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#6 link all records</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupType; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>Set Variable [ $brainstateDisplayID; Value:brainstate::_Number ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::groupOfGroupID; $brainstateID ]</li>
<li>Set Field [ brainstate::groupOfGroupDisplayID; $brainstateDisplayID ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#A) END find selected records to add and link to total record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Loop</li>
<li>#B) BEGIN add a merge record's ID# to the description of the new GRAND total record.</li>
<li>#</li>
<li>#1 make sure there is a record to be merged (this step will be important when this loop is repeated after the first record to be merged is omitted).</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>If [ brainstate::_lockBrainstateID  &ne;  brainstate::groupOfGroupID ]</li>
<li>#</li>
<li>#2 capture merged ID number for GRAND total's linkinfo field: total of: ID, ID, ID, etc.</li>
<li>Set Variable [ $CurrentBrainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $CurrentBrainstateDisplayID; Value:brainstate::_Number ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN finish</li>
<li>Else If [ brainstate::_lockBrainstateID = brainstate::groupOfGroupID ]</li>
<li>#If all records are empty then the merge is complete and now the user needs to be shown the updated total and its linked records.</li>
<li>Go to Layout [ &ldquo;TotalSort&rdquo; (brainstate) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupID; $totalbrainstateID ]</li>
<li>Perform Find [  ]</li>
<li>Go to Field [  ]</li>
<li>If [ Get ( SystemPlatform ) = 3 ]</li>
<li>Go to Layout [ &ldquo;TotalSortAndScheduleiPhone&rdquo; (brainstate) ]</li>
<li>End If</li>
<li>Halt Script</li>
<li>#END finish</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#B) END add a merge record's ID# to the description of the new total record.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#C BEGIN find merge record's related day records</li>
<li>#</li>
<li>#1 make a list of the first brainstate's day records in a new window</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ day1::_keyBrainstate; $CurrentBrainstateID ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#C END find merge record's related day records</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#D BEGIN no records found loop (this loop will either complete the merge process or find a merge record with related day records)
</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#1 if records are found exit loop</li>
<li>Exit Loop If [ Get ( LastError )  = 0 ]</li>
<li>#</li>
<li>#2 clear the merge field (the big X in the box on the ToBeMerged layout) and omit this record</li>
<li>If [ Get ( LastError )  = 401 ]</li>
<li>Go to Layout [ &ldquo;01SortAndSchedule&rdquo; (brainstate) ]</li>
<li>Set Field [ brainstate::groupOfGroupAddCheckbox; "" ]</li>
<li>Omit Record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN finish</li>
<li>If [ brainstate::_lockBrainstateID = brainstate::groupOfGroupID ]</li>
<li>#If all records are empty then the merge is complete and now the user needs to be shown the updated total and its linked records.</li>
<li>Go to Layout [ &ldquo;TotalEditTime&rdquo; (brainstate) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupID; $totalbrainstateID ]</li>
<li>Perform Find [  ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END finish</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN find error 2</li>
<li>Else If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming grand total merge script part D2."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#Find all records user had showing when they clicked the merge button</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>If [ steward::retiredStatus = "r" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>If [ steward::hideStatus = "" and steward::showORhide = "hide" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::hide: &ldquo;t&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::showStatus  &ne;  "" and steward::showORhide = "show" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::Show: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END find error 2
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#3 capture next records ID number for total's linkinfo field: total of: ID, ID, ID, etc.</li>
<li>Set Variable [ $CurrentBrainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $CurrentBrainstateDisplayID; Value:brainstate::_Number ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#4 make a list of this record's day records in a new window.</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ day1::_keyBrainstate; $CurrentBrainstateID ]</li>
<li>Perform Find [  ]</li>
<li>End Loop</li>
<li>#</li>
<li>#D END no records found loop 
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#E BEGIN create new related day records and add selected record's time to them</li>
<li>#</li>
<li>Loop</li>
<li>#1 find any day records for the new brainstate that match the kfDay of the first merge record.  If this new record already has data in it, then we want to add new data to the old data; not replace the old data with new data.</li>
<li>Set Variable [ $mergeDay; Value:day1::_keyDay ]</li>
<li>Enter Find Mode [  ]</li>
<li>Go to Layout [ &ldquo;calcTotalNewRecord&rdquo; (day2) ]</li>
<li>Set Field [ day2::_keyBrainstate; $brainstateID ]</li>
<li>Set Field [ day2::_keyDay; $mergeDay ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#2 if no matches are found, create a new day record and put in the time of the first the current day record</li>
<li>If [ Get ( LastError )  = 401 ]</li>
<li>New Record/Request</li>
<li>Set Field [ day2::_keyBrainstate; $brainstateID ]</li>
<li>Set Field [ day2::_keyDay; $mergeDay ]</li>
<li>Set Field [ day2::swStart; day2::_keyDay &amp; " 0:00:00" ]</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Set Variable [ $TotalActivity; Value:day1::swTotalActivity ]</li>
<li>Go to Layout [ &ldquo;calcTotalNewRecord&rdquo; (day2) ]</li>
<li>Set Field [ day2::swPause; Case ( 

$TotalActivity    &gt;   Time ( 23 ; 59 ; 59 )  ; day2::_keyDay &amp;  " 24:00:00" ; 

$TotalActivity     &lt;   Time ( 0 ; 0 ; 0 )  ; day2::_keyDay &amp;  " 00:00:00" ; 

day2::_keyDay &amp; " "  &amp; $TotalActivity )

//insures that no more than 24 hours will be put into a day and that a day with negative time does not cause an error. ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN find error 3</li>
<li>Else If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error" &amp; Get ( LastError )  &amp;  "peforming grand total merge script part E2."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#Find all records user had showing when they clicked the merge button.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>If [ steward::retiredStatus = "r" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>If [ steward::hideStatus = "" and steward::showORhide = "hide" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::hide: &ldquo;t&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::showStatus  &ne;  "" and steward::showORhide = "show" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::Show: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>#END find error 3
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#3 if a match is found, then add the current day's time to this day's time.</li>
<li>Else If [ Get ( LastError )  = 0 ]</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Set Variable [ $TotalActivity; Value:day1::swTotalActivity ]</li>
<li>Go to Layout [ &ldquo;calcTotalNewRecord&rdquo; (day2) ]</li>
<li>Set Field [ day2::swPause; Case ( 

$TotalActivity +  day2::swTotalActivity    &gt;   Time ( 23 ; 59 ; 59 )  ; day2::_keyDay &amp;  " 24:00:00" ; 

$TotalActivity +  day2::swTotalActivity    &lt;   Time ( 0 ; 0 ; 0 )  ; day2::_keyDay &amp;  " 00:00:00" ; 

day2::_keyDay &amp; " "  &amp; ($TotalActivity +  day2::swTotalActivity)  )

//insures that no more than 24 hours will be put into a day and that a day with negative time does not cause an error. ]</li>
<li>End If</li>
<li>#</li>
<li>#4 repeat loop for found record's next related day record.</li>
<li>Go to Layout [ &ldquo;calcTotalSelectedList&rdquo; (day1) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#E END create new related day records and add selected record's time to them</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#F BEGIN go to next record with related day records to be added to the new total record.</li>
<li>#</li>
<li>Go to Layout [ &ldquo;01SortAndSchedule&rdquo; (brainstate) ]</li>
<li>#Clear the merge field (the big X in the box on the ToBeMerged layout).</li>
<li>Set Field [ brainstate::groupOfGroupAddCheckbox; "" ]</li>
<li>Omit Record</li>
<li>#</li>
<li>#F END go to next record with related day records to be added to the new total record.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>End Loop</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>brainstate</em>::groupAddCheckbox</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::groupOfGroupID</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>brainstate</em>::groupOfGroupUpdate</li>
<li>
<em>day2</em>::_keyBrainstate</li>
<li>
<em>steward</em>::retiredStatus</li>
<li>
<em>brainstate</em>::sortRetired</li>
<li>
<em>steward</em>::hideStatus</li>
<li>
<em>steward</em>::showORhide</li>
<li>
<em>brainstate</em>::hide</li>
<li>
<em>steward</em>::showStatus</li>
<li>
<em>brainstate</em>::Show</li>
<li>
<em>brainstate</em>::_Number</li>
<li>
<em>brainstate</em>::groupOfGroupDisplayID</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>day1</em>::_keyBrainstate</li>
<li>
<em>brainstate</em>::groupOfGroupAddCheckbox</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>day2</em>::_keyDay</li>
<li>
<em>day2</em>::swStart</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swPause</li>
<li>
<em>day2</em>::swTotalActivity</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>calcTotalNewRecord</li>
<li>calcBrainstateTable</li>
<li>TotalSort</li>
<li>TotalSortAndScheduleiPhone</li>
<li>calcTotalSelectedList</li>
<li>01SortAndSchedule</li>
<li>TotalEditTime</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="32968ScriptAnchor_"></a><a href="#32968ScriptAnchor_toc">falsified ideas</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32932ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#32968ScriptAnchor_"><span>Parent Folder: [falsified ideas]</span></a></td><td class="script_navbar"><a href="#32948ScriptAnchor_"><span>Next Script: [CHUNK_deleteRecordsTimeFromGrandtotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">updateTimeAfterSeperate (OLD)</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE separate a record it total record only deleting only the time on the day separated, but keeping the time previously added.  This turned out not to be a good idea.  If the user re-adds this record to the total, its time doubled on those days its time was not deleted during the separate.</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #NOTE: the three # symbols set apart chunks of script.  </li>
<li>//  #NOTE: the finish and error script chunks are almost identical (the error message differ in telling where in the script they occur).  For this reason, they are not numbered as part of a particular chuck of the script, and are separated by three # symbols to set them apart.</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #basic administration tasks</li>
<li>//  Set Error Capture [ On ]</li>
<li>//  Allow User Abort [ Off ]</li>
<li>//  Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #A) BEGIN go to a new window and hide it to preserve focus in user's current window while peforming this script, and to hide the strobe effect of the window while performing the script.
</li>
<li>//  #</li>
<li>//  #1 open a new window and hide it</li>
<li>//  New Window [ Name: "UpateTime"; Height: 100; Width: 100 ]</li>
<li>//  Adjust Window
[ Hide ]</li>
<li>//  Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>//  #</li>
<li>//  #A) END go to a new window and hide it to preserve focus in user's current window while peforming this script, and to hide the strobe effect of the window while performing the script.
</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #B) BEGIN mark record for grandtotal update (if it is part of one) and determine if the just separated record was the last record this total record was summing up.</li>
<li>//  #</li>
<li>//  #1 flag for grand total update</li>
<li>//  Sort Records [ Specified Sort Order: brainstate::groupType; based on value list: &ldquo;MergeSort&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Set Field [ brainstate::groupOfGroupUpdate; If ( brainstate::groupOfGroupID &ne; "" ; "u" ; "" ) ]</li>
<li>//  #</li>
<li>//  #2 determine if user has deleted all records to total and if so give them the option to turn this total record into a normal record or add another record to it to keep it as a total record.</li>
<li>//  If [ Get ( FoundCount )  = 1 and brainstate::_lockBrainstateID = brainstate::groupID ]</li>
<li>//  If [ day1::_keyDay  &ne;  "" ]</li>
<li>//  Set Variable [ $dayID; Value:day1::_lockDay ]</li>
<li>//  Go to Layout [ &ldquo;calcDayTable&rdquo; (day1) ]</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ day1::_lockDay; $dayID ]</li>
<li>//  Perform Find [  ]</li>
<li>//  Delete Record/Request
[ No dialog ]</li>
<li>//  End If</li>
<li>//  Close Window [ Name: "UpateTime"; Current file ]</li>
<li>//  Go to Layout [ &ldquo;totalViewSeparated&rdquo; (brainstate) ]</li>
<li>//  Show Custom Dialog [ Title: "!"; Message: "Option 1) To make this record a non-total record, change its name (opptional), and click the go back button.&para;Option 2) To keep it as a total record, click the add button and select 1 or more records for it to total."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>//  Go to Field [ brainstate::description ]</li>
<li>//  Halt Script</li>
<li>//  End If</li>
<li>//  #</li>
<li>//  #B) END mark record for grandtotal update (if it is part of one) and determine if the just separated record was the last record this total record was summing up.</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #C) BEGIN total record</li>
<li>//  #</li>
<li>//  #1 if linked records are found, first reset the total record's time to zero in case the amount of time has decreased (essentially by deleting its current day record and creating a new blank one).
</li>
<li>//  If [ day1::_keyDay = "" ]</li>
<li>//  Set Variable [ $BrainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>//  Go to Layout [ &ldquo;calcDayTable&rdquo; (day1) ]</li>
<li>//  New Record/Request</li>
<li>//  Set Field [ day1::_keyBrainstate; $BrainstateID ]</li>
<li>//  Insert Calculated Result [ day1::_keyDay; reference::day1 ]
[ Select ]</li>
<li>//  Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>//  End If</li>
<li>//  Set Field [ day1::swStart; day1::_keyDay &amp; " 0:00:00" ]</li>
<li>//  Set Field [ day1::swPause; day1::_keyDay &amp; " 0:00:00" ]</li>
<li>//  #</li>
<li>//  Loop</li>
<li>//  #</li>
<li>//  #2 go to the last record


</li>
<li>//  Go to Record/Request/Page
[ Last ]</li>
<li>//  #</li>
<li>//  #3 if there are no records to add then delete the just created related day record for this total record (this action would be caused by the user deleting all the time in the linked records).
</li>
<li>//  If [ brainstate::_lockBrainstateID = brainstate::groupID ]</li>
<li>//  If [ day1::swTotalActivity = "0:00:00" ]</li>
<li>//  Set Variable [ $dayID; Value:day1::_lockDay ]</li>
<li>//  Go to Layout [ &ldquo;calcDayTable&rdquo; (day1) ]</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ day1::_lockDay; $dayID ]</li>
<li>//  Perform Find [  ]</li>
<li>//  Delete Record/Request
[ No dialog ]</li>
<li>//  Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>//  End If</li>
<li>//  #</li>
<li>//  #4 go the next part of the script once there are no more records to add

</li>
<li>//  Exit Loop If [ brainstate::_lockBrainstateID = brainstate::groupID ]</li>
<li>//  #</li>
<li>//  #5 if there is a record to add capture its total time, omit it, go the first record and add this time to current total time.


</li>
<li>//  Else If [ day1::_keyDay = "" ]</li>
<li>//  Omit Record</li>
<li>//  Else If [ day1::_keyDay &ne; "" ]</li>
<li>//  Set Variable [ $TotalActivity; Value:day1::swTotalActivity ]</li>
<li>//  Omit Record</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Insert Calculated Result [ day1::swPause; Case ( 

$TotalActivity +  day1::swTotalActivity    &gt;   Time ( 23 ; 59 ; 59 )  ; day1::_keyDay &amp;  " 24:00:00" ; 

$TotalActivity +  day1::swTotalActivity    &lt;   Time ( 0 ; 0 ; 0 )  ; day1::_keyDay &amp;  " 00:00:00" ; 

day1::_keyDay &amp; " "  &amp; ($TotalActivity +  day1::swTotalActivity)  )

//insures that no more than 24 hours will be put into a day and that a day with negative time does not cause an error. ]
[ Select ]</li>
<li>//  End If</li>
<li>//  End Loop</li>
<li>//  #</li>
<li>//  #C) END update found record</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #</li>
<li>//  Loop</li>
<li>//  #</li>
<li>//  #D) BEGIN find all user GRAND total records that need to be udated</li>
<li>//  #</li>
<li>//  #1 find records</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ brainstate::_keyUser; $user ]</li>
<li>//  Set Field [ brainstate::groupOfGroupUpdate; "u" ]</li>
<li>//  Perform Find [  ]</li>
<li>//  #</li>
<li>//  #2 if no records are found go to step</li>
<li>//  Exit Loop If [ Get ( LastError )  = 401 ]</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #BEGIN error 1</li>
<li>//  If [ Get ( LastError )   &ne; 0 ]</li>
<li>//  #tell user the error number
</li>
<li>//  Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming CheckUpdateTime step i1."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>//  Close Window [ Name: "UpateTime"; Current file ]</li>
<li>//  Exit Script [  ]</li>
<li>//  End If</li>
<li>//  #END error 1</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #D) END find all user GRAND total records that need to be udated</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #E) BEGIN update found record</li>
<li>//  #</li>
<li>//  #1 unflag this total record for grand total update</li>
<li>//  Clear [ brainstate::groupOfGroupUpdate ]
[ Select ]</li>
<li>//  #</li>
<li>//  #2 find its linked records

</li>
<li>//  Set Variable [ $mergeto; Value:brainstate::groupOfGroupID ]</li>
<li>//  Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ brainstate::groupOfGroupID; $mergeto ]</li>
<li>//  Perform Find [  ]</li>
<li>//  Sort Records [ Specified Sort Order: brainstate::groupType; based on value list: &ldquo;MergeSort&rdquo; ]
[ Restore; No dialog ]</li>
<li>//  #</li>
<li>//  #3 if linked records are found, first reset the total record's time to zero in case the amount of time has decreased (essentially by deleting its current day record and creating a new blank one).
</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  If [ day1::_keyDay = "" ]</li>
<li>//  Set Variable [ $BrainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>//  Go to Layout [ &ldquo;calcDayTable&rdquo; (day1) ]</li>
<li>//  New Record/Request</li>
<li>//  Set Field [ day1::_keyBrainstate; $BrainstateID ]</li>
<li>//  Insert Calculated Result [ day1::_keyDay; reference::day1 ]
[ Select ]</li>
<li>//  Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>//  End If</li>
<li>//  Set Field [ day1::swStart; day1::_keyDay &amp; " 0:00:00" ]</li>
<li>//  Set Field [ day1::swPause; day1::_keyDay &amp; " 0:00:00" ]</li>
<li>//  #</li>
<li>//  Loop</li>
<li>//  #</li>
<li>//  #4 go to the last record


</li>
<li>//  Go to Record/Request/Page
[ Last ]</li>
<li>//  #</li>
<li>//  #5 if there are no records to add then delete the just created related day record for this total record (this action would be caused by the user deleting all the time in the linked records).
</li>
<li>//  If [ brainstate::_lockBrainstateID = brainstate::groupOfGroupID ]</li>
<li>//  If [ day1::swTotalActivity = "0:00:00" ]</li>
<li>//  Set Variable [ $dayID; Value:day1::_lockDay ]</li>
<li>//  Go to Layout [ &ldquo;calcDayTable&rdquo; (day1) ]</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ day1::_lockDay; $dayID ]</li>
<li>//  Perform Find [  ]</li>
<li>//  Delete Record/Request
[ No dialog ]</li>
<li>//  Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>//  End If</li>
<li>//  #</li>
<li>//  #6 go the next part of the script once there are no more records to add

</li>
<li>//  Exit Loop If [ brainstate::_lockBrainstateID = brainstate::groupOfGroupID ]</li>
<li>//  #</li>
<li>//  #7 if there is a record to add capture its total time, omit it, go the first record and add this time to current total time.


</li>
<li>//  Else If [ day1::_keyDay = "" ]</li>
<li>//  Omit Record</li>
<li>//  Else If [ day1::_keyDay &ne; "" ]</li>
<li>//  Set Variable [ $TotalActivity; Value:day1::swTotalActivity ]</li>
<li>//  Omit Record</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Insert Calculated Result [ day1::swPause; Case ( 

$TotalActivity +  day1::swTotalActivity    &gt;   Time ( 23 ; 59 ; 59 )  ; day1::_keyDay &amp;  " 24:00:00" ; 

$TotalActivity +  day1::swTotalActivity    &lt;   Time ( 0 ; 0 ; 0 )  ; day1::_keyDay &amp;  " 00:00:00" ; 

day1::_keyDay &amp; " "  &amp; ($TotalActivity +  day1::swTotalActivity)  )

//insures that no more than 24 hours will be put into a day and that a day with negative time does not cause an error. ]
[ Select ]</li>
<li>//  End If</li>
<li>//  End Loop</li>
<li>//  End Loop</li>
<li>//  #</li>
<li>//  #8) close window and sort records</li>
<li>//  Close Window [ Name: "UpateTime"; Current file ]</li>
<li>//  Perform Script [ &ldquo;sortRestoreAfterScript&rdquo; ]</li>
<li>//  #</li>
<li>//  #E) END update found record</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>brainstate</em>::groupOfGroupID</li>
<li>
<em>brainstate</em>::groupOfGroupUpdate</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>day1</em>::_lockDay</li>
<li>
<em>day1</em>::_keyBrainstate</li>
<li>
<em>reference</em>::day1</li>
<li>
<em>day1</em>::swStart</li>
<li>
<em>day1</em>::swPause</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::_keyUser</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32830ScriptAnchor_">sortRestoreAfterScript</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>calcBrainstateTable</li>
<li>calcDayTable</li>
<li>totalViewSeparated</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32948ScriptAnchor_"></a><td class="script_navbar"><a href="#32932ScriptAnchor_"><span>Previous Script: [updateTimeAfterSeperate (OLD)]</span></a></td><td class="script_navbar"><a href="#32968ScriptAnchor_"><span>Parent Folder: [falsified ideas]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNK_deleteRecordsTimeFromGrandtotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32832ScriptAnchor_">seperateFromTotal</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#DISABLE: I thought this was a good idea to delete total records that nothing to total for the user.  But after thinking about it, I now think I should allow the user to do this.  There is no harm in having a non-working total record.  It can always be used again by adding records to it to total, or by turning it into a regular record.</li>
<li>//  #PURPOSE set the variables and make a list of the grandtotal records whose time has gone down</li>
<li>//  #CHUNK USED BY seperateFromTotal Script</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #basic administration tasks</li>
<li>//  Set Error Capture [ On ]</li>
<li>//  Allow User Abort [ Off ]</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #1 capture grandtotal record's ID number</li>
<li>//  Set Variable [ $brainstateID; Value:brainstate::groupOfGroupID ]</li>
<li>//  Set Variable [ $$deleteID; Value:brainstate::_lockBrainstateID ]</li>
<li>//  Set Variable [ $totaldisplayID; Value:brainstate::groupDisplayID ]</li>
<li>//  Set Variable [ $description; Value:brainstate::description ]</li>
<li>//  Set Field [ brainstate::description; "   delete interrupted!  click here for info:  Delete this record and this grandtotal record ID number -- "  &amp; $brainstateID  &amp; ". Both can be rebuilt if you still want them.  //  "  &amp; $description ]</li>
<li>//  Set Field [ brainstate::groupOfGroupID; "" ]</li>
<li>//  Set Field [ brainstate::groupOfGroupDisplayID; "" ]</li>
<li>//  #</li>
<li>//  #2 make a list of records that are part of the grandtotal -- including the grandtotal in preparation or totaling their time (after separating a record from one of the totals)</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ brainstate::groupOfGroupID; $brainstateID ]</li>
<li>//  Perform Find [  ]</li>
<li>//  Perform Script [ &ldquo;CHUNK_recalculateGrandTotal&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::groupOfGroupID</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::groupDisplayID</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>brainstate</em>::groupOfGroupDisplayID</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32939ScriptAnchor_">CHUNK_recalculateGrandTotal</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="32874ScriptAnchor_"></a><a href="#32874ScriptAnchor_toc">navigation</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33217ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#33154ScriptAnchor_"><span>Next Script: [gotoLibraryDatabase]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">moreInfo</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>New Window [ Name: "More Info"; Left: Get ( WindowDesktopWidth ) - (Get ( WindowDesktopWidth )  / 2 ) ]</li>
<li>Go to Layout [ &ldquo;moreInfo&rdquo; (steward) ]</li>
<li>Adjust Window
[ Resize to Fit ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>moreInfo</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33154ScriptAnchor_"></a><td class="script_navbar"><a href="#33217ScriptAnchor_"><span>Previous Script: [moreInfo]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#33216ScriptAnchor_"><span>Next Script: [gotoWebsite]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoLibraryDatabase</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>#Stop script if user is process of picking a specific action group.</li>
<li>If [ $$pick = 1 ]</li>
<li>Show Custom Dialog [ Message: "Pick a specific-action tag or click the cancel button in the Tag window.  After you do this you can go to the library.  "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Select the current library windows if open and selected.</li>
<li>Select Window [ Name: "Tag Menus" ]</li>
<li>Select Window [ Name: "Learn" ]</li>
<li>Select Window [ Name: "Setup" ]</li>
<li>Select Window [ Name: "Report" ]</li>
<li>Select Window [ Name: "References" ]</li>
<li>Select Window [ Name: MemorySwitch::currentLibraryMainWIndow ]</li>
<li>#</li>
<li>#If no library is open, then open the last library used.</li>
<li>If [ Get (LastError) = 112 and MemorySwitch::currentLibraryPath   &ne;   "" ]</li>
<li>Open URL [ Case ( Get ( SystemPlatform ) = - 2 ;

Substitute (MemorySwitch::currentLibraryPath ; " " ; "%20" ) ;

Substitute ( Substitute ( MemorySwitch::currentLibraryPath ; "file:/" ; "file://" ) ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>#</li>
<li>#If the path stored for the selected library failed to open</li>
<li>#the library, then that library is no longer there or its</li>
<li>#name has been changed, so inform the user of their</li>
<li>#options.</li>
<li>If [ Get (LastError)  = 5 ]</li>
<li>Show Custom Dialog [ Message: "Last library used cannot be found as it must have been renamed, moved, or deleted.  Find and open it manually or click the allsolutions button to select another library."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#If their are no libraries in the system let the user</li>
<li>#know how to add new ones.</li>
<li>Else If [ Get (LastError) = 112 and MemorySwitch::currentLibraryPath = "" ]</li>
<li>Show Custom Dialog [ Message: "There is no library file in memory.  Click on a library file manually and it will be added to memory and opened the next time you click the library button."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>MemorySwitch</em>::currentLibraryMainWIndow</li>
<li>
<em>MemorySwitch</em>::currentLibraryPath</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33216ScriptAnchor_"></a><td class="script_navbar"><a href="#33154ScriptAnchor_"><span>Previous Script: [gotoLibraryDatabase]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#33187ScriptAnchor_"><span>Next Script: [gotoLibraryDatabaseUsingGoButton]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoWebsite</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Close other solutions window if open after selecting website.</li>
<li>If [ $$otherApps = 1 ]</li>
<li>Set Variable [ $$otherApps ]</li>
<li>Close Window [ Name: "Other Solutions"; Current file ]</li>
<li>Open URL [ "http://helpgivethanks.org/apps/thebuggenie/wiki/Overview" ]
[ No dialog ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33187ScriptAnchor_"></a><td class="script_navbar"><a href="#33216ScriptAnchor_"><span>Previous Script: [gotoWebsite]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#33193ScriptAnchor_"><span>Next Script: [gotoHelp ]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoLibraryDatabaseUsingGoButton</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Because this portal is to external database it is </li>
<li>#essential to get this record's path info for use in </li>
<li>#other script steps.</li>
<li>Set Variable [ $path; Value:MemorySwitch::path ]</li>
<li>#</li>
<li>#If library path is blank (which should only happen if</li>
<li>#admin adds library manually with path), then delete</li>
<li>#this library name from the list.</li>
<li>If [ MemorySwitch::path = "" ]</li>
<li>Show Custom Dialog [ Message: "This library file cannot be found under the name " &amp; MemorySwitch::name &amp; ".  It will be removed from this list.  You can add it back by double clicking on it in its current location."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#</li>
<li>#ISSUE: If you have a portal into a table that is more </li>
<li>#than one relationship away, and if that related table </li>
<li>#exists in an external file, then you cannot delete </li>
<li>#the portal row. </li>
<li>//  Go to Portal Row [ $row ]
[ No dialog ]</li>
<li>//  Delete Record/Request
[ No dialog ]</li>
<li>//  Delete Portal Row
[ No dialog ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;MemorySwitch&rdquo; (MemorySwitch) ]</li>
<li>Show All Records</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $path = MemorySwitch::path ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ $path = MemorySwitch::path ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;users&rdquo; (steward) ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Select the current library windows if open and selected.</li>
<li>If [ MemorySwitch::currentLibraryPath = $path ]</li>
<li>Select Window [ Name: "Tag Menus" ]</li>
<li>Select Window [ Name: "Learn" ]</li>
<li>Select Window [ Name: "Setup" ]</li>
<li>Select Window [ Name: "Report" ]</li>
<li>Select Window [ Name: "References" ]</li>
<li>Select Window [ Name: MemorySwitch::currentLibraryMainWIndow ]</li>
<li>End If</li>
<li>#</li>
<li>#If the library selected is not open, then close the current</li>
<li>#library, which means closing all of its windows, and</li>
<li>#then open the selected library.</li>
<li>If [ MemorySwitch::currentLibraryPath  &ne;  $path or Get (LastError) = 112 ]</li>
<li>Close Window [ Name: "Tag Menus" ]</li>
<li>Close Window [ Name: "Setup" ]</li>
<li>Close Window [ Name: "Report" ]</li>
<li>Close Window [ Name: "Reference" ]</li>
<li>Close Window [ Name: "Recommendations" ]</li>
<li>Close Window [ Name: "Numbers" ]</li>
<li>Close Window [ Name: "Library Update" ]</li>
<li>Close Window [ Name: "import" ]</li>
<li>Close Window [ Name: "Test" ]</li>
<li>Close Window [ Name: "reorder" ]</li>
<li>Close Window [ Name: "delete tag" ]</li>
<li>Close Window [ Name: "Citation Note" ]</li>
<li>Close Window [ Name: "Preview" ]</li>
<li>Close Window [ Name: "Details" ]</li>
<li>Close Window [ Name: "" ]</li>
<li>Close Window [ Name: "Help" ]</li>
<li>Close Window [ Name: "Print/Copy" ]</li>
<li>Close Window [ Name: "Cover Page" ]</li>
<li>Close Window [ Name: "!" ]</li>
<li>Close Window [ Name: "Copy / Paste Evidence" ]</li>
<li>Close Window [ Name: "Day" ]</li>
<li>Open URL [ Case ( Get ( SystemPlatform ) = - 2 ;

Substitute (MemorySwitch::path ; " " ; "%20" ) ;

Substitute ( Substitute ( MemorySwitch::path ; "file:/" ; "file://" ) ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#If the path stored for the selected library failed to open</li>
<li>#the library, then that library is no longer there or its</li>
<li>#name has been changed, so delete it from the </li>
<li>#library list.</li>
<li>If [ Get (LastError)  = 5 ]</li>
<li>Show Custom Dialog [ Message: "Selected library file cannot be found under the name " &amp; MemorySwitch::name &amp; ".  It will be removed from the library list.  You can add it back by double clicking on it in its current location."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#</li>
<li>#ISSUE: If you have a portal into a table that is more </li>
<li>#than one relationship away, and if that related table </li>
<li>#exists in an external file, then you cannot delete </li>
<li>#the portal row. </li>
<li>//  Go to Portal Row [ $row ]
[ No dialog ]</li>
<li>//  Delete Record/Request
[ No dialog ]</li>
<li>//  Delete Portal Row
[ No dialog ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;MemorySwitch&rdquo; (MemorySwitch) ]</li>
<li>Show All Records</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $path = MemorySwitch::path ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ $path = MemorySwitch::path ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;users&rdquo; (steward) ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Close other solutions window if open after selecting a library.</li>
<li>If [ $$otherApps = 1 ]</li>
<li>Close Window [ Name: "Other Solutions"; Current file ]</li>
<li>Set Variable [ $$otherApps ]</li>
<li>End If</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>MemorySwitch</em>::path</li>
<li>
<em>MemorySwitch</em>::name</li>
<li>
<em>MemorySwitch</em>::currentLibraryPath</li>
<li>
<em>MemorySwitch</em>::currentLibraryMainWIndow</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>MemorySwitch</li>
<li>users</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33193ScriptAnchor_"></a><td class="script_navbar"><a href="#33187ScriptAnchor_"><span>Previous Script: [gotoLibraryDatabaseUsingGoButton]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#33185ScriptAnchor_"><span>Next Script: [gotoOtherDatabase]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoHelp </td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>#Stop script if user is process of picking a specific action group.</li>
<li>If [ $$pick = 1 ]</li>
<li>Show Custom Dialog [ Message: "Pick a specific-action tag or click the cancel button in the Tag window.  After you do this you can open Help to learn about creating new specific-actions.  "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#If triggered on the Other Solutions window then </li>
<li>#show a comment instead of opening the Help solultion.</li>
<li>If [ Get ( WindowName ) = "Other Solutions" ]</li>
<li>Show Custom Dialog [ Message: "This window is just buttons that open other solutions or the website.  Click a button and your solution will open."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Set back path from help to this solution.</li>
<li>Set Field [ MemorySwitch::backToSolution; "ActionLog" ]</li>
<li>#</li>
<li>If [ Get (LayoutName) = "users" ]</li>
<li>Set Field [ MemorySwitch::helpLayoutName; "dashboard" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "" ]</li>
<li>#</li>
<li>Else If [ Get (LayoutName) = "01Main" ]</li>
<li>Set Field [ MemorySwitch::helpLayoutName; "timer" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "" ]</li>
<li>#</li>
<li>Else If [ Get (LayoutName) = "01editTime" ]</li>
<li>Set Field [ MemorySwitch::helpLayoutName; "timer edit" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "" ]</li>
<li>#</li>
<li>Else If [ Get (LayoutName) = "Issues" ]</li>
<li>Set Field [ MemorySwitch::helpLayoutName; "Specific Action" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "specific action" ]</li>
<li>#</li>
<li>Else If [ Left (Get (LayoutName) ; 3 ) = "log" ]</li>
<li>Set Field [ MemorySwitch::helpLayoutName; "Specific Action" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "day" ]</li>
<li>#</li>
<li>Else If [ Get (LayoutName) = "IssuesAndObservationsTag" ]</li>
<li>Set Field [ MemorySwitch::helpLayoutName; "Specific Action" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "add" ]</li>
<li>#</li>
<li>Else If [ Get (LayoutName) = "IssuesAndObservationsOrder" ]</li>
<li>Set Field [ MemorySwitch::helpLayoutName; "Specific Action" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "order" ]</li>
<li>#</li>
<li>Else If [ Get (LayoutName) = "IssuesAndObservationsFIND" ]</li>
<li>Set Field [ MemorySwitch::helpLayoutName; "Specific Action" ]</li>
<li>Set Field [ MemorySwitch::helpObjectName; "find" ]</li>
<li>End If</li>
<li>#</li>
<li>#Open the help solution and set the help screen to look at.</li>
<li>Open URL [ Case ( Get ( SystemPlatform ) = - 2 ;

Substitute ( Substitute ( Get (FilePath) ; Get (FileName) &amp; Right ( Get (FilePath) ; 4 ) ; "help" &amp; Right ( Get (FilePath) ; 4 )  ) ; " " ; "%20" ) ;

Substitute ( Substitute ( Substitute ( Get (FilePath) ; Get (FileName) &amp; Right ( Get (FilePath) ; 4 ) ; "help" &amp; Right ( Get (FilePath) ; 4 )  ) ; "file:/" ; "file://" ) ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>Open URL [ Substitute ( Substitute ( Substitute ( Substitute ( Get (FilePath) ; Get (FileName) &amp; Right ( Get (FilePath) ; 4 ) ; "help" &amp; Right ( Get (FilePath) ; 4 )  ) ; "file:/" ; "file://" ) ; " " ; "%20" ) ; "file://" ; "file:///Volumes/" ) ]
[ No dialog ]</li>
<li>#</li>
<li>#If it is already open, then just go the currently open</li>
<li>#windows of the Help solution.</li>
<li>Select Window [ Name: "Help" ]</li>
<li>Select Window [ Name: "Tutorial" ]</li>
<li>#</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>MemorySwitch</em>::backToSolution</li>
<li>
<em>MemorySwitch</em>::helpLayoutName</li>
<li>
<em>MemorySwitch</em>::helpObjectName</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33185ScriptAnchor_"></a><td class="script_navbar"><a href="#33193ScriptAnchor_"><span>Previous Script: [gotoHelp ]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#33189ScriptAnchor_"><span>Next Script: [gotoDatabaseHeartWhisperer]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoOtherDatabase</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Show Custom Dialog [ Message: "Open the Fat and Muscle Efficiency Research (FMER) application or the Budget Research application?"; Buttons: &ldquo;cancel&rdquo;, &ldquo;Budget&rdquo;, &ldquo;FMER&rdquo; ]</li>
<li>If [ Get (LastMessageChoice) = 1 ]</li>
<li>Else If [ Get (LastMessageChoice) = 2 ]</li>
<li>Select Window [ Name: "Budget Research" ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Open URL [ Case ( Get ( SystemPlatform ) = - 2 ;

Substitute ( 
Substitute (Left (Get (FilePath) ; Length ( Get (FilePath) )  - ( Length ( Get (FileName) ) + 4 )  ) ; "file:/" ; "file:/" )
&amp; "Budget Research." &amp; Right ( Get ( FilePath ) ; 3 )
 ; " " ; "%20" ) ;

Substitute ( 
Substitute (Left (Get (FilePath) ; Length ( Get (FilePath) )  - ( Length ( Get (FileName) ) + 4 )  ) ; "file:/" ; "file://" )
&amp; "Budget Research." &amp; Right ( Get ( FilePath ) ; 3 )
 ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>Open URL [ Case ( Get ( SystemPlatform ) = - 2 ;

Substitute ( 
Substitute (Left (Get (FilePath) ; Length ( Get (FilePath) )  - ( Length ( Get (FileName) ) + 4 )  ) ; "file:/" ; "file:/" )
&amp; "Budget Research.USR" 
 ; " " ; "%20" ) ;

Substitute ( 
Substitute (Left (Get (FilePath) ; Length ( Get (FilePath) )  - ( Length ( Get (FileName) ) + 4 )  ) ; "file:/" ; "file://" )
&amp; "Budget Research.USR" 
 ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>End If</li>
<li>End If</li>
<li>Else If [ Get (LastMessageChoice) = 3 ]</li>
<li>Select Window [ Name: "Icons" ]</li>
<li>Select Window [ Name: "Workout Editor" ]</li>
<li>Select Window [ Name: "Plan Week" ]</li>
<li>Select Window [ Name: "My Workouts" ]</li>
<li>Select Window [ Name: "Planned Workouts" ]</li>
<li>If [ MemorySwitch::fatPath = "Workout Editor" ]</li>
<li>Select Window [ Name: "Icons" ]</li>
<li>Select Window [ Name: "Workout Editor" ]</li>
<li>Select Window [ Name: "Plan Week" ]</li>
<li>Else If [ MemorySwitch::fatPath = "Plan Week" ]</li>
<li>Select Window [ Name: "Icons" ]</li>
<li>Select Window [ Name: "Workout Editor" ]</li>
<li>Select Window [ Name: "Plan Week" ]</li>
<li>Else If [ MemorySwitch::fatPath = "Icons" ]</li>
<li>Select Window [ Name: "Icons" ]</li>
<li>Select Window [ Name: "Workout Editor" ]</li>
<li>Select Window [ Name: "Plan Week" ]</li>
<li>Else If [ MemorySwitch::fatPath = "My Workouts" ]</li>
<li>Select Window [ Name: "My Workouts" ]</li>
<li>Select Window [ Name: "Planned Workouts" ]</li>
<li>Else If [ MemorySwitch::fatPath = "Planned Workouts" ]</li>
<li>Select Window [ Name: "My Workouts" ]</li>
<li>Select Window [ Name: "Planned Workouts" ]</li>
<li>End If</li>
<li>Select Window [ Name: MemorySwitch::fatPath ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Open URL [ Case ( Get ( SystemPlatform ) = - 2 ;

Substitute ( 
Substitute (Left (Get (FilePath) ; Length ( Get (FilePath) )  - ( Length ( Get (FileName) ) + 4 )  ) ; "file:/" ; "file:/" )
&amp; "Fat and Muscle Efficiency Research." &amp; Right ( Get ( FilePath ) ; 3 )
 ; " " ; "%20" ) ;

Substitute ( 
Substitute (Left (Get (FilePath) ; Length ( Get (FilePath) )  - ( Length ( Get (FileName) ) + 4 )  ) ; "file:/" ; "file://" )
&amp; "Fat and Muscle Efficiency Research." &amp; Right ( Get ( FilePath ) ; 3 )
 ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>Open URL [ Case ( Get ( SystemPlatform ) = - 2 ;

Substitute ( 
Substitute (Left (Get (FilePath) ; Length ( Get (FilePath) )  - ( Length ( Get (FileName) ) + 4 )  ) ; "file:/" ; "file:/" )
&amp; "Fat and Muscle Efficiency Research.USR" 
 ; " " ; "%20" ) ;

Substitute ( 
Substitute (Left (Get (FilePath) ; Length ( Get (FilePath) )  - ( Length ( Get (FileName) ) + 4 )  ) ; "file:/" ; "file://" )
&amp; "Fat and Muscle Efficiency Research.USR" 
 ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>End If</li>
<li>End If</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>MemorySwitch</em>::fatPath</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33189ScriptAnchor_"></a><td class="script_navbar"><a href="#33185ScriptAnchor_"><span>Previous Script: [gotoOtherDatabase]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#33188ScriptAnchor_"><span>Next Script: [gotoDatabaseBudget]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoDatabaseHeartWhisperer</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Select Window [ Name: "Icons" ]</li>
<li>Select Window [ Name: "Workout Editor" ]</li>
<li>Select Window [ Name: "Plan Week" ]</li>
<li>Select Window [ Name: "My Workouts" ]</li>
<li>Select Window [ Name: "Planned Workouts" ]</li>
<li>If [ MemorySwitch::fatPath = "Workout Editor" ]</li>
<li>Select Window [ Name: "Icons" ]</li>
<li>Select Window [ Name: "Workout Editor" ]</li>
<li>Select Window [ Name: "Plan Week" ]</li>
<li>Else If [ MemorySwitch::fatPath = "Plan Week" ]</li>
<li>Select Window [ Name: "Icons" ]</li>
<li>Select Window [ Name: "Workout Editor" ]</li>
<li>Select Window [ Name: "Plan Week" ]</li>
<li>Else If [ MemorySwitch::fatPath = "Icons" ]</li>
<li>Select Window [ Name: "Icons" ]</li>
<li>Select Window [ Name: "Workout Editor" ]</li>
<li>Select Window [ Name: "Plan Week" ]</li>
<li>Else If [ MemorySwitch::fatPath = "My Workouts" ]</li>
<li>Select Window [ Name: "My Workouts" ]</li>
<li>Select Window [ Name: "Planned Workouts" ]</li>
<li>Else If [ MemorySwitch::fatPath = "Planned Workouts" ]</li>
<li>Select Window [ Name: "My Workouts" ]</li>
<li>Select Window [ Name: "Planned Workouts" ]</li>
<li>End If</li>
<li>Select Window [ Name: MemorySwitch::fatPath ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Open URL [ Case ( Get ( SystemPlatform ) = - 2 ;

Substitute ( 
Substitute (Left (Get (FilePath) ; Length ( Get (FilePath) )  - ( Length ( Get (FileName) ) + 4 )  ) ; "file:/" ; "file:/" )
&amp; "Heart Whisperer." &amp; Right ( Get ( FilePath ) ; 3 )
 ; " " ; "%20" ) ;

Substitute ( 
Substitute (Left (Get (FilePath) ; Length ( Get (FilePath) )  - ( Length ( Get (FileName) ) + 4 )  ) ; "file:/" ; "file://" )
&amp; "Heart Whisperer." &amp; Right ( Get ( FilePath ) ; 3 )
 ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>Open URL [ Case ( Get ( SystemPlatform ) = - 2 ;

Substitute ( 
Substitute (Left (Get (FilePath) ; Length ( Get (FilePath) )  - ( Length ( Get (FileName) ) + 4 )  ) ; "file:/" ; "file:/" )
&amp; "Heart Whisperer.HG2" 
 ; " " ; "%20" ) ;

Substitute ( 
Substitute (Left (Get (FilePath) ; Length ( Get (FilePath) )  - ( Length ( Get (FileName) ) + 4 )  ) ; "file:/" ; "file://" )
&amp; "Heart Whisperer.HG2" 
 ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Close other apps window if open after selecting an app.</li>
<li>If [ $$otherApps = 1 ]</li>
<li>Set Variable [ $$otherApps ]</li>
<li>Close Window [ Name: "All Solutions"; Current file ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>MemorySwitch</em>::fatPath</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33188ScriptAnchor_"></a><td class="script_navbar"><a href="#33189ScriptAnchor_"><span>Previous Script: [gotoDatabaseHeartWhisperer]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#33196ScriptAnchor_"><span>Next Script: [gotoTimer]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoDatabaseBudget</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Select Window [ Name: "Budget Research" ]</li>
<li>If [ Get (LastError) = 112 ]</li>
<li>Open URL [ Case ( Get ( SystemPlatform ) = - 2 ;

Substitute ( 
Substitute (Left (Get (FilePath) ; Length ( Get (FilePath) )  - ( Length ( Get (FileName) ) + 4 )  ) ; "file:/" ; "file:/" )
&amp; "Budget Planner." &amp; Right ( Get ( FilePath ) ; 3 )
 ; " " ; "%20" ) ;

Substitute ( 
Substitute (Left (Get (FilePath) ; Length ( Get (FilePath) )  - ( Length ( Get (FileName) ) + 4 )  ) ; "file:/" ; "file://" )
&amp; "Budget Planner." &amp; Right ( Get ( FilePath ) ; 3 )
 ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>If [ Get (LastError) = 5 ]</li>
<li>Open URL [ Case ( Get ( SystemPlatform ) = - 2 ;

Substitute ( 
Substitute (Left (Get (FilePath) ; Length ( Get (FilePath) )  - ( Length ( Get (FileName) ) + 4 )  ) ; "file:/" ; "file:/" )
&amp; "Budget Research.HG2" 
 ; " " ; "%20" ) ;

Substitute ( 
Substitute (Left (Get (FilePath) ; Length ( Get (FilePath) )  - ( Length ( Get (FileName) ) + 4 )  ) ; "file:/" ; "file://" )
&amp; "Budget Research.HG2" 
 ; " " ; "%20" ) ) ]
[ No dialog ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#Close other apps window if open after selecting an app.</li>
<li>If [ $$otherApps = 1 ]</li>
<li>Set Variable [ $$otherApps ]</li>
<li>Close Window [ Name: "All Solutions"; Current file ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33196ScriptAnchor_"></a><td class="script_navbar"><a href="#33188ScriptAnchor_"><span>Previous Script: [gotoDatabaseBudget]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#33197ScriptAnchor_"><span>Next Script: [gotoSpecificAction]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoTimer</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Stop script if user is process of picking a specific action group.</li>
<li>If [ $$pick = 1 ]</li>
<li>Show Custom Dialog [ Message: "Pick a specific-action group.  After you do this you can select to go to other windows.  "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Select Window [ Name: "Timer" ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33197ScriptAnchor_"></a><td class="script_navbar"><a href="#33196ScriptAnchor_"><span>Previous Script: [gotoTimer]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#104ScriptAnchor_"><span>Next Script: [goDay]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoSpecificAction</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Stop script if user is process of picking a specific action group.</li>
<li>If [ $$pick = 1 ]</li>
<li>Show Custom Dialog [ Message: "Pick a specific-action tag or click the cancel button in the Tag window.  After you do this you can go to the Specific Action window.  "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Select Window [ Name: "Specific Action" ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="104ScriptAnchor_"></a><td class="script_navbar"><a href="#33197ScriptAnchor_"><span>Previous Script: [gotoSpecificAction]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#33056ScriptAnchor_"><span>Next Script: [goDayLastDayUsed]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">goDay</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go back or forwards the number of days specified in the number field to the right the go button on the 1 day layouts</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 capture desired number of days and add to the current date.  (User picks days from a drop down list that includes negative and positive numbers.)</li>
<li>Set Field [ reference::day1; reference::day1 + reference::go ]</li>
<li>#</li>
<li>#2 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#3 capture user's current date perference</li>
<li>Set Field [ steward::chosenDay; reference::day1 ]</li>
<li>#</li>
<li>//  #4 sort the records if the current sort is based on time so if any time is changed it goes up or down the current set of records according to its time value.  The point is to keep the focus where the user expects it to be so the sort, which removes the focus from the current record is only done if the user wants the records sorted by time, in which case after the sort the focus is returned to the first record.</li>
<li>//  Perform Script [ &ldquo;sortRestoreAfterScript&rdquo; ]</li>
<li>#</li>
<li>#4 sort the records</li>
<li>Sort Records [  ]
[ No dialog ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day1</li>
<li>
<em>reference</em>::go</li>
<li>
<em>steward</em>::chosenDay</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32830ScriptAnchor_">sortRestoreAfterScript</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33056ScriptAnchor_"></a><td class="script_navbar"><a href="#104ScriptAnchor_"><span>Previous Script: [goDay]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#33018ScriptAnchor_"><span>Next Script: [goPlus1]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">goDayLastDayUsed</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go back or forwards the number of days specified in the number field to the right the go button on the 1 day layouts</li>
<li>#</li>
<li>#</li>
<li>If [ brainstate::DaysSinceLastUse = "" or brainstate::DaysSinceLastUse = 0 or brainstate::DaysSinceLastUseToggle &ne; "" ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#1 capture desired number of days and add to the current date.  (User picks days from a drop down list that includes negative and positive numbers.)</li>
<li>Set Field [ reference::day1; reference::day1 - brainstate::DaysSinceLastUse ]</li>
<li>#</li>
<li>#2 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#3 capture user's current date perference</li>
<li>Set Field [ steward::chosenDay; reference::day1 ]</li>
<li>#</li>
<li>#4 sort the records if the current sort is based on time so if any time is changed it goes up or down the current set of records according to its time value.  The point is to keep the focus where the user expects it to be so the sort, which removes the focus from the current record is only done if the user wants the records sorted by time, in which case after the sort the focus is returned to the first record.</li>
<li>Perform Script [ &ldquo;sortRestoreAfterScript&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::DaysSinceLastUse</li>
<li>
<em>brainstate</em>::DaysSinceLastUseToggle</li>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenDay</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32830ScriptAnchor_">sortRestoreAfterScript</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33018ScriptAnchor_"></a><td class="script_navbar"><a href="#33056ScriptAnchor_"><span>Previous Script: [goDayLastDayUsed]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#33033ScriptAnchor_"><span>Next Script: [goPlus1iphone]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">goPlus1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go forwards 1 day</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 add one the current date. </li>
<li>Set Field [ reference::day1; reference::day1 + 1 ]</li>
<li>#</li>
<li>#2 refresh the layout so that the key fields for each</li>
<li>#record will be recalculated based on the new day </li>
<li>#selected.  The date and times shown for each </li>
<li>#record are in a table related to each brainstate </li>
<li>#record by their dates.  The key date fields for all </li>
<li>#brainstate records are calculations where the value</li>
<li># equals the reference field date shown at the top of </li>
<li>#the screen in the green, red, or yellow box.  So </li>
<li>#when the user changes the date in the reference </li>
<li>#field (top colored box) and then this script </li>
<li>#refreshes the database, all the brainstate records </li>
<li>#including the ones not shown recalculate their key</li>
<li># fields, the result being they all take in the new </li>
<li>#date.  This means that the related day records now</li>
<li># change too to show the user the day records that </li>
<li>#match the updated brainstate record keys.  (These</li>
<li># day fields are locked to their related brainstate </li>
<li>#records by the brainstate records ID number. </li>
<li># Using these two keys, the database is able to return</li>
<li># the desired day fields for the brainstate record the </li>
<li>#user elects to view at any time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#3 capture user's current date perference</li>
<li>Set Field [ steward::chosenDay; reference::day1 ]</li>
<li>#</li>
<li>//  #4 sort the records if the current sort is based on time so if any time is changed it goes up or down the current set of records according to its time value.  The point is to keep the focus where the user expects it to be so the sort, which removes the focus from the current record is only done if the user wants the records sorted by time, in which case after the sort the focus is returned to the first record.</li>
<li>//  Perform Script [ &ldquo;sortRestoreAfterScript&rdquo; ]</li>
<li>#</li>
<li>#4 sort the records</li>
<li>If [ Get ( LayoutName ) = "01EditTime" ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
brainstate::groupType; ascending
day1::swStart; ascending
brainstate::sortNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Else</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenDay</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>day1</em>::swStart</li>
<li>
<em>brainstate</em>::sortNumber</li>
<li>
<em>brainstate</em>::sortAlpha</li>
<li>
<em>brainstate</em>::sortSubNumber</li>
<li>
<em>brainstate</em>::sortCategory</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32830ScriptAnchor_">sortRestoreAfterScript</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33033ScriptAnchor_"></a><td class="script_navbar"><a href="#33018ScriptAnchor_"><span>Previous Script: [goPlus1]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#33019ScriptAnchor_"><span>Next Script: [goMinus1]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">goPlus1iphone</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go forwards 1 day</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 add one the current date. </li>
<li>Set Field [ reference::day1; reference::day1 + 1 ]</li>
<li>#</li>
<li>#2 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#3 capture user's current date perference</li>
<li>Set Field [ steward::chosenDay; reference::day1 ]</li>
<li>#</li>
<li>#disable step 4 because in view is not a list, so sorting is not helpful.</li>
<li>//  #4 sort the records if the current sort is based on time so if any time is changed it goes up or down the current set of records according to its time value.  The point is to keep the focus where the user expects it to be so the sort, which removes the focus from the current record is only done if the user wants the records sorted by time, in which case after the sort the focus is returned to the first record.</li>
<li>//  Perform Script [ &ldquo;sortRestoreAfterScript&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenDay</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32830ScriptAnchor_">sortRestoreAfterScript</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33019ScriptAnchor_"></a><td class="script_navbar"><a href="#33033ScriptAnchor_"><span>Previous Script: [goPlus1iphone]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#33032ScriptAnchor_"><span>Next Script: [goMinus1iphone]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">goMinus1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go backwards 1 day</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 subract one day from the current date. </li>
<li>Set Field [ reference::day1; reference::day1 - 1 ]</li>
<li>#</li>
<li>#2 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#3 capture user's current date perference</li>
<li>Set Field [ steward::chosenDay; reference::day1 ]</li>
<li>#</li>
<li>//  #4 sort the records if the current sort is based on time so if any time is changed it goes up or down the current set of records according to its time value.  The point is to keep the focus where the user expects it to be so the sort, which removes the focus from the current record is only done if the user wants the records sorted by time, in which case after the sort the focus is returned to the first record.</li>
<li>//  Perform Script [ &ldquo;sortRestoreAfterScript&rdquo; ]</li>
<li>#</li>
<li>#4 sort the records</li>
<li>Sort Records [  ]
[ No dialog ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenDay</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32830ScriptAnchor_">sortRestoreAfterScript</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33032ScriptAnchor_"></a><td class="script_navbar"><a href="#33019ScriptAnchor_"><span>Previous Script: [goMinus1]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#32843ScriptAnchor_"><span>Next Script: [goWeekPlus1]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">goMinus1iphone</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go backwards 1 day</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 subract one day from the current date. </li>
<li>Set Field [ reference::day1; reference::day1 - 1 ]</li>
<li>#</li>
<li>#2 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#3 capture user's current date perference</li>
<li>Set Field [ steward::chosenDay; reference::day1 ]</li>
<li>#</li>
<li>#disable step 4 because in view is not a list, so sorting is not helpful.</li>
<li>//  #4 sort the records if the current sort is based on time so if any time is changed it goes up or down the current set of records according to its time value.  The point is to keep the focus where the user expects it to be so the sort, which removes the focus from the current record is only done if the user wants the records sorted by time, in which case after the sort the focus is returned to the first record.</li>
<li>//  Perform Script [ &ldquo;sortRestoreAfterScript&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenDay</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32830ScriptAnchor_">sortRestoreAfterScript</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32843ScriptAnchor_"></a><td class="script_navbar"><a href="#33032ScriptAnchor_"><span>Previous Script: [goMinus1iphone]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#33156ScriptAnchor_"><span>Next Script: [goWeekMinus1]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">goWeekPlus1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go back or forwards the number of days specified in the number field to the right the go button on the 7 day layouts</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 add one the current date. </li>
<li>Set Field [ reference::day1; reference::day1 + 1 ]</li>
<li>#</li>
<li>#2 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#3 capture user's current date perference for starting the week</li>
<li>Set Field [ steward::chosenWeek; reference::day1 ]</li>
<li>#</li>
<li>#4 freeze window to speed up the calculation by  refreshing the window after all records have been calcuated rather than after each record is calcuated. (This must be done after flushing the cache (step 2) otherwise the flush unfreezes the window.)</li>
<li>Freeze Window</li>
<li>#</li>
<li>#5 go to a different layout to perform this script, which prevents user from seeing the current window refresh.</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#6 total 7 days of time for each record displayed, along with the average time, and number of days contributing time the this average</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::monthsum; day1::swTotalActivity + 
day2::swTotalActivity + 
day3::swTotalActivity + 
day4::swTotalActivity + 
day5::swTotalActivity + 
day6::swTotalActivity + 
day7::swTotalActivity ]</li>
<li>Set Field [ brainstate::monthsumaverage; If ( 

If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) 
 =  0
 ; "" ; brainstate::monthsum / 

(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) 
)

 ) ]</li>
<li>Set Field [ brainstate::monthsumdays; 
(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 )
) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#7 finish by going back to the orginal layout and first record</li>
<li>Go to Layout [ original layout ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenWeek</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swTotalActivity</li>
<li>
<em>day3</em>::swTotalActivity</li>
<li>
<em>day4</em>::swTotalActivity</li>
<li>
<em>day5</em>::swTotalActivity</li>
<li>
<em>day6</em>::swTotalActivity</li>
<li>
<em>day7</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::monthsum</li>
<li>
<em>brainstate</em>::monthsumaverage</li>
<li>
<em>brainstate</em>::monthsumdays</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>calcBrainstateTable</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33156ScriptAnchor_"></a><td class="script_navbar"><a href="#32843ScriptAnchor_"><span>Previous Script: [goWeekPlus1]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#32907ScriptAnchor_"><span>Next Script: [goMonthPlus]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">goWeekMinus1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go back or forwards the number of days specified in the number field to the right the go button on the 7 day layouts</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 add one the current date. </li>
<li>Set Field [ reference::day1; reference::day1 - 1 ]</li>
<li>#</li>
<li>#2 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#3 capture user's current date perference for starting the week</li>
<li>Set Field [ steward::chosenWeek; reference::day1 ]</li>
<li>#</li>
<li>#4 freeze window to speed up the calculation by  refreshing the window after all records have been calcuated rather than after each record is calcuated. (This must be done after flushing the cache (step 2) otherwise the flush unfreezes the window.)</li>
<li>Freeze Window</li>
<li>#</li>
<li>#5 go to a different layout to perform this script, which prevents user from seeing the current window refresh.</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#6 total 7 days of time for each record displayed, along with the average time, and number of days contributing time the this average</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::monthsum; day1::swTotalActivity + 
day2::swTotalActivity + 
day3::swTotalActivity + 
day4::swTotalActivity + 
day5::swTotalActivity + 
day6::swTotalActivity + 
day7::swTotalActivity ]</li>
<li>Set Field [ brainstate::monthsumaverage; If ( 

If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) 
 =  0
 ; "" ; brainstate::monthsum / 

(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) 
)

 ) ]</li>
<li>Set Field [ brainstate::monthsumdays; 
(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 )
) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#7 finish by going back to the orginal layout and first record</li>
<li>Go to Layout [ original layout ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenWeek</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swTotalActivity</li>
<li>
<em>day3</em>::swTotalActivity</li>
<li>
<em>day4</em>::swTotalActivity</li>
<li>
<em>day5</em>::swTotalActivity</li>
<li>
<em>day6</em>::swTotalActivity</li>
<li>
<em>day7</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::monthsum</li>
<li>
<em>brainstate</em>::monthsumaverage</li>
<li>
<em>brainstate</em>::monthsumdays</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>calcBrainstateTable</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32907ScriptAnchor_"></a><td class="script_navbar"><a href="#33156ScriptAnchor_"><span>Previous Script: [goWeekMinus1]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#33157ScriptAnchor_"><span>Next Script: [goMonthMinus]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">goMonthPlus</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go back or forwards the number of days specified in the number field to the right the go button on the 7 day layouts</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 capture desired number of days and add to the current date.  (User picks days from a drop down list that includes negative and positive numbers.)</li>
<li>Set Field [ reference::day1; reference::day1 + reference::go ]</li>
<li>#</li>
<li>#2 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#3 capture user's current date perference for starting the month</li>
<li>Set Field [ steward::chosenMonth; reference::day1 ]</li>
<li>#</li>
<li>#4 freeze window to speed up the calculation by  refreshing the window after all records have been calcuated rather than after each record is calcuated. (This must be done after flushing the cache (step 2) otherwise the flush unfreezes the window.)</li>
<li>Freeze Window</li>
<li>#</li>
<li>#5 go to a different layout to perform this script, which prevents user from seeing the current window refresh.</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#6 total 31 days of time for each record displayed, along with the average time, and number of days contributing time the this average</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::monthsum; day1::swTotalActivity + 
day2::swTotalActivity + 
day3::swTotalActivity + 
day4::swTotalActivity + 
day5::swTotalActivity + 
day6::swTotalActivity + 
day7::swTotalActivity +
day8::swTotalActivity + 
day9::swTotalActivity + 
day10::swTotalActivity +
day11::swTotalActivity +
day12::swTotalActivity +
day13::swTotalActivity +
day14::swTotalActivity +
day15::swTotalActivity +
day16::swTotalActivity +
day17::swTotalActivity +
day18::swTotalActivity +
day19::swTotalActivity +
day20::swTotalActivity +
day21::swTotalActivity +
day22::swTotalActivity +
day23::swTotalActivity +
day24::swTotalActivity +
day25::swTotalActivity +
day26::swTotalActivity +
day27::swTotalActivity +
day28::swTotalActivity +
day29::swTotalActivity +
day30::swTotalActivity +
day31::swTotalActivity ]</li>
<li>Set Field [ brainstate::monthsumaverage; If ( 

If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 )
 =  0
 ; "" ; brainstate::monthsum / 

(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 )
)

 ) ]</li>
<li>Set Field [ brainstate::monthsumdays; If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#7 finish by going back to the orginal layout and first record</li>
<li>Go to Layout [ original layout ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day1</li>
<li>
<em>reference</em>::go</li>
<li>
<em>steward</em>::chosenMonth</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swTotalActivity</li>
<li>
<em>day3</em>::swTotalActivity</li>
<li>
<em>day4</em>::swTotalActivity</li>
<li>
<em>day5</em>::swTotalActivity</li>
<li>
<em>day6</em>::swTotalActivity</li>
<li>
<em>day7</em>::swTotalActivity</li>
<li>
<em>day8</em>::swTotalActivity</li>
<li>
<em>day9</em>::swTotalActivity</li>
<li>
<em>day10</em>::swTotalActivity</li>
<li>
<em>day11</em>::swTotalActivity</li>
<li>
<em>day12</em>::swTotalActivity</li>
<li>
<em>day13</em>::swTotalActivity</li>
<li>
<em>day14</em>::swTotalActivity</li>
<li>
<em>day15</em>::swTotalActivity</li>
<li>
<em>day16</em>::swTotalActivity</li>
<li>
<em>day17</em>::swTotalActivity</li>
<li>
<em>day18</em>::swTotalActivity</li>
<li>
<em>day19</em>::swTotalActivity</li>
<li>
<em>day20</em>::swTotalActivity</li>
<li>
<em>day21</em>::swTotalActivity</li>
<li>
<em>day22</em>::swTotalActivity</li>
<li>
<em>day23</em>::swTotalActivity</li>
<li>
<em>day24</em>::swTotalActivity</li>
<li>
<em>day25</em>::swTotalActivity</li>
<li>
<em>day26</em>::swTotalActivity</li>
<li>
<em>day27</em>::swTotalActivity</li>
<li>
<em>day28</em>::swTotalActivity</li>
<li>
<em>day29</em>::swTotalActivity</li>
<li>
<em>day30</em>::swTotalActivity</li>
<li>
<em>day31</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::monthsum</li>
<li>
<em>brainstate</em>::monthsumaverage</li>
<li>
<em>brainstate</em>::monthsumdays</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>calcBrainstateTable</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33157ScriptAnchor_"></a><td class="script_navbar"><a href="#32907ScriptAnchor_"><span>Previous Script: [goMonthPlus]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#32903ScriptAnchor_"><span>Next Script: [goToFarmer]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">goMonthMinus</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go back or forwards the number of days specified in the number field to the right the go button on the 7 day layouts</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 capture desired number of days and add to the current date.  (User picks days from a drop down list that includes negative and positive numbers.)</li>
<li>Set Field [ reference::day1; reference::day1 - reference::go ]</li>
<li>#</li>
<li>#2 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#3 capture user's current date perference for starting the month</li>
<li>Set Field [ steward::chosenMonth; reference::day1 ]</li>
<li>#</li>
<li>#4 freeze window to speed up the calculation by  refreshing the window after all records have been calcuated rather than after each record is calcuated. (This must be done after flushing the cache (step 2) otherwise the flush unfreezes the window.)</li>
<li>Freeze Window</li>
<li>#</li>
<li>#5 go to a different layout to perform this script, which prevents user from seeing the current window refresh.</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#6 total 31 days of time for each record displayed, along with the average time, and number of days contributing time the this average</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::monthsum; day1::swTotalActivity + 
day2::swTotalActivity + 
day3::swTotalActivity + 
day4::swTotalActivity + 
day5::swTotalActivity + 
day6::swTotalActivity + 
day7::swTotalActivity +
day8::swTotalActivity + 
day9::swTotalActivity + 
day10::swTotalActivity +
day11::swTotalActivity +
day12::swTotalActivity +
day13::swTotalActivity +
day14::swTotalActivity +
day15::swTotalActivity +
day16::swTotalActivity +
day17::swTotalActivity +
day18::swTotalActivity +
day19::swTotalActivity +
day20::swTotalActivity +
day21::swTotalActivity +
day22::swTotalActivity +
day23::swTotalActivity +
day24::swTotalActivity +
day25::swTotalActivity +
day26::swTotalActivity +
day27::swTotalActivity +
day28::swTotalActivity +
day29::swTotalActivity +
day30::swTotalActivity +
day31::swTotalActivity ]</li>
<li>Set Field [ brainstate::monthsumaverage; If ( 

If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 )
 =  0
 ; "" ; brainstate::monthsum / 

(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 )
)

 ) ]</li>
<li>Set Field [ brainstate::monthsumdays; If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#7 finish by going back to the orginal layout and first record</li>
<li>Go to Layout [ original layout ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day1</li>
<li>
<em>reference</em>::go</li>
<li>
<em>steward</em>::chosenMonth</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swTotalActivity</li>
<li>
<em>day3</em>::swTotalActivity</li>
<li>
<em>day4</em>::swTotalActivity</li>
<li>
<em>day5</em>::swTotalActivity</li>
<li>
<em>day6</em>::swTotalActivity</li>
<li>
<em>day7</em>::swTotalActivity</li>
<li>
<em>day8</em>::swTotalActivity</li>
<li>
<em>day9</em>::swTotalActivity</li>
<li>
<em>day10</em>::swTotalActivity</li>
<li>
<em>day11</em>::swTotalActivity</li>
<li>
<em>day12</em>::swTotalActivity</li>
<li>
<em>day13</em>::swTotalActivity</li>
<li>
<em>day14</em>::swTotalActivity</li>
<li>
<em>day15</em>::swTotalActivity</li>
<li>
<em>day16</em>::swTotalActivity</li>
<li>
<em>day17</em>::swTotalActivity</li>
<li>
<em>day18</em>::swTotalActivity</li>
<li>
<em>day19</em>::swTotalActivity</li>
<li>
<em>day20</em>::swTotalActivity</li>
<li>
<em>day21</em>::swTotalActivity</li>
<li>
<em>day22</em>::swTotalActivity</li>
<li>
<em>day23</em>::swTotalActivity</li>
<li>
<em>day24</em>::swTotalActivity</li>
<li>
<em>day25</em>::swTotalActivity</li>
<li>
<em>day26</em>::swTotalActivity</li>
<li>
<em>day27</em>::swTotalActivity</li>
<li>
<em>day28</em>::swTotalActivity</li>
<li>
<em>day29</em>::swTotalActivity</li>
<li>
<em>day30</em>::swTotalActivity</li>
<li>
<em>day31</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::monthsum</li>
<li>
<em>brainstate</em>::monthsumaverage</li>
<li>
<em>brainstate</em>::monthsumdays</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>calcBrainstateTable</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32903ScriptAnchor_"></a><td class="script_navbar"><a href="#33157ScriptAnchor_"><span>Previous Script: [goMonthMinus]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#32921ScriptAnchor_"><span>Next Script: [calendarDayCalc]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">goToFarmer</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go the selected farmer's records from the createEditFarmer layout.  (This is script is identical to the switchFarmer script except for step 1, which is required because the reference field is not available on this layout, and so the user's ID must be taken from the user table, not the reference table.)</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>#</li>
<li>#Loop to correct record.  Portal shows up in on each</li>
<li>#records layout, so first before the script continues</li>
<li>#we need to make sure we are on the record that the user selected.</li>
<li>Set Variable [ $userID; Value:steward 2::_lockUser ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $userID = steward::_lockUser ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>#</li>
<li>#</li>
<li>Freeze Window</li>
<li>If [ Get ( SystemPlatform )  &ne;  3 and steward::iPhoneLayout  =  "" ]</li>
<li>//  Move/Resize Window [ Current Window; Height: steward::windowSizeAndPlace [1]; Width: steward::windowSizeAndPlace [2]; Top: steward::windowSizeAndPlace [3]; Left: steward::windowSizeAndPlace [4] ]</li>
<li>Move/Resize Window [ Current Window; Height: Get (ScreenHeight) - 2 * ( Get (ScreenHeight)  * .05 ); Width:  Get (ScreenWidth)  * .8; Top: Get (ScreenHeight)  * .05; Left:  Get (ScreenWidth)  * .1 ]</li>
<li>Else If [ steward::iPhoneLayout  &ne;  "" ]</li>
<li>Move/Resize Window [ Current Window; Height: steward::windowSizeAndPlace [5]; Width: steward::windowSizeAndPlace [6]; Top: steward::windowSizeAndPlace [7]; Left: steward::windowSizeAndPlace [8] ]</li>
<li>End If</li>
<li>#</li>
<li>#1 capture selected userID, insert it into the referenceID field, then go to layout showing brainstate records.</li>
<li>Set Variable [ $userID; Value:steward::_lockUser ]</li>
<li>Set Field [ reference::farmerID; $userID ]</li>
<li>#</li>
<li>#2 find this user's records</li>
<li>Perform Script [ &ldquo;CHUNK_createRecordsForNewUsers&rdquo; ]</li>
<li>#</li>
<li>#4 show the user's name</li>
<li>Set Field [ reference::farmerName; steward::FirstPlusLast ]</li>
<li>#</li>
<li>#5 show/hide all records according the user's last settings</li>
<li>If [ steward::hideStatus = "" and steward::showORhide = "show" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::hide: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>Else If [ steward::showStatus  &ne;  "" and steward::showORhide = "hide" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::groupType: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>#8 it the user wants retired records hidden then hide these records if any</li>
<li>Perform Script [ &ldquo;CHUNK_retire&rdquo; ]</li>
<li>#</li>
<li>//  #6 go to user's chosen day, sort records, and choose last used layout</li>
<li>//  If [ Left ( steward::chosenLayout ; 2 ) = "01" ]</li>
<li>//  Perform Script [ &ldquo;to 1&rdquo; ]</li>
<li>//  Else If [ Left ( steward::chosenLayout ; 2 ) = "07" ]</li>
<li>//  Perform Script [ &ldquo;to 7&rdquo; ]</li>
<li>//  Else If [ Left ( steward::chosenLayout ; 2 ) = "31" ]</li>
<li>//  Perform Script [ &ldquo;to 31&rdquo; ]</li>
<li>//  End If</li>
<li>#</li>
<li>#Set window title.</li>
<li>Set Window Title [ Current Window; New Title: "Timer" ]</li>
<li>#</li>
<li>#Size window to 150.</li>
<li>Set Zoom Level
[ 150% ]</li>
<li>#</li>
<li>#1 go to user's last layout</li>
<li>If [ steward::chosenLayout = "users" ]</li>
<li>Go to Layout [ &ldquo;01Main&rdquo; (brainstate) ]</li>
<li>#NOT TESTED</li>
<li>If [ Get ( SystemPlatform ) = 3 or steward::iPhoneLayout &ne; "" ]</li>
<li>Go to Layout [ &ldquo;MainiPhone&rdquo; (brainstate) ]</li>
<li>End If</li>
<li>#END NOT TESTED</li>
<li>Else If [ steward::chosenLayout &ne; "users" ]</li>
<li>Go to Layout [ &ldquo;01Main&rdquo; (brainstate) ]</li>
<li>#NOT TESTED</li>
<li>If [ Get ( SystemPlatform ) = 3 or steward::iPhoneLayout &ne; "" ]</li>
<li>Go to Layout [ &ldquo;MainiPhone&rdquo; (brainstate) ]</li>
<li>End If</li>
<li>#END NOT TESTED</li>
<li>End If</li>
<li>#</li>
<li>#2 go to user's chosen day</li>
<li>Set Field [ steward::chosenDay; Get ( CurrentDate ) ]</li>
<li>Set Field [ reference::day1; steward::chosenDay ]</li>
<li>#</li>
<li>#3 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#4 sort records (neccessary because the week and month view usually show more active records than the day view that need to be sorted out of top of list), and go to the first record.</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>Set Field [ steward::chosenLayout; steward::chosenLayoutMain ]</li>
<li>Perform Script [ &ldquo;sortNumbers&rdquo; ]</li>
<li>#7 go to active brainstate or first brainstate.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ day1::swBugField  = "veto" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ day1::swBugField   &ne;  "veto" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>Perform Script [ &ldquo;openSpecificAction&rdquo; ]</li>
<li>Select Window [ Name: "Timer"; Current file ]</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Perform Script [ &ldquo;recordLoad&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward 2</em>::_lockUser</li>
<li>
<em>steward</em>::_lockUser</li>
<li>
<em>steward</em>::iPhoneLayout</li>
<li>
<em>steward</em>::windowSizeAndPlace</li>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>steward</em>::FirstPlusLast</li>
<li>
<em>reference</em>::farmerName</li>
<li>
<em>steward</em>::hideStatus</li>
<li>
<em>steward</em>::showORhide</li>
<li>
<em>brainstate</em>::hide</li>
<li>
<em>steward</em>::showStatus</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>steward</em>::chosenLayout</li>
<li>
<em>steward</em>::chosenDay</li>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenLayoutMain</li>
<li>
<em>day1</em>::swBugField</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32943ScriptAnchor_">CHUNK_createRecordsForNewUsers</a></li>
<li><a href="#33060ScriptAnchor_">CHUNK_retire</a></li>
<li><a href="#32839ScriptAnchor_">to 1</a></li>
<li><a href="#32908ScriptAnchor_">to 7</a></li>
<li><a href="#32910ScriptAnchor_">to 31</a></li>
<li><a href="#32791ScriptAnchor_">sortNumbers</a></li>
<li><a href="#33167ScriptAnchor_">openSpecificAction</a></li>
<li><a href="#33035ScriptAnchor_">recordLoad</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>01Main</li>
<li>MainiPhone</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32921ScriptAnchor_"></a><td class="script_navbar"><a href="#32903ScriptAnchor_"><span>Previous Script: [goToFarmer]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#33034ScriptAnchor_"><span>Next Script: [calendarDayCalciphone]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">calendarDayCalc</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE change the day to start the week and recalculate the Day1 key fields to show the user's data for this day.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 capture the new day as the user's choosen day</li>
<li>Set Field [ steward::chosenDay; reference::day1 ]</li>
<li>#</li>
<li>#2 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>Perform Script [ &ldquo;sortRestoreAfterScript&rdquo; ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenDay</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32830ScriptAnchor_">sortRestoreAfterScript</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33034ScriptAnchor_"></a><td class="script_navbar"><a href="#32921ScriptAnchor_"><span>Previous Script: [calendarDayCalc]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#118ScriptAnchor_"><span>Next Script: [calendarWeekCalc]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">calendarDayCalciphone</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE change the day to start the week and recalculate the Day1 key fields to show the user's data for this day.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 capture the new day as the user's choosen day</li>
<li>Set Field [ steward::chosenDay; reference::day1 ]</li>
<li>#</li>
<li>#2 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#disable next step because in view is not a list, so sorting is not helpful.</li>
<li>//  Perform Script [ &ldquo;sortRestoreAfterScript&rdquo; ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenDay</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32830ScriptAnchor_">sortRestoreAfterScript</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="118ScriptAnchor_"></a><td class="script_navbar"><a href="#33034ScriptAnchor_"><span>Previous Script: [calendarDayCalciphone]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#32846ScriptAnchor_"><span>Next Script: [calendarMonthCalc]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">calendarWeekCalc</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE calculate the total time for 7 days worth of time</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 add 7 days to the users selection of the day desired to start the week.  (Day 1 is the day the user is currently looking at on the day view layouts.  In order to give the user on the week and month view layouts a calendar going from 1 to 7 or 31 it is neccessary to put the Day 1 field at the far right, or furtherest from the titles of the records.  The user expects to to select the day they want to see by clicking on the day field closest to do the titles, which is day 7 on the week and day 31 on month view.  So this script setp captures this left most choice and adds the 6 or 30 to it and applies it to the day 1 field.)</li>
<li>//  Set Field [ reference::day1; reference::day1 +  6 ]</li>
<li>Set Field [ reference::day1; reference::day7Calc + 6 ]</li>
<li>#</li>
<li>#2 capture user's current date perference for starting the week</li>
<li>Set Field [ steward::chosenWeek; reference::day1 ]</li>
<li>#</li>
<li>#3 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#4 freeze window to speed up the calculation by  refreshing the window after all records have been calcuated rather than after each record is calcuated. (This must be done after flushing the cache (step 2) otherwise the flush unfreezes the window.)</li>
<li>Freeze Window</li>
<li>#</li>
<li>#5 go to a different layout to perform this script, which prevents user from seeing the current window refresh.</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#6 total 31 days of time for each record displayed, along with the average time, and number of days contributing time the this average</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::monthsum; day1::swTotalActivity + 
day2::swTotalActivity + 
day3::swTotalActivity + 
day4::swTotalActivity + 
day5::swTotalActivity + 
day6::swTotalActivity + 
day7::swTotalActivity ]</li>
<li>Set Field [ brainstate::monthsumaverage; If ( 

If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) 
 =  0
 ; "" ; brainstate::monthsum / 

(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) 
)

 ) ]</li>
<li>Set Field [ brainstate::monthsumdays; 
(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 )
) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#7 finish by going back to the orginal layout and first record</li>
<li>Go to Layout [ original layout ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Field [ reference::day7Calc; reference::day7 ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day1</li>
<li>
<em>reference</em>::day7Calc</li>
<li>
<em>steward</em>::chosenWeek</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swTotalActivity</li>
<li>
<em>day3</em>::swTotalActivity</li>
<li>
<em>day4</em>::swTotalActivity</li>
<li>
<em>day5</em>::swTotalActivity</li>
<li>
<em>day6</em>::swTotalActivity</li>
<li>
<em>day7</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::monthsum</li>
<li>
<em>brainstate</em>::monthsumaverage</li>
<li>
<em>brainstate</em>::monthsumdays</li>
<li>
<em>reference</em>::day7</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>calcBrainstateTable</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32846ScriptAnchor_"></a><td class="script_navbar"><a href="#118ScriptAnchor_"><span>Previous Script: [calendarWeekCalc]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#32915ScriptAnchor_"><span>Next Script: [calendarMonthCalcChartSortN]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">calendarMonthCalc</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE calculate the total time for 31 days worth of time</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 add 30 days to the users selection of the day desired to start the month.  (Day 1 is the day the user is currently looking at on the day view layouts.  In order to give the user on the week and month view layouts a calendar going from 1 to 7 or 31 it is neccessary to put the Day 1 field at the far right, or furtherest from the titles of the records.  The user expects to to select the day they want to see by clicking on the day field closest to do the titles, which is day 7 on the week and day 31 on month view.  So this script setp captures this left most choice and adds the 6 or 30 to it and applies it to the day 1 field.)</li>
<li>Set Field [ reference::day1; reference::day31Calc  +  30 ]</li>
<li>#</li>
<li>#2 capture user's current date perference for starting the month</li>
<li>Set Field [ steward::chosenMonth; reference::day1 ]</li>
<li>#</li>
<li>#3 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#4 freeze window to speed up the calculation by  refreshing the window after all records have been calcuated rather than after each record is calcuated. (This must be done after flushing the cache (step 2) otherwise the flush unfreezes the window.)</li>
<li>Freeze Window</li>
<li>#</li>
<li>#5 go to a different layout to perform this script, which prevents user from seeing the current window refresh.</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#6 total 31 days of time for each record displayed, along with the average time, and number of days contributing time the this average</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::monthsum; day1::swTotalActivity + 
day2::swTotalActivity + 
day3::swTotalActivity + 
day4::swTotalActivity + 
day5::swTotalActivity + 
day6::swTotalActivity + 
day7::swTotalActivity +
day8::swTotalActivity + 
day9::swTotalActivity + 
day10::swTotalActivity +
day11::swTotalActivity +
day12::swTotalActivity +
day13::swTotalActivity +
day14::swTotalActivity +
day15::swTotalActivity +
day16::swTotalActivity +
day17::swTotalActivity +
day18::swTotalActivity +
day19::swTotalActivity +
day20::swTotalActivity +
day21::swTotalActivity +
day22::swTotalActivity +
day23::swTotalActivity +
day24::swTotalActivity +
day25::swTotalActivity +
day26::swTotalActivity +
day27::swTotalActivity +
day28::swTotalActivity +
day29::swTotalActivity +
day30::swTotalActivity +
day31::swTotalActivity ]</li>
<li>Set Field [ brainstate::monthsumaverage; If ( 

If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 )
 =  0
 ; "" ; brainstate::monthsum / 

(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 )
)

 ) ]</li>
<li>Set Field [ brainstate::monthsumdays; If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#7 finish by going back to the orginal layout and first record</li>
<li>Go to Layout [ &ldquo;31SortN&rdquo; (brainstate) ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day31Calc</li>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenMonth</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swTotalActivity</li>
<li>
<em>day3</em>::swTotalActivity</li>
<li>
<em>day4</em>::swTotalActivity</li>
<li>
<em>day5</em>::swTotalActivity</li>
<li>
<em>day6</em>::swTotalActivity</li>
<li>
<em>day7</em>::swTotalActivity</li>
<li>
<em>day8</em>::swTotalActivity</li>
<li>
<em>day9</em>::swTotalActivity</li>
<li>
<em>day10</em>::swTotalActivity</li>
<li>
<em>day11</em>::swTotalActivity</li>
<li>
<em>day12</em>::swTotalActivity</li>
<li>
<em>day13</em>::swTotalActivity</li>
<li>
<em>day14</em>::swTotalActivity</li>
<li>
<em>day15</em>::swTotalActivity</li>
<li>
<em>day16</em>::swTotalActivity</li>
<li>
<em>day17</em>::swTotalActivity</li>
<li>
<em>day18</em>::swTotalActivity</li>
<li>
<em>day19</em>::swTotalActivity</li>
<li>
<em>day20</em>::swTotalActivity</li>
<li>
<em>day21</em>::swTotalActivity</li>
<li>
<em>day22</em>::swTotalActivity</li>
<li>
<em>day23</em>::swTotalActivity</li>
<li>
<em>day24</em>::swTotalActivity</li>
<li>
<em>day25</em>::swTotalActivity</li>
<li>
<em>day26</em>::swTotalActivity</li>
<li>
<em>day27</em>::swTotalActivity</li>
<li>
<em>day28</em>::swTotalActivity</li>
<li>
<em>day29</em>::swTotalActivity</li>
<li>
<em>day30</em>::swTotalActivity</li>
<li>
<em>day31</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::monthsum</li>
<li>
<em>brainstate</em>::monthsumaverage</li>
<li>
<em>brainstate</em>::monthsumdays</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>calcBrainstateTable</li>
<li>31SortN</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32915ScriptAnchor_"></a><td class="script_navbar"><a href="#32846ScriptAnchor_"><span>Previous Script: [calendarMonthCalc]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#32839ScriptAnchor_"><span>Next Script: [to 1]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">calendarMonthCalcChartSortN</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE calculate the total time for 31 days worth of time</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 add 30 days to the users selection of the day desired to start the month.  (Day 1 is the day the user is currently looking at on the day view layouts.  In order to give the user on the week and month view layouts a calendar going from 1 to 7 or 31 it is neccessary to put the Day 1 field at the far right, or furtherest from the titles of the records.  The user expects to to select the day they want to see by clicking on the day field closest to do the titles, which is day 7 on the week and day 31 on month view.  So this script setp captures this left most choice and adds the 6 or 30 to it and applies it to the day 1 field.)</li>
<li>Set Field [ reference::day1; reference::day31Calc  +  30 ]</li>
<li>#</li>
<li>#2 capture user's current date perference for starting the month</li>
<li>Set Field [ steward::chosenMonth; reference::day1 ]</li>
<li>#</li>
<li>#3 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#4 freeze window to speed up the calculation by  refreshing the window after all records have been calcuated rather than after each record is calcuated. (This must be done after flushing the cache (step 2) otherwise the flush unfreezes the window.)</li>
<li>Freeze Window</li>
<li>#</li>
<li>#5 go to a different layout to perform this script, which prevents user from seeing the current window refresh.</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#6 total 31 days of time for each record displayed, along with the average time, and number of days contributing time the this average</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::monthsum; day1::swTotalActivity + 
day2::swTotalActivity + 
day3::swTotalActivity + 
day4::swTotalActivity + 
day5::swTotalActivity + 
day6::swTotalActivity + 
day7::swTotalActivity +
day8::swTotalActivity + 
day9::swTotalActivity + 
day10::swTotalActivity +
day11::swTotalActivity +
day12::swTotalActivity +
day13::swTotalActivity +
day14::swTotalActivity +
day15::swTotalActivity +
day16::swTotalActivity +
day17::swTotalActivity +
day18::swTotalActivity +
day19::swTotalActivity +
day20::swTotalActivity +
day21::swTotalActivity +
day22::swTotalActivity +
day23::swTotalActivity +
day24::swTotalActivity +
day25::swTotalActivity +
day26::swTotalActivity +
day27::swTotalActivity +
day28::swTotalActivity +
day29::swTotalActivity +
day30::swTotalActivity +
day31::swTotalActivity ]</li>
<li>Set Field [ brainstate::monthsumaverage; If ( 

If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 )
 =  0
 ; "" ; brainstate::monthsum / 

(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 )
)

 ) ]</li>
<li>Set Field [ brainstate::monthsumdays; If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#7 finish by going back to the orginal layout and first record</li>
<li>Go to Layout [ &ldquo;31chartSortN&rdquo; (brainstate) ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day31Calc</li>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenMonth</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swTotalActivity</li>
<li>
<em>day3</em>::swTotalActivity</li>
<li>
<em>day4</em>::swTotalActivity</li>
<li>
<em>day5</em>::swTotalActivity</li>
<li>
<em>day6</em>::swTotalActivity</li>
<li>
<em>day7</em>::swTotalActivity</li>
<li>
<em>day8</em>::swTotalActivity</li>
<li>
<em>day9</em>::swTotalActivity</li>
<li>
<em>day10</em>::swTotalActivity</li>
<li>
<em>day11</em>::swTotalActivity</li>
<li>
<em>day12</em>::swTotalActivity</li>
<li>
<em>day13</em>::swTotalActivity</li>
<li>
<em>day14</em>::swTotalActivity</li>
<li>
<em>day15</em>::swTotalActivity</li>
<li>
<em>day16</em>::swTotalActivity</li>
<li>
<em>day17</em>::swTotalActivity</li>
<li>
<em>day18</em>::swTotalActivity</li>
<li>
<em>day19</em>::swTotalActivity</li>
<li>
<em>day20</em>::swTotalActivity</li>
<li>
<em>day21</em>::swTotalActivity</li>
<li>
<em>day22</em>::swTotalActivity</li>
<li>
<em>day23</em>::swTotalActivity</li>
<li>
<em>day24</em>::swTotalActivity</li>
<li>
<em>day25</em>::swTotalActivity</li>
<li>
<em>day26</em>::swTotalActivity</li>
<li>
<em>day27</em>::swTotalActivity</li>
<li>
<em>day28</em>::swTotalActivity</li>
<li>
<em>day29</em>::swTotalActivity</li>
<li>
<em>day30</em>::swTotalActivity</li>
<li>
<em>day31</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::monthsum</li>
<li>
<em>brainstate</em>::monthsumaverage</li>
<li>
<em>brainstate</em>::monthsumdays</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>calcBrainstateTable</li>
<li>31chartSortN</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32839ScriptAnchor_"></a><td class="script_navbar"><a href="#32915ScriptAnchor_"><span>Previous Script: [calendarMonthCalcChartSortN]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#32919ScriptAnchor_"><span>Next Script: [to 1 chart]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">to 1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32903ScriptAnchor_">goToFarmer</a></li>
<li><a href="#32861ScriptAnchor_">switchFarmer</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go to time layout 1</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 go to time layout 1</li>
<li>Go to Layout [ &ldquo;01Main&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#2 go to user's chosen day</li>
<li>Set Field [ reference::day1; steward::chosenDay ]</li>
<li>#</li>
<li>#3 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#4 sort records (neccessary because the week and month view usually show more active records than the day view that need to be sorted out of top of list), and go to the first record.</li>
<li>Perform Script [ &ldquo;sortNumbers&rdquo; ]</li>
<li>#</li>
<li>#5 go to active brainstate or first brainstate.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ day1::swBugField  = "veto" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ day1::swBugField   &ne;  "veto" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenLayout</li>
<li>
<em>steward</em>::chosenDay</li>
<li>
<em>reference</em>::day1</li>
<li>
<em>day1</em>::swBugField</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32791ScriptAnchor_">sortNumbers</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>01Main</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32919ScriptAnchor_"></a><td class="script_navbar"><a href="#32839ScriptAnchor_"><span>Previous Script: [to 1]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#32908ScriptAnchor_"><span>Next Script: [to 7]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">to 1 chart</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go to time layout 1</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 go to time layout 1</li>
<li>Go to Layout [ &ldquo;01chartSortN&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#2 go to user's chosen day</li>
<li>Set Field [ reference::day1; steward::chosenDay ]</li>
<li>#</li>
<li>#3 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#4 sort records (neccessary because the week and month view usually show more active records than the day view that need to be sorted out of top of list), and go to the first record.</li>
<li>Perform Script [ &ldquo;DaySelectSortThenSort&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenLayout</li>
<li>
<em>steward</em>::chosenDay</li>
<li>
<em>reference</em>::day1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32902ScriptAnchor_">DaySelectSortThenSort</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>01chartSortN</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32908ScriptAnchor_"></a><td class="script_navbar"><a href="#32919ScriptAnchor_"><span>Previous Script: [to 1 chart]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#32918ScriptAnchor_"><span>Next Script: [to 7 chart]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">to 7</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32903ScriptAnchor_">goToFarmer</a></li>
<li><a href="#32861ScriptAnchor_">switchFarmer</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go to time layout 7</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 go to user's chosen day to start the week view</li>
<li>//  Set Field [ reference::day1; Get ( CurrentDate ) ]</li>
<li>#</li>
<li>#2 go to requested layout. (This step prevents the user from seeing the current screen change with the a new date before going to the new layout.)</li>
<li>Go to Layout [ &ldquo;07SortN&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#3 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#4 freeze window to speed up the calculation by  refreshing the window after all records have been calcuated rather than after each record is calcuated. (This must be done after flushing the cache (step 2) otherwise the flush unfreezes the window.)</li>
<li>Freeze Window</li>
<li>#</li>
<li>#5 go to a different layout to perform this script, which prevents user from seeing the current window refresh.</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#6 total 7 days of time for each record displayed, along with the average time, and number of days contributing time the this average</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::monthsum; day1::swTotalActivity + 
day2::swTotalActivity + 
day3::swTotalActivity + 
day4::swTotalActivity + 
day5::swTotalActivity + 
day6::swTotalActivity + 
day7::swTotalActivity ]</li>
<li>Set Field [ brainstate::monthsumaverage; If ( 

If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) 
 =  0
 ; "" ; brainstate::monthsum / 

(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) 
)

 ) ]</li>
<li>Set Field [ brainstate::monthsumdays; 
(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 )
) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#7 go to active brainstate or first brainstate.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ day1::swBugField  = "veto" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ day1::swBugField   &ne;  "veto" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>#</li>
<li>#8 go back to layout time 7, sort records (neccessary because the week and month view usually show more active records that need to be sorted to the top of list), and go to the first record.</li>
<li>Go to Layout [ &ldquo;07SortN&rdquo; (brainstate) ]</li>
<li>Set Field [ reference::day7Calc; reference::day7 ]</li>
<li>Set Field [ steward::chosenSort; "act" ]</li>
<li>Perform Script [ &ldquo;sortActivityWeek&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenLayout</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swTotalActivity</li>
<li>
<em>day3</em>::swTotalActivity</li>
<li>
<em>day4</em>::swTotalActivity</li>
<li>
<em>day5</em>::swTotalActivity</li>
<li>
<em>day6</em>::swTotalActivity</li>
<li>
<em>day7</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::monthsum</li>
<li>
<em>brainstate</em>::monthsumaverage</li>
<li>
<em>brainstate</em>::monthsumdays</li>
<li>
<em>day1</em>::swBugField</li>
<li>
<em>reference</em>::day7</li>
<li>
<em>reference</em>::day7Calc</li>
<li>
<em>steward</em>::chosenSort</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32840ScriptAnchor_">sortActivityWeek</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>07SortN</li>
<li>calcBrainstateTable</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32918ScriptAnchor_"></a><td class="script_navbar"><a href="#32908ScriptAnchor_"><span>Previous Script: [to 7]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#32910ScriptAnchor_"><span>Next Script: [to 31]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">to 7 chart</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go to time layout 7</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 go to user's chosen day to start the week view</li>
<li>If [ steward::chosenWeek = "" ]</li>
<li>Set Field [ steward::chosenWeek; steward::chosenDay ]</li>
<li>End If</li>
<li>Set Field [ reference::day1; steward::chosenWeek ]</li>
<li>#</li>
<li>#2 go to requested layout. (This step prevents the user from seeing the current screen change with the a new date before going to the new layout.)</li>
<li>Go to Layout [ &ldquo;07chartSortN&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#3 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#4 freeze window to speed up the calculation by  refreshing the window after all records have been calcuated rather than after each record is calcuated. (This must be done after flushing the cache (step 2) otherwise the flush unfreezes the window.)</li>
<li>Freeze Window</li>
<li>#</li>
<li>#5 go to a different layout to perform this script, which prevents user from seeing the current window refresh.</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#6 total 7 days of time for each record displayed, along with the average time, and number of days contributing time the this average</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::monthsum; day1::swTotalActivity + 
day2::swTotalActivity + 
day3::swTotalActivity + 
day4::swTotalActivity + 
day5::swTotalActivity + 
day6::swTotalActivity + 
day7::swTotalActivity ]</li>
<li>Set Field [ brainstate::monthsumaverage; If ( 

If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) 
 =  0
 ; "" ; brainstate::monthsum / 

(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) 
)

 ) ]</li>
<li>Set Field [ brainstate::monthsumdays; 
(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 )
) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#7 go back to layout time 7, sort records (neccessary because the week and month view usually show more active records that need to be sorted to the top of list), and go to the first record.</li>
<li>Go to Layout [ &ldquo;07chartSortN&rdquo; (brainstate) ]</li>
<li>Perform Script [ &ldquo;WeekMonthSelectSortThenSort&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenWeek</li>
<li>
<em>steward</em>::chosenDay</li>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenLayout</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swTotalActivity</li>
<li>
<em>day3</em>::swTotalActivity</li>
<li>
<em>day4</em>::swTotalActivity</li>
<li>
<em>day5</em>::swTotalActivity</li>
<li>
<em>day6</em>::swTotalActivity</li>
<li>
<em>day7</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::monthsum</li>
<li>
<em>brainstate</em>::monthsumaverage</li>
<li>
<em>brainstate</em>::monthsumdays</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32909ScriptAnchor_">WeekMonthSelectSortThenSort</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>07chartSortN</li>
<li>calcBrainstateTable</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32910ScriptAnchor_"></a><td class="script_navbar"><a href="#32918ScriptAnchor_"><span>Previous Script: [to 7 chart]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#32913ScriptAnchor_"><span>Next Script: [to 31 chart]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">to 31</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32903ScriptAnchor_">goToFarmer</a></li>
<li><a href="#32861ScriptAnchor_">switchFarmer</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go to time layout 31</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 go to user's chosen day to start the month view</li>
<li>//  Set Field [ reference::day1; Get ( CurrentDate ) ]</li>
<li>#</li>
<li>#2 go to requested layout. (This step prevents the user from seeing the current screen change with the a new date before going to the new layout.)</li>
<li>Go to Layout [ &ldquo;31SortN&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#3 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#4 freeze window to speed up the calculation by  refreshing the window after all records have been calcuated rather than after each record is calcuated. (This must be done after flushing the cache (step 2) otherwise the flush unfreezes the window.)</li>
<li>Freeze Window</li>
<li>#</li>
<li>#5 go to a different layout to perform this script, which prevents user from seeing the current window refresh.</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#6 total 7 days of time for each record displayed, along with the average time, and number of days contributing time the this average</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::monthsum; day1::swTotalActivity + 
day2::swTotalActivity + 
day3::swTotalActivity + 
day4::swTotalActivity + 
day5::swTotalActivity + 
day6::swTotalActivity + 
day7::swTotalActivity +
day8::swTotalActivity + 
day9::swTotalActivity + 
day10::swTotalActivity +
day11::swTotalActivity +
day12::swTotalActivity +
day13::swTotalActivity +
day14::swTotalActivity +
day15::swTotalActivity +
day16::swTotalActivity +
day17::swTotalActivity +
day18::swTotalActivity +
day19::swTotalActivity +
day20::swTotalActivity +
day21::swTotalActivity +
day22::swTotalActivity +
day23::swTotalActivity +
day24::swTotalActivity +
day25::swTotalActivity +
day26::swTotalActivity +
day27::swTotalActivity +
day28::swTotalActivity +
day29::swTotalActivity +
day30::swTotalActivity +
day31::swTotalActivity ]</li>
<li>Set Field [ brainstate::monthsumaverage; If ( 

If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 )
 =  0
 ; "" ; brainstate::monthsum / 

(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 )
)

 ) ]</li>
<li>Set Field [ brainstate::monthsumdays; If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#7 go to active brainstate or first brainstate.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ day1::swBugField  = "veto" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ day1::swBugField   &ne;  "veto" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>#</li>
<li>#8 go back to layout time 7, sort records (neccessary because the week and month view usually show more active records that need to be sorted to the top of list), and go to the first record.</li>
<li>Go to Layout [ &ldquo;31SortN&rdquo; (brainstate) ]</li>
<li>Set Field [ steward::chosenSort; "act" ]</li>
<li>Set Field [ reference::day31Calc; reference::day31 ]</li>
<li>Perform Script [ &ldquo;sortActivityWeek&rdquo; ]</li>
<li>Perform Script [ &ldquo;WeekMonthSelectSortThenSort&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenLayout</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swTotalActivity</li>
<li>
<em>day3</em>::swTotalActivity</li>
<li>
<em>day4</em>::swTotalActivity</li>
<li>
<em>day5</em>::swTotalActivity</li>
<li>
<em>day6</em>::swTotalActivity</li>
<li>
<em>day7</em>::swTotalActivity</li>
<li>
<em>day8</em>::swTotalActivity</li>
<li>
<em>day9</em>::swTotalActivity</li>
<li>
<em>day10</em>::swTotalActivity</li>
<li>
<em>day11</em>::swTotalActivity</li>
<li>
<em>day12</em>::swTotalActivity</li>
<li>
<em>day13</em>::swTotalActivity</li>
<li>
<em>day14</em>::swTotalActivity</li>
<li>
<em>day15</em>::swTotalActivity</li>
<li>
<em>day16</em>::swTotalActivity</li>
<li>
<em>day17</em>::swTotalActivity</li>
<li>
<em>day18</em>::swTotalActivity</li>
<li>
<em>day19</em>::swTotalActivity</li>
<li>
<em>day20</em>::swTotalActivity</li>
<li>
<em>day21</em>::swTotalActivity</li>
<li>
<em>day22</em>::swTotalActivity</li>
<li>
<em>day23</em>::swTotalActivity</li>
<li>
<em>day24</em>::swTotalActivity</li>
<li>
<em>day25</em>::swTotalActivity</li>
<li>
<em>day26</em>::swTotalActivity</li>
<li>
<em>day27</em>::swTotalActivity</li>
<li>
<em>day28</em>::swTotalActivity</li>
<li>
<em>day29</em>::swTotalActivity</li>
<li>
<em>day30</em>::swTotalActivity</li>
<li>
<em>day31</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::monthsum</li>
<li>
<em>brainstate</em>::monthsumaverage</li>
<li>
<em>brainstate</em>::monthsumdays</li>
<li>
<em>day1</em>::swBugField</li>
<li>
<em>steward</em>::chosenSort</li>
<li>
<em>reference</em>::day31</li>
<li>
<em>reference</em>::day31Calc</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32840ScriptAnchor_">sortActivityWeek</a></li>
<li><a href="#32909ScriptAnchor_">WeekMonthSelectSortThenSort</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>31SortN</li>
<li>calcBrainstateTable</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32913ScriptAnchor_"></a><td class="script_navbar"><a href="#32910ScriptAnchor_"><span>Previous Script: [to 31]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#33098ScriptAnchor_"><span>Next Script: [iphoneModegotoSort]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">to 31 chart</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go to chart layout 31</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 go to user's chosen day to start the month view</li>
<li>If [ steward::chosenMonth = "" ]</li>
<li>Set Field [ steward::chosenMonth; steward::chosenDay ]</li>
<li>End If</li>
<li>Set Field [ reference::day1; steward::chosenMonth ]</li>
<li>#</li>
<li>#2 go to requested layout. (This step prevents the user from seeing the current screen change with the a new date before going to the new layout.)</li>
<li>Go to Layout [ &ldquo;31chartSortN&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#3 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#4 freeze window to speed up the calculation by  refreshing the window after all records have been calcuated rather than after each record is calcuated. (This must be done after flushing the cache (step 2) otherwise the flush unfreezes the window.)</li>
<li>Freeze Window</li>
<li>#</li>
<li>#5 go to a different layout to perform this script, which prevents user from seeing the current window refresh.</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#6 total 7 days of time for each record displayed, along with the average time, and number of days contributing time the this average</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::monthsum; day1::swTotalActivity + 
day2::swTotalActivity + 
day3::swTotalActivity + 
day4::swTotalActivity + 
day5::swTotalActivity + 
day6::swTotalActivity + 
day7::swTotalActivity +
day8::swTotalActivity + 
day9::swTotalActivity + 
day10::swTotalActivity +
day11::swTotalActivity +
day12::swTotalActivity +
day13::swTotalActivity +
day14::swTotalActivity +
day15::swTotalActivity +
day16::swTotalActivity +
day17::swTotalActivity +
day18::swTotalActivity +
day19::swTotalActivity +
day20::swTotalActivity +
day21::swTotalActivity +
day22::swTotalActivity +
day23::swTotalActivity +
day24::swTotalActivity +
day25::swTotalActivity +
day26::swTotalActivity +
day27::swTotalActivity +
day28::swTotalActivity +
day29::swTotalActivity +
day30::swTotalActivity +
day31::swTotalActivity ]</li>
<li>Set Field [ brainstate::monthsumaverage; If ( 

If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 )
 =  0
 ; "" ; brainstate::monthsum / 

(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 )
)

 ) ]</li>
<li>Set Field [ brainstate::monthsumdays; If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#7 go back to layout time 7, sort records (neccessary because the week and month view usually show more active records that need to be sorted to the top of list), and go to the first record.</li>
<li>Go to Layout [ &ldquo;31chartSortN&rdquo; (brainstate) ]</li>
<li>Perform Script [ &ldquo;WeekMonthSelectSortThenSort&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenMonth</li>
<li>
<em>steward</em>::chosenDay</li>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenLayout</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swTotalActivity</li>
<li>
<em>day3</em>::swTotalActivity</li>
<li>
<em>day4</em>::swTotalActivity</li>
<li>
<em>day5</em>::swTotalActivity</li>
<li>
<em>day6</em>::swTotalActivity</li>
<li>
<em>day7</em>::swTotalActivity</li>
<li>
<em>day8</em>::swTotalActivity</li>
<li>
<em>day9</em>::swTotalActivity</li>
<li>
<em>day10</em>::swTotalActivity</li>
<li>
<em>day11</em>::swTotalActivity</li>
<li>
<em>day12</em>::swTotalActivity</li>
<li>
<em>day13</em>::swTotalActivity</li>
<li>
<em>day14</em>::swTotalActivity</li>
<li>
<em>day15</em>::swTotalActivity</li>
<li>
<em>day16</em>::swTotalActivity</li>
<li>
<em>day17</em>::swTotalActivity</li>
<li>
<em>day18</em>::swTotalActivity</li>
<li>
<em>day19</em>::swTotalActivity</li>
<li>
<em>day20</em>::swTotalActivity</li>
<li>
<em>day21</em>::swTotalActivity</li>
<li>
<em>day22</em>::swTotalActivity</li>
<li>
<em>day23</em>::swTotalActivity</li>
<li>
<em>day24</em>::swTotalActivity</li>
<li>
<em>day25</em>::swTotalActivity</li>
<li>
<em>day26</em>::swTotalActivity</li>
<li>
<em>day27</em>::swTotalActivity</li>
<li>
<em>day28</em>::swTotalActivity</li>
<li>
<em>day29</em>::swTotalActivity</li>
<li>
<em>day30</em>::swTotalActivity</li>
<li>
<em>day31</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::monthsum</li>
<li>
<em>brainstate</em>::monthsumaverage</li>
<li>
<em>brainstate</em>::monthsumdays</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32909ScriptAnchor_">WeekMonthSelectSortThenSort</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>31chartSortN</li>
<li>calcBrainstateTable</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33098ScriptAnchor_"></a><td class="script_navbar"><a href="#32913ScriptAnchor_"><span>Previous Script: [to 31 chart]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#33099ScriptAnchor_"><span>Next Script: [iphoneModegotoSortBack]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">iphoneModegotoSort</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $$iPhoneLayout; Value:Get ( LayoutName ) ]</li>
<li>Set Field [ steward::windowSizeAndPlace[5]; Get ( WindowHeight ) ]</li>
<li>Set Field [ steward::windowSizeAndPlace[6]; Get ( WindowWidth ) ]</li>
<li>Set Field [ steward::windowSizeAndPlace[7]; Get ( WindowTop ) ]</li>
<li>Set Field [ steward::windowSizeAndPlace[8]; Get ( WindowLeft ) ]</li>
<li>Go to Layout [ &ldquo;01SortAndSchedule&rdquo; (brainstate) ]</li>
<li>Move/Resize Window [ Current Window; Height: steward::windowSizeAndPlace [1]; Width: steward::windowSizeAndPlace [2]; Top: steward::windowSizeAndPlace [3]; Left: steward::windowSizeAndPlace [4] ]</li>
<li>//  Adjust Window
[ Maximize ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::windowSizeAndPlace</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>01SortAndSchedule</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33099ScriptAnchor_"></a><td class="script_navbar"><a href="#33098ScriptAnchor_"><span>Previous Script: [iphoneModegotoSort]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#33100ScriptAnchor_"><span>Next Script: [iphoneModegotoSortTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">iphoneModegotoSortBack</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ steward::iPhoneLayout &ne; "" ]</li>
<li>Set Field [ steward::windowSizeAndPlace; Get ( WindowHeight ) ]</li>
<li>Set Field [ steward::windowSizeAndPlace[2]; Get ( WindowWidth ) ]</li>
<li>Set Field [ steward::windowSizeAndPlace[3]; Get ( WindowTop ) ]</li>
<li>Set Field [ steward::windowSizeAndPlace[4]; Get ( WindowLeft ) ]</li>
<li>Go to Layout [ $$iPhoneLayout ]</li>
<li>Move/Resize Window [ Current Window; Height: steward::windowSizeAndPlace [5]; Width: steward::windowSizeAndPlace [6]; Top: steward::windowSizeAndPlace [7]; Left: steward::windowSizeAndPlace [8] ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;01Main&rdquo; (brainstate) ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::iPhoneLayout</li>
<li>
<em>steward</em>::windowSizeAndPlace</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>01Main</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33100ScriptAnchor_"></a><td class="script_navbar"><a href="#33099ScriptAnchor_"><span>Previous Script: [iphoneModegotoSortBack]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#33102ScriptAnchor_"><span>Next Script: [iphoneModegotoSortBackTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">iphoneModegotoSortTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $$iPhoneLayout; Value:Get ( LayoutName ) ]</li>
<li>Set Field [ steward::windowSizeAndPlace[5]; Get ( WindowHeight ) ]</li>
<li>Set Field [ steward::windowSizeAndPlace[6]; Get ( WindowWidth ) ]</li>
<li>Set Field [ steward::windowSizeAndPlace[7]; Get ( WindowTop ) ]</li>
<li>Set Field [ steward::windowSizeAndPlace[8]; Get ( WindowLeft ) ]</li>
<li>Go to Layout [ &ldquo;TotalSort&rdquo; (brainstate) ]</li>
<li>Move/Resize Window [ Current Window; Height: steward::windowSizeAndPlace [1]; Width: steward::windowSizeAndPlace [2]; Top: steward::windowSizeAndPlace [3]; Left: steward::windowSizeAndPlace [4] ]</li>
<li>//  Adjust Window
[ Maximize ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::windowSizeAndPlace</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>TotalSort</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33102ScriptAnchor_"></a><td class="script_navbar"><a href="#33100ScriptAnchor_"><span>Previous Script: [iphoneModegotoSortTotal]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#33105ScriptAnchor_"><span>Next Script: [editTimePart1]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">iphoneModegotoSortBackTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ steward::iPhoneLayout &ne; "" ]</li>
<li>Set Field [ steward::windowSizeAndPlace; Get ( WindowHeight ) ]</li>
<li>Set Field [ steward::windowSizeAndPlace[2]; Get ( WindowWidth ) ]</li>
<li>Set Field [ steward::windowSizeAndPlace[3]; Get ( WindowTop ) ]</li>
<li>Set Field [ steward::windowSizeAndPlace[4]; Get ( WindowLeft ) ]</li>
<li>Go to Layout [ $$iPhoneLayout ]</li>
<li>Move/Resize Window [ Current Window; Height: steward::windowSizeAndPlace [5]; Width: steward::windowSizeAndPlace [6]; Top: steward::windowSizeAndPlace [7]; Left: steward::windowSizeAndPlace [8] ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;TotalMain&rdquo; (brainstate) ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::iPhoneLayout</li>
<li>
<em>steward</em>::windowSizeAndPlace</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>TotalMain</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33105ScriptAnchor_"></a><td class="script_navbar"><a href="#33102ScriptAnchor_"><span>Previous Script: [iphoneModegotoSortBackTotal]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#33106ScriptAnchor_"><span>Next Script: [editTimePart2]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">editTimePart1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Field [ steward::chosenLayoutMain; steward::chosenSort ]</li>
<li>#</li>
<li>#</li>
<li>#2 toggle the retired status field</li>
<li>If [ steward::retiredStatus = "" ]</li>
<li>Perform Script [ &ldquo;retireButton&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Go to Layout [ &ldquo;01EditTime&rdquo; (brainstate) ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
brainstate::groupType; ascending
day1::swStart; ascending
brainstate::sortNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>//  Sort Records [ Specified Sort Order: brainstate::sortNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "allow" ]</li>
<li>#7 go to active brainstate or first brainstate.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ day1::swBugField  = "veto" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ day1::swBugField   &ne;  "veto" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Loop</li>
<li>//  Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>//  Go to Record/Request/Page
[ Next ]</li>
<li>//  End Loop</li>
<li>//  If [ day1::_keyBrainstate = "" ]</li>
<li>//  Scroll Window
[ Home ]</li>
<li>//  End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>steward</em>::chosenSort</li>
<li>
<em>steward</em>::chosenLayoutMain</li>
<li>
<em>steward</em>::retiredStatus</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>day1</em>::swStart</li>
<li>
<em>brainstate</em>::sortNumber</li>
<li>
<em>brainstate</em>::sortAlpha</li>
<li>
<em>brainstate</em>::sortSubNumber</li>
<li>
<em>brainstate</em>::sortCategory</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>day1</em>::swBugField</li>
<li>
<em>day1</em>::_keyBrainstate</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32865ScriptAnchor_">retireButton</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>01EditTime</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33106ScriptAnchor_"></a><td class="script_navbar"><a href="#33105ScriptAnchor_"><span>Previous Script: [editTimePart1]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#32844ScriptAnchor_"><span>Next Script: [goAndComeBackPart1]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">editTimePart2</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>#</li>
<li>#this gotoField removes focus from field if user in a</li>
<li>#field when activates this script.  It then causes the script</li>
<li>#update script to cancel this script, but without changing</li>
<li>#the users sort.  Then when activitated again having now</li>
<li>#exited all fields, the scirpt preforms fine.  The alternative</li>
<li>#would be to cancel this script if the user was in a field</li>
<li>#when it was activited.  This essentially does that (</li>
<li>#cancels the script because the focus will trigger a conflicting script).</li>
<li>Go to Field [  ]</li>
<li>Set Field [ steward::chosenSort; steward::chosenLayoutMain ]</li>
<li>Go to Layout [ &ldquo;01Main&rdquo; (brainstate) ]</li>
<li>#1 set the layout status field</li>
<li>Set Field [ steward::chosenLayout; Get ( LayoutName ) ]</li>
<li>Set Field [ steward::chosenSort; "rebmun" ]</li>
<li>Perform Script [ &ldquo;sortNumbers&rdquo; ]</li>
<li>#7 go to active brainstate or first brainstate.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ day1::swBugField  = "veto" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ day1::swBugField   &ne;  "veto" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>steward</em>::chosenLayoutMain</li>
<li>
<em>steward</em>::chosenSort</li>
<li>
<em>steward</em>::chosenLayout</li>
<li>
<em>day1</em>::swBugField</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32791ScriptAnchor_">sortNumbers</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>01Main</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32844ScriptAnchor_"></a><td class="script_navbar"><a href="#33106ScriptAnchor_"><span>Previous Script: [editTimePart2]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#32916ScriptAnchor_"><span>Next Script: [goAndComeBackPart2]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">goAndComeBackPart1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE prevent huge time delay.  (For some reason, when you select a new value in the go or scale dropdown lists, filemaker goes into a lengthy re-calc of all the barcharts on the layout, even though these drop downs are not connected in anyway with any of the record being calculated.  To prevent this form happening, this script makes filemaker freeze the window and go to another layout.  This other layout has a script layout trigger that causes the user to be returned to the layout that they just left.  This back and forth between layouts seems to stop the recalc process from occuring.)</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 freeze window and go to bounce back layout.</li>
<li>Freeze Window</li>
<li>Go to Layout [ &ldquo;bounceBackUtilityLayout&rdquo; (brainstate) ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>bounceBackUtilityLayout</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32916ScriptAnchor_"></a><td class="script_navbar"><a href="#32844ScriptAnchor_"><span>Previous Script: [goAndComeBackPart1]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#32934ScriptAnchor_"><span>Next Script: [goBackButton]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">goAndComeBackPart2</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE bounce back to previous layout via a script trigger on layout load.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 bounce back layout user just left.</li>
<li>Go to Layout [ steward::chosenLayout ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenLayout</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32934ScriptAnchor_"></a><td class="script_navbar"><a href="#32916ScriptAnchor_"><span>Previous Script: [goAndComeBackPart2]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#99ScriptAnchor_"><span>Next Script: [closeWindowHaltScript]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">goBackButton</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32953ScriptAnchor_">cancelTotal</a></li>
<li><a href="#32832ScriptAnchor_">seperateFromTotal</a></li>
<li><a href="#110ScriptAnchor_">deleteBrainstate</a></li>
<li><a href="#32942ScriptAnchor_">CHUNK_deleteTotalOrGrandtotalRecord</a></li>
<li><a href="#32940ScriptAnchor_">CHUNK_deleteRecordsTimeFromTotal</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE return the user to the layout they where one and find all the records being looked at, and hide the records previously hidden (plus or minus records created and deleted on this layout).</li>
<li>#</li>
<li>#</li>
<li>If [ Get (WindowName) = "Day" or 
Get (WindowName) = "Tag" or 
Get (WindowName) = "Specific Action" ]</li>
<li>Close Window [ Name: "Day"; Current file ]</li>
<li>Close Window [ Name: "Specific Action"; Current file ]</li>
<li>Close Window [ Name: "Tag"; Current file ]</li>
<li>Set Variable [ $$log ]</li>
<li>Set Variable [ $$issue ]</li>
<li>Set Variable [ $$group ]</li>
<li>Set Variable [ $$status ]</li>
<li>Set Variable [ $$timeAll ]</li>
<li>Set Variable [ $$issueSort ]</li>
<li>Set Variable [ $$logissues ]</li>
<li>Set Variable [ $$issueLogs ]</li>
<li>Set Variable [ $$logrecordID ]</li>
<li>Set Variable [ $$logBrainstate ]</li>
<li>Set Variable [ $$issueRecordID ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>#reset recordnumber for use in sort on final layout and erase holder variable.</li>
<li>Set Variable [ $$recordnumber; Value:$$recordnumber2 ]</li>
<li>Set Variable [ $$recordnumber2 ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#A BEGIN go back to log layout</li>
<li>#</li>
<li>#1 determine if user is on a log layout</li>
<li>If [ Left ( Get ( LayoutName ); 3 ) = "log" or Left ( $$iphoneLog; 8 ) = "TotalLog" ]</li>
<li>#NOT TESTED</li>
<li>If [ Get ( SystemPlatform ) = 3 or steward::iPhoneLayout &ne; "" ]</li>
<li>If [ Left ( $$iphoneLog; 8 ) = "TotalLog" ]</li>
<li>Go to Layout [ &ldquo;TotalLogEditTimeiPhone&rdquo; (brainstate) ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Set Variable [ $$iphoneLog; Value:"" ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;LogEditTimeiPhone&rdquo; (brainstate) ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Set Variable [ $$iphoneLog; Value:"" ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Go to Layout [ $$loglayout ]</li>
<li>Set Variable [ $$loglayout; Value:"" ]</li>
<li>//  Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#A END go back to log layout</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#B BEGIN check if user just deleted the total or grandtotal record on a view layout and if so tell them why they are leaving the view that they were on.</li>
<li>#</li>
<li>#1 determine if user deleted a total or grandtotal record</li>
<li>If [ Left ( Get ( LayoutName ); 5 ) = "Total" and $$deleteID = "total" ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "You are now being returned to your previous screen as this screen was for showing the total record that you just deleted and all the records that it totaled."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ Left ( Get ( LayoutName ); 5 ) = "viewG" and $$deleteID =  "grandtotal" ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "You are now being returned to your previous screen as this screen was for showing the grandtotal record that you just deleted and all the records that it totaled."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#2 clear the $$deleteID variable so that it will not trigger the above dialog boxes without a delete being done.</li>
<li>Set Variable [ $$deleteID; Value:"" ]</li>
<li>#</li>
<li>#B END  check if user just deleted the total or grandtotal record on a view layout and if so tell them why they are leaving the view that they were on.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#C BEGIN show user all records they where looking at previously on the main screen</li>
<li>#</li>
<li>#</li>
<li>#2 show user all records at which they were previously looking</li>
<li>Perform Script [ &ldquo;goBackButton_FindRecordsChunk&rdquo; ]</li>
<li>#</li>
<li>#C END shorten list if user has selected to not show some of their records</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#D BEGIN go to layout</li>
<li>#</li>
<li>#1 go to user's last layout</li>
<li>Go to Layout [ steward::chosenLayout ]</li>
<li>#NOT TESTED</li>
<li>If [ Get ( SystemPlatform ) = 3 or steward::iPhoneLayout &ne; "" ]</li>
<li>Go to Layout [ &ldquo;MainiPhone&rdquo; (brainstate) ]</li>
<li>End If</li>
<li>Freeze Window</li>
<li>#</li>
<li>#2 go to user's chosen day</li>
<li>Set Field [ reference::day1; steward::chosenDay ]</li>
<li>#</li>
<li>#3 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#4 sort records (neccessary because the week and month view usually show more active records than the day view that need to be sorted out of top of list), and go to the first record.</li>
<li>Perform Script [ &ldquo;DaySelectSortThenSort&rdquo; ]</li>
<li>#</li>
<li>#D END go to layout</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>steward</em>::iPhoneLayout</li>
<li>
<em>steward</em>::chosenLayout</li>
<li>
<em>steward</em>::chosenDay</li>
<li>
<em>reference</em>::day1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33030ScriptAnchor_">goBackButton_FindRecordsChunk</a></li>
<li><a href="#32902ScriptAnchor_">DaySelectSortThenSort</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>TotalLogEditTimeiPhone</li>
<li>LogEditTimeiPhone</li>
<li>&lt;Missing Layout&gt;</li>
<li>MainiPhone</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="99ScriptAnchor_"></a><td class="script_navbar"><a href="#32934ScriptAnchor_"><span>Previous Script: [goBackButton]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"><a href="#32943ScriptAnchor_"><span>Next Script: [CHUNK_createRecordsForNewUsers]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">closeWindowHaltScript</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#Used on Other Solutions and moreInfo layout.</li>
<li>Close Window [ Current Window ]</li>
<li>Set Variable [ $$otherApps ]</li>
<li>Halt Script</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32943ScriptAnchor_"></a><td class="script_navbar"><a href="#99ScriptAnchor_"><span>Previous Script: [closeWindowHaltScript]</span></a></td><td class="script_navbar"><a href="#32874ScriptAnchor_"><span>Parent Folder: [navigation]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNK_createRecordsForNewUsers</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32903ScriptAnchor_">goToFarmer</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE check to make sure that the user has records and if not create a record for the user</li>
<li>#CHUNK USED BY goBackButton script</li>
<li>#CHUNK USED BY goToFarmer script</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#NOTE: the three # symbols set apart chunks of script.  </li>
<li>#NOTE: the finish and error script chunks are almost identical (the error message differ in telling where in the script they occur).  For this reason, they are not numbered as part of a particular chuck of the script, and are separated by three # symbols to set them apart.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 find this user's brainstate records</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#2 if the user has no records, create a new one and assign it to the user so that there name will show up.  (All the layouts are tied to the brainstate table not the user table.  So the only way to show a user name  and all the correct formating attributes is to have one user record.)</li>
<li>If [ Get ( FoundCount )  = 0 ]</li>
<li>Set Variable [ $actionNames; Value:"sleep" &amp; &para; &amp; 
"exercise brain" &amp; &para; &amp; 
"exercise body" &amp; &para; &amp; 
"decrease confusion" &amp; &para; &amp; 
"note learning" &amp; &para; &amp; 
"break" &amp; &para; &amp; 
"prepare" &amp; &para; &amp; 
//"travel" &amp; &para; &amp; 
"send and receive" &amp; &para; &amp; 
"study others" &amp; &para; &amp; 
"new day" &amp; &para; ]</li>
<li>Set Variable [ $actionOrderNumber; Value:1 &amp; &para; &amp; 
2 &amp; &para; &amp; 
4 &amp; &para; &amp; 
5 &amp; &para; &amp; 
7 &amp; &para; &amp; 
8 &amp; &para; &amp; 
10 &amp; &para; &amp; 
//12 &amp; &para; &amp; 
13 &amp; &para; &amp; 
15 &amp; &para; &amp; 
16 &amp; &para; ]</li>
<li>Set Variable [ $number; Value:1 ]</li>
<li>Loop</li>
<li>New Record/Request</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Set Field [ brainstate::hide; "t" &amp; &para; ]</li>
<li>Set Field [ brainstate::description; GetValue ( $actionNames ; $number ) ]</li>
<li>Set Field [ brainstate::sortNumber; GetValue ( $actionOrderNumber ; $number ) ]</li>
<li>Set Variable [ $number; Value:$number + 1 ]</li>
<li>Exit Loop If [ $number = 11 ]</li>
<li>End Loop</li>
<li>#</li>
<li>Set Variable [ $kpnBrainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Go to Layout [ &ldquo;calcDayTable&rdquo; (day1) ]</li>
<li>New Record/Request</li>
<li>Set Field [ day1::_keyBrainstate; $kpnBrainstateID ]</li>
<li>Set Field [ day1::_keyUser; $userID ]</li>
<li>//  Set Field [ day1::_keyDay; reference::day1 ]</li>
<li>Set Field [ day1::swStart; Get ( CurrentTimeStamp ) ]</li>
<li>Set Field [ day1::swPause; Get ( CurrentTimeStamp ) ]</li>
<li>Show Custom Dialog [ Message: "Enter your date of birth so that this program can calculate your new day number, every day."; Buttons: &ldquo;OK&rdquo;; Input #1: day1::_keyDay, "use date format: 01/01/1900" ]</li>
<li>Commit Records/Requests</li>
<li>If [ IsValid ( day1::_keyDay ) &ne; 1 ]</li>
<li>Show Custom Dialog [ Message: "Enter your date of birth so that this program can calculate your new day number, every day.  Use must enter a valid date using this format: 00/00/0000."; Buttons: &ldquo;OK&rdquo;; Input #1: day1::_keyDay, "use date format: 01/01/1900" ]</li>
<li>Commit Records/Requests</li>
<li>End If</li>
<li>Set Variable [ $dateOfLastUse; Value:day1::_keyDay ]</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>Set Field [ brainstate::DateOfLastUse; $dateOfLastUse ]</li>
<li>End If</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>brainstate</em>::_keyUser</li>
<li>
<em>brainstate</em>::hide</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>brainstate</em>::sortNumber</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>day1</em>::_keyBrainstate</li>
<li>
<em>day1</em>::_keyUser</li>
<li>
<em>reference</em>::day1</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>day1</em>::swStart</li>
<li>
<em>day1</em>::swPause</li>
<li>&lt;Missing Field&gt;</li>
<li>
<em>brainstate</em>::DateOfLastUse</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>calcBrainstateTable</li>
<li>calcDayTable</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="32979ScriptAnchor_"></a><a href="#32979ScriptAnchor_toc">total</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32994ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#32979ScriptAnchor_"><span>Parent Folder: [total]</span></a></td><td class="script_navbar"><a href="#32995ScriptAnchor_"><span>Next Script: [goWeekTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">goDayTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go back or forwards the number of days specified in the number field to the right the go button on the 1 day layouts</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 capture desired number of days and add to the current date.  (User picks days from a drop down list that includes negative and positive numbers.)</li>
<li>Set Field [ reference::day1; reference::day1 + reference::go ]</li>
<li>#</li>
<li>#2 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#3 capture user's current date perference</li>
<li>Set Field [ steward::chosenDayTotal; reference::day1 ]</li>
<li>#</li>
<li>#4 sort the records if the current sort is based on time so if any time is changed it goes up or down the current set of records according to its time value.  The point is to keep the focus where the user expects it to be so the sort, which removes the focus from the current record is only done if the user wants the records sorted by time, in which case after the sort the focus is returned to the first record.</li>
<li>Perform Script [ &ldquo;sortRestoreAfterScript&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day1</li>
<li>
<em>reference</em>::go</li>
<li>
<em>steward</em>::chosenDayTotal</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32830ScriptAnchor_">sortRestoreAfterScript</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32995ScriptAnchor_"></a><td class="script_navbar"><a href="#32994ScriptAnchor_"><span>Previous Script: [goDayTotal]</span></a></td><td class="script_navbar"><a href="#32979ScriptAnchor_"><span>Parent Folder: [total]</span></a></td><td class="script_navbar"><a href="#32996ScriptAnchor_"><span>Next Script: [goMonthTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">goWeekTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go back or forwards the number of days specified in the number field to the right the go button on the 7 day layouts</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 capture desired number of days and add to the current date.  (User picks days from a drop down list that includes negative and positive numbers.)</li>
<li>Set Field [ reference::day1; reference::day1 + reference::go ]</li>
<li>#</li>
<li>#2 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#3 capture user's current date perference for starting the week</li>
<li>Set Field [ steward::chosenWeekTotal; reference::day1 ]</li>
<li>#</li>
<li>#4 freeze window to speed up the calculation by  refreshing the window after all records have been calcuated rather than after each record is calcuated. (This must be done after flushing the cache (step 2) otherwise the flush unfreezes the window.)</li>
<li>Freeze Window</li>
<li>#</li>
<li>#5 go to a different layout to perform this script, which prevents user from seeing the current window refresh.</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#6 total 7 days of time for each record displayed, along with the average time, and number of days contributing time the this average</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::monthsum; day1::swTotalActivity + 
day2::swTotalActivity + 
day3::swTotalActivity + 
day4::swTotalActivity + 
day5::swTotalActivity + 
day6::swTotalActivity + 
day7::swTotalActivity ]</li>
<li>Set Field [ brainstate::monthsumaverage; If ( 

If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) 
 =  0
 ; "" ; brainstate::monthsum / 

(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) 
)

 ) ]</li>
<li>Set Field [ brainstate::monthsumdays; 
(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 )
) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#7 finish by going back to the orginal layout and first record</li>
<li>Go to Layout [ original layout ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day1</li>
<li>
<em>reference</em>::go</li>
<li>
<em>steward</em>::chosenWeekTotal</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swTotalActivity</li>
<li>
<em>day3</em>::swTotalActivity</li>
<li>
<em>day4</em>::swTotalActivity</li>
<li>
<em>day5</em>::swTotalActivity</li>
<li>
<em>day6</em>::swTotalActivity</li>
<li>
<em>day7</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::monthsum</li>
<li>
<em>brainstate</em>::monthsumaverage</li>
<li>
<em>brainstate</em>::monthsumdays</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>calcBrainstateTable</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32996ScriptAnchor_"></a><td class="script_navbar"><a href="#32995ScriptAnchor_"><span>Previous Script: [goWeekTotal]</span></a></td><td class="script_navbar"><a href="#32979ScriptAnchor_"><span>Parent Folder: [total]</span></a></td><td class="script_navbar"><a href="#32987ScriptAnchor_"><span>Next Script: [calendarDayCalcTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">goMonthTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go back or forwards the number of days specified in the number field to the right the go button on the 7 day layouts</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 capture desired number of days and add to the current date.  (User picks days from a drop down list that includes negative and positive numbers.)</li>
<li>Set Field [ reference::day1; reference::day1 + reference::go ]</li>
<li>#</li>
<li>#2 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#3 capture user's current date perference for starting the month</li>
<li>Set Field [ steward::chosenMonthTotal; reference::day1 ]</li>
<li>#</li>
<li>#4 freeze window to speed up the calculation by  refreshing the window after all records have been calcuated rather than after each record is calcuated. (This must be done after flushing the cache (step 2) otherwise the flush unfreezes the window.)</li>
<li>Freeze Window</li>
<li>#</li>
<li>#5 go to a different layout to perform this script, which prevents user from seeing the current window refresh.</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#6 total 31 days of time for each record displayed, along with the average time, and number of days contributing time the this average</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::monthsum; day1::swTotalActivity + 
day2::swTotalActivity + 
day3::swTotalActivity + 
day4::swTotalActivity + 
day5::swTotalActivity + 
day6::swTotalActivity + 
day7::swTotalActivity +
day8::swTotalActivity + 
day9::swTotalActivity + 
day10::swTotalActivity +
day11::swTotalActivity +
day12::swTotalActivity +
day13::swTotalActivity +
day14::swTotalActivity +
day15::swTotalActivity +
day16::swTotalActivity +
day17::swTotalActivity +
day18::swTotalActivity +
day19::swTotalActivity +
day20::swTotalActivity +
day21::swTotalActivity +
day22::swTotalActivity +
day23::swTotalActivity +
day24::swTotalActivity +
day25::swTotalActivity +
day26::swTotalActivity +
day27::swTotalActivity +
day28::swTotalActivity +
day29::swTotalActivity +
day30::swTotalActivity +
day31::swTotalActivity ]</li>
<li>Set Field [ brainstate::monthsumaverage; If ( 

If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 )
 =  0
 ; "" ; brainstate::monthsum / 

(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 )
)

 ) ]</li>
<li>Set Field [ brainstate::monthsumdays; If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#7 finish by going back to the orginal layout and first record</li>
<li>Go to Layout [ original layout ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day1</li>
<li>
<em>reference</em>::go</li>
<li>
<em>steward</em>::chosenMonthTotal</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swTotalActivity</li>
<li>
<em>day3</em>::swTotalActivity</li>
<li>
<em>day4</em>::swTotalActivity</li>
<li>
<em>day5</em>::swTotalActivity</li>
<li>
<em>day6</em>::swTotalActivity</li>
<li>
<em>day7</em>::swTotalActivity</li>
<li>
<em>day8</em>::swTotalActivity</li>
<li>
<em>day9</em>::swTotalActivity</li>
<li>
<em>day10</em>::swTotalActivity</li>
<li>
<em>day11</em>::swTotalActivity</li>
<li>
<em>day12</em>::swTotalActivity</li>
<li>
<em>day13</em>::swTotalActivity</li>
<li>
<em>day14</em>::swTotalActivity</li>
<li>
<em>day15</em>::swTotalActivity</li>
<li>
<em>day16</em>::swTotalActivity</li>
<li>
<em>day17</em>::swTotalActivity</li>
<li>
<em>day18</em>::swTotalActivity</li>
<li>
<em>day19</em>::swTotalActivity</li>
<li>
<em>day20</em>::swTotalActivity</li>
<li>
<em>day21</em>::swTotalActivity</li>
<li>
<em>day22</em>::swTotalActivity</li>
<li>
<em>day23</em>::swTotalActivity</li>
<li>
<em>day24</em>::swTotalActivity</li>
<li>
<em>day25</em>::swTotalActivity</li>
<li>
<em>day26</em>::swTotalActivity</li>
<li>
<em>day27</em>::swTotalActivity</li>
<li>
<em>day28</em>::swTotalActivity</li>
<li>
<em>day29</em>::swTotalActivity</li>
<li>
<em>day30</em>::swTotalActivity</li>
<li>
<em>day31</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::monthsum</li>
<li>
<em>brainstate</em>::monthsumaverage</li>
<li>
<em>brainstate</em>::monthsumdays</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>calcBrainstateTable</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32987ScriptAnchor_"></a><td class="script_navbar"><a href="#32996ScriptAnchor_"><span>Previous Script: [goMonthTotal]</span></a></td><td class="script_navbar"><a href="#32979ScriptAnchor_"><span>Parent Folder: [total]</span></a></td><td class="script_navbar"><a href="#32991ScriptAnchor_"><span>Next Script: [calendarWeekCalcTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">calendarDayCalcTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE change the day to start the week and recalculate the Day1 key fields to show the user's data for this day.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 capture the new day as the user's choosen day</li>
<li>Set Field [ steward::chosenDayTotal; reference::day1 ]</li>
<li>#</li>
<li>#2 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>Perform Script [ &ldquo;sortRestoreAfterScript&rdquo; ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenDayTotal</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32830ScriptAnchor_">sortRestoreAfterScript</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32991ScriptAnchor_"></a><td class="script_navbar"><a href="#32987ScriptAnchor_"><span>Previous Script: [calendarDayCalcTotal]</span></a></td><td class="script_navbar"><a href="#32979ScriptAnchor_"><span>Parent Folder: [total]</span></a></td><td class="script_navbar"><a href="#32989ScriptAnchor_"><span>Next Script: [calendarMonthCalcTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">calendarWeekCalcTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE calculate the total time for 7 days worth of time</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 add 7 days to the users selection of the day desired to start the week.  (Day 1 is the day the user is currently looking at on the day view layouts.  In order to give the user on the week and month view layouts a calendar going from 1 to 7 or 31 it is neccessary to put the Day 1 field at the far right, or furtherest from the titles of the records.  The user expects to to select the day they want to see by clicking on the day field closest to do the titles, which is day 7 on the week and day 31 on month view.  So this script setp captures this left most choice and adds the 6 or 30 to it and applies it to the day 1 field.)</li>
<li>Set Field [ reference::day1; reference::day7Calc  +  6 ]</li>
<li>#</li>
<li>#2 capture user's current date perference for starting the week AND capture layout name for bounceback script</li>
<li>Set Field [ steward::chosenWeekTotal; reference::day1 ]</li>
<li>Set Variable [ $$layoutTotal; Value:Get ( LayoutName ) ]</li>
<li>#</li>
<li>#3 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#4 freeze window to speed up the calculation by  refreshing the window after all records have been calcuated rather than after each record is calcuated. (This must be done after flushing the cache (step 2) otherwise the flush unfreezes the window.)</li>
<li>Freeze Window</li>
<li>#</li>
<li>#5 go to a different layout to perform this script, which prevents user from seeing the current window refresh.</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#6 total 31 days of time for each record displayed, along with the average time, and number of days contributing time the this average</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::monthsum; day1::swTotalActivity + 
day2::swTotalActivity + 
day3::swTotalActivity + 
day4::swTotalActivity + 
day5::swTotalActivity + 
day6::swTotalActivity + 
day7::swTotalActivity ]</li>
<li>Set Field [ brainstate::monthsumaverage; If ( 

If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) 
 =  0
 ; "" ; brainstate::monthsum / 

(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) 
)

 ) ]</li>
<li>Set Field [ brainstate::monthsumdays; 
(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 )
) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#7 finish by going back to the orginal layout and first record</li>
<li>Go to Layout [ original layout ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day7Calc</li>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenWeekTotal</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swTotalActivity</li>
<li>
<em>day3</em>::swTotalActivity</li>
<li>
<em>day4</em>::swTotalActivity</li>
<li>
<em>day5</em>::swTotalActivity</li>
<li>
<em>day6</em>::swTotalActivity</li>
<li>
<em>day7</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::monthsum</li>
<li>
<em>brainstate</em>::monthsumaverage</li>
<li>
<em>brainstate</em>::monthsumdays</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>calcBrainstateTable</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32989ScriptAnchor_"></a><td class="script_navbar"><a href="#32991ScriptAnchor_"><span>Previous Script: [calendarWeekCalcTotal]</span></a></td><td class="script_navbar"><a href="#32979ScriptAnchor_"><span>Parent Folder: [total]</span></a></td><td class="script_navbar"><a href="#32990ScriptAnchor_"><span>Next Script: [calendarMonthCalcChartTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">calendarMonthCalcTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE calculate the total time for 31 days worth of time</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 add 30 days to the users selection of the day desired to start the month.  (Day 1 is the day the user is currently looking at on the day view layouts.  In order to give the user on the week and month view layouts a calendar going from 1 to 7 or 31 it is neccessary to put the Day 1 field at the far right, or furtherest from the titles of the records.  The user expects to to select the day they want to see by clicking on the day field closest to do the titles, which is day 7 on the week and day 31 on month view.  So this script setp captures this left most choice and adds the 6 or 30 to it and applies it to the day 1 field.)</li>
<li>Set Field [ reference::day1; reference::day31Calc  +  30 ]</li>
<li>#</li>
<li>#2 capture user's current date perference for starting the month AND capture layout name for bounceback script</li>
<li>Set Field [ steward::chosenMonthTotal; reference::day1 ]</li>
<li>Set Variable [ $$layoutTotal; Value:Get ( LayoutName ) ]</li>
<li>#</li>
<li>#3 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#4 freeze window to speed up the calculation by  refreshing the window after all records have been calcuated rather than after each record is calcuated. (This must be done after flushing the cache (step 2) otherwise the flush unfreezes the window.)</li>
<li>Freeze Window</li>
<li>#</li>
<li>#5 go to a different layout to perform this script, which prevents user from seeing the current window refresh.</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#6 total 31 days of time for each record displayed, along with the average time, and number of days contributing time the this average</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::monthsum; day1::swTotalActivity + 
day2::swTotalActivity + 
day3::swTotalActivity + 
day4::swTotalActivity + 
day5::swTotalActivity + 
day6::swTotalActivity + 
day7::swTotalActivity +
day8::swTotalActivity + 
day9::swTotalActivity + 
day10::swTotalActivity +
day11::swTotalActivity +
day12::swTotalActivity +
day13::swTotalActivity +
day14::swTotalActivity +
day15::swTotalActivity +
day16::swTotalActivity +
day17::swTotalActivity +
day18::swTotalActivity +
day19::swTotalActivity +
day20::swTotalActivity +
day21::swTotalActivity +
day22::swTotalActivity +
day23::swTotalActivity +
day24::swTotalActivity +
day25::swTotalActivity +
day26::swTotalActivity +
day27::swTotalActivity +
day28::swTotalActivity +
day29::swTotalActivity +
day30::swTotalActivity +
day31::swTotalActivity ]</li>
<li>Set Field [ brainstate::monthsumaverage; If ( 

If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 )
 =  0
 ; "" ; brainstate::monthsum / 

(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 )
)

 ) ]</li>
<li>Set Field [ brainstate::monthsumdays; If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#7 finish by going back to the orginal layout and first record</li>
<li>Go to Layout [ &ldquo;Total31&rdquo; (brainstate) ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day31Calc</li>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenMonthTotal</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swTotalActivity</li>
<li>
<em>day3</em>::swTotalActivity</li>
<li>
<em>day4</em>::swTotalActivity</li>
<li>
<em>day5</em>::swTotalActivity</li>
<li>
<em>day6</em>::swTotalActivity</li>
<li>
<em>day7</em>::swTotalActivity</li>
<li>
<em>day8</em>::swTotalActivity</li>
<li>
<em>day9</em>::swTotalActivity</li>
<li>
<em>day10</em>::swTotalActivity</li>
<li>
<em>day11</em>::swTotalActivity</li>
<li>
<em>day12</em>::swTotalActivity</li>
<li>
<em>day13</em>::swTotalActivity</li>
<li>
<em>day14</em>::swTotalActivity</li>
<li>
<em>day15</em>::swTotalActivity</li>
<li>
<em>day16</em>::swTotalActivity</li>
<li>
<em>day17</em>::swTotalActivity</li>
<li>
<em>day18</em>::swTotalActivity</li>
<li>
<em>day19</em>::swTotalActivity</li>
<li>
<em>day20</em>::swTotalActivity</li>
<li>
<em>day21</em>::swTotalActivity</li>
<li>
<em>day22</em>::swTotalActivity</li>
<li>
<em>day23</em>::swTotalActivity</li>
<li>
<em>day24</em>::swTotalActivity</li>
<li>
<em>day25</em>::swTotalActivity</li>
<li>
<em>day26</em>::swTotalActivity</li>
<li>
<em>day27</em>::swTotalActivity</li>
<li>
<em>day28</em>::swTotalActivity</li>
<li>
<em>day29</em>::swTotalActivity</li>
<li>
<em>day30</em>::swTotalActivity</li>
<li>
<em>day31</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::monthsum</li>
<li>
<em>brainstate</em>::monthsumaverage</li>
<li>
<em>brainstate</em>::monthsumdays</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>calcBrainstateTable</li>
<li>Total31</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32990ScriptAnchor_"></a><td class="script_navbar"><a href="#32989ScriptAnchor_"><span>Previous Script: [calendarMonthCalcTotal]</span></a></td><td class="script_navbar"><a href="#32979ScriptAnchor_"><span>Parent Folder: [total]</span></a></td><td class="script_navbar"><a href="#32981ScriptAnchor_"><span>Next Script: [to 1 Total]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">calendarMonthCalcChartTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE calculate the total time for 31 days worth of time</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 add 30 days to the users selection of the day desired to start the month.  (Day 1 is the day the user is currently looking at on the day view layouts.  In order to give the user on the week and month view layouts a calendar going from 1 to 7 or 31 it is neccessary to put the Day 1 field at the far right, or furtherest from the titles of the records.  The user expects to to select the day they want to see by clicking on the day field closest to do the titles, which is day 7 on the week and day 31 on month view.  So this script setp captures this left most choice and adds the 6 or 30 to it and applies it to the day 1 field.)</li>
<li>Set Field [ reference::day1; reference::day31Calc  +  30 ]</li>
<li>#</li>
<li>#2 capture user's current date perference for starting the month AND capture layout name for bounceback script</li>
<li>Set Field [ steward::chosenMonthTotal; reference::day1 ]</li>
<li>Set Variable [ $$layoutTotal; Value:Get ( LayoutName ) ]</li>
<li>#</li>
<li>#3 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#4 freeze window to speed up the calculation by  refreshing the window after all records have been calcuated rather than after each record is calcuated. (This must be done after flushing the cache (step 2) otherwise the flush unfreezes the window.)</li>
<li>Freeze Window</li>
<li>#</li>
<li>#5 go to a different layout to perform this script, which prevents user from seeing the current window refresh.</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#6 total 31 days of time for each record displayed, along with the average time, and number of days contributing time the this average</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::monthsum; day1::swTotalActivity + 
day2::swTotalActivity + 
day3::swTotalActivity + 
day4::swTotalActivity + 
day5::swTotalActivity + 
day6::swTotalActivity + 
day7::swTotalActivity +
day8::swTotalActivity + 
day9::swTotalActivity + 
day10::swTotalActivity +
day11::swTotalActivity +
day12::swTotalActivity +
day13::swTotalActivity +
day14::swTotalActivity +
day15::swTotalActivity +
day16::swTotalActivity +
day17::swTotalActivity +
day18::swTotalActivity +
day19::swTotalActivity +
day20::swTotalActivity +
day21::swTotalActivity +
day22::swTotalActivity +
day23::swTotalActivity +
day24::swTotalActivity +
day25::swTotalActivity +
day26::swTotalActivity +
day27::swTotalActivity +
day28::swTotalActivity +
day29::swTotalActivity +
day30::swTotalActivity +
day31::swTotalActivity ]</li>
<li>Set Field [ brainstate::monthsumaverage; If ( 

If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 )
 =  0
 ; "" ; brainstate::monthsum / 

(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 )
)

 ) ]</li>
<li>Set Field [ brainstate::monthsumdays; If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#7 finish by going back to the orginal layout and first record</li>
<li>Go to Layout [ &ldquo;Total31chart&rdquo; (brainstate) ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day31Calc</li>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenMonthTotal</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swTotalActivity</li>
<li>
<em>day3</em>::swTotalActivity</li>
<li>
<em>day4</em>::swTotalActivity</li>
<li>
<em>day5</em>::swTotalActivity</li>
<li>
<em>day6</em>::swTotalActivity</li>
<li>
<em>day7</em>::swTotalActivity</li>
<li>
<em>day8</em>::swTotalActivity</li>
<li>
<em>day9</em>::swTotalActivity</li>
<li>
<em>day10</em>::swTotalActivity</li>
<li>
<em>day11</em>::swTotalActivity</li>
<li>
<em>day12</em>::swTotalActivity</li>
<li>
<em>day13</em>::swTotalActivity</li>
<li>
<em>day14</em>::swTotalActivity</li>
<li>
<em>day15</em>::swTotalActivity</li>
<li>
<em>day16</em>::swTotalActivity</li>
<li>
<em>day17</em>::swTotalActivity</li>
<li>
<em>day18</em>::swTotalActivity</li>
<li>
<em>day19</em>::swTotalActivity</li>
<li>
<em>day20</em>::swTotalActivity</li>
<li>
<em>day21</em>::swTotalActivity</li>
<li>
<em>day22</em>::swTotalActivity</li>
<li>
<em>day23</em>::swTotalActivity</li>
<li>
<em>day24</em>::swTotalActivity</li>
<li>
<em>day25</em>::swTotalActivity</li>
<li>
<em>day26</em>::swTotalActivity</li>
<li>
<em>day27</em>::swTotalActivity</li>
<li>
<em>day28</em>::swTotalActivity</li>
<li>
<em>day29</em>::swTotalActivity</li>
<li>
<em>day30</em>::swTotalActivity</li>
<li>
<em>day31</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::monthsum</li>
<li>
<em>brainstate</em>::monthsumaverage</li>
<li>
<em>brainstate</em>::monthsumdays</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>calcBrainstateTable</li>
<li>Total31chart</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32981ScriptAnchor_"></a><td class="script_navbar"><a href="#32990ScriptAnchor_"><span>Previous Script: [calendarMonthCalcChartTotal]</span></a></td><td class="script_navbar"><a href="#32979ScriptAnchor_"><span>Parent Folder: [total]</span></a></td><td class="script_navbar"><a href="#32982ScriptAnchor_"><span>Next Script: [to 1 chart Total]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">to 1 Total</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go to time Total layout 1</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 go to time layout 1</li>
<li>Go to Layout [ &ldquo;TotalMain&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#2 go to user's chosen day</li>
<li>Set Field [ reference::day1; steward::chosenDayTotal ]</li>
<li>#</li>
<li>#3 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#4 sort records (neccessary because the week and month view usually show more active records than the day view that need to be sorted out of top of list), and go to the first record.</li>
<li>Perform Script [ &ldquo;DaySelectSortThenSort&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenLayout</li>
<li>
<em>steward</em>::chosenDayTotal</li>
<li>
<em>reference</em>::day1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32902ScriptAnchor_">DaySelectSortThenSort</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>TotalMain</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32982ScriptAnchor_"></a><td class="script_navbar"><a href="#32981ScriptAnchor_"><span>Previous Script: [to 1 Total]</span></a></td><td class="script_navbar"><a href="#32979ScriptAnchor_"><span>Parent Folder: [total]</span></a></td><td class="script_navbar"><a href="#32983ScriptAnchor_"><span>Next Script: [to 7 Total]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">to 1 chart Total</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go to time Total layout 1</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 go to time layout 1</li>
<li>Go to Layout [ &ldquo;Total01chart&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#2 go to user's chosen day</li>
<li>Set Field [ reference::day1; steward::chosenDayTotal ]</li>
<li>#</li>
<li>#3 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#4 sort records (neccessary because the week and month view usually show more active records than the day view that need to be sorted out of top of list), and go to the first record.</li>
<li>Perform Script [ &ldquo;DaySelectSortThenSort&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenLayout</li>
<li>
<em>steward</em>::chosenDayTotal</li>
<li>
<em>reference</em>::day1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32902ScriptAnchor_">DaySelectSortThenSort</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>Total01chart</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32983ScriptAnchor_"></a><td class="script_navbar"><a href="#32982ScriptAnchor_"><span>Previous Script: [to 1 chart Total]</span></a></td><td class="script_navbar"><a href="#32979ScriptAnchor_"><span>Parent Folder: [total]</span></a></td><td class="script_navbar"><a href="#32984ScriptAnchor_"><span>Next Script: [to 7 chart Total]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">to 7 Total</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go to time Total layout 7</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 go to user's chosen day to start the week view</li>
<li>If [ steward::chosenWeekTotal = "" ]</li>
<li>Set Field [ steward::chosenWeekTotal; steward::chosenDayTotal ]</li>
<li>End If</li>
<li>Set Field [ reference::day1; steward::chosenWeekTotal ]</li>
<li>#</li>
<li>#2 go to requested layout. (This step prevents the user from seeing the current screen change with the a new date before going to the new layout.)</li>
<li>Go to Layout [ &ldquo;Total07&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#3 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#4 freeze window to speed up the calculation by  refreshing the window after all records have been calcuated rather than after each record is calcuated. (This must be done after flushing the cache (step 2) otherwise the flush unfreezes the window.)</li>
<li>Freeze Window</li>
<li>#</li>
<li>#5 go to a different layout to perform this script, which prevents user from seeing the current window refresh.</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#6 total 7 days of time for each record displayed, along with the average time, and number of days contributing time the this average</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::monthsum; day1::swTotalActivity + 
day2::swTotalActivity + 
day3::swTotalActivity + 
day4::swTotalActivity + 
day5::swTotalActivity + 
day6::swTotalActivity + 
day7::swTotalActivity ]</li>
<li>Set Field [ brainstate::monthsumaverage; If ( 

If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) 
 =  0
 ; "" ; brainstate::monthsum / 

(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) 
)

 ) ]</li>
<li>Set Field [ brainstate::monthsumdays; 
(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 )
) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#7 go back to layout time 7, sort records (neccessary because the week and month view usually show more active records that need to be sorted to the top of list), and go to the first record.</li>
<li>Go to Layout [ &ldquo;Total07&rdquo; (brainstate) ]</li>
<li>Perform Script [ &ldquo;WeekMonthSelectSortThenSort&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenWeekTotal</li>
<li>
<em>steward</em>::chosenDayTotal</li>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenLayout</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swTotalActivity</li>
<li>
<em>day3</em>::swTotalActivity</li>
<li>
<em>day4</em>::swTotalActivity</li>
<li>
<em>day5</em>::swTotalActivity</li>
<li>
<em>day6</em>::swTotalActivity</li>
<li>
<em>day7</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::monthsum</li>
<li>
<em>brainstate</em>::monthsumaverage</li>
<li>
<em>brainstate</em>::monthsumdays</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32909ScriptAnchor_">WeekMonthSelectSortThenSort</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>Total07</li>
<li>calcBrainstateTable</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32984ScriptAnchor_"></a><td class="script_navbar"><a href="#32983ScriptAnchor_"><span>Previous Script: [to 7 Total]</span></a></td><td class="script_navbar"><a href="#32979ScriptAnchor_"><span>Parent Folder: [total]</span></a></td><td class="script_navbar"><a href="#32985ScriptAnchor_"><span>Next Script: [to 32 Total]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">to 7 chart Total</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go to time Total layout 7</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 go to user's chosen day to start the week view</li>
<li>If [ steward::chosenWeekTotal = "" ]</li>
<li>Set Field [ steward::chosenWeekTotal; steward::chosenDay ]</li>
<li>End If</li>
<li>Set Field [ reference::day1; steward::chosenWeekTotal ]</li>
<li>#</li>
<li>#2 go to requested layout. (This step prevents the user from seeing the current screen change with the a new date before going to the new layout.)</li>
<li>Go to Layout [ &ldquo;Total07chart&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#3 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#4 freeze window to speed up the calculation by  refreshing the window after all records have been calcuated rather than after each record is calcuated. (This must be done after flushing the cache (step 2) otherwise the flush unfreezes the window.)</li>
<li>Freeze Window</li>
<li>#</li>
<li>#5 go to a different layout to perform this script, which prevents user from seeing the current window refresh.</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#6 total 7 days of time for each record displayed, along with the average time, and number of days contributing time the this average</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::monthsum; day1::swTotalActivity + 
day2::swTotalActivity + 
day3::swTotalActivity + 
day4::swTotalActivity + 
day5::swTotalActivity + 
day6::swTotalActivity + 
day7::swTotalActivity ]</li>
<li>Set Field [ brainstate::monthsumaverage; If ( 

If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) 
 =  0
 ; "" ; brainstate::monthsum / 

(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) 
)

 ) ]</li>
<li>Set Field [ brainstate::monthsumdays; 
(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 )
) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#7 go back to layout time 7, sort records (neccessary because the week and month view usually show more active records that need to be sorted to the top of list), and go to the first record.</li>
<li>Go to Layout [ &ldquo;Total07chart&rdquo; (brainstate) ]</li>
<li>Perform Script [ &ldquo;WeekMonthSelectSortThenSort&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenWeekTotal</li>
<li>
<em>steward</em>::chosenDay</li>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenLayout</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swTotalActivity</li>
<li>
<em>day3</em>::swTotalActivity</li>
<li>
<em>day4</em>::swTotalActivity</li>
<li>
<em>day5</em>::swTotalActivity</li>
<li>
<em>day6</em>::swTotalActivity</li>
<li>
<em>day7</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::monthsum</li>
<li>
<em>brainstate</em>::monthsumaverage</li>
<li>
<em>brainstate</em>::monthsumdays</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32909ScriptAnchor_">WeekMonthSelectSortThenSort</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>Total07chart</li>
<li>calcBrainstateTable</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32985ScriptAnchor_"></a><td class="script_navbar"><a href="#32984ScriptAnchor_"><span>Previous Script: [to 7 chart Total]</span></a></td><td class="script_navbar"><a href="#32979ScriptAnchor_"><span>Parent Folder: [total]</span></a></td><td class="script_navbar"><a href="#32986ScriptAnchor_"><span>Next Script: [to 31 chart Total]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">to 32 Total</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go to time Total layout 31</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 go to user's chosen day to start the month view</li>
<li>If [ steward::chosenMonthTotal = "" ]</li>
<li>Set Field [ steward::chosenMonthTotal; steward::chosenDayTotal ]</li>
<li>End If</li>
<li>Set Field [ reference::day1; steward::chosenMonthTotal ]</li>
<li>#</li>
<li>#2 go to requested layout. (This step prevents the user from seeing the current screen change with the a new date before going to the new layout.)</li>
<li>Go to Layout [ &ldquo;Total31&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#3 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#4 freeze window to speed up the calculation by  refreshing the window after all records have been calcuated rather than after each record is calcuated. (This must be done after flushing the cache (step 2) otherwise the flush unfreezes the window.)</li>
<li>Freeze Window</li>
<li>#</li>
<li>#5 go to a different layout to perform this script, which prevents user from seeing the current window refresh.</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#6 total 7 days of time for each record displayed, along with the average time, and number of days contributing time the this average</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::monthsum; day1::swTotalActivity + 
day2::swTotalActivity + 
day3::swTotalActivity + 
day4::swTotalActivity + 
day5::swTotalActivity + 
day6::swTotalActivity + 
day7::swTotalActivity +
day8::swTotalActivity + 
day9::swTotalActivity + 
day10::swTotalActivity +
day11::swTotalActivity +
day12::swTotalActivity +
day13::swTotalActivity +
day14::swTotalActivity +
day15::swTotalActivity +
day16::swTotalActivity +
day17::swTotalActivity +
day18::swTotalActivity +
day19::swTotalActivity +
day20::swTotalActivity +
day21::swTotalActivity +
day22::swTotalActivity +
day23::swTotalActivity +
day24::swTotalActivity +
day25::swTotalActivity +
day26::swTotalActivity +
day27::swTotalActivity +
day28::swTotalActivity +
day29::swTotalActivity +
day30::swTotalActivity +
day31::swTotalActivity ]</li>
<li>Set Field [ brainstate::monthsumaverage; If ( 

If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 )
 =  0
 ; "" ; brainstate::monthsum / 

(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 )
)

 ) ]</li>
<li>Set Field [ brainstate::monthsumdays; If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#7 go back to layout time 7, sort records (neccessary because the week and month view usually show more active records that need to be sorted to the top of list), and go to the first record.</li>
<li>Go to Layout [ &ldquo;Total31&rdquo; (brainstate) ]</li>
<li>Perform Script [ &ldquo;WeekMonthSelectSortThenSort&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenMonthTotal</li>
<li>
<em>steward</em>::chosenDayTotal</li>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenLayout</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swTotalActivity</li>
<li>
<em>day3</em>::swTotalActivity</li>
<li>
<em>day4</em>::swTotalActivity</li>
<li>
<em>day5</em>::swTotalActivity</li>
<li>
<em>day6</em>::swTotalActivity</li>
<li>
<em>day7</em>::swTotalActivity</li>
<li>
<em>day8</em>::swTotalActivity</li>
<li>
<em>day9</em>::swTotalActivity</li>
<li>
<em>day10</em>::swTotalActivity</li>
<li>
<em>day11</em>::swTotalActivity</li>
<li>
<em>day12</em>::swTotalActivity</li>
<li>
<em>day13</em>::swTotalActivity</li>
<li>
<em>day14</em>::swTotalActivity</li>
<li>
<em>day15</em>::swTotalActivity</li>
<li>
<em>day16</em>::swTotalActivity</li>
<li>
<em>day17</em>::swTotalActivity</li>
<li>
<em>day18</em>::swTotalActivity</li>
<li>
<em>day19</em>::swTotalActivity</li>
<li>
<em>day20</em>::swTotalActivity</li>
<li>
<em>day21</em>::swTotalActivity</li>
<li>
<em>day22</em>::swTotalActivity</li>
<li>
<em>day23</em>::swTotalActivity</li>
<li>
<em>day24</em>::swTotalActivity</li>
<li>
<em>day25</em>::swTotalActivity</li>
<li>
<em>day26</em>::swTotalActivity</li>
<li>
<em>day27</em>::swTotalActivity</li>
<li>
<em>day28</em>::swTotalActivity</li>
<li>
<em>day29</em>::swTotalActivity</li>
<li>
<em>day30</em>::swTotalActivity</li>
<li>
<em>day31</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::monthsum</li>
<li>
<em>brainstate</em>::monthsumaverage</li>
<li>
<em>brainstate</em>::monthsumdays</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32909ScriptAnchor_">WeekMonthSelectSortThenSort</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>Total31</li>
<li>calcBrainstateTable</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32986ScriptAnchor_"></a><td class="script_navbar"><a href="#32985ScriptAnchor_"><span>Previous Script: [to 32 Total]</span></a></td><td class="script_navbar"><a href="#32979ScriptAnchor_"><span>Parent Folder: [total]</span></a></td><td class="script_navbar"><a href="#32992ScriptAnchor_"><span>Next Script: [goAndComeBackPart1Total]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">to 31 chart Total</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go to chart Total layout 31</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 go to user's chosen day to start the month view</li>
<li>If [ steward::chosenMonthTotal = "" ]</li>
<li>Set Field [ steward::chosenMonthTotal; steward::chosenDayTotal ]</li>
<li>End If</li>
<li>Set Field [ reference::day1; steward::chosenMonthTotal ]</li>
<li>#</li>
<li>#2 go to requested layout. (This step prevents the user from seeing the current screen change with the a new date before going to the new layout.)</li>
<li>Go to Layout [ &ldquo;Total31chart&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#3 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#4 freeze window to speed up the calculation by  refreshing the window after all records have been calcuated rather than after each record is calcuated. (This must be done after flushing the cache (step 2) otherwise the flush unfreezes the window.)</li>
<li>Freeze Window</li>
<li>#</li>
<li>#5 go to a different layout to perform this script, which prevents user from seeing the current window refresh.</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#6 total 7 days of time for each record displayed, along with the average time, and number of days contributing time the this average</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::monthsum; day1::swTotalActivity + 
day2::swTotalActivity + 
day3::swTotalActivity + 
day4::swTotalActivity + 
day5::swTotalActivity + 
day6::swTotalActivity + 
day7::swTotalActivity +
day8::swTotalActivity + 
day9::swTotalActivity + 
day10::swTotalActivity +
day11::swTotalActivity +
day12::swTotalActivity +
day13::swTotalActivity +
day14::swTotalActivity +
day15::swTotalActivity +
day16::swTotalActivity +
day17::swTotalActivity +
day18::swTotalActivity +
day19::swTotalActivity +
day20::swTotalActivity +
day21::swTotalActivity +
day22::swTotalActivity +
day23::swTotalActivity +
day24::swTotalActivity +
day25::swTotalActivity +
day26::swTotalActivity +
day27::swTotalActivity +
day28::swTotalActivity +
day29::swTotalActivity +
day30::swTotalActivity +
day31::swTotalActivity ]</li>
<li>Set Field [ brainstate::monthsumaverage; If ( 

If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 )
 =  0
 ; "" ; brainstate::monthsum / 

(
If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 )
)

 ) ]</li>
<li>Set Field [ brainstate::monthsumdays; If ( day1::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day2::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day3::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day4::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day5::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day6::swTotalActivity &ne; 0 ; 1 ; 0 ) + 
If ( day7::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day8::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day9::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day10::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day11::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day12::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day13::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day14::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day15::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day16::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day17::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day18::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day19::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day20::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day21::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day22::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day23::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day24::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day25::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day26::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day27::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day28::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day29::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day30::swTotalActivity &ne; 0 ; 1 ; 0 ) +
If ( day31::swTotalActivity &ne; 0 ; 1 ; 0 ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#7 go back to layout time 7, sort records (neccessary because the week and month view usually show more active records that need to be sorted to the top of list), and go to the first record.</li>
<li>Go to Layout [ &ldquo;Total31chart&rdquo; (brainstate) ]</li>
<li>Perform Script [ &ldquo;WeekMonthSelectSortThenSort&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenMonthTotal</li>
<li>
<em>steward</em>::chosenDayTotal</li>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenLayout</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swTotalActivity</li>
<li>
<em>day3</em>::swTotalActivity</li>
<li>
<em>day4</em>::swTotalActivity</li>
<li>
<em>day5</em>::swTotalActivity</li>
<li>
<em>day6</em>::swTotalActivity</li>
<li>
<em>day7</em>::swTotalActivity</li>
<li>
<em>day8</em>::swTotalActivity</li>
<li>
<em>day9</em>::swTotalActivity</li>
<li>
<em>day10</em>::swTotalActivity</li>
<li>
<em>day11</em>::swTotalActivity</li>
<li>
<em>day12</em>::swTotalActivity</li>
<li>
<em>day13</em>::swTotalActivity</li>
<li>
<em>day14</em>::swTotalActivity</li>
<li>
<em>day15</em>::swTotalActivity</li>
<li>
<em>day16</em>::swTotalActivity</li>
<li>
<em>day17</em>::swTotalActivity</li>
<li>
<em>day18</em>::swTotalActivity</li>
<li>
<em>day19</em>::swTotalActivity</li>
<li>
<em>day20</em>::swTotalActivity</li>
<li>
<em>day21</em>::swTotalActivity</li>
<li>
<em>day22</em>::swTotalActivity</li>
<li>
<em>day23</em>::swTotalActivity</li>
<li>
<em>day24</em>::swTotalActivity</li>
<li>
<em>day25</em>::swTotalActivity</li>
<li>
<em>day26</em>::swTotalActivity</li>
<li>
<em>day27</em>::swTotalActivity</li>
<li>
<em>day28</em>::swTotalActivity</li>
<li>
<em>day29</em>::swTotalActivity</li>
<li>
<em>day30</em>::swTotalActivity</li>
<li>
<em>day31</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::monthsum</li>
<li>
<em>brainstate</em>::monthsumaverage</li>
<li>
<em>brainstate</em>::monthsumdays</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32909ScriptAnchor_">WeekMonthSelectSortThenSort</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>Total31chart</li>
<li>calcBrainstateTable</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32992ScriptAnchor_"></a><td class="script_navbar"><a href="#32986ScriptAnchor_"><span>Previous Script: [to 31 chart Total]</span></a></td><td class="script_navbar"><a href="#32979ScriptAnchor_"><span>Parent Folder: [total]</span></a></td><td class="script_navbar"><a href="#32993ScriptAnchor_"><span>Next Script: [goAndComeBackPart2Total]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">goAndComeBackPart1Total</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE prevent huge time delay.  (For some reason, when you select a new value in the go or scale dropdown lists, filemaker goes into a lengthy re-calc of all the barcharts on the layout, even though these drop downs are not connected in anyway with any of the record being calculated.  To prevent this form happening, this script makes filemaker freeze the window and go to another layout.  This other layout has a script layout trigger that causes the user to be returned to the layout that they just left.  This back and forth between layouts seems to stop the recalc process from occuring.)</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1  capture layout name for bounceback part 2 and then freeze window and go to bounce back layout.</li>
<li>Set Variable [ $$layoutTotal; Value:Get ( LayoutName ) ]</li>
<li>Freeze Window</li>
<li>Go to Layout [ &ldquo;bounceBackUtilityLayoutTotal&rdquo; (brainstate) ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>bounceBackUtilityLayoutTotal</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32993ScriptAnchor_"></a><td class="script_navbar"><a href="#32992ScriptAnchor_"><span>Previous Script: [goAndComeBackPart1Total]</span></a></td><td class="script_navbar"><a href="#32979ScriptAnchor_"><span>Parent Folder: [total]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">goAndComeBackPart2Total</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE bounce back to previous layout via a script trigger on layout load.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 bounce back layout user just left.</li>
<li>//  Go to Layout [ steward::chosenLayout ]</li>
<li>Go to Layout [ $$layoutTotal ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenLayout</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="32879ScriptAnchor_"></a><a href="#32879ScriptAnchor_toc">log</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32923ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#32879ScriptAnchor_"><span>Parent Folder: [log]</span></a></td><td class="script_navbar"><a href="#32833ScriptAnchor_"><span>Next Script: [gotoSpecificIssuesLog]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">logShowAll</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE show only all records being browsed (list view)</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>//  If [   Left ( $$loglayout ; 5 )  &ne; "total" ]</li>
<li>//  Halt Script</li>
<li>//  End If</li>
<li>#1 capture record number and object number user is currently on</li>
<li>#</li>
<li>#2 go to selected object</li>
<li>Go to Layout [ &ldquo;LogHome&rdquo; (brainstate) ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $itemID; Value:brainstate::_lockBrainstateID ]</li>
<li>Go to Layout [ &ldquo;logs2rows&rdquo; (logs) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ logs::_keyBrainstate; $itemID ]</li>
<li>Perform Find [  ]</li>
<li>Loop</li>
<li>Go to Layout [ &ldquo;LogHome&rdquo; (brainstate) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>Set Variable [ $itemID; Value:brainstate::_lockBrainstateID ]</li>
<li>Go to Layout [ &ldquo;logs2rows&rdquo; (logs) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ logs::_keyBrainstate; $itemID ]</li>
<li>Extend Found Set [  ]</li>
<li>End Loop</li>
<li>Go to Layout [ &ldquo;logs2rows&rdquo; (logs) ]</li>
<li>#NOT TESTED</li>
<li>If [ Get ( SystemPlatform ) = 3 or steward::iPhoneLayout &ne; "" ]</li>
<li>Go to Layout [ &ldquo;logByActioniPhone&rdquo; (logs) ]</li>
<li>End If</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
logs::_keyBrainstate; ascending
logs::logDay; descending ]
[ Restore; No dialog ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>logs</em>::_keyBrainstate</li>
<li>
<em>steward</em>::iPhoneLayout</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>logs</em>::logDay</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>LogHome</li>
<li>logs2rows</li>
<li>logByActioniPhone</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32833ScriptAnchor_"></a><td class="script_navbar"><a href="#32923ScriptAnchor_"><span>Previous Script: [logShowAll]</span></a></td><td class="script_navbar"><a href="#32879ScriptAnchor_"><span>Parent Folder: [log]</span></a></td><td class="script_navbar"><a href="#33167ScriptAnchor_"><span>Next Script: [openSpecificAction]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoSpecificIssuesLog</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE open log windows</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>Select Window [ Name: "Tag"; Current file ]</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33167ScriptAnchor_"></a><td class="script_navbar"><a href="#32833ScriptAnchor_"><span>Previous Script: [gotoSpecificIssuesLog]</span></a></td><td class="script_navbar"><a href="#32879ScriptAnchor_"><span>Parent Folder: [log]</span></a></td><td class="script_navbar"><a href="#33171ScriptAnchor_"><span>Next Script: [gotoLogs]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">openSpecificAction</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32903ScriptAnchor_">goToFarmer</a></li>
<li><a href="#33162ScriptAnchor_">gotoIssueLog</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE open log window and select log entry for </li>
<li>#current record.</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>#Stop the load record scripts. They  slow things down.</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>Set Variable [ $$stopSubtotal; Value:1 ]</li>
<li>#</li>
<li>#I really need to decide on ONE means to store the </li>
<li>#current brainstate key, isntead of making up a new</li>
<li>#one for each module because I'm not sure how the</li>
<li>#others are being used.   A definition of each variable</li>
<li>#and how it is used would be great!</li>
<li>Set Variable [ $$logBrainstate; Value:brainstate::_lockBrainstateID ]</li>
<li>#</li>
<li>Set Window Title [ Current Window; New Title: "Timer" ]</li>
<li>#</li>
<li>#Open a new window to test if any log records exist</li>
<li>#for this brainstate record.  A log record will not exist</li>
<li>#if the user has never logged anytime for this brainstate.</li>
<li>New Window [ Name: "Day"; Height: Get (ScreenHeight); Width: 344; Top: 0; Left: Get (ScreenWidth) - 688 ]</li>
<li>Set Zoom Level
[ 100% ]</li>
<li>#</li>
<li>#Find first issue record if there is one and set variable</li>
<li>#to conditionally format times for the first day record.</li>
<li>Go to Layout [ &ldquo;Issues&rdquo; (issue) ]</li>
<li>#</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Field [ issue::lock; "issue" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>If [ Get ( LastError ) = 401 ]</li>
<li>//  New Record/Request</li>
<li>//  Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>//  Set Field [ issue::_keyCategory; $groupID ]</li>
<li>//  Set Field [ issue::date; Get ( CurrentTimeStamp ) ]</li>
<li>//  Set Field [ issue::lock; "issue" ]</li>
<li>//  Set Field [ issue::text; "specific action" ]</li>
<li>//  #</li>
<li>//  #makes all new issues stay at the top of the window </li>
<li>//  #until a non-blank status is assigned to them.</li>
<li>//  Set Field [ issue::_keyStatus; 6302011014838316 ]</li>
<li>//  Go to Field [  ]</li>
<li>//  Go to Field [ issue::text ]</li>
<li>Else</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issueStatus::order; based on value list: &ldquo;__-99&rdquo;
issueStatus::text; ascending
issueCategory::order; ascending
issue::sortTime; ascending
issue::order; based on value list: &ldquo;__-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>Set Variable [ $$stopSubtotal ]</li>
<li>Perform Script [ &ldquo;TsubtotalTimeByGroup&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>Set Variable [ $$issue; Value:issue::_LockList ]</li>
<li>Set Variable [ $$status; Value:issue::_keyStatus ]</li>
<li>Set Variable [ $$issueLogs; Value:issue::_keyLogs ]</li>
<li>Set Variable [ $$group; Value:issue::_keyCategory ]</li>
<li>Set Variable [ $$issueRecordID; Value:Get ( RecordID ) ]</li>
<li>Set Variable [ $$timeAll; Value:issue::timeSegmentKeyList ]</li>
<li>#</li>
<li>#Now find log records for this timer.</li>
<li>Go to Layout [ &ldquo;logs2rows&rdquo; (logs) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ logs::_keyBrainstate; $$logBrainstate ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Display all rows of time for this timer.</li>
<li>If [ daylog::swActivityLength[11] &ne; "" ]</li>
<li>Go to Layout [ &ldquo;logs3rows&rdquo; (logs) ]</li>
<li>Else If [ daylog::swActivityLength[6] &ne; "" ]</li>
<li>Go to Layout [ &ldquo;logs2rows&rdquo; (logs) ]</li>
<li>Else If [ daylog::swActivityLength[6] = "" ]</li>
<li>Go to Layout [ &ldquo;logs1row&rdquo; (logs) ]</li>
<li>End If</li>
<li>#</li>
<li>#Sort and go to first record.</li>
<li>Sort Records [ Specified Sort Order: logs::_keyBrainstate; descending
logs::_keyDay; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>#</li>
<li>#For attaching issue record IDs to log records, and</li>
<li>#for conditionally formatting log records related to an issue,</li>
<li>#system needs to know what IDs are associated with a log record.</li>
<li>Set Variable [ $$log; Value:logs::_lockDay ]</li>
<li>Set Variable [ $$logrecordID; Value:Get ( RecordID ) ]</li>
<li>Set Variable [ $$logissues; Value:logs::_keyLogIssues ]</li>
<li>#</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Find all category tags for this timer.</li>
<li>New Window [ Name: "Tag" ]</li>
<li>Move/Resize Window [ Current Window; Height: Get (ScreenHeight); Top: 0; Left: Get (ScreenWidth) - 344 ]</li>
<li>Go to Layout [ &ldquo;IssuesAndObservationsTag&rdquo; (category) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_lockBrainstateID; $$logBrainstate ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If none are found then create one.</li>
<li>If [ Get ( LastError ) = 401 ]</li>
<li>Perform Script [ &ldquo;newTagGroup&rdquo; ]</li>
<li>End If</li>
<li>Sort Records [ Specified Sort Order: group::text; ascending
category::sortTime; ascending
category::text; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $newtag; Value:category::_LockList ]</li>
<li>#</li>
<li>#Update timer's total time.  This is only done now</li>
<li>#when selecting a specific action timer rather than</li>
<li>#each time a timer's total is changed due to the </li>
<li>#amount of time it takes to calculate this total.</li>
<li>Perform Script [ &ldquo;updateTimerTotalTimeInTagWindow&rdquo; ]</li>
<li>#</li>
<li>#Find all status tags.</li>
<li>Set Variable [ $brainstateName; Value:brainstate::description ]</li>
<li>Go to Layout [ &ldquo;IssuesAndObservationsStatus&rdquo; (status) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ status::lock; "status" ]</li>
<li>Perform Find [  ]</li>
<li>Set Field [ status::status; $brainstateName ]</li>
<li>Sort Records [ Specified Sort Order: status::order; ascending
status::text; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Create status tags if none exist.</li>
<li>Go to Layout [ &ldquo;IssuesAndObservationsStatus&rdquo; (status) ]</li>
<li>Set Variable [ $reviewNames; Value:"priority"  &amp; &para; &amp; 
"active" &amp; &para; &amp; 
"pending"  &amp; &para; &amp; 
"on hold" &amp; &para; &amp; 
"backlog"  &amp; &para; &amp; 
"complete" &amp; &para; &amp; 
"discard" ]</li>
<li>Set Variable [ $number; Value:1 ]</li>
<li>If [ Get (FoundCount) = 0 ]</li>
<li>Loop</li>
<li>New Record/Request</li>
<li>Set Field [ status::text; GetValue ( $reviewNames ; $number ) ]</li>
<li>Set Variable [ $number; Value:$number + 1 ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $newStatus; Value:status::_LockList ]</li>
<li>#</li>
<li>#Show all category tags for this timer.</li>
<li>Go to Layout [ &ldquo;IssuesAndObservationsTag&rdquo; (category) ]</li>
<li>#</li>
<li>#Show all issues for this brainstate's log.</li>
<li>New Window [ Name: "Specific Action"; Height: Get (ScreenHeight); Width: Get (ScreenWidth) - 688; Top: 0; Left: 0 ]</li>
<li>Go to Layout [ &ldquo;IssuesLayoutForScripts&rdquo; (issue) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Field [ issue::lock; "issue" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If none are found then create one.</li>
<li>If [ Get ( LastError ) = 401 ]</li>
<li>New Record/Request</li>
<li>Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Field [ issue::date; Get ( CurrentTimeStamp ) ]</li>
<li>Set Field [ issue::lock; "issue" ]</li>
<li>Set Field [ issue::text; "review these specific action items and update their status, priority, and grouping as necessary." ]</li>
<li>Set Field [ brainstate::pulldownBrainstate; issue::_keyBrainstate ]</li>
<li>Set Field [ issue::_keyStatus; $newStatus ]</li>
<li>Set Field [ issue::_keyCategory; $newTag ]</li>
<li>End If</li>
<li>#</li>
<li>Go to Layout [ &ldquo;Issues&rdquo; (issue) ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issueStatus::order; based on value list: &ldquo;__-99&rdquo;
issueStatus::text; ascending
issueCategory::order; ascending
issue::sortTime; ascending
issue::order; based on value list: &ldquo;__-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>Set Variable [ $$issueSort; Value:"status" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>#</li>
<li>If [ issue::_keyStatus = "" ]</li>
<li>Set Field [ issue::_keyStatus; $newStatus ]</li>
<li>End If</li>
<li>#</li>
<li>#Start load record scripts as needed for normal function.</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>issue</em>::_keyBrainstate</li>
<li>
<em>issue</em>::lock</li>
<li>
<em>issue</em>::_keyCategory</li>
<li>
<em>issue</em>::date</li>
<li>
<em>issue</em>::text</li>
<li>
<em>issue</em>::_keyStatus</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>issueStatus</em>::order</li>
<li>
<em>issueStatus</em>::text</li>
<li>
<em>issueCategory</em>::order</li>
<li>
<em>issue</em>::sortTime</li>
<li>
<em>issue</em>::order</li>
<li>
<em>issue</em>::_LockList</li>
<li>
<em>issue</em>::_keyLogs</li>
<li>
<em>issue</em>::timeSegmentKeyList</li>
<li>
<em>logs</em>::_keyBrainstate</li>
<li>
<em>daylog</em>::swActivityLength</li>
<li>
<em>logs</em>::_keyDay</li>
<li>
<em>logs</em>::_lockDay</li>
<li>
<em>logs</em>::_keyLogIssues</li>
<li>
<em>group</em>::text</li>
<li>
<em>category</em>::sortTime</li>
<li>
<em>category</em>::text</li>
<li>
<em>category</em>::_LockList</li>
<li>
<em>status</em>::lock</li>
<li>
<em>status</em>::status</li>
<li>
<em>status</em>::order</li>
<li>
<em>status</em>::text</li>
<li>
<em>status</em>::_LockList</li>
<li>
<em>brainstate</em>::pulldownBrainstate</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33112ScriptAnchor_">TsubtotalTimeByGroup</a></li>
<li><a href="#33223ScriptAnchor_">newTagGroup</a></li>
<li><a href="#33229ScriptAnchor_">updateTimerTotalTimeInTagWindow</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>Issues</li>
<li>logs2rows</li>
<li>logs3rows</li>
<li>logs1row</li>
<li>IssuesAndObservationsTag</li>
<li>IssuesAndObservationsStatus</li>
<li>IssuesLayoutForScripts</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33171ScriptAnchor_"></a><td class="script_navbar"><a href="#33167ScriptAnchor_"><span>Previous Script: [openSpecificAction]</span></a></td><td class="script_navbar"><a href="#32879ScriptAnchor_"><span>Parent Folder: [log]</span></a></td><td class="script_navbar"><a href="#33168ScriptAnchor_"><span>Next Script: [changeLogs Copy]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoLogs</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE open log window and select log entry for </li>
<li>#current record.</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>#If user remains in time edit field, conditional formatting</li>
<li>#fails to work in day window when time is assigned.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Stop the load record scripts. They  slow things down.</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>Set Variable [ $$stopSubtotal; Value:1 ]</li>
<li>#</li>
<li>#I really need to decide on ONE means to store the </li>
<li>#current brainstate key, isntead of making up a new</li>
<li>#one for each module because I'm not sure how the</li>
<li>#others are being used.   A definition of each variable</li>
<li>#and how it is used would be great!</li>
<li>Set Variable [ $$logBrainstate; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $day1; Value:reference::day1 ]</li>
<li>#</li>
<li>#If the user is already viewing the Specific Action</li>
<li>#and current day record for this timer then just</li>
<li>#show them these windows.</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
<li>If [ logs::_keyBrainstate = $$logBrainstate and logs::_keyDay = $day1 ]</li>
<li>#</li>
<li>#Display all rows of time for this timer.</li>
<li>If [ daylog::swActivityLength[11] &ne; "" ]</li>
<li>Go to Layout [ &ldquo;logs3rows&rdquo; (logs) ]</li>
<li>Else If [ daylog::swActivityLength[6] &ne; "" ]</li>
<li>Go to Layout [ &ldquo;logs2rows&rdquo; (logs) ]</li>
<li>Else If [ daylog::swActivityLength[6] = "" ]</li>
<li>Go to Layout [ &ldquo;logs1row&rdquo; (logs) ]</li>
<li>End If</li>
<li>#</li>
<li>Select Window [ Name: "Tag"; Current file ]</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>#</li>
<li>#Start load record scripts as needed for normal function.</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Set Variable [ $$stopSubtotal ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#If only a new day has been added, then just update</li>
<li>#the Day window and show user the rest of the</li>
<li>#Specific Action windows without changing them.  </li>
<li>Else If [ logs::_keyBrainstate = $$logBrainstate and logs::_keyDay &ne; $day1 ]</li>
<li>#</li>
<li>#Find new day record for this timer.</li>
<li>Go to Layout [ &ldquo;logs2rows&rdquo; (logs) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ logs::_keyBrainstate; $$logBrainstate ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Sort and go to first record.</li>
<li>Sort Records [ Specified Sort Order: logs::_keyBrainstate; descending
logs::_keyDay; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>#</li>
<li>#Display all rows of time for this timer.</li>
<li>If [ daylog::swActivityLength[11] &ne; "" ]</li>
<li>Go to Layout [ &ldquo;logs3rows&rdquo; (logs) ]</li>
<li>Else If [ daylog::swActivityLength[6] &ne; "" ]</li>
<li>Go to Layout [ &ldquo;logs2rows&rdquo; (logs) ]</li>
<li>Else If [ daylog::swActivityLength[6] = "" ]</li>
<li>Go to Layout [ &ldquo;logs1row&rdquo; (logs) ]</li>
<li>End If</li>
<li>#</li>
<li>#For attaching issue record IDs to log records, and</li>
<li>#for conditionally formatting log records related to an issue,</li>
<li>#system needs to know what IDs are associated with a log record.</li>
<li>Set Variable [ $$log; Value:logs::_lockDay ]</li>
<li>Set Variable [ $$logrecordID; Value:Get ( RecordID ) ]</li>
<li>Set Variable [ $$logissues; Value:logs::_keyLogIssues ]</li>
<li>#</li>
<li>#Start load record scripts as needed for normal function.</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Set Variable [ $$stopSubtotal ]</li>
<li>#</li>
<li>Perform Script [ &ldquo;loadLogrecordID&rdquo; ]</li>
<li>#</li>
<li>Select Window [ Name: "Tag"; Current file ]</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>#</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#Find first issue record if there is one and set variable</li>
<li>#to conditionally format times for the first day record.</li>
<li>Go to Layout [ &ldquo;Issues&rdquo; (issue) ]</li>
<li>#</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Field [ issue::lock; "issue" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>If [ Get ( LastError ) = 401 ]</li>
<li>//  New Record/Request</li>
<li>//  Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>//  Set Field [ issue::_keyCategory; $groupID ]</li>
<li>//  Set Field [ issue::date; Get ( CurrentTimeStamp ) ]</li>
<li>//  Set Field [ issue::lock; "issue" ]</li>
<li>//  Set Field [ issue::text; "specific action" ]</li>
<li>//  #</li>
<li>//  #makes all new issues stay at the top of the window </li>
<li>//  #until a non-blank status is assigned to them.</li>
<li>//  Set Field [ issue::_keyStatus; 7152011154818554 ]</li>
<li>//  Go to Field [  ]</li>
<li>//  Go to Field [ issue::text ]</li>
<li>Else</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issueStatus::order; based on value list: &ldquo;__-99&rdquo;
issueStatus::text; ascending
issueCategory::order; ascending
issue::sortTime; ascending
issue::order; based on value list: &ldquo;__-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>Set Variable [ $$stopSubtotal ]</li>
<li>Perform Script [ &ldquo;TsubtotalTimeByGroup&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>Set Variable [ $$issue; Value:issue::_LockList ]</li>
<li>Set Variable [ $$status; Value:issue::_keyStatus ]</li>
<li>Set Variable [ $$issueLogs; Value:issue::_keyLogs ]</li>
<li>Set Variable [ $$group; Value:issue::_keyCategory ]</li>
<li>Set Variable [ $$issueRecordID; Value:Get ( RecordID ) ]</li>
<li>Set Variable [ $$timeAll; Value:issue::timeSegmentKeyList ]</li>
<li>#</li>
<li>#Now find log records for this timer.</li>
<li>Go to Layout [ &ldquo;logs2rows&rdquo; (logs) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ logs::_keyBrainstate; $$logBrainstate ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Sort and go to first record.</li>
<li>Sort Records [ Specified Sort Order: logs::_keyBrainstate; descending
logs::_keyDay; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>#</li>
<li>#Display all rows of time for this timer.</li>
<li>If [ daylog::swActivityLength[11] &ne; "" ]</li>
<li>Go to Layout [ &ldquo;logs3rows&rdquo; (logs) ]</li>
<li>Else If [ daylog::swActivityLength[6] &ne; "" ]</li>
<li>Go to Layout [ &ldquo;logs2rows&rdquo; (logs) ]</li>
<li>Else If [ daylog::swActivityLength[6] = "" ]</li>
<li>Go to Layout [ &ldquo;logs1row&rdquo; (logs) ]</li>
<li>End If</li>
<li>#</li>
<li>#For attaching issue record IDs to log records, and</li>
<li>#for conditionally formatting log records related to an issue,</li>
<li>#system needs to know what IDs are associated with a log record.</li>
<li>Set Variable [ $$log; Value:logs::_lockDay ]</li>
<li>Set Variable [ $$logrecordID; Value:Get ( RecordID ) ]</li>
<li>Set Variable [ $$logissues; Value:logs::_keyLogIssues ]</li>
<li>#</li>
<li>Refresh Window</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Show all status and category menu items for 
brainstate's log.</li>
<li>Select Window [ Name: "Tag"; Current file ]</li>
<li>Go to Layout [ &ldquo;IssuesAndObservationsTag&rdquo; (category) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_lockBrainstateID; $$logBrainstate ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: group::text; ascending
category::sortTime; ascending
category::text; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Update timer's total time.  This is only done</li>
<li>#when switching specific action timers rather than</li>
<li>#each time a timer's total is changed due to the </li>
<li>#amount of time it takes to calculate this total.</li>
<li>Perform Script [ &ldquo;updateTimerTotalTimeInTagWindow&rdquo; ]</li>
<li>#</li>
<li>#FIX FIX FIX FIX</li>
<li>#FIX FIX FIX FIX</li>
<li>#FIX FIX FIX FIX</li>
<li>#FIX FIX FIX FIX</li>
<li>#FIX FIX FIX FIX</li>
<li>#</li>
<li>#Update review dates.</li>
<li>Go to Object [ Object Name: "status" ]</li>
<li>Go to Portal Row
[ Select; First ]</li>
<li>Set Variable [ $reviewNames; Value:"daily"  &amp; &para; &amp; 
"weekly" &amp; &para; &amp; 
"monthly"  &amp; &para; &amp; 
"1/2 yearly" &amp; &para; &amp; 
"yearly"  &amp; &para; &amp; 
"complete" &amp; &para; &amp; 
"discard" ]</li>
<li>Set Variable [ $reviewDates; Value://daily review
"" &amp; &para; &amp; 
//weekly review
Case ( 
Day  ( Get ( CurrentDate )       )  &lt; 8 ; 
Month ( Get ( CurrentDate ) ) - 1 &amp; "/"  ;
Month ( Get ( CurrentDate ) ) &amp; "/"  )  &amp; 
Case (
DayOfWeek  ( Get ( CurrentDate )       ) = 1 ; Day ( Get ( CurrentDate )      ) ;
DayOfWeek  ( Get ( CurrentDate ) - 1 ) = 1 ; Day ( Get ( CurrentDate ) - 1 ) ;
DayOfWeek  ( Get ( CurrentDate ) - 2 ) = 1 ; Day ( Get ( CurrentDate ) - 2 ) ;
DayOfWeek  ( Get ( CurrentDate ) - 3 ) = 1 ; Day ( Get ( CurrentDate ) - 3 ) ;
DayOfWeek  ( Get ( CurrentDate ) - 4 ) = 1 ; Day ( Get ( CurrentDate ) - 4 ) ;
DayOfWeek  ( Get ( CurrentDate ) - 5 ) = 1 ; Day ( Get ( CurrentDate ) - 5 ) ;
DayOfWeek  ( Get ( CurrentDate ) - 6 ) = 1 ; Day ( Get ( CurrentDate ) - 6 ) ) 
//&amp; " - " 
&amp; 
//Month ( Get ( CurrentDate ) ) &amp; "/" &amp;
//Case (
//DayOfWeek  ( Get ( CurrentDate )       ) = 7 ; Day ( Get ( CurrentDate )      ) ;
//DayOfWeek  ( Get ( CurrentDate ) + 1 ) = 7 ; Day ( Get ( CurrentDate ) + 1 ) ;
//DayOfWeek  ( Get ( CurrentDate ) + 2 ) = 7 ; Day ( Get ( CurrentDate ) + 2 ) ;
//DayOfWeek  ( Get ( CurrentDate ) + 3 ) = 7 ; Day ( Get ( CurrentDate ) + 3 ) ;
//DayOfWeek  ( Get ( CurrentDate ) + 4 ) = 7 ; Day ( Get ( CurrentDate ) + 4 ) ;
//DayOfWeek  ( Get ( CurrentDate ) + 5 ) = 7 ; Day ( Get ( CurrentDate ) + 5 ) ;
//DayOfWeek  ( Get ( CurrentDate ) + 6 ) = 7 ; Day ( Get ( CurrentDate ) + 6 ) )
&para; &amp; 

//monthly review
"  " &amp; 
Case (
Day ( Get ( CurrentDate ) )  &gt; 7 ;
//MonthName (  Month ( Get ( CurrentDate ) ) + 1 &amp; "/" &amp; 1  &amp; "/" &amp; 2012)  ;
//MonthName (  Month ( Get ( CurrentDate ) ) &amp; "/" &amp; 1  &amp; "/" &amp; 2012)  )
//&amp; ")"

Month ( Get ( CurrentDate ) ) + 1 &amp; "/" &amp; "1" ;
Month ( Get ( CurrentDate ) ) &amp; "/" &amp; "1" ) ]</li>
<li>Set Variable [ $number; Value:1 ]</li>
<li>If [ status::text = "" ]</li>
<li>Set Field [ status::status; "Remember existence" &amp; &para; &amp; "of a specific action..." ]</li>
<li>Loop</li>
<li>Set Field [ status::text; GetValue ( $reviewNames ; $number ) ]</li>
<li>Set Field [ status::reviewDate; GetValue ( $reviewDates ; $number ) ]</li>
<li>Set Variable [ $number; Value:$number + 1 ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>#Find all groups for this action.</li>
<li>Go to Layout [ &ldquo;menuGroups&rdquo; (issueCategory) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issueCategory::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Field [ issueCategory::lock; "location" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If none are found then create one.</li>
<li>If [ Get ( LastError ) = 401 ]</li>
<li>New Record/Request</li>
<li>Set Field [ issueCategory::lock; "location" ]</li>
<li>Set Field [ issueCategory::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Field [ issueCategory::text; "administration" ]</li>
<li>Set Variable [ $groupKey; Value:issueCategory::_LockList ]</li>
<li>End If</li>
<li>#</li>
<li>Go to Layout [ &ldquo;IssuesAndObservationsTag&rdquo; (category) ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Show all issues for this brainstate's log.</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>Go to Layout [ &ldquo;IssuesLayoutForScripts&rdquo; (issue) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Field [ issue::lock; "issue" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If none are found then create one.</li>
<li>If [ Get ( LastError ) = 401 ]</li>
<li>New Record/Request</li>
<li>Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Field [ issue::date; Get ( CurrentTimeStamp ) ]</li>
<li>Set Field [ issue::lock; "issue" ]</li>
<li>Set Field [ issue::text; "review these specific action items and update their status, priority, and grouping as necessary." ]</li>
<li>Set Field [ brainstate::pulldownBrainstate; issue::_keyBrainstate ]</li>
<li>Set Field [ issue::_keyStatus; 7152011154818554 ]</li>
<li>Set Field [ issue::_keyCategory; $groupKey ]</li>
<li>End If</li>
<li>#</li>
<li>Go to Layout [ &ldquo;Issues&rdquo; (issue) ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issueStatus::order; based on value list: &ldquo;__-99&rdquo;
issueStatus::text; ascending
issueCategory::order; ascending
issue::sortTime; ascending
issue::order; based on value list: &ldquo;__-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>Set Variable [ $$issueSort; Value:"status" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>#</li>
<li>#Start load record scripts as needed for normal function.</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Perform Script [ &ldquo;loadIssuerecordID&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>reference</em>::day1</li>
<li>
<em>logs</em>::_keyBrainstate</li>
<li>
<em>logs</em>::_keyDay</li>
<li>
<em>daylog</em>::swActivityLength</li>
<li>
<em>logs</em>::_lockDay</li>
<li>
<em>logs</em>::_keyLogIssues</li>
<li>
<em>issue</em>::_keyBrainstate</li>
<li>
<em>issue</em>::lock</li>
<li>
<em>issue</em>::_keyCategory</li>
<li>
<em>issue</em>::date</li>
<li>
<em>issue</em>::text</li>
<li>
<em>issue</em>::_keyStatus</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>issueStatus</em>::order</li>
<li>
<em>issueStatus</em>::text</li>
<li>
<em>issueCategory</em>::order</li>
<li>
<em>issue</em>::sortTime</li>
<li>
<em>issue</em>::order</li>
<li>
<em>issue</em>::_LockList</li>
<li>
<em>issue</em>::_keyLogs</li>
<li>
<em>issue</em>::timeSegmentKeyList</li>
<li>
<em>group</em>::text</li>
<li>
<em>category</em>::sortTime</li>
<li>
<em>category</em>::text</li>
<li>
<em>status</em>::text</li>
<li>
<em>status</em>::status</li>
<li>
<em>status</em>::reviewDate</li>
<li>
<em>issueCategory</em>::_keyBrainstate</li>
<li>
<em>issueCategory</em>::lock</li>
<li>
<em>issueCategory</em>::text</li>
<li>
<em>issueCategory</em>::_LockList</li>
<li>
<em>brainstate</em>::pulldownBrainstate</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33124ScriptAnchor_">loadLogrecordID</a></li>
<li><a href="#33112ScriptAnchor_">TsubtotalTimeByGroup</a></li>
<li><a href="#33229ScriptAnchor_">updateTimerTotalTimeInTagWindow</a></li>
<li><a href="#33115ScriptAnchor_">loadIssuerecordID</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>logs3rows</li>
<li>logs2rows</li>
<li>logs1row</li>
<li>Issues</li>
<li>IssuesAndObservationsTag</li>
<li>menuGroups</li>
<li>IssuesLayoutForScripts</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33168ScriptAnchor_"></a><td class="script_navbar"><a href="#33171ScriptAnchor_"><span>Previous Script: [gotoLogs]</span></a></td><td class="script_navbar"><a href="#32879ScriptAnchor_"><span>Parent Folder: [log]</span></a></td><td class="script_navbar"><a href="#33162ScriptAnchor_"><span>Next Script: [gotoIssueLog]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">changeLogs Copy</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE open log window and select log entry for </li>
<li>#current record, but if that record has no time entry </li>
<li>#the show the calendar log view for that record</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $$stopSubtotal; Value:1 ]</li>
<li>#</li>
<li>#I really need to decide on ONE means to store the </li>
<li>#current brainstate key, isntead of making up a new</li>
<li>#one for each module because I'm not sure how the</li>
<li>#others are being used.   A definition of each variable</li>
<li>#and how it is used would be great!</li>
<li>Set Variable [ $$logBrainstate; Value:brainstate::_lockBrainstateID ]</li>
<li>#</li>
<li>#Stop the load record scripts. They  slow things down.</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>Set Window Title [ Current Window; New Title: "Timer" ]</li>
<li>#</li>
<li>Select Window [ Name: "Tag"; Current file ]</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>//  End If</li>
<li>Go to Layout [ &ldquo;Issues&rdquo; (issue) ]</li>
<li>Set Variable [ $$issueRecordID; Value:Get ( RecordID ) ]</li>
<li>Set Variable [ $$issue; Value:issue::_LockList ]</li>
<li>Set Variable [ $$issueLogs; Value:issue::_keyLogs ]</li>
<li>Refresh Window</li>
<li>#neccessary step when two monitors are used as this</li>
<li>#window can be opened in smaller monitor and then </li>
<li>#move over to larger monitor but not adjust its height</li>
<li>#unless this step is included.</li>
<li>Move/Resize Window [ Name: "Day"; Current file; Height: Get (ScreenHeight) ]</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Open a new window to test if any log records exist</li>
<li>#for this brainstate record.  A log record will not exist</li>
<li>#if the user has never logged anytime for this brainstate.</li>
<li>New Window [ Name: "Day"; Height: Get (ScreenHeight); Width: 608; Top: 0; Left: 441 ]</li>
<li>Move/Resize Window [ Current Window; Width: Get (ScreenWidth) / 2; Left: Get (ScreenWidth) / 2 ]</li>
<li>Set Zoom Level
[ 100% ]</li>
<li>Go to Layout [ &ldquo;logs2rows&rdquo; (logs) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ logs::_keyBrainstate; $$logBrainstate ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Decided to show log windows even if there are</li>
<li>#no log records as user may want to create some</li>
<li>#issues.</li>
<li>If [ Get ( LastError )  = 401 ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "You can create issues for this brainstate, but  until you click the stopwatch for this brainstate there will be no log records to show in the Activity Log  window. "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#If there are records for this brainstate then show them.</li>
<li>Sort Records [ Specified Sort Order: logs::_keyBrainstate; descending
logs::_keyDay; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>#</li>
<li>#Show all status and category menu items for 
brainstate's log.</li>
<li>Select Window [ Name: "Tag"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>New Window [ Name: "Tag" ]</li>
<li>Move/Resize Window [ Current Window; Height: Get (ScreenHeight); Width: 441; Top: 0; Left: //If (Get (ScreenWidth) / 2 + 1100 &le; Get (ScreenWidth) ; Get (ScreenWidth)/2 ; Get (ScreenWidth)  - 1100 )

Get (ScreenWidth)/2 ]</li>
<li>Set Zoom Level
[ 100% ]</li>
<li>End If</li>
<li>Go to Layout [ &lt;unknown&gt; ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_lockBrainstateID; $$logBrainstate ]</li>
<li>Perform Find [  ]</li>
<li>Go to Layout [ &ldquo;menuGroups&rdquo; (issueCategory) ]</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>#Find the blank (10 space) record for this brainstate's</li>
<li>#set of group tags for grouping issues by group.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issueCategory::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Field [ issueCategory::lock; "location" ]</li>
<li>Set Field [ issueCategory::text; "==" &amp; "          " ]</li>
<li>Set Field [ issueCategory::order; "" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If the blank (10 space) record is not found then</li>
<li>#create a new one.</li>
<li>If [ Get ( LastError ) = 401 ]</li>
<li>New Record/Request</li>
<li>Set Field [ issueCategory::lock; "location" ]</li>
<li>Set Field [ issueCategory::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Field [ issueCategory::text; "          " ]</li>
<li>Set Variable [ $groupID; Value:issueCategory::_LockList ]</li>
<li>End If</li>
<li>#</li>
<li>#Set the key for the first blank record (actually</li>
<li>#the record with 10 spaces in it, which looks</li>
<li>#blank to the user and will scroll to the top, which </li>
<li>#is what is essential.</li>
<li>Set Variable [ $$blankGroupKey; Value:issueCategory::_LockList ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issueCategory::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Field [ issueCategory::lock; "location" ]</li>
<li>Perform Find [  ]</li>
<li>Go to Layout [ &lt;unknown&gt; ]</li>
<li>#</li>
<li>#</li>
<li>#Show all issues for this brainstate's log.</li>
<li>New Window [ Name: "Specific Action"; Height: Get (ScreenHeight); Width: Get (ScreenWidth) / 2; Top: 0; Left: 0 ]</li>
<li>Set Zoom Level
[ 100% ]</li>
<li>Go to Layout [ &ldquo;IssuesLayoutForScripts&rdquo; (issue) ]</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Field [ issue::lock; "issue" ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get ( LastError ) = 401 ]</li>
<li>New Record/Request</li>
<li>Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Field [ issue::_keyCategory; $groupID ]</li>
<li>Set Field [ issue::date; Get ( CurrentTimeStamp ) ]</li>
<li>Set Field [ issue::lock; "issue" ]</li>
<li>Set Field [ issue::text; "issue" ]</li>
<li>#</li>
<li>#makes all new issues stay at the top of the window </li>
<li>#until a non-blank status is assigned to them.</li>
<li>Set Field [ issue::_keyStatus; 6302011014838316 ]</li>
<li>Go to Field [  ]</li>
<li>Go to Field [ issue::text ]</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;Issues&rdquo; (issue) ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issueStatus::order; based on value list: &ldquo;__-99&rdquo;
issueStatus::text; ascending
issueCategory::order; ascending
issue::sortTime; ascending
issue::order; based on value list: &ldquo;__-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>Perform Script [ &ldquo;TsubtotalTimeByGroup&rdquo; ]</li>
<li>Set Variable [ $$issueSort; Value:"status" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>#</li>
<li>#neccessary step when two monitors are used as this</li>
<li>#window can be opened in smaller monitor and then </li>
<li>#move over to larger monitor but not adjust its height</li>
<li>#unless this step is included.</li>
<li>//  Move/Resize Window [ Name: "Activity Log"; Current file; Height: Get (ScreenHeight) ]</li>
<li>#</li>
<li>#Start load record scripts as needed for normal function.</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Perform Script [ &ldquo;loadIssuerecordID&rdquo; ]</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
<li>Perform Script [ &ldquo;loadLogrecordID&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>issue</em>::_LockList</li>
<li>
<em>issue</em>::_keyLogs</li>
<li>
<em>logs</em>::_keyBrainstate</li>
<li>
<em>logs</em>::_keyDay</li>
<li>
<em>issueCategory</em>::_keyBrainstate</li>
<li>
<em>issueCategory</em>::lock</li>
<li>
<em>issueCategory</em>::text</li>
<li>
<em>issueCategory</em>::order</li>
<li>
<em>issueCategory</em>::_LockList</li>
<li>
<em>issue</em>::_keyBrainstate</li>
<li>
<em>issue</em>::lock</li>
<li>
<em>issue</em>::_keyCategory</li>
<li>
<em>issue</em>::date</li>
<li>
<em>issue</em>::text</li>
<li>
<em>issue</em>::_keyStatus</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>issueStatus</em>::order</li>
<li>
<em>issueStatus</em>::text</li>
<li>
<em>issue</em>::sortTime</li>
<li>
<em>issue</em>::order</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33112ScriptAnchor_">TsubtotalTimeByGroup</a></li>
<li><a href="#33115ScriptAnchor_">loadIssuerecordID</a></li>
<li><a href="#33124ScriptAnchor_">loadLogrecordID</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>Issues</li>
<li>logs2rows</li>
<li>&lt;Missing Layout&gt;</li>
<li>menuGroups</li>
<li>IssuesLayoutForScripts</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33162ScriptAnchor_"></a><td class="script_navbar"><a href="#33168ScriptAnchor_"><span>Previous Script: [changeLogs Copy]</span></a></td><td class="script_navbar"><a href="#32879ScriptAnchor_"><span>Parent Folder: [log]</span></a></td><td class="script_navbar"><a href="#33044ScriptAnchor_"><span>Next Script: [logOpen]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoIssueLog</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>Perform Script [ &ldquo;openSpecificAction&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33167ScriptAnchor_">openSpecificAction</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33044ScriptAnchor_"></a><td class="script_navbar"><a href="#33162ScriptAnchor_"><span>Previous Script: [gotoIssueLog]</span></a></td><td class="script_navbar"><a href="#32879ScriptAnchor_"><span>Parent Folder: [log]</span></a></td><td class="script_navbar"><a href="#33046ScriptAnchor_"><span>Next Script: [logClose]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">logOpen</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $$loglayout; Value:Get ( LayoutName ) ]</li>
<li>Go to Layout [ &ldquo;LogHome&rdquo; (brainstate) ]</li>
<li>#NOT TESTED</li>
<li>If [ Get ( SystemPlatform ) = 3 ]</li>
<li>Go to Layout [ &ldquo;logHomeiPhone&rdquo; (brainstate) ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>LogHome</li>
<li>logHomeiPhone</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33046ScriptAnchor_"></a><td class="script_navbar"><a href="#33044ScriptAnchor_"><span>Previous Script: [logOpen]</span></a></td><td class="script_navbar"><a href="#32879ScriptAnchor_"><span>Parent Folder: [log]</span></a></td><td class="script_navbar"><a href="#33041ScriptAnchor_"><span>Next Script: [logViewByDate]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">logClose</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Layout [ $$loglayout ]</li>
<li>Set Variable [ $$loglayout ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33041ScriptAnchor_"></a><td class="script_navbar"><a href="#33046ScriptAnchor_"><span>Previous Script: [logClose]</span></a></td><td class="script_navbar"><a href="#32879ScriptAnchor_"><span>Parent Folder: [log]</span></a></td><td class="script_navbar"><a href="#33043ScriptAnchor_"><span>Next Script: [logViewByAction]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">logViewByDate</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Layout [ &ldquo;logByDate&rdquo; (logs) ]</li>
<li>#NOT TESTED</li>
<li>If [ Get ( SystemPlatform ) = 3 or steward::iPhoneLayout &ne; "" ]</li>
<li>Go to Layout [ &ldquo;logByDateiPhone&rdquo; (logs) ]</li>
<li>End If</li>
<li>Sort Records [ Specified Sort Order: logs::_keyDay; descending
logs::swStart; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::iPhoneLayout</li>
<li>
<em>logs</em>::_keyDay</li>
<li>
<em>logs</em>::swStart</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>logByDate</li>
<li>logByDateiPhone</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33043ScriptAnchor_"></a><td class="script_navbar"><a href="#33041ScriptAnchor_"><span>Previous Script: [logViewByDate]</span></a></td><td class="script_navbar"><a href="#32879ScriptAnchor_"><span>Parent Folder: [log]</span></a></td><td class="script_navbar"><a href="#33040ScriptAnchor_"><span>Next Script: [logHideBlanks]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">logViewByAction</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Layout [ &ldquo;logs2rows&rdquo; (logs) ]</li>
<li>#NOT TESTED</li>
<li>If [ Get ( SystemPlatform ) = 3 or steward::iPhoneLayout &ne; "" ]</li>
<li>Go to Layout [ &ldquo;logByActioniPhone&rdquo; (logs) ]</li>
<li>End If</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
logs::_keyBrainstate; descending
logs::swStart; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::iPhoneLayout</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>logs</em>::_keyBrainstate</li>
<li>
<em>logs</em>::swStart</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>logs2rows</li>
<li>logByActioniPhone</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33040ScriptAnchor_"></a><td class="script_navbar"><a href="#33043ScriptAnchor_"><span>Previous Script: [logViewByAction]</span></a></td><td class="script_navbar"><a href="#32879ScriptAnchor_"><span>Parent Folder: [log]</span></a></td><td class="script_navbar"><a href="#33015ScriptAnchor_"><span>Next Script: [removeTextFormatting]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">logHideBlanks</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE open log window and select log entry for current record, but if that record has no time entry the show the calendar log view for that record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: logs::log: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>#1 capture layout name for the return trip</li>
<li>If [ Get ( LastError )  = 401 ]</li>
<li>If [ Get ( SystemPlatform ) = 3 or steward::iPhoneLayout &ne; "" ]</li>
<li>If [ Left ( $$iphoneLog; 8 ) = "TotalLog" ]</li>
<li>Go to Layout [ &ldquo;TotalLogEditTimeiPhone&rdquo; (brainstate) ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Set Variable [ $$iphoneLog; Value:"" ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "All log entries are blank."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;LogEditTimeiPhone&rdquo; (brainstate) ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "All log entries are blank."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Go to Layout [ $$loglayout ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "All log entries are blank."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>logs</em>::log</li>
<li>
<em>steward</em>::iPhoneLayout</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>TotalLogEditTimeiPhone</li>
<li>LogEditTimeiPhone</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33015ScriptAnchor_"></a><td class="script_navbar"><a href="#33040ScriptAnchor_"><span>Previous Script: [logHideBlanks]</span></a></td><td class="script_navbar"><a href="#32879ScriptAnchor_"><span>Parent Folder: [log]</span></a></td><td class="script_navbar"><a href="#33199ScriptAnchor_"><span>Next Script: [resetRememberTags]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">removeTextFormatting</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Field [ TextFontRemove ( (Get ( ActiveFieldContents ))  ) ]</li>
<li>Set Field [ TextFormatRemove ( (Get ( ActiveFieldContents ))  ) ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33199ScriptAnchor_"></a><td class="script_navbar"><a href="#33015ScriptAnchor_"><span>Previous Script: [removeTextFormatting]</span></a></td><td class="script_navbar"><a href="#32879ScriptAnchor_"><span>Parent Folder: [log]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">resetRememberTags</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE resets remember tags.</li>
<li>#</li>
<li>#</li>
<li>#Stop script if user is process of picking a specific action group.</li>
<li>If [ $$pick = 1 ]</li>
<li>Show Custom Dialog [ Message: "Pick a specific-action group.  After you do this you can reset these tags to the default setting.  "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Make sure user wants to reset dates to default.</li>
<li>Show Custom Dialog [ Message: "Are you sure you want to reset the remember tags names to daily, weekly, monthly, 1/2 yearly, yearly, complete, discard?"; Buttons: &ldquo;cancel&rdquo;, &ldquo;OK&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Update remember names and review dates.</li>
<li>Set Field [ status::status; "Remember existence" &amp; &para; &amp; "of a specific action..." ]</li>
<li>Go to Object [ Object Name: "status" ]</li>
<li>Go to Portal Row
[ Select; First ]</li>
<li>Set Variable [ $reviewNames; Value:"daily"  &amp; &para; &amp; 
"weekly" &amp; &para; &amp; 
"monthly"  &amp; &para; &amp; 
"1/2 yearly" &amp; &para; &amp; 
"yearly"  &amp; &para; &amp; 
"complete" &amp; &para; &amp; 
"discard" ]</li>
<li>//  Set Variable [ $reviewDates; Value://daily review
"" &amp; &para; &amp; 
//weekly review
Case ( 
Day  ( Get ( CurrentDate )       )  &lt; 8 ; 
Month ( Get ( CurrentDate ) ) - 1 &amp; "/"  ;
Month ( Get ( CurrentDate ) ) &amp; "/"  )  &amp; 
Case (
DayOfWeek  ( Get ( CurrentDate )       ) = 1 ; Day ( Get ( CurrentDate )      ) ;
DayOfWeek  ( Get ( CurrentDate ) - 1 ) = 1 ; Day ( Get ( CurrentDate ) - 1 ) ;
DayOfWeek  ( Get ( CurrentDate ) - 2 ) = 1 ; Day ( Get ( CurrentDate ) - 2 ) ;
DayOfWeek  ( Get ( CurrentDate ) - 3 ) = 1 ; Day ( Get ( CurrentDate ) - 3 ) ;
DayOfWeek  ( Get ( CurrentDate ) - 4 ) = 1 ; Day ( Get ( CurrentDate ) - 4 ) ;
DayOfWeek  ( Get ( CurrentDate ) - 5 ) = 1 ; Day ( Get ( CurrentDate ) - 5 ) ;
DayOfWeek  ( Get ( CurrentDate ) - 6 ) = 1 ; Day ( Get ( CurrentDate ) - 6 ) ) 
&amp; " - " &amp; 
//Month ( Get ( CurrentDate ) ) &amp; "/" &amp;
Case (
DayOfWeek  ( Get ( CurrentDate )       ) = 7 ; Day ( Get ( CurrentDate )      ) ;
DayOfWeek  ( Get ( CurrentDate ) + 1 ) = 7 ; Day ( Get ( CurrentDate ) + 1 ) ;
DayOfWeek  ( Get ( CurrentDate ) + 2 ) = 7 ; Day ( Get ( CurrentDate ) + 2 ) ;
DayOfWeek  ( Get ( CurrentDate ) + 3 ) = 7 ; Day ( Get ( CurrentDate ) + 3 ) ;
DayOfWeek  ( Get ( CurrentDate ) + 4 ) = 7 ; Day ( Get ( CurrentDate ) + 4 ) ;
DayOfWeek  ( Get ( CurrentDate ) + 5 ) = 7 ; Day ( Get ( CurrentDate ) + 5 ) ;
DayOfWeek  ( Get ( CurrentDate ) + 6 ) = 7 ; Day ( Get ( CurrentDate ) + 6 ) )
&amp; &para; &amp; 

//monthly review
"  " &amp; 
Case (
Day ( Get ( CurrentDate ) )  &gt; 7 ;
//MonthName (  Month ( Get ( CurrentDate ) ) + 1 &amp; "/" &amp; 1  &amp; "/" &amp; 2012)  ;
//MonthName (  Month ( Get ( CurrentDate ) ) &amp; "/" &amp; 1  &amp; "/" &amp; 2012)  )
//&amp; ")"

Month ( Get ( CurrentDate ) ) + 1 &amp; "/" &amp; "1" ;
Month ( Get ( CurrentDate ) ) &amp; "/" &amp; "1" ) ]</li>
<li>Set Variable [ $reviewDates; Value://daily review
"" &amp; &para; &amp; 
//weekly review
Case ( 
Day  ( Get ( CurrentDate )       )  &lt; 8 ; 
Month ( Get ( CurrentDate ) ) - 1 &amp; "/"  ;
Month ( Get ( CurrentDate ) ) &amp; "/"  )  &amp; 
Case (
DayOfWeek  ( Get ( CurrentDate )       ) = 1 ; Day ( Get ( CurrentDate )      ) ;
DayOfWeek  ( Get ( CurrentDate ) - 1 ) = 1 ; Day ( Get ( CurrentDate ) - 1 ) ;
DayOfWeek  ( Get ( CurrentDate ) - 2 ) = 1 ; Day ( Get ( CurrentDate ) - 2 ) ;
DayOfWeek  ( Get ( CurrentDate ) - 3 ) = 1 ; Day ( Get ( CurrentDate ) - 3 ) ;
DayOfWeek  ( Get ( CurrentDate ) - 4 ) = 1 ; Day ( Get ( CurrentDate ) - 4 ) ;
DayOfWeek  ( Get ( CurrentDate ) - 5 ) = 1 ; Day ( Get ( CurrentDate ) - 5 ) ;
DayOfWeek  ( Get ( CurrentDate ) - 6 ) = 1 ; Day ( Get ( CurrentDate ) - 6 ) ) 
//&amp; " - " 
&amp; 
//Month ( Get ( CurrentDate ) ) &amp; "/" &amp;
//Case (
//DayOfWeek  ( Get ( CurrentDate )       ) = 7 ; Day ( Get ( CurrentDate )      ) ;
//DayOfWeek  ( Get ( CurrentDate ) + 1 ) = 7 ; Day ( Get ( CurrentDate ) + 1 ) ;
//DayOfWeek  ( Get ( CurrentDate ) + 2 ) = 7 ; Day ( Get ( CurrentDate ) + 2 ) ;
//DayOfWeek  ( Get ( CurrentDate ) + 3 ) = 7 ; Day ( Get ( CurrentDate ) + 3 ) ;
//DayOfWeek  ( Get ( CurrentDate ) + 4 ) = 7 ; Day ( Get ( CurrentDate ) + 4 ) ;
//DayOfWeek  ( Get ( CurrentDate ) + 5 ) = 7 ; Day ( Get ( CurrentDate ) + 5 ) ;
//DayOfWeek  ( Get ( CurrentDate ) + 6 ) = 7 ; Day ( Get ( CurrentDate ) + 6 ) )
&para; &amp; 

//monthly review
"  " &amp; 
Case (
Day ( Get ( CurrentDate ) )  &gt; 7 ;
//MonthName (  Month ( Get ( CurrentDate ) ) + 1 &amp; "/" &amp; 1  &amp; "/" &amp; 2012)  ;
//MonthName (  Month ( Get ( CurrentDate ) ) &amp; "/" &amp; 1  &amp; "/" &amp; 2012)  )
//&amp; ")"

Month ( Get ( CurrentDate ) ) + 1 &amp; "/" &amp; "1" ;
Month ( Get ( CurrentDate ) ) &amp; "/" &amp; "1" ) ]</li>
<li>Set Variable [ $number; Value:1 ]</li>
<li>Loop</li>
<li>Set Field [ status::text; GetValue ( $reviewNames ; $number ) ]</li>
<li>Set Field [ status::reviewDate; GetValue ( $reviewDates ; $number ) ]</li>
<li>Set Variable [ $number; Value:$number + 1 ]</li>
<li>Go to Portal Row
[ Select; Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>Go to Field [  ]</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>status</em>::status</li>
<li>
<em>status</em>::text</li>
<li>
<em>status</em>::reviewDate</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="32881ScriptAnchor_"></a><a href="#32881ScriptAnchor_toc">action buttons</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="102ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#33047ScriptAnchor_"><span>Next Script: [note veto view (old: opened things in new windows)]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">note veto view</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#110ScriptAnchor_">deleteBrainstate</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE merge selected record's time data into one total record and then link these records so that time added in the future to any of the merge records will be automatically added to the one total record.</li>
<li>#</li>
<li>#</li>
<li>Set Variable [ $$recordFIXTOMANYVARIABLES; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $$record; Value:Get (RecordNumber) ]</li>
<li>Set Variable [ $$recordnumber; Value:Get ( RecordNumber ) ]</li>
<li>Freeze Window</li>
<li>#needed by folderstopwatchcheck script in case the stopwatch being started or stopped belongs to a total record</li>
<li>Set Variable [ $$folderon; Value:brainstate::groupID ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ brainstate::sortRetired &ne; "" ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "This record is currently retired.  To make it active again, click on the r to the immediate left of the record title (if the edit controls are hidden, then first click the edit button (top left corner of this window)."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ brainstate::description = "" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#1 if the view button is showing: determine if the record is total record, and it is show the these linked records, unless the user is on the total record layout in which case halt the script.  (From the user's point of view the stopwatch button will say 'view' instead of 'note' if it is a total record, and this part of the script will be activitated.) </li>
<li>If [ brainstate::_lockBrainstateID = brainstate::groupID or brainstate::_lockBrainstateID = brainstate::groupOfGroupID ]</li>
<li>If [ Left ( Get ( LayoutName ) ; 5 ) = "total" or Left ( Get ( LayoutName ) ; 5 )  =  "grand" ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Set Variable [ $$record; Value:1 ]</li>
<li>Perform Script [ &ldquo;showLinkedRecords&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#1 If there is no day record create a new one.</li>
<li>If [ day1::swSymbols = "" ]</li>
<li>Set Variable [ $$stopwatchON; Value:"t" ]</li>
<li>Set Variable [ $$newTimer; Value:1 ]</li>
<li>#</li>
<li>#1 capture record number user is currently on</li>
<li>Set Variable [ $record; Value:Get ( RecordNumber ) ]</li>
<li>#2 if not create a new one for this brainstate record and do it a new window so the user's focus is maintained (just going to the day layout and back resest the scroll bar unfortunately and I can't find away around this, but I want too!)</li>
<li>#</li>
<li>Set Variable [ $kpnBrainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>Go to Layout [ &ldquo;calcDayTable&rdquo; (day1) ]</li>
<li>New Record/Request</li>
<li>Set Field [ day1::_keyBrainstate; $kpnBrainstateID ]</li>
<li>Set Field [ day1::_keyUser; $userID ]</li>
<li>Set Field [ day1::_keyDay; reference::day1 ]</li>
<li>#</li>
<li>#3 start the timer by inserting the current time in the start field</li>
<li>Set Field [ day1::swStart; Get ( CurrentTimeStamp ) ]</li>
<li>#</li>
<li>#This step sets a flag for the updateTime </li>
<li>#script telling it to ignore this stopwatches </li>
<li>#time for updates to total records because </li>
<li>#until it is stopped its time has not changed </li>
<li>#and does not need to be included in an update.</li>
<li>Set Field [ day1::updateTimeSymbol; day1::swSymbols ]</li>
<li>Set Field [ day1::updateTime; day1::updateTimeCurrentTimeCalc ]</li>
<li>Go to Layout [ original layout ]</li>
<li>Go to Record/Request/Page [ $record ]
[ No dialog ]</li>
<li>Perform Script [ &ldquo;CHUNK_lastDayUsed&rdquo; ]</li>
<li>#</li>
<li>#</li>
<li>#Now find the new log record for this timer.</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>Go to Layout [ &ldquo;logs2rows&rdquo; (logs) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ logs::_keyBrainstate; $$logBrainstate ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Sort, turn on load record script to set Day </li>
<li>#record's variables, and go to first record.</li>
<li>Sort Records [ Specified Sort Order: logs::_keyBrainstate; descending
logs::_keyDay; descending ]
[ Restore; No dialog ]</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>#</li>
<li>Select Window [ Name: "Timer"; Current file ]</li>
<li>Set Variable [ $$newTimer ]</li>
<li>#</li>
<li>#NOTE: The folder or parent and child timer</li>
<li>#scripts and layouts are currently not is use in </li>
<li>#favor of tracking such parent-child information</li>
<li>#in the Specific Action module.  </li>
<li>//  #4 check if the record belongs to a total </li>
<li>//  #record and modify its foldercheck field if so </li>
<li>//  #to inform user on main screen that a </li>
<li>//  #stopwatch may be activite that is not currently shown.</li>
<li>//  Perform Script [ &ldquo;folderStopwatchCheck&rdquo; ]</li>
<li>#</li>
<li>#4 sort the records if the current sort is based </li>
<li>#on time which will make this record with zero </li>
<li>#current time shoot to the top or bottom of the </li>
<li>#list depending on how the user is currently </li>
<li>#shorting time.  The point is to keep the focus </li>
<li>#where the user expects it to be so the sort, </li>
<li>#which removes the focus from the current </li>
<li>#record is only done if the user wants the </li>
<li>#records sorted by time, in which case after </li>
<li>#the sort the focus is returned to the first record.</li>
<li>Perform Script [ &ldquo;DaySelectSortThenSort&rdquo; ]</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#5 if the veto button is showing stop the </li>
<li>#stopwatch and put in the in the time stopped.</li>
<li>If [ day1::swSymbols  = "veto" ]</li>
<li>Set Variable [ $$stopwatchON; Value:"f" ]</li>
<li>Set Field [ day1::swPause[day1::swOccurances]; Get ( CurrentTimeStamp ) ]</li>
<li>Set Variable [ $$TimeAssignedToSpecificAction; Value:issue::_LockList ]</li>
<li>#</li>
<li>#5 recalculate the time for this record and </li>
<li>#check and see if is linked to any total records </li>
<li>#and if so update their time too.</li>
<li>Perform Script [ &ldquo;updateTime&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#6 if the note button is showing restart the </li>
<li>#timer by putting  a new start time in next </li>
<li>#available start field for this day record.</li>
<li>Set Variable [ $$stopwatchON; Value:"t" ]</li>
<li>Set Field [ day1::swStart[day1::swOccurances + 1]; Get ( CurrentTimeStamp ) ]</li>
<li>If [ day1::swOccurances = 29 ]</li>
<li>Set Field [ day1::swStart[29]; Get ( CurrentTimeStamp ) ]</li>
<li>End If</li>
<li>#</li>
<li>#7 recalculate the pause between stop and </li>
<li>#start times to show user the amount of time </li>
<li>#that has passed since the last time this </li>
<li>#brainstate was active.</li>
<li>Perform Script [ &ldquo;updatePauseTotals&rdquo; ]</li>
<li>#</li>
<li>#This sets a flag for the updateTime script </li>
<li>#telling it to ignore this stopwatches time for </li>
<li>#updates to total records because until it is </li>
<li>#stopped its time has not changed and does </li>
<li>#not need to be included in an update.</li>
<li>Set Field [ day1::updateTimeSymbol; day1::swSymbols ]</li>
<li>Set Field [ day1::updateTime; day1::updateTimeCurrentTimeCalc ]</li>
<li>#</li>
<li>#NOTE: The folder or parent and child timer</li>
<li>#scripts and layouts are currently not is use in </li>
<li>#favor of tracking such parent-child information</li>
<li>#in the Specific Action module.  </li>
<li>//  #4 check if the record belongs to a total </li>
<li>//  #record and modify its foldercheck field if so </li>
<li>//  #to inform user on main screen that a </li>
<li>//  #stopwatch may be activite that is not currently shown.</li>
<li>//  Perform Script [ &ldquo;folderStopwatchCheck&rdquo; ]</li>
<li>#</li>
<li>#Go back to original record number so sort script</li>
<li>#gets ID number.  (It would be better to fix sort</li>
<li>#script so it exits rather than halts all scripts.)</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Perform Script [ &ldquo;DaySelectSortThenSort&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>brainstate</em>::sortRetired</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>brainstate</em>::groupOfGroupID</li>
<li>
<em>day1</em>::swSymbols</li>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>day1</em>::_keyBrainstate</li>
<li>
<em>day1</em>::_keyUser</li>
<li>
<em>reference</em>::day1</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>day1</em>::swStart</li>
<li>
<em>day1</em>::updateTimeSymbol</li>
<li>
<em>day1</em>::updateTimeCurrentTimeCalc</li>
<li>
<em>day1</em>::updateTime</li>
<li>
<em>logs</em>::_keyBrainstate</li>
<li>
<em>logs</em>::_keyDay</li>
<li>
<em>day1</em>::swPause</li>
<li>
<em>day1</em>::swOccurances</li>
<li>
<em>issue</em>::_LockList</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32811ScriptAnchor_">showLinkedRecords</a></li>
<li><a href="#33053ScriptAnchor_">CHUNK_lastDayUsed</a></li>
<li><a href="#33027ScriptAnchor_">folderStopwatchCheck</a></li>
<li><a href="#32902ScriptAnchor_">DaySelectSortThenSort</a></li>
<li><a href="#32829ScriptAnchor_">updateTime</a></li>
<li><a href="#117ScriptAnchor_">updatePauseTotals</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>calcDayTable</li>
<li>logs2rows</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33047ScriptAnchor_"></a><td class="script_navbar"><a href="#102ScriptAnchor_"><span>Previous Script: [note veto view]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#33010ScriptAnchor_"><span>Next Script: [timerCloseWindow]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">note veto view (old: opened things in new windows)</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE merge selected record's time data into one total record and then link these records so that time added in the future to any of the merge records will be automatically added to the one total record.</li>
<li>#</li>
<li>#</li>
<li>#BUG remove focus from any fields.   This step seems to be neccessary as I periodically have been getting a -- this record is being modified in a separate window -- message.  I'm leaving this step in to see if I stop getting this message.</li>
<li>Set Variable [ $recordNumber; Value:Get ( RecordNumber ) ]</li>
<li>Go to Field [  ]</li>
<li>Go to Record/Request/Page [ $recordNumber ]
[ No dialog ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ brainstate::sortRetired &ne; "" ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "This record is currently retired.  To make it active again, click on the r to the immediate left of the record title (if the edit controls are hidden, then first click the edit button (top left corner of this window)."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#1 if the view button is showing: determine if the record is total record, and it is show the these linked records, unless the user is on the total record layout in which case halt the script.  (From the user's point of view the stopwatch button will say 'view' instead of 'note' if it is a total record, and this part of the script will be activitated.) </li>
<li>If [ brainstate::_lockBrainstateID = brainstate::groupID or brainstate::_lockBrainstateID = brainstate::groupOfGroupID ]</li>
<li>If [ Left ( Get ( LayoutName ) ; 5 ) = "total" or Left ( Get ( LayoutName ) ; 5 )  =  "grand" ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Perform Script [ &ldquo;showLinkedRecords&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#1 if the note button is showing first determine if there is a day record to update</li>
<li>If [ day1::swSymbols = "" ]</li>
<li>#</li>
<li>#2 if not create a new one for this brainstate record and do it a new window so the user's focus is maintained (just going to the day layout and back resest the scroll bar unfortunately and I can't find away around this, but I want too!)</li>
<li>Set Variable [ $kpnBrainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>New Window [ Name: "!"; Height: 100; Width: 100 ]</li>
<li>Adjust Window
[ Hide ]</li>
<li>Go to Layout [ &ldquo;calcDayTable&rdquo; (day1) ]</li>
<li>New Record/Request</li>
<li>Set Field [ day1::_keyBrainstate; $kpnBrainstateID ]</li>
<li>Set Field [ day1::_keyUser; $userID ]</li>
<li>Set Field [ day1::_keyDay; reference::day1 ]</li>
<li>#</li>
<li>#3 start the timer by inserting the current time in the start field</li>
<li>Set Field [ day1::swStart; Get ( CurrentTimeStamp ) ]</li>
<li>Close Window [ Name: "!"; Current file ]</li>
<li>Go to Layout [ original layout ]</li>
<li>#</li>
<li>#4 sort the records if the current sort is based on time which will make this record with zero current time shoot the top or bottom of the list depending on how the user is currently shorting time.  The point is to keep the focus where the user expects it to be so the sort, which removes the focus from the current record is only done if the user wants the records sorted by time, in which case after the sort the focus is returned to the first record.</li>
<li>Perform Script [ &ldquo;DaySelectSortThenSort&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#5 if the veto button is showing stop the stopwatch and put in the in the time stopped</li>
<li>If [ day1::swSymbols  = "veto" ]</li>
<li>Set Field [ day1::swPause[day1::swOccurances]; Get ( CurrentTimeStamp ) ]</li>
<li>#</li>
<li>#5 recalculate the time for this record and check and see if is linked to any total records and if so update their time too</li>
<li>Perform Script [ &ldquo;updateTime&rdquo; ]</li>
<li>Perform Script [ &ldquo;DaySelectSortThenSort&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#6 if the note button is showing restart the timer by putting  a new start time in next available start field for this day record</li>
<li>Set Field [ day1::swStart[day1::swOccurances + 1]; Get ( CurrentTimeStamp ) ]</li>
<li>If [ day1::swOccurances = 29 ]</li>
<li>Set Field [ day1::swStart[29]; Get ( CurrentTimeStamp ) ]</li>
<li>End If</li>
<li>#</li>
<li>#7 recalculate the pause between stop and start times to show user the amount of time that has passed since the last time this brainstate was active</li>
<li>Perform Script [ &ldquo;updatePauseTotals&rdquo; ]</li>
<li>Perform Script [ &ldquo;DaySelectSortThenSort&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::sortRetired</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>brainstate</em>::groupOfGroupID</li>
<li>
<em>day1</em>::swSymbols</li>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>day1</em>::_keyBrainstate</li>
<li>
<em>day1</em>::_keyUser</li>
<li>
<em>reference</em>::day1</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>day1</em>::swStart</li>
<li>
<em>day1</em>::swPause</li>
<li>
<em>day1</em>::swOccurances</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32811ScriptAnchor_">showLinkedRecords</a></li>
<li><a href="#32902ScriptAnchor_">DaySelectSortThenSort</a></li>
<li><a href="#32829ScriptAnchor_">updateTime</a></li>
<li><a href="#117ScriptAnchor_">updatePauseTotals</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>calcDayTable</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33010ScriptAnchor_"></a><td class="script_navbar"><a href="#33047ScriptAnchor_"><span>Previous Script: [note veto view (old: opened things in new windows)]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#32829ScriptAnchor_"><span>Next Script: [updateTime]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">timerCloseWindow</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE return user to previous layout and end the script which is done in the button setup by selecting the 'halt script' option.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Go to Layout [ $$alarmLayout ]</li>
<li>Set Variable [ $$alarmLayout ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32829ScriptAnchor_"></a><td class="script_navbar"><a href="#33010ScriptAnchor_"><span>Previous Script: [timerCloseWindow]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#33055ScriptAnchor_"><span>Next Script: [daysSinceLastUseToggle]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">updateTime</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#102ScriptAnchor_">note veto view</a></li>
<li><a href="#33047ScriptAnchor_">note veto view (old: opened things in new windows)</a></li>
<li><a href="#33058ScriptAnchor_">clearPart2</a></li>
<li><a href="#33049ScriptAnchor_">clear (old: opens windows to perform)</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE update the time paused fields and the total and grand total fields after a user leaves a time field or clicks the veto button.  They may or may not have done anything, but in case they did this update is performed.</li>
<li>#</li>
<li>#If user just clicked into the time field and the clicked</li>
<li>#out without doing anything then stop this script as</li>
<li>#there is not time change to update.</li>
<li>#NEED TO STOP $$FIELDVALUE GETTING CREATED WHEN STOPWATCH BUTTON IS CLICKED, THEN THIS SCRIPT STEP SHOULD WORK.</li>
<li>#SAME TIME INCLUDE VARIABLE TO STOP UPDATE OF ISSUE TIME!</li>
<li>//  If [ $$fieldValue = Get (ActiveFieldContents) ]</li>
<li>//  Exit Script [  ]</li>
<li>//  End If</li>
<li>#</li>
<li>#If user clicked the clear button but was in a field</li>
<li>#the clearPart1 script when it exits this field will</li>
<li>#trigger this script, which must be exited for the </li>
<li>#clearPart1 script to continue.</li>
<li>If [ $$warning &ne; "" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>If [ $$iphoneStop &ne; "" ]</li>
<li>Set Variable [ $$iphoneStop ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>#</li>
<li>#</li>
<li>#when the user is in the time edit window we want to</li>
<li>#use the recordnumber variable to focus on record in</li>
<li>#in use on this window.  But when user goes from this</li>
<li>#edit window to the main window we want the sort script</li>
<li>#to find the record to focus by looping through each record's</li>
<li>#ID number until the correct record is found.</li>
<li>If [ $$sortstatus &ne; "" ]</li>
<li>Set Variable [ $$recordnumber; Value:Get (RecordNumber) ]</li>
<li>End If</li>
<li>#</li>
<li>#NOTE: the three # symbols set apart chunks of script.  </li>
<li>#NOTE: the finish and error script chunks are almost identical (the error message differ in telling where in the script they occur).  For this reason, they are not numbered as part of a particular chuck of the script, and are separated by three # symbols to set them apart.</li>
<li>#</li>
<li>Freeze Window</li>
<li>#If the user enters a time field but makes no changes prevent the script from continuing if on the iphone.  Do not do this for the PC as the user could have dragged the time into another stopwatch, thus requring the script to udate this stopwatch's values. </li>
<li>If [ Get ( SystemPlatform ) = 3  and Get ( ActiveFieldContents ) = $$fieldValue and $$fieldValue &ne; "" ]</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$fieldValue ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>#If the user has deleted time in a time slot,</li>
<li>#check if this slot has been assigned</li>
<li>#to a specific action, and if so, remove its key</li>
<li>#from this specific action, and also show it as</li>
<li>#available to be assigned to any specific action.</li>
<li>Set Variable [ $RepetitionNumber; Value:Get ( ActiveRepetitionNumber ) ]</li>
<li>Set Variable [ $time; Value:$RepetitionNumber &amp; day1::_lockDay ]</li>
<li>Set Variable [ $day; Value:day1::_lockDay ]</li>
<li>Go to Field [  ]</li>
<li>If [ day1::swStart[$repetitionNumber] = "" and day1::swPause[$repetitionNumber] = "" ]</li>
<li>#</li>
<li>#If user deleted all time for the day then</li>
<li>#prepare to remove the link to this day record.  </li>
<li>If [ day1::_lockDay &ne; "" and day1::swTotalActivity = "" ]</li>
<li>Set Variable [ $removeDayLink; Value:1 ]</li>
<li>End If</li>
<li>#</li>
<li>#Subtract segment key from specific action record.</li>
<li>New Window [ Height: 1; Width: 1; Top: -10000; Left: -10000 ]</li>
<li>Go to Layout [ &ldquo;Issues&rdquo; (issue) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::timeSegmentKeyList; $time ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $$timeAll; Value:issue::timeSegmentKeyList ]</li>
<li>Set Field [ issue::timeSegmentKeyList; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

If ( ValueCount ( $$timeAll ) &ne; ValueCount ( Substitute ( $$timeAll ; $time &amp; "&para;"  ; "" ) ) ; 

Substitute ( $$timeAll ; $time &amp; "&para;"  ; "" ) ; 

Substitute ( $$timeAll ; $time ; "" ) 

) ]</li>
<li>Set Variable [ $$timeAll; Value:issue::timeSegmentKeyList ]</li>
<li>Set Field [ day1::swLogTimeAccounting[$RepetitionNumber]; "" ]</li>
<li>#</li>
<li>#Remove link to day log from this issue record </li>
<li>#if day record is being deleted.</li>
<li>If [ $removeDayLink = 1 ]</li>
<li>Set Field [ issue::_keyLogs; If ( ValueCount ( issue::_keyLogs ) &ne; ValueCount ( Substitute ( issue::_keyLogs ; $day &amp; "&para;"  ; "" ) ) ; 

Substitute ( issue::_keyLogs ; $day &amp; "&para;"  ; "" ) ; 

Substitute ( issue::_keyLogs ; $day ; "" ) ) ]</li>
<li>End If</li>
<li>#</li>
<li>#See if time segment is already in use by this time segment.</li>
<li>Go to Layout [ &ldquo;issueTime&rdquo; (issueTime) ]</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issueTime::_keyDay; $day ]</li>
<li>Set Field [ issueTime::_keyRepetition; $RepetitionNumber ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If it is in use then delete it from this segment.</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>#</li>
<li>Close Window [ Current Window ]</li>
<li>#</li>
<li>#Make re-assignable.</li>
<li>Set Field [ issue::issueTotalTime; $totalTime ]</li>
<li>#</li>
<li>#Conditionally formats text of issue field Timer Green for on.</li>
<li>Set Variable [ $$TimeAssignedToSpecificAction ]</li>
<li>#</li>
<li>#Conditionally formats Day Time Segment Timer Green for on.</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>Set Variable [ $$ActiveTimeSegment ]</li>
<li>Set Variable [ $$day1BugField ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Timer"; Current file ]</li>
<li>End If</li>
<li>Set Variable [ $RepetitionNumber ]</li>
<li>#</li>
<li>#</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>Set Variable [ $mergeID; Value:brainstate::groupID ]</li>
<li>Set Variable [ $mergeGrandID; Value:brainstate::groupOfGroupID ]</li>
<li>Set Variable [ $layout; Value:Get ( LayoutName ) ]</li>
<li>Set Variable [ $record; Value:Get (RecordNumber) ]</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $$recordFIXTOMANYVARIABLES; Value:brainstate::_lockBrainstateID ]</li>
<li>//  #needed by folderstopwatchcheck script in case the stopwatch being started or stopped belongs to a total record</li>
<li>//  Set Variable [ $$folderon; Value:brainstate::groupID ]</li>
<li>//  If [ day1::swSymbols = "veto" ]</li>
<li>//  Set Variable [ $$stopwatchON; Value:"t" ]</li>
<li>//  Set Variable [ $$onoff; Value:"" ]</li>
<li>//  Else If [ day1::swSymbols = "note" or $$onoff = "note" ]</li>
<li>//  Set Variable [ $$stopwatchON; Value:"f" ]</li>
<li>//  Set Variable [ $$onoff; Value:"" ]</li>
<li>//  End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#A) BEGIN go to a new window and hide it to preserve focus in user's current window while peforming this script, and to hide the strobe effect of the window while performing the script.
</li>
<li>#</li>
<li>#1 exit field the user is in so that they are returned to a clean layout when done</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>//  #2 open a new window and hide it</li>
<li>//  New Window [ Name: "UpateTime"; Height: 100; Width: 100 ]</li>
<li>//  Adjust Window
[ Hide ]</li>
<li>#</li>
<li>#3 go to the first record</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>If [ day1::_lockDay  =  "" and brainstate::_lockBrainstateID &ne; brainstate::groupID ]</li>
<li>Omit Record</li>
<li>Else If [ day1::_lockDay &ne;  ""  or  brainstate::_lockBrainstateID  =  brainstate::groupID ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End If</li>
<li>End Loop</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#A) END go to a new window and hide it to preserve focus in user's current window while peforming this script, and to hide the strobe effect of the window while performing the script.
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#B) BEGIN if the user deleted all time, then delete the related day record.  (The user may decide they want to begin this timer again, but if they don't a blank day record will exist which causes conditional formatting issues on the layouts.)</li>
<li>#</li>
<li>#1 get the day records ID number</li>
<li>If [ day1::_lockDay &ne; "" and day1::swTotalActivity = "" ]</li>
<li>Set Variable [ $DayID; Value:day1::_lockDay ]</li>
<li>#needed by folderstopwatchcheck script</li>
<li>Set Variable [ $$stopwatchON; Value:"f" ]</li>
<li>#</li>
<li>#2 tag the main record as updated so any total and grand totals it is a part of get updated too</li>
<li>Set Field [ brainstate::groupUpdate; If ( brainstate::groupID &ne; "" ; "u" ; "" ) ]</li>
<li>Set Field [ brainstate::groupOfGroupUpdate; If ( brainstate::groupOfGroupID &ne; "" ; "u" ; "" ) ]</li>
<li>#</li>
<li>#3 find the day record and delete it.</li>
<li>Go to Layout [ &ldquo;calcDayTable&rdquo; (day1) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ day1::_lockDay; $DayID ]</li>
<li>Perform Find [  ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>#</li>
<li>#4 Load updated variables in both Day and </li>
<li>#Specific Action windows and refresh them to </li>
<li>#trigger current conditional formatting for </li>
<li>#selected records.</li>
<li>Set Variable [ $refreshDayCurrentWindow; Value:Get ( WindowName ) ]</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
<li>Set Variable [ $$logissues; Value:logs::_keyLogIssues ]</li>
<li>Set Variable [ $$log; Value:logs::_lockDay ]</li>
<li>Set Variable [ $$day1BugField; Value:logs::swBugField ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>Set Variable [ $$issueLogs; Value:issue::_keyLogs ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: $refreshDayCurrentWindow; Current file ]</li>
<li>#</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>End If</li>
<li>#</li>
<li>#B) END if the user deleted all time, then delete the related day record.  (The user may decide they want to begin this timer again, but if they don't a blank day record will exist which causes conditional formatting issues on the layouts.)</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#C) START skip the records that have not been changed.  </li>
<li>#</li>
<li>#1 compare the record's total time against the last </li>
<li>#update time recorded, and if they are the same go </li>
<li>#to the next record. </li>
<li>#
</li>
<li>#The updatetime field is populated by this script as a </li>
<li>#way of flagging when a record has been updated by </li>
<li>#this script.  </li>
<li>#

</li>
<li>#User may have used the drag feature to change </li>
<li>#multiple records and the only way to know what has </li>
<li>#been changed is to compare these time fields.
</li>
<li>//  If [ day1::updateTime  &ne;  day1::updateTimeCurrentTimeCalc and day1::swBugField = "note" ]</li>
<li>If [ day1::swSymbols  &ne;  day1::updateTimeSymbol  or  day1::updateTime  &ne;  day1::updateTimeCurrentTimeCalc ]</li>
<li>#</li>
<li>#2 if the record is a total or grand total record, go to the next record (these will be updated later in the script).</li>
<li>If [ brainstate::groupID  &ne;  brainstate::_lockBrainstateID ]</li>
<li>#</li>
<li>#C) END skip the records that have not been changed.  </li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#D) BEGIN update changed record's flags</li>
<li>#</li>
<li>#1 equalize these two times, thus unflagging this record as needing updating.</li>
<li>Set Field [ day1::updateTime; day1::updateTimeCurrentTimeCalc ]</li>
<li>#</li>
<li>#2 flag this record as changed if it belongs to a total record, so later in this script that record's time can be updated</li>
<li>Set Field [ brainstate::groupUpdate; If ( brainstate::groupID &ne; "" ; "u" ; "" ) ]</li>
<li>#</li>
<li>#D) END update changed record's flags</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#E) BEGIN update the pause time fields</li>
<li>#</li>
<li>#This script step has been removed.  Initially, I thought since most records only have one time event to skip the update pause step for these records.  However, in testing I found that when a timer is started for a second time event a pause time is calculated resulting in a gray bar in the bar chart.  If the user then deletes this second start time, this now disabled script stops that bar from being removed because when this script gets to this step the field is blank and so no calculation is done.  I decided to leave this failure in just in case I forgot why this doesn't work, try it again, and fail to not perform the correct test, which I did until by accident noticed something wrong!  
</li>
<li>//  #1 if there is only one time, skip the following steps to recalculate the time paused between more than one time.
</li>
<li>//  If [ day1::swActivityLength[2] &ne; "" ]</li>
<li>#</li>
<li>#1 clear all PauseTotal fields, which is necessary because a user may have reduced the number of activity times, thus reducing the number of pauses.  NOTE: pause field repetition 1 is never used as their is no pause between time zero and the first time.
</li>
<li>Set Variable [ $repetition; Value:2 ]</li>
<li>Loop</li>
<li>Set Field [ day1::swPauseLength[$repetition]; Get ( CurrentTime ) ]</li>
<li>Clear [ day1::swPauseLength[$repetition] ]
[ Select ]</li>
<li>Set Variable [ $repetition; Value:$repetition+1 ]</li>
<li>Exit Loop If [ $repetition = 31 ]</li>
<li>End Loop</li>
<li>#</li>
<li>#2 calculate all pause times between activity times.  This step is stopped when the next time to calculate a pause between is blank or when this loop has reached the last repitition (this test is neccessary because there are only 30 repetitions, so there will not be a blank 31 to detect, thus reaching 31 has to trigger  a stop).
</li>
<li>Set Variable [ $repetition; Value:2 ]</li>
<li>Loop</li>
<li>Set Field [ day1::swPauseLength[$repetition]; day1::swStart[$repetition] - day1::swPause[$repetition-1] ]</li>
<li>Set Variable [ $repetition; Value:$repetition+1 ]</li>
<li>Exit Loop If [ day1::swStart[$repetition] = "" ]</li>
<li>Exit Loop If [ $repetition = 31 ]</li>
<li>End Loop</li>
<li>#</li>
<li>#E) END update the pause time fields</li>
<li>#</li>
<li>#</li>
<li>#E2) UPDATE the time in any dependent issues.</li>
<li>If [ $$stopCHUNK_updateIssueCategoryTime &ne; 1 ]</li>
<li>Set Variable [ $$updateDay; Value:day1::_lockDay ]</li>
<li>Perform Script [ &ldquo;CHUNK_updateIssueCategoryTime&rdquo; ]</li>
<li>Set Variable [ $$updateDay ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>Set Variable [ $$stopCHUNK_updateIssueCategoryTime ]</li>
<li>#</li>
<li>#</li>
<li>#F) BEGIN go to next record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#F) END go to next record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#G) BEGIN find all user total records that need to be udated</li>
<li>#</li>
<li>#1 find records</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $user ]</li>
<li>Set Field [ brainstate::groupUpdate; "u" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#2 if no records are found go to step</li>
<li>Exit Loop If [ Get ( LastError )  = 401 ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN error 1</li>
<li>If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming CheckUpdateTime step G1."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Go to Record/Request/Page [ $record ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#END error 1</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#G) END find all user total records that need to be udated</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#H) BEGIN update found record</li>
<li>#</li>
<li>#1 unflag this total record for total update</li>
<li>Clear [ brainstate::groupUpdate ]
[ Select ]</li>
<li>#</li>
<li>#1b set variables so total record's conditional formatting will match that of the stopwatch being updated.</li>
<li>If [ day1::swSymbols  &ne;  day1::updateTimeSymbol or $$onoff = "note" ]</li>
<li>Set Variable [ $$folderon; Value:brainstate::groupID ]</li>
<li>If [ day1::swSymbols = "veto" ]</li>
<li>Set Variable [ $$stopwatchON; Value:"t" ]</li>
<li>Set Variable [ $$onoff; Value:"" ]</li>
<li>Else If [ day1::swSymbols = "note" or $$onoff = "note" ]</li>
<li>Set Variable [ $$stopwatchON; Value:"f" ]</li>
<li>Set Variable [ $$onoff; Value:"" ]</li>
<li>End If</li>
<li>End If</li>
<li>Set Field [ day1::updateTimeSymbol; day1::swSymbols ]</li>
<li>#</li>
<li>#2 find its linked records

</li>
<li>Set Variable [ $mergeto; Value:brainstate::groupID ]</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupID; $mergeto ]</li>
<li>//  Set Field [ brainstate::sortRetired; "=" ]</li>
<li>Perform Find [  ]</li>
<li>Perform Script [ &ldquo;folderStopwatchCheck&rdquo; ]</li>
<li>#3 go to the first record</li>
<li>Loop</li>
<li>If [ day1::swStart = "" and brainstate::_lockBrainstateID &ne; brainstate::groupID ]</li>
<li>Omit Record</li>
<li>Else If [ day1::swStart  &ne;  ""  or  brainstate::_lockBrainstateID  =  brainstate::groupID ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End If</li>
<li>End Loop</li>
<li>#</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupType; based on value list: &ldquo;MergeSort&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#3 flag for grand total update</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Field [ brainstate::groupOfGroupUpdate; If ( brainstate::groupOfGroupID &ne; "" ; "u" ; "" ) ]</li>
<li>#</li>
<li>#4 if linked records are found, first reset the total record's time to zero in case the amount of time has decreased (essentially by deleting its current day record and creating a new blank one).
</li>
<li>If [ day1::_keyDay = "" ]</li>
<li>Set Variable [ $BrainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Go to Layout [ &ldquo;calcDayTable&rdquo; (day1) ]</li>
<li>New Record/Request</li>
<li>Set Field [ day1::_keyBrainstate; $BrainstateID ]</li>
<li>Insert Calculated Result [ day1::_keyDay; reference::day1 ]
[ Select ]</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>End If</li>
<li>Set Field [ day1::swStart; day1::_keyDay &amp; " 0:00:00" ]</li>
<li>Set Field [ day1::swPause; day1::_keyDay &amp; " 0:00:00" ]</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#5 go to the last record


</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>#</li>
<li>#6 if there are no records to add then delete the just created related day record for this total record (this action would be caused by the user deleting all the time in the linked records).
</li>
<li>If [ brainstate::_lockBrainstateID = brainstate::groupID ]</li>
<li>If [ day1::swTotalActivity = "0:00:00" ]</li>
<li>Set Variable [ $dayID; Value:day1::_lockDay ]</li>
<li>Go to Layout [ &ldquo;calcDayTable&rdquo; (day1) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ day1::_lockDay; $dayID ]</li>
<li>Perform Find [  ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>End If</li>
<li>#</li>
<li>#7 go the next part of the script once there are no more records to add

</li>
<li>Exit Loop If [ brainstate::_lockBrainstateID = brainstate::groupID ]</li>
<li>#</li>
<li>#8 if there is a record to add capture its total time, omit it, go the first record and add this time to current total time.


</li>
<li>Else If [ day1::_keyDay = "" ]</li>
<li>Omit Record</li>
<li>Else If [ day1::_keyDay &ne; "" ]</li>
<li>Set Variable [ $TotalActivity; Value:day1::swTotalActivity ]</li>
<li>Omit Record</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Insert Calculated Result [ day1::swPause; Case ( 

$TotalActivity +  day1::swTotalActivity    &gt;   Time ( 23 ; 59 ; 59 )  ; day1::_keyDay &amp;  " 24:00:00" ; 

$TotalActivity +  day1::swTotalActivity    &lt;   Time ( 0 ; 0 ; 0 )  ; day1::_keyDay &amp;  " 00:00:00" ; 

day1::_keyDay &amp; " "  &amp; ($TotalActivity +  day1::swTotalActivity)  )

//insures that no more than 24 hours will be put into a day and that a day with negative time does not cause an error. ]
[ Select ]</li>
<li>End If</li>
<li>End Loop</li>
<li>#</li>
<li>#H) END update found record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#I) BEGIN find all user GRAND total records that need to be udated</li>
<li>#</li>
<li>#1 find records</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $user ]</li>
<li>Set Field [ brainstate::groupOfGroupUpdate; "u" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#2 if no records are found go to step</li>
<li>Exit Loop If [ Get ( LastError )  = 401 ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN error 1</li>
<li>If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming CheckUpdateTime step i1."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>//  Close Window [ Name: "UpateTime"; Current file ]</li>
<li>Go to Record/Request/Page [ $record ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#END error 1</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#I) END find all user total records that need to be udated</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#J) BEGIN update found record</li>
<li>#</li>
<li>#1 unflag this total record for grand total update</li>
<li>Clear [ brainstate::groupOfGroupUpdate ]
[ Select ]</li>
<li>#</li>
<li>#2 find its linked records

</li>
<li>Set Variable [ $mergeto; Value:brainstate::groupOfGroupID ]</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupOfGroupID; $mergeto ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupType; based on value list: &ldquo;MergeSort&rdquo; ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#3 if linked records are found, first reset the total record's time to zero in case the amount of time has decreased (essentially by deleting its current day record and creating a new blank one).
</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>If [ day1::_keyDay = "" ]</li>
<li>Set Variable [ $BrainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Go to Layout [ &ldquo;calcDayTable&rdquo; (day1) ]</li>
<li>New Record/Request</li>
<li>Set Field [ day1::_keyBrainstate; $BrainstateID ]</li>
<li>Insert Calculated Result [ day1::_keyDay; reference::day1 ]
[ Select ]</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>End If</li>
<li>Set Field [ day1::swStart; day1::_keyDay &amp; " 0:00:00" ]</li>
<li>Set Field [ day1::swPause; day1::_keyDay &amp; " 0:00:00" ]</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#4 go to the last record


</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>#</li>
<li>#5 if there are no records to add then delete the just created related day record for this total record (this action would be caused by the user deleting all the time in the linked records).
</li>
<li>If [ brainstate::_lockBrainstateID = brainstate::groupOfGroupID ]</li>
<li>If [ day1::swTotalActivity = "0:00:00" ]</li>
<li>Set Variable [ $dayID; Value:day1::_lockDay ]</li>
<li>Go to Layout [ &ldquo;calcDayTable&rdquo; (day1) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ day1::_lockDay; $dayID ]</li>
<li>Perform Find [  ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>End If</li>
<li>#</li>
<li>#6 go the next part of the script once there are no more records to add

</li>
<li>Exit Loop If [ brainstate::_lockBrainstateID = brainstate::groupOfGroupID ]</li>
<li>#</li>
<li>#7 if there is a record to add capture its total time, omit it, go the first record and add this time to current total time.


</li>
<li>Else If [ day1::_keyDay = "" ]</li>
<li>Omit Record</li>
<li>Else If [ day1::_keyDay &ne; "" ]</li>
<li>Set Variable [ $TotalActivity; Value:day1::swTotalActivity ]</li>
<li>Omit Record</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Insert Calculated Result [ day1::swPause; Case ( 

$TotalActivity +  day1::swTotalActivity    &gt;   Time ( 23 ; 59 ; 59 )  ; day1::_keyDay &amp;  " 24:00:00" ; 

$TotalActivity +  day1::swTotalActivity    &lt;   Time ( 0 ; 0 ; 0 )  ; day1::_keyDay &amp;  " 00:00:00" ; 

day1::_keyDay &amp; " "  &amp; ($TotalActivity +  day1::swTotalActivity)  )

//insures that no more than 24 hours will be put into a day and that a day with negative time does not cause an error. ]
[ Select ]</li>
<li>End If</li>
<li>End Loop</li>
<li>End Loop</li>
<li>#</li>
<li>#J) END update found record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>End Loop</li>
<li>#</li>
<li>#Have to go back to orginal layout, otherwise Hide Window step causes the data to be delayed showing up after the next interation of the stopwatch script runs thru.  
</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_lockBrainstateID; $$record ]</li>
<li>Perform Find [  ]</li>
<li>Go to Layout [ $layout ]</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>If [ $mergeID &ne; "" and Left ( $layout ; 5 ) = "Total" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupID; $mergeID ]</li>
<li>Perform Find [  ]</li>
<li>Else If [ $mergeGrandID &ne; "" and Left ( $layout ; 5 ) = "Grand" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupOfGroupID; $mergeGrandID ]</li>
<li>Perform Find [  ]</li>
<li>Else If [  Left ( $layout ; 5 ) &ne; "Total" ]</li>
<li>Perform Script [ &ldquo;goBackButton_FindRecordsChunk&rdquo; ]</li>
<li>Perform Script [ &ldquo;CHUNK_lastDayUsed&rdquo; ]</li>
<li>//  Perform Script [ &ldquo;folderStopwatchCheck&rdquo; ]</li>
<li>Perform Script [ &ldquo;DaySelectSortThenSort&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::retiredStatus = "r" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>Perform Script [ &ldquo;CHUNK_lastDayUsed&rdquo; ]</li>
<li>//  Perform Script [ &ldquo;folderStopwatchCheck&rdquo; ]</li>
<li>Perform Script [ &ldquo;DaySelectSortThenSort&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>day1</em>::_lockDay</li>
<li>
<em>day1</em>::swStart</li>
<li>
<em>day1</em>::swPause</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>issue</em>::timeSegmentKeyList</li>
<li>
<em>day1</em>::swLogTimeAccounting</li>
<li>
<em>issue</em>::_keyLogs</li>
<li>
<em>issueTime</em>::_keyDay</li>
<li>
<em>issueTime</em>::_keyRepetition</li>
<li>
<em>issue</em>::issueTotalTime</li>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>brainstate</em>::groupOfGroupID</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>day1</em>::swSymbols</li>
<li>
<em>brainstate</em>::groupUpdate</li>
<li>
<em>brainstate</em>::groupOfGroupUpdate</li>
<li>
<em>logs</em>::_keyLogIssues</li>
<li>
<em>logs</em>::_lockDay</li>
<li>
<em>logs</em>::swBugField</li>
<li>
<em>day1</em>::updateTime</li>
<li>
<em>day1</em>::updateTimeCurrentTimeCalc</li>
<li>
<em>day1</em>::swBugField</li>
<li>
<em>day1</em>::updateTimeSymbol</li>
<li>
<em>day1</em>::swActivityLength</li>
<li>
<em>day1</em>::swPauseLength</li>
<li>
<em>brainstate</em>::_keyUser</li>
<li>
<em>brainstate</em>::sortRetired</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>day1</em>::_keyBrainstate</li>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::retiredStatus</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33138ScriptAnchor_">CHUNK_updateIssueCategoryTime</a></li>
<li><a href="#33027ScriptAnchor_">folderStopwatchCheck</a></li>
<li><a href="#33030ScriptAnchor_">goBackButton_FindRecordsChunk</a></li>
<li><a href="#33053ScriptAnchor_">CHUNK_lastDayUsed</a></li>
<li><a href="#32902ScriptAnchor_">DaySelectSortThenSort</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>Issues</li>
<li>issueTime</li>
<li>calcBrainstateTable</li>
<li>calcDayTable</li>
<li>&lt;Missing Layout&gt;</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33055ScriptAnchor_"></a><td class="script_navbar"><a href="#32829ScriptAnchor_"><span>Previous Script: [updateTime]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#33054ScriptAnchor_"><span>Next Script: [updateNumberOfDaysSince]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">daysSinceLastUseToggle</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ brainstate::DaysSinceLastUseToggle = "" ]</li>
<li>Set Field [ brainstate::DaysSinceLastUseToggle; "t" ]</li>
<li>Else If [ brainstate::DaysSinceLastUseToggle &ne; "" ]</li>
<li>Set Field [ brainstate::DaysSinceLastUseToggle; "" ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::DaysSinceLastUseToggle</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33054ScriptAnchor_"></a><td class="script_navbar"><a href="#33055ScriptAnchor_"><span>Previous Script: [daysSinceLastUseToggle]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#33053ScriptAnchor_"><span>Next Script: [CHUNK_lastDayUsed]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">updateNumberOfDaysSince</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Show All Records</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Perform Script [ &ldquo;CHUNK_lastDayUsed&rdquo; ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33053ScriptAnchor_">CHUNK_lastDayUsed</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33053ScriptAnchor_"></a><td class="script_navbar"><a href="#33054ScriptAnchor_"><span>Previous Script: [updateNumberOfDaysSince]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#33048ScriptAnchor_"><span>Next Script: [updateTime (old: opened things in new windows)]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNK_lastDayUsed</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#102ScriptAnchor_">note veto view</a></li>
<li><a href="#32829ScriptAnchor_">updateTime</a></li>
<li><a href="#33054ScriptAnchor_">updateNumberOfDaysSince</a></li>
<li><a href="#33058ScriptAnchor_">clearPart2</a></li>
<li><a href="#33219ScriptAnchor_">startTimerAssignTimeSegmentToSpecificAction</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go the selected farmer's records from the createEditFarmer layout.  (This is script is identical to the switchFarmer script except for step 1, which is required because the reference field is not available on this layout, and so the user's ID must be taken from the user table, not the reference table.)</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Set Variable [ $brainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Go to Layout [ &ldquo;logByDate&rdquo; (logs) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ logs::_keyBrainstate; $brainstateID ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get ( LastError ) = 401 ]</li>
<li>Go to Layout [ original layout ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Sort Records [ Specified Sort Order: logs::_keyDay; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Field [ brainstate::DateOfLastUse; logs::_keyDay ]</li>
<li>Set Variable [ $date; Value:logs::_keyDay ]</li>
<li>If [ brainstate::groupID &ne; "" ]</li>
<li>Set Variable [ $brainstateID; Value:brainstate::groupID ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ logs::_keyBrainstate; $brainstateID ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get ( LastError ) = 401 ]</li>
<li>Go to Layout [ original layout ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Sort Records [ Specified Sort Order: logs::_keyDay; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>If [ reference::day1 &ne; $date ]</li>
<li>Set Field [ brainstate::DateOfLastUse; logs::_keyDay ]</li>
<li>Else If [ reference::day1 = $date ]</li>
<li>Set Field [ brainstate::DateOfLastUse; $date ]</li>
<li>End If</li>
<li>End If</li>
<li>Go to Layout [ original layout ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>logs</em>::_keyBrainstate</li>
<li>
<em>logs</em>::_keyDay</li>
<li>
<em>brainstate</em>::DateOfLastUse</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>reference</em>::day1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>logByDate</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33048ScriptAnchor_"></a><td class="script_navbar"><a href="#33053ScriptAnchor_"><span>Previous Script: [CHUNK_lastDayUsed]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#117ScriptAnchor_"><span>Next Script: [updatePauseTotals]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">updateTime (old: opened things in new windows)</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE update the time paused fields and the total and grand total fields after a user leaves a time field or clicks the veto button.  They may or may not have done anything, but in case they did this update is performed.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#NOTE: the three # symbols set apart chunks of script.  </li>
<li>#NOTE: the finish and error script chunks are almost identical (the error message differ in telling where in the script they occur).  For this reason, they are not numbered as part of a particular chuck of the script, and are separated by three # symbols to set them apart.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#A) BEGIN go to a new window and hide it to preserve focus in user's current window while peforming this script, and to hide the strobe effect of the window while performing the script.
</li>
<li>#</li>
<li>#1 exit field the user is in so that they are returned to a clean layout when done</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#2 open a new window and hide it</li>
<li>New Window [ Name: "UpateTime"; Height: 100; Width: 100 ]</li>
<li>Adjust Window
[ Hide ]</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#3 go to the first record</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#A) END go to a new window and hide it to preserve focus in user's current window while peforming this script, and to hide the strobe effect of the window while performing the script.
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#B) BEGIN if the user deleted all time, then delete the related day record.  (The user may decide they want to begin this timer again, but if they don't a blank day record will exist which causes conditional formatting issues on the layouts.)</li>
<li>#</li>
<li>#1 get the day records ID number</li>
<li>If [ day1::_lockDay &ne; "" and day1::swTotalActivity = "" ]</li>
<li>Set Variable [ $DayID; Value:day1::_lockDay ]</li>
<li>#</li>
<li>#2 tag the main record as updated so any total and grand totals it is a part of get updated too</li>
<li>Set Field [ brainstate::groupUpdate; If ( brainstate::groupID &ne; "" ; "u" ; "" ) ]</li>
<li>Set Field [ brainstate::groupOfGroupUpdate; If ( brainstate::groupOfGroupID &ne; "" ; "u" ; "" ) ]</li>
<li>#</li>
<li>#3 find the day record ad delete it</li>
<li>Go to Layout [ &ldquo;calcDayTable&rdquo; (day1) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ day1::_lockDay; $DayID ]</li>
<li>Perform Find [  ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>End If</li>
<li>#</li>
<li>#B) END if the user deleted all time, then delete the related day record.  (The user may decide they want to begin this timer again, but if they don't a blank day record will exist which causes conditional formatting issues on the layouts.)</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#C) START skip the records that have not been changed.  </li>
<li>#</li>
<li>#1 compare the record's total time against the last update time recorded, and if they are the same go to the next record. 

The updatetime field is populated by this script as a way of flagging when a record has been updated by this script.  

User may have used the drag feature to change multiple records and the only way to know what has been changed is to compare these time fields.
</li>
<li>If [ day1::updateTime  &ne;  day1::updateTimeCurrentTimeCalc ]</li>
<li>#</li>
<li>#2 if the record is a total or grand total record, go to the next record (these will be updated later in the script).</li>
<li>If [ brainstate::groupID  &ne;  brainstate::_lockBrainstateID ]</li>
<li>#</li>
<li>#C) END skip the records that have not been changed.  </li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#D) BEGIN update changed record's flags</li>
<li>#</li>
<li>#1 equalize these two times, thus unflagging this record as needing updating.</li>
<li>Set Field [ day1::updateTime; day1::updateTimeCurrentTimeCalc ]</li>
<li>#</li>
<li>#2 flag this record as changed if it belongs to a total record, so later in this script that record's time can be updated</li>
<li>Set Field [ brainstate::groupUpdate; If ( brainstate::groupID &ne; "" ; "u" ; "" ) ]</li>
<li>#</li>
<li>#D) END update changed record's flags</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#E) BEGIN update the pause time fields</li>
<li>#</li>
<li>#This script step has been removed.  Initially, I thought since most records only have one time event to skip the update pause step for these records.  However, in testing I found that when a timer is started for a second time event a pause time is calculated resulting in a gray bar in the bar chart.  If the user then deletes this second start time, this now disabled script stops that bar from being removed because when this script gets to this step the field is blank and so no calculation is done.  I decided to leave this failure in just in case I forgot why this doesn't work, try it again, and fail to not perform the correct test, which I did until by accident noticed something wrong!  
</li>
<li>//  #1 if there is only one time, skip the following steps to recalculate the time paused between more than one time.
</li>
<li>//  If [ day1::swActivityLength[2] &ne; "" ]</li>
<li>#</li>
<li>#1 clear all PauseTotal fields, which is necessary because a user may have reduced the number of activity times, thus reducing the number of pauses.  NOTE: pause field repetition 1 is never used as their is no pause between time zero and the first time.
</li>
<li>Set Variable [ $repetition; Value:2 ]</li>
<li>Loop</li>
<li>Set Field [ day1::swPauseLength[$repetition]; Get ( CurrentTime ) ]</li>
<li>Clear [ day1::swPauseLength[$repetition] ]
[ Select ]</li>
<li>Set Variable [ $repetition; Value:$repetition+1 ]</li>
<li>Exit Loop If [ $repetition = 31 ]</li>
<li>End Loop</li>
<li>#</li>
<li>#2 calculate all pause times between activity times.  This step is stopped when the next time to calculate a pause between is blank or when this loop has reached the last repitition (this test is neccessary because there are only 30 repetitions, so there will not be a blank 31 to detect, thus reaching 31 has to trigger  a stop).
</li>
<li>Set Variable [ $repetition; Value:2 ]</li>
<li>Loop</li>
<li>Set Field [ day1::swPauseLength[$repetition]; day1::swStart[$repetition] - day1::swPause[$repetition-1] ]</li>
<li>Set Variable [ $repetition; Value:$repetition+1 ]</li>
<li>Exit Loop If [ day1::swStart[$repetition] = "" ]</li>
<li>Exit Loop If [ $repetition = 31 ]</li>
<li>End Loop</li>
<li>#</li>
<li>#E) END update the pause time fields</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#F) BEGIN go to next record</li>
<li>#</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#F) END go to next record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#G) BEGIN find all user total records that need to be udated</li>
<li>#</li>
<li>#1 find records</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $user ]</li>
<li>Set Field [ brainstate::groupUpdate; "u" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#2 if no records are found go to step</li>
<li>Exit Loop If [ Get ( LastError )  = 401 ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN error 1</li>
<li>If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming CheckUpdateTime step G1."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Close Window [ Name: "UpateTime"; Current file ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#END error 1</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#G) END find all user total records that need to be udated</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#H) BEGIN update found record</li>
<li>#</li>
<li>#1 unflag this total record for total update</li>
<li>Clear [ brainstate::groupUpdate ]
[ Select ]</li>
<li>#</li>
<li>#2 find its linked records

</li>
<li>Set Variable [ $mergeto; Value:brainstate::groupID ]</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupID; $mergeto ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupType; based on value list: &ldquo;MergeSort&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#3 flag for grand total update</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Field [ brainstate::groupOfGroupUpdate; If ( brainstate::groupOfGroupID &ne; "" ; "u" ; "" ) ]</li>
<li>#</li>
<li>#4 if linked records are found, first reset the total record's time to zero in case the amount of time has decreased (essentially by deleting its current day record and creating a new blank one).
</li>
<li>If [ day1::_keyDay = "" ]</li>
<li>Set Variable [ $BrainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Go to Layout [ &ldquo;calcDayTable&rdquo; (day1) ]</li>
<li>New Record/Request</li>
<li>Set Field [ day1::_keyBrainstate; $BrainstateID ]</li>
<li>Insert Calculated Result [ day1::_keyDay; reference::day1 ]
[ Select ]</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>End If</li>
<li>Set Field [ day1::swStart; day1::_keyDay &amp; " 0:00:00" ]</li>
<li>Set Field [ day1::swPause; day1::_keyDay &amp; " 0:00:00" ]</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#5 go to the last record


</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>#</li>
<li>#6 if there are no records to add then delete the just created related day record for this total record (this action would be caused by the user deleting all the time in the linked records).
</li>
<li>If [ brainstate::_lockBrainstateID = brainstate::groupID ]</li>
<li>If [ day1::swTotalActivity = "0:00:00" ]</li>
<li>Set Variable [ $dayID; Value:day1::_lockDay ]</li>
<li>Go to Layout [ &ldquo;calcDayTable&rdquo; (day1) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ day1::_lockDay; $dayID ]</li>
<li>Perform Find [  ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>End If</li>
<li>#</li>
<li>#7 go the next part of the script once there are no more records to add

</li>
<li>Exit Loop If [ brainstate::_lockBrainstateID = brainstate::groupID ]</li>
<li>#</li>
<li>#8 if there is a record to add capture its total time, omit it, go the first record and add this time to current total time.


</li>
<li>Else If [ day1::_keyDay = "" ]</li>
<li>Omit Record</li>
<li>Else If [ day1::_keyDay &ne; "" ]</li>
<li>Set Variable [ $TotalActivity; Value:day1::swTotalActivity ]</li>
<li>Omit Record</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Insert Calculated Result [ day1::swPause; Case ( 

$TotalActivity +  day1::swTotalActivity    &gt;   Time ( 23 ; 59 ; 59 )  ; day1::_keyDay &amp;  " 24:00:00" ; 

$TotalActivity +  day1::swTotalActivity    &lt;   Time ( 0 ; 0 ; 0 )  ; day1::_keyDay &amp;  " 00:00:00" ; 

day1::_keyDay &amp; " "  &amp; ($TotalActivity +  day1::swTotalActivity)  )

//insures that no more than 24 hours will be put into a day and that a day with negative time does not cause an error. ]
[ Select ]</li>
<li>End If</li>
<li>End Loop</li>
<li>#</li>
<li>#H) END update found record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#I) BEGIN find all user GRAND total records that need to be udated</li>
<li>#</li>
<li>#1 find records</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $user ]</li>
<li>Set Field [ brainstate::groupOfGroupUpdate; "u" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#2 if no records are found go to step</li>
<li>Exit Loop If [ Get ( LastError )  = 401 ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN error 1</li>
<li>If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming CheckUpdateTime step i1."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Close Window [ Name: "UpateTime"; Current file ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#END error 1</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#I) END find all user total records that need to be udated</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#J) BEGIN update found record</li>
<li>#</li>
<li>#1 unflag this total record for grand total update</li>
<li>Clear [ brainstate::groupOfGroupUpdate ]
[ Select ]</li>
<li>#</li>
<li>#2 find its linked records

</li>
<li>Set Variable [ $mergeto; Value:brainstate::groupOfGroupID ]</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupOfGroupID; $mergeto ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupType; based on value list: &ldquo;MergeSort&rdquo; ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#3 if linked records are found, first reset the total record's time to zero in case the amount of time has decreased (essentially by deleting its current day record and creating a new blank one).
</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>If [ day1::_keyDay = "" ]</li>
<li>Set Variable [ $BrainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Go to Layout [ &ldquo;calcDayTable&rdquo; (day1) ]</li>
<li>New Record/Request</li>
<li>Set Field [ day1::_keyBrainstate; $BrainstateID ]</li>
<li>Insert Calculated Result [ day1::_keyDay; reference::day1 ]
[ Select ]</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>End If</li>
<li>Set Field [ day1::swStart; day1::_keyDay &amp; " 0:00:00" ]</li>
<li>Set Field [ day1::swPause; day1::_keyDay &amp; " 0:00:00" ]</li>
<li>#</li>
<li>Loop</li>
<li>#</li>
<li>#4 go to the last record


</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>#</li>
<li>#5 if there are no records to add then delete the just created related day record for this total record (this action would be caused by the user deleting all the time in the linked records).
</li>
<li>If [ brainstate::_lockBrainstateID = brainstate::groupOfGroupID ]</li>
<li>If [ day1::swTotalActivity = "0:00:00" ]</li>
<li>Set Variable [ $dayID; Value:day1::_lockDay ]</li>
<li>Go to Layout [ &ldquo;calcDayTable&rdquo; (day1) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ day1::_lockDay; $dayID ]</li>
<li>Perform Find [  ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>End If</li>
<li>#</li>
<li>#6 go the next part of the script once there are no more records to add

</li>
<li>Exit Loop If [ brainstate::_lockBrainstateID = brainstate::groupOfGroupID ]</li>
<li>#</li>
<li>#7 if there is a record to add capture its total time, omit it, go the first record and add this time to current total time.


</li>
<li>Else If [ day1::_keyDay = "" ]</li>
<li>Omit Record</li>
<li>Else If [ day1::_keyDay &ne; "" ]</li>
<li>Set Variable [ $TotalActivity; Value:day1::swTotalActivity ]</li>
<li>Omit Record</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Insert Calculated Result [ day1::swPause; Case ( 

$TotalActivity +  day1::swTotalActivity    &gt;   Time ( 23 ; 59 ; 59 )  ; day1::_keyDay &amp;  " 24:00:00" ; 

$TotalActivity +  day1::swTotalActivity    &lt;   Time ( 0 ; 0 ; 0 )  ; day1::_keyDay &amp;  " 00:00:00" ; 

day1::_keyDay &amp; " "  &amp; ($TotalActivity +  day1::swTotalActivity)  )

//insures that no more than 24 hours will be put into a day and that a day with negative time does not cause an error. ]
[ Select ]</li>
<li>End If</li>
<li>End Loop</li>
<li>End Loop</li>
<li>#</li>
<li>#J) END update found record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>End Loop</li>
<li>#</li>
<li>#Have to go back to orginal layout, otherwise Hide Window step causes the data to be delayed showing up after the next interation of the stopwatch script runs thru.  
</li>
<li>Close Window [ Name: "UpateTime"; Current file ]</li>
<li>Perform Script [ &ldquo;DaySelectSortThenSort&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>day1</em>::_lockDay</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>brainstate</em>::groupUpdate</li>
<li>
<em>brainstate</em>::groupOfGroupID</li>
<li>
<em>brainstate</em>::groupOfGroupUpdate</li>
<li>
<em>day1</em>::updateTime</li>
<li>
<em>day1</em>::updateTimeCurrentTimeCalc</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>day1</em>::swActivityLength</li>
<li>
<em>day1</em>::swPauseLength</li>
<li>
<em>day1</em>::swStart</li>
<li>
<em>day1</em>::swPause</li>
<li>
<em>brainstate</em>::_keyUser</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>day1</em>::_keyBrainstate</li>
<li>
<em>reference</em>::day1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32902ScriptAnchor_">DaySelectSortThenSort</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>calcBrainstateTable</li>
<li>calcDayTable</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="117ScriptAnchor_"></a><td class="script_navbar"><a href="#33048ScriptAnchor_"><span>Previous Script: [updateTime (old: opened things in new windows)]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#87ScriptAnchor_"><span>Next Script: [clearPart1]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">updatePauseTotals</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#102ScriptAnchor_">note veto view</a></li>
<li><a href="#33047ScriptAnchor_">note veto view (old: opened things in new windows)</a></li>
<li><a href="#33219ScriptAnchor_">startTimerAssignTimeSegmentToSpecificAction</a></li>
<li><a href="#33220ScriptAnchor_">stopTimerAssignedToSpecificAction</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE update the time paused fields and the total and grand total fields after a user leaves a time field or clicks the veto button.  They may or may not have done anything, but in case they did this update is performed.</li>
<li>#</li>
<li>#</li>
<li>#1 if there is only one time, skip the following steps to recalculate the time paused between more than one time.
</li>
<li>If [ day1::swActivityLength[2] &ne; "" ]</li>
<li>#</li>
<li>#2 calculate all pause times between activity times.  This step is stopped when the next time to calculate a pause between is blank or when this loop has reached the last repitition (this test is neccessary because there are only 30 repetitions, so there will not be a blank 31 to detect, thus reaching 31 has to trigger  a stop).
</li>
<li>Set Variable [ $repetition; Value:2 ]</li>
<li>Loop</li>
<li>Set Field [ day1::swPauseLength[$repetition]; day1::swStart[$repetition] - day1::swPause[$repetition-1] ]</li>
<li>Set Variable [ $repetition; Value:$repetition+1 ]</li>
<li>Exit Loop If [ day1::swStart[$repetition] = "" ]</li>
<li>Exit Loop If [ $repetition = 31 ]</li>
<li>End Loop</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>day1</em>::swActivityLength</li>
<li>
<em>day1</em>::swStart</li>
<li>
<em>day1</em>::swPause</li>
<li>
<em>day1</em>::swPauseLength</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="87ScriptAnchor_"></a><td class="script_navbar"><a href="#117ScriptAnchor_"><span>Previous Script: [updatePauseTotals]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#33058ScriptAnchor_"><span>Next Script: [clearPart2]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">clearPart1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ day1::swActivityLength = "" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Variable [ $$warning; Value:brainstate::_lockBrainstateID ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Title: "?"; Message: "Clear all today's times for"  &amp; &para;  &amp;  &para; &amp; GetValue ( brainstate::description ; 1 ) &amp; "?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;OK&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Set Variable [ $$warning ]</li>
<li>Refresh Window</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ $$logBrainstate &ne; brainstate::_lockBrainstateID ]</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>Set Variable [ $name; Value:brainstate::description ]</li>
<li>Select Window [ Name: "Timer"; Current file ]</li>
<li>Show Custom Dialog [ Title: "?"; Message: "Specific Action window's timer = " &amp; GetValue ( $name  ; 1 )&amp; &para; &amp; "Timer window's timer = "  &amp; GetValue ( brainstate::description ; 1 ) &amp;&para; &amp; "Really clear Timer window's &mdash; " &amp; GetValue ( brainstate::description ; 1 )  &amp; " &mdash; timer?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Set Variable [ $$warning ]</li>
<li>Refresh Window</li>
<li>Halt Script</li>
<li>End If</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$warning ]</li>
<li>Refresh Window</li>
<li>Set Variable [ $$recordFIXTOMANYVARIABLES; Value:brainstate::_lockBrainstateID ]</li>
<li>Perform Script [ &ldquo;clearPart2&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>day1</em>::swActivityLength</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33058ScriptAnchor_">clearPart2</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33058ScriptAnchor_"></a><td class="script_navbar"><a href="#87ScriptAnchor_"><span>Previous Script: [clearPart1]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#33049ScriptAnchor_"><span>Next Script: [clear (old: opens windows to perform)]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">clearPart2</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#87ScriptAnchor_">clearPart1</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE just like on a stopwatch, this script activated by the clear button deletes the time recorded for a brainstate record's related day record.   Rather than just return the time to zero, this scripts deletes the record in case the user made a mistake in starting a timer for a particular brainstate record and will not be using it at all, in which case if it is not deleted, this unused record will fill up the database wasting space.</li>
<li>#</li>
<li>#</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>#</li>
<li>#1 check to insure that there is a record to clear and if not hast the script, then check to insure if there is a record that it is not a total or grand total record.  These total records are sums of other records and so their times are not created by the stopwatch script and should not be cleared by this script.  They will be cleared if there linked records' times are cleared by the UpdateTime script.</li>
<li>If [ day1::_keyDay = "" or 

brainstate::_lockBrainstateID = brainstate::groupID or 

brainstate::_lockBrainstateID = brainstate::groupOfGroupID ]</li>
<li>Set Variable [ $$recordFIXTOMANYVARIABLES ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#preserve stopwatch symbol for use in updatetime script as it will be deleted by this script</li>
<li>Set Variable [ $$onoff; Value:"note" ]</li>
<li>#BUG remove focus from any fields.   This step seems to be neccessary as I periodically have been getting a -- this record is being modified in a separate window -- message.  I'm leaving this step in to see if I stop getting this message.</li>
<li>Set Variable [ $recordNumber; Value:Get ( RecordNumber ) ]</li>
<li>Go to Field [  ]</li>
<li>Go to Record/Request/Page [ $recordNumber ]
[ No dialog ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#2 capture the day record's ID number</li>
<li>Set Variable [ $dayID; Value:day1::_lockDay ]</li>
<li>#</li>
<li>//  #3 open a new window to perform the delete.  This is neccessary because just going to the day layout and then back to the brainstate layout will reset the scroll and confuse the user.  When a new window is used the scroll and focus on the orignal layout is not changed.</li>
<li>//  New Window [ Name: "Clear"; Height: 2; Width: 2 ]</li>
<li>//  Adjust Window
[ Hide ]</li>
<li>#</li>
<li>#3 find and delete the day record</li>
<li>Go to Layout [ &ldquo;calcDayTable&rdquo; (day1) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Insert Calculated Result [ day1::_lockDay; $dayID ]
[ Select ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Capture day key to remove time from an issues records</li>
<li>#that currently have time from this day attributed to them.</li>
<li>Set Variable [ $$updateDay; Value:day1::_lockDay ]</li>
<li>Set Variable [ $$clear; Value:1 ]</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Go to Layout [ original layout ]</li>
<li>Perform Script [ &ldquo;CHUNK_lastDayUsed&rdquo; ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#4 determine if the record whose time was just cleared is linked to a total and if so flag it as changed and run the UpdateTime script to update its total record's time.</li>
<li>Set Field [ brainstate::groupUpdate; If ( brainstate::groupID &ne; "" ; "u" ; "" ) ]</li>
<li>If [ brainstate::groupID &ne; "" ]</li>
<li>#</li>
<li>#Update time in issue records if neccessary.</li>
<li>Perform Script [ &ldquo;CHUNK_updateIssueCategoryTime&rdquo; ]</li>
<li>#</li>
<li>#Load updated variables in both Day and </li>
<li>#Specific Action windows and refresh them to </li>
<li>#trigger current conditional formatting for </li>
<li>#selected records.</li>
<li>Set Variable [ $refreshDayCurrentWindow; Value:Get ( WindowName ) ]</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
<li>Set Variable [ $$logissues; Value:logs::_keyLogIssues ]</li>
<li>Set Variable [ $$log; Value:logs::_lockDay ]</li>
<li>Set Variable [ $$day1BugField; Value:logs::swBugField ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>Set Variable [ $$issueLogs; Value:issue::_keyLogs ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: $refreshDayCurrentWindow; Current file ]</li>
<li>#</li>
<li>#Script will halt after performing sort step below</li>
<li>#so clear the $$clear variable.  </li>
<li>Set Variable [ $$clear ]</li>
<li>#</li>
<li>//  #Reload log record in case current variables are</li>
<li>//  #set for log record that was just deleted/cleared.</li>
<li>//  Select Window [ Name: "Activity Log"; Current file ]</li>
<li>//  If [ Get (LastError) &ne; 112  //window missing ]</li>
<li>//  Perform Script [ &ldquo;loadLogrecordID&rdquo; ]</li>
<li>//  End If</li>
<li>Select Window [ Name: "Timer"; Current file ]</li>
<li>Set Variable [ $$stopCHUNK_updateIssueCategoryTime; Value:1 ]</li>
<li>#</li>
<li>#Update time for affected total record if any and for</li>
<li>#other brainstate records as user may have dragged</li>
<li>#time to other records before clearing this one, and</li>
<li>#so system needs to update the time in those records.</li>
<li>Perform Script [ &ldquo;updateTime&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#5 determine if the user is currently sorting by time and if so sort re-sort the records to remove this record from its current position in the time sort.  (It should be listed in alphabetical order under the list of records sorted by their times as this record no longer has any time associated with it.)</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>brainstate</em>::groupOfGroupID</li>
<li>
<em>day1</em>::_lockDay</li>
<li>
<em>brainstate</em>::groupUpdate</li>
<li>
<em>logs</em>::_keyLogIssues</li>
<li>
<em>logs</em>::_lockDay</li>
<li>
<em>logs</em>::swBugField</li>
<li>
<em>issue</em>::_keyLogs</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33053ScriptAnchor_">CHUNK_lastDayUsed</a></li>
<li><a href="#33138ScriptAnchor_">CHUNK_updateIssueCategoryTime</a></li>
<li><a href="#33124ScriptAnchor_">loadLogrecordID</a></li>
<li><a href="#32829ScriptAnchor_">updateTime</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>calcDayTable</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33049ScriptAnchor_"></a><td class="script_navbar"><a href="#33058ScriptAnchor_"><span>Previous Script: [clearPart2]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#107ScriptAnchor_"><span>Next Script: [newBrainstateOnTotalLayouts]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">clear (old: opens windows to perform)</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE just like on a stopwatch, this script activated by the clear button deletes the time recorded for a brainstate record's related day record.   Rather than just return the time to zero, this scripts deletes the record in case the user made a mistake in starting a timer for a particular brainstate record and will not be using it at all, in which case if it is not deleted, this unused record will fill up the database wasting space.</li>
<li>#</li>
<li>#</li>
<li>#BUG remove focus from any fields.   This step seems to be neccessary as I periodically have been getting a -- this record is being modified in a separate window -- message.  I'm leaving this step in to see if I stop getting this message.</li>
<li>Set Variable [ $recordNumber; Value:Get ( RecordNumber ) ]</li>
<li>Go to Field [  ]</li>
<li>Go to Record/Request/Page [ $recordNumber ]
[ No dialog ]</li>
<li>#</li>
<li>#</li>
<li>#1 check to insure that there is a record to clear and if not hast the script, then check to insure if there is a record that it is not a total or grand total record.  These total records are sums of other records and so their times are not created by the stopwatch script and should not be cleared by this script.  They will be cleared if there linked records' times are cleared by the UpdateTime script.</li>
<li>If [ day1::_keyDay = "" or 

brainstate::_lockBrainstateID = brainstate::groupID or 

brainstate::_lockBrainstateID = brainstate::groupOfGroupID ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#2 capture the day record's ID number</li>
<li>Set Variable [ $dayID; Value:day1::_lockDay ]</li>
<li>#</li>
<li>#3 open a new window to perform the delete.  This is neccessary because just going to the day layout and then back to the brainstate layout will reset the scroll and confuse the user.  When a new window is used the scroll and focus on the orignal layout is not changed.</li>
<li>New Window [ Name: "Clear"; Height: 2; Width: 2 ]</li>
<li>Adjust Window
[ Hide ]</li>
<li>#</li>
<li>#3 find and delete the day record then close the window</li>
<li>Go to Layout [ &ldquo;calcDayTable&rdquo; (day1) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Insert Calculated Result [ day1::_lockDay; $dayID ]
[ Select ]</li>
<li>Perform Find [  ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Go to Layout [ original layout ]</li>
<li>Close Window [ Name: "Clear"; Current file ]</li>
<li>#</li>
<li>#4 determine if the record whose time was just cleared is linked to a total and if so flag it as changed and run the UpdateTime script to update its total record's time.</li>
<li>Set Field [ brainstate::groupUpdate; If ( brainstate::groupID &ne; "" ; "u" ; "" ) ]</li>
<li>If [ brainstate::groupID &ne; "" ]</li>
<li>Perform Script [ &ldquo;updateTime&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#5 determine if the user is currently sorting by time and if so sort re-sort the records to remove this record from its current position in the time sort.  (It should be listed in alphabetical order under the list of records sorted by their times as this record no longer has any time associated with it.)</li>
<li>Perform Script [ &ldquo;sortRestoreAfterScript&rdquo; ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>brainstate</em>::groupOfGroupID</li>
<li>
<em>day1</em>::_lockDay</li>
<li>
<em>brainstate</em>::groupUpdate</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32829ScriptAnchor_">updateTime</a></li>
<li><a href="#32830ScriptAnchor_">sortRestoreAfterScript</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>calcDayTable</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="107ScriptAnchor_"></a><td class="script_navbar"><a href="#33049ScriptAnchor_"><span>Previous Script: [clear (old: opens windows to perform)]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#33029ScriptAnchor_"><span>Next Script: [newBrainstateOnMainLayouts]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newBrainstateOnTotalLayouts</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE create a new record for the user (but do not check hide automatically)</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 capture the user's ID number</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>#</li>
<li>#2 create a new record</li>
<li>New Record/Request</li>
<li>#</li>
<li>#3 assign is to the user</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Commit Records/Requests
[ Skip data entry validation; No dialog ]</li>
<li>#</li>
<li>#4 records must be sorted by ID number, otherwise as soon as the brainstate name field is exited the database sorts the brainstate list by whatever current sort is selected, and the user will see their newly created record disappear.  Step 1 of sorting by ID is to clear the reference::sort field which is used to conditionally formate the label of the currnt sort.  2 sort the records so the new record is the first record, then 3 go to that first records brainstate name field.</li>
<li>Clear [ reference::sort ]
[ Select ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; descending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#5 put cursor in title text box for the user to enter a title</li>
<li>Go to Field [ brainstate::description ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>brainstate</em>::_keyUser</li>
<li>
<em>reference</em>::sort</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33029ScriptAnchor_"></a><td class="script_navbar"><a href="#107ScriptAnchor_"><span>Previous Script: [newBrainstateOnTotalLayouts]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#32905ScriptAnchor_"><span>Next Script: [newFarmer]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newBrainstateOnMainLayouts</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE create a new record for the user and check hide automatically so record will show up on main page if requested by user (I know, the field name should be changed)</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 capture the user's ID number</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>#</li>
<li>#2 create a new record</li>
<li>New Record/Request</li>
<li>#</li>
<li>#3 assign is to the user and check hide field</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Set Field [ brainstate::hide; "t" ]</li>
<li>Commit Records/Requests
[ Skip data entry validation; No dialog ]</li>
<li>#</li>
<li>#4 records must be sorted by ID number, otherwise as soon as the brainstate name field is exited the database sorts the brainstate list by whatever current sort is selected, and the user will see their newly created record disappear.  Step 1 of sorting by ID is to clear the reference::sort field which is used to conditionally formate the label of the currnt sort.  2 sort the records so the new record is the first record, then 3 go to that first records brainstate name field.</li>
<li>Clear [ reference::sort ]
[ Select ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; descending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#5 put cursor in title text box for the user to enter a title</li>
<li>Go to Field [ brainstate::description ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>brainstate</em>::_keyUser</li>
<li>
<em>brainstate</em>::hide</li>
<li>
<em>reference</em>::sort</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32905ScriptAnchor_"></a><td class="script_navbar"><a href="#33029ScriptAnchor_"><span>Previous Script: [newBrainstateOnMainLayouts]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#32900ScriptAnchor_"><span>Next Script: [info]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newFarmer</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE create a new record for the user</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 create a new record</li>
<li>New Record/Request</li>
<li>#</li>
<li>#2 put cursor in title text box for the user to enter first name</li>
<li>Go to Field [ steward::FirstName ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::FirstName</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32900ScriptAnchor_"></a><td class="script_navbar"><a href="#32905ScriptAnchor_"><span>Previous Script: [newFarmer]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#33175ScriptAnchor_"><span>Next Script: [iphoneCut]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">info</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE open a window to display record info if there is any to display.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 check to see if there is info</li>
<li>If [ brainstate::linkinfo &ne; "" ]</li>
<li>#</li>
<li>#2 open window and display info</li>
<li>New Window [ Name: "info"; Height: 500; Width: 400 ]</li>
<li>Show/Hide Status Area
[ Lock; Hide ]</li>
<li>Show/Hide Text Ruler
[ Hide ]</li>
<li>Go to Layout [ &ldquo;info&rdquo; (brainstate) ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::linkinfo</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>info</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33175ScriptAnchor_"></a><td class="script_navbar"><a href="#32900ScriptAnchor_"><span>Previous Script: [info]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#33200ScriptAnchor_"><span>Next Script: [findSpecificAction]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">iphoneCut</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>//  Cut [  ]
[ Select ]</li>
<li>Set Variable [ $$cut; Value:Get (ActiveFieldContents) ]</li>
<li>Set Variable [ $$iphoneStop; Value:1 ]</li>
<li>Set Field [ "" ]</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33200ScriptAnchor_"></a><td class="script_navbar"><a href="#33175ScriptAnchor_"><span>Previous Script: [iphoneCut]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#33202ScriptAnchor_"><span>Next Script: [findSpecificActionCancel]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">findSpecificAction</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#Capture errors and tell user about them in custom </li>
<li>#dialogue box.</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#If the user clicks the find button and the system is already</li>
<li>#in find mode, capture the user's current find request</li>
<li>#and then perform the requested find.</li>
<li>#This capture is done in case nothing is found and the</li>
<li>#user is asked if they want to modify their request.</li>
<li>#The system puts in the captured request so that the </li>
<li>#user can see the failed request.</li>
<li>If [ Get (WindowMode) = 1 ]</li>
<li>Set Variable [ $issueText; Value:issue::text ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If the system is not in find mode and the find button</li>
<li>#is clicked then enter find mode and await the user's</li>
<li>#find request. </li>
<li>Else</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>Show/Hide Status Area
[ Hide ]</li>
<li>Show/Hide Text Ruler
[ Hide ]</li>
<li>Go to Layout [ &ldquo;IssuesFIND&rdquo; (issue) ]</li>
<li>Go to Field [ issue::text ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>Set Variable [ $issueText; Value:issue::text ]</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If the find fails tell the user it failed and give them</li>
<li>#option to modify their request or cancel the find.</li>
<li>Loop</li>
<li>If [ Get (LastError) = 401 ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Field [ issue::text; $issueText ]</li>
<li>Go to Field [ issue::text ]</li>
<li>Show Custom Dialog [ Message: "No records match this request."; Buttons: &ldquo;cancel&rdquo;, &ldquo;modify find&rdquo; ]</li>
<li>#</li>
<li>#If the user decides to modify their request then re-enter</li>
<li>#find mode and await the users new request.</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Variable [ $issueText; Value:issue::text ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Field [ issue::text; $issueText ]</li>
<li>Go to Field [ issue::text ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>Set Variable [ $issueText; Value:issue::text ]</li>
<li>#</li>
<li>#If the user decides to cancel their the find, then return</li>
<li>#to the main record window and show all records.</li>
<li>Else If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Go to Layout [ &ldquo;Issues&rdquo; (issue) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>Perform Find [  ]</li>
<li>Show/Hide Status Area
[ Hide ]</li>
<li>Show/Hide Text Ruler
[ Hide ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If the find is successful then show the user the found</li>
<li>#records on the main records layout.</li>
<li>Exit Loop If [ Get (LastError) = 0 ]</li>
<li>End Loop</li>
<li>Go to Layout [ &ldquo;Issues&rdquo; (issue) ]</li>
<li>Show/Hide Status Area
[ Hide ]</li>
<li>Show/Hide Text Ruler
[ Hide ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>issue</em>::text</li>
<li>
<em>issue</em>::_keyBrainstate</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>IssuesFIND</li>
<li>Issues</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33202ScriptAnchor_"></a><td class="script_navbar"><a href="#33200ScriptAnchor_"><span>Previous Script: [findSpecificAction]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#33178ScriptAnchor_"><span>Next Script: [iphoneCopy]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">findSpecificActionCancel</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#If the user decides to cancel their the find, then return</li>
<li>#to the main record window and show all records.</li>
<li>Go to Layout [ &ldquo;Issues&rdquo; (issue) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>Perform Find [  ]</li>
<li>Show/Hide Status Area
[ Hide ]</li>
<li>Show/Hide Text Ruler
[ Hide ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Halt Script</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>issue</em>::_keyBrainstate</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>Issues</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33178ScriptAnchor_"></a><td class="script_navbar"><a href="#33202ScriptAnchor_"><span>Previous Script: [findSpecificActionCancel]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#33176ScriptAnchor_"><span>Next Script: [iphonePaste]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">iphoneCopy</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $$cut; Value:Get (ActiveFieldContents) ]</li>
<li>Set Variable [ $$iphoneStop; Value:1 ]</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33176ScriptAnchor_"></a><td class="script_navbar"><a href="#33178ScriptAnchor_"><span>Previous Script: [iphoneCopy]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#110ScriptAnchor_"><span>Next Script: [deleteBrainstate]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">iphonePaste</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Field [ $$cut ]</li>
<li>Set Variable [ $$cut ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="110ScriptAnchor_"></a><td class="script_navbar"><a href="#33176ScriptAnchor_"><span>Previous Script: [iphonePaste]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#33023ScriptAnchor_"><span>Next Script: [deleteBrainstateFromTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">deleteBrainstate</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE determine if user really wants to delete the selected record, delete that record if true, and if it is a total or grand total record also clear its linked records of their link.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#NOTE: the three # symbols set apart chunks of script.  </li>
<li>#NOTE: the finish and error script chunks are almost identical (the error message differ in telling where in the script they occur).  For this reason, they are not numbered as part of a particular chuck of the script, and are separated by three # symbols to set them apart.</li>
<li>#</li>
<li>#</li>
<li>If [ brainstate::_lockBrainstateID = brainstate::groupID and brainstate::groupType &ne; "" ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Action groups must be deleted from the group display screen.  You will taken there now."; Buttons: &ldquo;OK&rdquo;, &ldquo;Cancel&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Perform Script [ &ldquo;note veto view&rdquo; ]</li>
<li>Go to Layout [ &ldquo;TotalSort&rdquo; (brainstate) ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>Set Variable [ $brainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $deleteID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $deletelayout; Value:Get ( LayoutName ) ]</li>
<li>Set Variable [ $$deletelayout; Value:Get ( LayoutName ) ]</li>
<li>Set Variable [ $$hide; Value:brainstate::hide ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#A) BEGIN check if user is in any fields (neccessary because if user is in a field another script could be triggered causing this script to be terminated).</li>
<li>#</li>
<li>#1 check if user is in any fields and if so halt the script</li>
<li>If [ Get ( ActiveFieldName ) &ne; "" ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "As long as record is in use it cannot be deleted.  Please exit all fields and try again.  "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#A) END check if user is in any fields (neccessary because if user is in a field another script could be triggered causing this script to be terminated).</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#B) BEGIN ask for delete confirmation</li>
<li>#</li>
<li>#1) clear the reference.  This field is the lock the user must insert the first letter of the record's title to open and then delete the record.  This step insures it is locked!  (If there is a value in the field, the field is unlocked and the user could accidently delete a record they really decide that they want to keep.)</li>
<li>Set Field [ reference::YorN; "" ]</li>
<li>#</li>
<li>#2) open a text box and ask the user to type in the first letter of the records title</li>
<li>Set Variable [ $$warning; Value:brainstate::_lockBrainstateID ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Title: brainstate::description; Message: "Type the 1st character of the title below (or 1 space if blank) and click OK to delete  &para;&para;" 

&amp; brainstate::description; Buttons: &ldquo;OK&rdquo;, &ldquo;Cancel&rdquo;; Input #1: reference::YorN ]</li>
<li>#</li>
<li>#B) END ask for delete confirmation</li>
<li>#</li>
<li>Set Variable [ $$warning ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#</li>
<li>#C) BEGIN confirm user wants to delete record or cancel delete</li>
<li>#</li>
<li>#1) halt delete if the user typed nothing and clicked OK or hit the cancel button</li>
<li>If [ reference::YorN = "" ]</li>
<li>Set Variable [ $$warning ]</li>
<li>Refresh Window</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#2) confirm user typed correct letter OR if record was blank and user typed in a blank (this test covers the possibility that first letter of title may be a blank, and insures the user's desire to delete the record is taken care of in the case of blank or blank looking record).</li>
<li>If [ reference::YorN  = Left ( brainstate::description ; 1 ) or reference::YorN = " " and brainstate::description  =  "" ]</li>
<li>#</li>
<li>#3) if the user failed to follow directions give them all the chances they need to follow them correctly</li>
<li>Else If [ reference::YorN   &ne;  Left ( brainstate::description ; 1 ) or reference::YorN  &ne;  " " and brainstate::description  =  "" ]</li>
<li>Loop</li>
<li>Set Field [ reference::YorN; "" ]</li>
<li>Show Custom Dialog [ Title: brainstate::description; Message: "Type the 1st character of the title below (or click the space bar once to type a space in the field below if title appears to be blank) and click OK to delete  &para;" 

&amp; brainstate::description; Buttons: &ldquo;OK&rdquo;, &ldquo;Cancel&rdquo;; Input #1: reference::YorN ]</li>
<li>Exit Loop If [ reference::YorN    =    Left ( brainstate::description ; 1 )   

or 

brainstate::description = "" and reference::YorN  =  " "

or  

reference::YorN    =    "" ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>#4) recheck if the user typed nothing and clicked OK or hit the cancel button</li>
<li>If [ reference::YorN = "" ]</li>
<li>Set Variable [ $$warning ]</li>
<li>Refresh Window</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#C) END confirm user wants to delete record or cancel delete</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#D) BEGIN delete total or grandtotal record</li>
<li>#</li>
<li>#1) check if total or grandtotal record and if so perform the CHUNK_deleteTotalOrGrandtotalRecord script</li>
<li>If [ brainstate::groupType  &ne;  "" and brainstate::_lockBrainstateID = brainstate::groupID

 or 

brainstate::groupType  &ne;  "" and brainstate::_lockBrainstateID = brainstate::groupOfGroupID ]</li>
<li>Perform Script [ &ldquo;CHUNK_deleteTotalOrGrandtotalRecord&rdquo; ]</li>
<li>Set Variable [ $$warning ]</li>
<li>Refresh Window</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#D) END delete total or grandtotal record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#E) BEGIN determine if record is linked to a total record and subtract it</li>
<li>#</li>
<li>#1) subtract record's time from total if it was part of a total. </li>
<li>If [ brainstate::groupID &ne; "" ]</li>
<li>Perform Script [ &ldquo;CHUNK_deleteRecordsTimeFromTotal&rdquo; ]</li>
<li>#</li>
<li>#2) capture mergeID (necessary if user was on the totalview layout for returning the user to that layout and showing only the records with the same mergeID)</li>
<li>Set Variable [ $brainstateID; Value:brainstate::groupID ]</li>
<li>#</li>
<li>#E) END determine if record is linked to a total record and subtract it</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#F) BEGIN delete record linked to a total record and a grandtotal record</li>
<li>#</li>
<li>#1) subtract record's time from a grandtotal if this record was part of a grandtotal</li>
<li>If [ brainstate::groupOfGroupUpdate = "u" ]</li>
<li>Perform Script [ &ldquo;CHUNK_recalculateGrandTotal&rdquo; ]</li>
<li>#</li>
<li>#2) delete the record chosen to be deleted aftering updating total and grandtotal</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_lockBrainstateID; $$deleteID ]</li>
<li>Perform Find [  ]</li>
<li>If [ brainstate::_lockBrainstateID = $deleteID ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Else If [ brainstate::_lockBrainstateID  &ne;  $deleteID ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Error peforming F2 of the DeleteBrainstate script."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#3) if user was on the viewTotal screen find only those records that are part of the total being viewed prior to deleting and show the user those records on that layout.</li>
<li>If [ Left ( $deletelayout ; 5 ) = "Total" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupID; $brainstateID ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Layout [ $$deletelayout ]</li>
<li>//  #NOT TESTED</li>
<li>//  If [ Get ( SystemPlatform ) = 3 ]</li>
<li>//  Go to Layout [ &ldquo;TotalMainiPhone&rdquo; (brainstate) ]</li>
<li>//  End If</li>
<li>//  #END NOT TESTED</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$warning ]</li>
<li>Refresh Window</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#4) if user was not on the viewTotal screen go back to the layout user was on and show records that users was looking at</li>
<li>Perform Script [ &ldquo;goBackButton&rdquo; ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#F) END delete record linked to a total record and a grandtotal record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#G) BEGIN delete record</li>
<li>#</li>
<li>#1) delete the record chosen to be deleted</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_lockBrainstateID; $deleteID ]</li>
<li>Perform Find [  ]</li>
<li>If [ brainstate::_lockBrainstateID = $deleteID ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Else If [ brainstate::_lockBrainstateID  &ne;  $deleteID ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Error peforming G1 of the DeleteBrainstate script."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#2) if user was on the viewTotal screen find only those records that are part of the total being viewed prior to deleting and show the user those records on that layout.</li>
<li>If [ Left ( $deletelayout ; 4 ) = "Tota" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupID; $brainstateID ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Layout [ $$deletelayout ]</li>
<li>//  #NOT TESTED</li>
<li>//  If [ Get ( SystemPlatform ) = 3 ]</li>
<li>//  Go to Layout [ &ldquo;TotalMainiPhone&rdquo; (brainstate) ]</li>
<li>//  End If</li>
<li>//  #END NOT TESTED</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#3) if user was not on the view Total screen, go back to the layout user was on and show records that users was looking at</li>
<li>Perform Script [ &ldquo;goBackButton&rdquo; ]</li>
<li>Halt Script</li>
<li>#</li>
<li>#G) END delete record</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>brainstate</em>::hide</li>
<li>
<em>reference</em>::YorN</li>
<li>
<em>brainstate</em>::description</li>
<li>&lt;Missing Field&gt;</li>
<li>
<em>brainstate</em>::groupOfGroupID</li>
<li>
<em>brainstate</em>::groupOfGroupUpdate</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#102ScriptAnchor_">note veto view</a></li>
<li><a href="#32942ScriptAnchor_">CHUNK_deleteTotalOrGrandtotalRecord</a></li>
<li><a href="#32940ScriptAnchor_">CHUNK_deleteRecordsTimeFromTotal</a></li>
<li><a href="#32939ScriptAnchor_">CHUNK_recalculateGrandTotal</a></li>
<li><a href="#32934ScriptAnchor_">goBackButton</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>TotalSort</li>
<li>TotalMainiPhone</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33023ScriptAnchor_"></a><td class="script_navbar"><a href="#110ScriptAnchor_"><span>Previous Script: [deleteBrainstate]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#32904ScriptAnchor_"><span>Next Script: [deleteFarmer]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">deleteBrainstateFromTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE determine if user really wants to delete the selected record, delete that record if true, and if it is a total or grand total record also clear its linked records of their link.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#NOTE: the three # symbols set apart chunks of script.  </li>
<li>#NOTE: the finish and error script chunks are almost identical (the error message differ in telling where in the script they occur).  For this reason, they are not numbered as part of a particular chuck of the script, and are separated by three # symbols to set them apart.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>Set Variable [ $brainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $mergeID; Value:brainstate::groupID ]</li>
<li>Set Variable [ $deleteID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $deletelayout; Value:Get ( LayoutName ) ]</li>
<li>Set Variable [ $$deletelayout; Value:Get ( LayoutName ) ]</li>
<li>Set Variable [ $$record; Value:Get ( RecordNumber ) ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#A) BEGIN check if user is in any fields (neccessary because if user is in a field another script could be triggered causing this script to be terminated).</li>
<li>#</li>
<li>#1 check if user is in any fields and if so halt the script</li>
<li>If [ Get ( ActiveFieldName ) &ne; "" ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "As long as record is in use it cannot be deleted.  Please exit all fields and try again.  "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#A) END check if user is in any fields (neccessary because if user is in a field another script could be triggered causing this script to be terminated).</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#B) BEGIN ask for delete confirmation</li>
<li>#</li>
<li>#1) clear the reference.  This field is the lock the user must insert the first letter of the record's title to open and then delete the record.  This step insures it is locked!  (If there is a value in the field, the field is unlocked and the user could accidently delete a record they really decide that they want to keep.)</li>
<li>Set Field [ reference::YorN; "" ]</li>
<li>#</li>
<li>#2) open a text box and ask the user to type in the first letter of the records title</li>
<li>Show Custom Dialog [ Title: brainstate::description; Message: "Type the 1st character of the title below (or 1 space if blank) and click OK to delete  &para;&para;" 

&amp; brainstate::description; Buttons: &ldquo;OK&rdquo;, &ldquo;Cancel&rdquo;; Input #1: reference::YorN ]</li>
<li>#</li>
<li>#B) END ask for delete confirmation</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#C) BEGIN confirm user wants to delete record or cancel delete</li>
<li>#</li>
<li>#1) halt delete if the user typed nothing and clicked OK or hit the cancel button</li>
<li>If [ reference::YorN = "" ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#2) confirm user typed correct letter OR if record was blank and user typed in a blank (this test covers the possibility that first letter of title may be a blank, and insures the user's desire to delete the record is taken care of in the case of blank or blank looking record).</li>
<li>If [ reference::YorN  = Left ( brainstate::description ; 1 ) or reference::YorN = " " and brainstate::description  =  "" ]</li>
<li>#</li>
<li>#3) if the user failed to follow directions give them all the chances they need to follow them correctly</li>
<li>Else If [ reference::YorN   &ne;  Left ( brainstate::description ; 1 ) or reference::YorN  &ne;  " " and brainstate::description  =  "" ]</li>
<li>Loop</li>
<li>Set Field [ reference::YorN; "" ]</li>
<li>Show Custom Dialog [ Title: brainstate::description; Message: "Type the 1st character of the title below (or click the space bar once to type a space in the field below if title appears to be blank) and click OK to delete  &para;" 

&amp; brainstate::description; Buttons: &ldquo;OK&rdquo;, &ldquo;Cancel&rdquo;; Input #1: reference::YorN ]</li>
<li>Exit Loop If [ reference::YorN    =    Left ( brainstate::description ; 1 )   

or 

brainstate::description = "" and reference::YorN  =  " "

or  

reference::YorN    =    "" ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>#4) recheck if the user typed nothing and clicked OK or hit the cancel button</li>
<li>If [ reference::YorN = "" ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#C) END confirm user wants to delete record or cancel delete</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#D) BEGIN delete total or grandtotal record</li>
<li>#</li>
<li>#1) check if total or grandtotal record and if so perform the CHUNK_deleteTotalOrGrandtotalRecord script</li>
<li>If [ brainstate::groupType  &ne;  "" ]</li>
<li>Perform Script [ &ldquo;CHUNK_deleteTotalOrGrandtotalRecord&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#D) END delete total or grandtotal record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#E) BEGIN determine if record is linked to a total record and subtract it</li>
<li>#</li>
<li>#1) subtract record's time from total if it was part of a total. </li>
<li>If [ brainstate::groupID &ne; "" ]</li>
<li>Perform Script [ &ldquo;CHUNK_deleteRecordsTimeFromTotal&rdquo; ]</li>
<li>#</li>
<li>#2) capture mergeID (necessary if user was on the totalview layout for returning the user to that layout and showing only the records with the same mergeID)</li>
<li>Set Variable [ $brainstateID; Value:brainstate::groupID ]</li>
<li>#</li>
<li>#E) END determine if record is linked to a total record and subtract it</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#F) BEGIN delete record linked to a total record and a grandtotal record</li>
<li>#</li>
<li>#1) subtract record's time from a grandtotal if this record was part of a grandtotal</li>
<li>If [ brainstate::groupOfGroupUpdate = "u" ]</li>
<li>Perform Script [ &ldquo;CHUNK_recalculateGrandTotal&rdquo; ]</li>
<li>#</li>
<li>#2) delete the record chosen to be deleted aftering updating total and grandtotal</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_lockBrainstateID; $$deleteID ]</li>
<li>Perform Find [  ]</li>
<li>If [ brainstate::_lockBrainstateID = $deleteID ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Else If [ brainstate::_lockBrainstateID  &ne;  $deleteID ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Error peforming F2 of the DeleteBrainstate script."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#3) if user was on the viewTotal screen find only those records that are part of the total being viewed prior to deleting and show the user those records on that layout.</li>
<li>If [ Left ( $deletelayout ; 5 ) = "total" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupID; $mergeID ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Layout [ $$deletelayout ]</li>
<li>//  #NOT TESTED</li>
<li>//  If [ Get ( SystemPlatform ) = 3 ]</li>
<li>//  Go to Layout [ &ldquo;TotalMainiPhone&rdquo; (brainstate) ]</li>
<li>//  End If</li>
<li>//  #END NOT TESTED</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#4) if user was not on the viewTotal screen go back to the layout user was on and show records that users was looking at</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#F) END delete record linked to a total record and a grandtotal record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#G) BEGIN delete record</li>
<li>#</li>
<li>#1) delete the record chosen to be deleted</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_lockBrainstateID; $deleteID ]</li>
<li>Perform Find [  ]</li>
<li>If [ brainstate::_lockBrainstateID = $deleteID ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Else If [ brainstate::_lockBrainstateID  &ne;  $deleteID ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Error peforming G1 of the DeleteBrainstate script."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#2) if user was on the viewTotal screen find only those records that are part of the total being viewed prior to deleting and show the user those records on that layout.</li>
<li>If [ Left ( $deletelayout ; 4 ) = "Tota" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupID; $brainstateID ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#4 it the user wants retired records hidden then hide these records if any</li>
<li>//  If [ steward::retiredStatus    &ne;   "" ]</li>
<li>//  Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>//  End If</li>
<li>Perform Script [ &ldquo;CHUNK_retire&rdquo; ]</li>
<li>#</li>
<li>Perform Script [ &ldquo;CHUNK_DaySelectSortThenSort&rdquo; ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Layout [ $$deletelayout ]</li>
<li>//  #NOT TESTED</li>
<li>//  If [ Get ( SystemPlatform ) = 3 ]</li>
<li>//  Go to Layout [ &ldquo;TotalMainiPhone&rdquo; (brainstate) ]</li>
<li>//  End If</li>
<li>//  #END NOT TESTED</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#3) if user was not on the view Total screen, go back to the layout user was on and show records that users was looking at</li>
<li>Halt Script</li>
<li>#</li>
<li>#G) END delete record</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>reference</em>::YorN</li>
<li>
<em>brainstate</em>::description</li>
<li>&lt;Missing Field&gt;</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::groupOfGroupUpdate</li>
<li>
<em>steward</em>::retiredStatus</li>
<li>
<em>brainstate</em>::sortRetired</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32942ScriptAnchor_">CHUNK_deleteTotalOrGrandtotalRecord</a></li>
<li><a href="#32940ScriptAnchor_">CHUNK_deleteRecordsTimeFromTotal</a></li>
<li><a href="#32939ScriptAnchor_">CHUNK_recalculateGrandTotal</a></li>
<li><a href="#33060ScriptAnchor_">CHUNK_retire</a></li>
<li><a href="#33052ScriptAnchor_">CHUNK_DaySelectSortThenSort</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>TotalMainiPhone</li>
<li>&lt;Missing Layout&gt;</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32904ScriptAnchor_"></a><td class="script_navbar"><a href="#33023ScriptAnchor_"><span>Previous Script: [deleteBrainstateFromTotal]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#32860ScriptAnchor_"><span>Next Script: [editFarmer]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">deleteFarmer</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE determine if user really wants to delete the selected record and delete that record if true.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#NOTE: the three # symbols set apart chunks of script.  </li>
<li>#NOTE: the finish and error script chunks are almost identical (the error message differ in telling where in the script they occur).  For this reason, they are not numbered as part of a particular chuck of the script, and are separated by three # symbols to set them apart.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>Set Variable [ $brainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#A) BEGIN check if user is in any fields (neccessary because if user is in a field another script could be triggered causing this script to be terminated).</li>
<li>#</li>
<li>#1 check if there are 2 or more records to merge and if not halt the script.  (Can't merge if zero or 1 records are selected.  </li>
<li>If [ Get ( ActiveFieldName ) &ne; "" ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "As long as record is in use it cannot be deleted.  Please exit all fields and try again.  "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#A) END check if user is in any fields (neccessary because if user is in a field another script could be triggered causing this script to be terminated).</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#B) BEGIN check to insure user has something they can use a password to delete this record and all records associated with it</li>
<li>#</li>
<li>#1 password check</li>
<li>If [ WordCount ( steward::FirstName  )  +  WordCount ( steward::LastName  ) = 0 ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "You must have something (other than spaces) typed in at least the first or last name text boxes to use as a password to delete this record."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#B) END check to insure user has something they can use a password to delete this record and all records associated with it</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#C) BEGIN ask for delete confirmation</li>
<li>#</li>
<li>#1) clear the reference.  This field is the lock the user must insert the first letter of the record's title to open and then delete the record.  This step insures it is locked!</li>
<li>Set Field [ reference::YorN; "" ]</li>
<li>#</li>
<li>#2) open a text box and ask the user to type in the full name of the user to be deleted</li>
<li>Show Custom Dialog [ Title: "DELETE steward::FirstPlusLast"; Message: "Type the full name as shown below and click OK to delete all records for this person.  &para;&para;" 

&amp; steward::FirstPlusLast; Buttons: &ldquo;OK&rdquo;, &ldquo;Cancel&rdquo;; Input #1: reference::YorN ]</li>
<li>#</li>
<li>#C) END ask for delete confirmation</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#D) BEGIN delete</li>
<li>#</li>
<li>#1) halt delete if the user typed nothing or hit the cancel button</li>
<li>If [ reference::YorN = "" ]</li>
<li>Halt Script</li>
<li>#</li>
<li>#2) confirm user typed correct name</li>
<li>Else If [ reference::YorN  = steward::FirstPlusLast  or 

reference::YorN  = steward::FirstName  and  steward::LastName = "" ]</li>
<li>#</li>
<li>#3) delete</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Halt Script</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#4) if the user failed to follow directions give them another chance</li>
<li>Loop</li>
<li>Set Field [ reference::YorN; "" ]</li>
<li>Show Custom Dialog [ Title: "DELETE steward::FirstPlusLast"; Message: "Type the full name as shown below and click OK to delete all records for this person.  &para;&para;" 

&amp; steward::FirstPlusLast; Buttons: &ldquo;OK&rdquo;, &ldquo;Cancel&rdquo;; Input #1: reference::YorN ]</li>
<li>Exit Loop If [ reference::YorN    =    steward::FirstPlusLast

 or 

reference::YorN  = steward::FirstName  and  steward::LastName = ""

or  

reference::YorN    =    "" ]</li>
<li>End Loop</li>
<li>#</li>
<li>#5) halt delete if the user typed nothing or hit the cancel button</li>
<li>If [ reference::YorN = "" ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#6) delete</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Halt Script</li>
<li>#</li>
<li>#D) END delete</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>steward</em>::FirstName</li>
<li>
<em>steward</em>::LastName</li>
<li>
<em>reference</em>::YorN</li>
<li>
<em>steward</em>::FirstPlusLast</li>
<li>&lt;Missing Field&gt;</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32860ScriptAnchor_"></a><td class="script_navbar"><a href="#32904ScriptAnchor_"><span>Previous Script: [deleteFarmer]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#33195ScriptAnchor_"><span>Next Script: [allSolutionsMenu]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">editFarmer</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go to createEdit farmer layout and show all users.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 go to the edit/create layout and show all users.</li>
<li>Go to Layout [ &ldquo;users&rdquo; (steward) ]</li>
<li>Show All Records</li>
<li>Close Window [ Name: "Day"; Current file ]</li>
<li>Close Window [ Name: "Specific Action"; Current file ]</li>
<li>Close Window [ Name: "Tag"; Current file ]</li>
<li>#</li>
<li>#Set window title.</li>
<li>Set Window Title [ Current Window; New Title: "HelpGiveThanks Solutions" ]</li>
<li>#</li>
<li>#Size window to 100%</li>
<li>Set Zoom Level
[ 100% ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>users</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33195ScriptAnchor_"></a><td class="script_navbar"><a href="#32860ScriptAnchor_"><span>Previous Script: [editFarmer]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#32861ScriptAnchor_"><span>Next Script: [switchFarmer]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">allSolutionsMenu</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go to all solutions menu.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 go to the edit/create layout and show all users.</li>
<li>Close Window [ Name: "All Solutions"; Current file ]</li>
<li>New Window [ Name: "All Solutions" ]</li>
<li>Go to Layout [ &ldquo;allSolutionsMenu&rdquo; (steward) ]</li>
<li>Show All Records</li>
<li>#</li>
<li>#Size window to 100%</li>
<li>Set Zoom Level
[ 100% ]</li>
<li>Adjust Window
[ Resize to Fit ]</li>
<li>#</li>
<li>#</li>
<li>#Set variable that will close this other apps menu</li>
<li>#when the user selectes a new database.</li>
<li>Set Variable [ $$otherApps; Value:1 ]</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>allSolutionsMenu</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32861ScriptAnchor_"></a><td class="script_navbar"><a href="#33195ScriptAnchor_"><span>Previous Script: [allSolutionsMenu]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#32870ScriptAnchor_"><span>Next Script: [time]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">switchFarmer</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE switch from one user's records to anothers via the reference field farmer which is a global field holding the current ID number of the current user.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 capture selected userID chosen</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>#</li>
<li>#2 find this user's records</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#3 if the user has no records, create a new one and assign it to the user so that there name will show up.  (All the layouts are tied to the brainstate table not the user table.  So the only way to show a user name  and all the correct formating attributes is to have one user record.)</li>
<li>If [ Get ( LastError ) = 401 ]</li>
<li>Set Field [ reference::farmerID; "" ]</li>
<li>Go to Field [ reference::farmerID ]</li>
<li>Halt Script</li>
<li>Else If [ Get ( LastError ) &ne; 0 ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error performing switchFarmer script"; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Go to Layout [ &ldquo;users&rdquo; (steward) ]</li>
<li>Show All Records</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#4 show the user's name</li>
<li>Set Field [ reference::farmerName; steward::FirstPlusLast ]</li>
<li>#</li>
<li>#5 show/hide all records according the user's last settings</li>
<li>If [ steward::retiredStatus = "r" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>If [ steward::hideStatus = "" and steward::showORhide = "hide" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::hide: &ldquo;t&rdquo; ]
[ Restore ]</li>
<li>Else If [ steward::showStatus  &ne;  "" and steward::showORhide = "show" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::Show: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>#</li>
<li>#6 go to user's chosen day, sort records, and choose last used layout</li>
<li>If [ Left ( steward::chosenLayout ; 2 ) = "01" ]</li>
<li>Perform Script [ &ldquo;to 1&rdquo; ]</li>
<li>Else If [ Left ( steward::chosenLayout ; 2 ) = "07" ]</li>
<li>Perform Script [ &ldquo;to 7&rdquo; ]</li>
<li>Else If [ Left ( steward::chosenLayout ; 2 ) = "31" ]</li>
<li>Perform Script [ &ldquo;to 31&rdquo; ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>brainstate</em>::_keyUser</li>
<li>
<em>steward</em>::FirstPlusLast</li>
<li>
<em>reference</em>::farmerName</li>
<li>
<em>steward</em>::retiredStatus</li>
<li>
<em>brainstate</em>::sortRetired</li>
<li>
<em>steward</em>::hideStatus</li>
<li>
<em>steward</em>::showORhide</li>
<li>
<em>brainstate</em>::hide</li>
<li>
<em>steward</em>::showStatus</li>
<li>
<em>brainstate</em>::Show</li>
<li>
<em>steward</em>::chosenLayout</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32839ScriptAnchor_">to 1</a></li>
<li><a href="#32908ScriptAnchor_">to 7</a></li>
<li><a href="#32910ScriptAnchor_">to 31</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>users</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32870ScriptAnchor_"></a><td class="script_navbar"><a href="#32861ScriptAnchor_"><span>Previous Script: [switchFarmer]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#32942ScriptAnchor_"><span>Next Script: [CHUNK_deleteTotalOrGrandtotalRecord]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">time</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE script attached to the time button on the edit time layouts.  It checks if user is in a time field, and if they are inserts the current time into it, and if they are not tells them how to use the time button.</li>
<li>#</li>
<li>#</li>
<li>If [ brainstate::_lockBrainstateID = brainstate::groupID ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#1 determine if the user is in a time field</li>
<li>If [ Get ( ActiveFieldName )   =   "swPause" or Get ( ActiveFieldName )   =   "swStart" ]</li>
<li>#</li>
<li>#2 if they are then insert the current time into it</li>
<li>Insert Current Time [  ]
[ Select ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#2 if they are not tell them how to use this button</li>
<li>Show Custom Dialog [ Title: "!"; Message: "This button is for inserting the current time into a stop or start time field."; Buttons: &ldquo;OK&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::groupID</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32942ScriptAnchor_"></a><td class="script_navbar"><a href="#32870ScriptAnchor_"><span>Previous Script: [time]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"><a href="#32940ScriptAnchor_"><span>Next Script: [CHUNK_deleteRecordsTimeFromTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNK_deleteTotalOrGrandtotalRecord</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#110ScriptAnchor_">deleteBrainstate</a></li>
<li><a href="#33023ScriptAnchor_">deleteBrainstateFromTotal</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE delete a total or grand total record and also clear the linked records of their link to it (the records that add up to the total/grandtotal being deleted).</li>
<li>#CHUNK USED BY DeleteBrainstate Script</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#NOTE: the three # symbols set apart chunks of script.  </li>
<li>#NOTE: the finish and error script chunks are almost identical (the error message differ in telling where in the script they occur).  For this reason, they are not numbered as part of a particular chuck of the script, and are separated by three # symbols to set them apart.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>#</li>
<li>#A BEGIN delete total record</li>
<li>#</li>
<li>#1 if total record find all linked records so that they can be cleared of their link</li>
<li>If [ brainstate::groupType = "merge" ]</li>
<li>Set Variable [ $mergeID; Value:brainstate::groupID ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupID; $mergeID ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN find error 1</li>
<li>If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number.
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming CHUNK_deleteTotalOrGrandtotalRecord script part A1."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#Find all records user had showing when they clicked the merge button</li>
<li>Perform Script [ &ldquo;goBackButton&rdquo; ]</li>
<li>End If</li>
<li>#END find error 1
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#2 clear all the linked record's linked to the old total record</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::groupID; "" ]</li>
<li>Set Field [ brainstate::groupDisplayID; "" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#3 sort the total record to the top and mark it for deletion. (Delete is the last step in the process so if the computer crashes or loses power the user can still complete the delete process. If the record was deleted before the links the where deleted and the computer crashed, those linked records would forever be linked to the now deleted total record unless the user could directly access the data table.)</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupType; based on value list: &ldquo;MergeSort&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $$deleteID; Value:brainstate::_lockBrainstateID ]</li>
<li>If [ brainstate::groupOfGroupID &ne; "" ]</li>
<li>#</li>
<li>#4 capture total record's ID number from the record to be deleted and then omit this soon to be deleted record</li>
<li>Set Variable [ $brainstateID; Value:brainstate::groupOfGroupID ]</li>
<li>Set Variable [ $displayID; Value:brainstate::_Number ]</li>
<li>Set Variable [ $description; Value:brainstate::description ]</li>
<li>Set Field [ brainstate::description; "   delete interrupted!  click here for info:  This record should be deleted, along with this total record ID number -- "  &amp; $brainstateID  &amp; ".  You can then rebuild it using the total process.  //  "  &amp; $description ]</li>
<li>Set Field [ brainstate::groupOfGroupID; "" ]</li>
<li>Omit Record</li>
<li>#</li>
<li>#5 make a list of the grandtotal records it is being removed from so that they can be used to re-total the grandtotal</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_lockBrainstateID; $brainstateID ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupAddCheckbox; descending
brainstate::groupType; based on value list: &ldquo;MergeSort&rdquo; ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Field [ brainstate::linkinfo; brainstate::linkinfo &amp; "&para;&para;"  &amp; Get ( CurrentTimeStamp ) &amp; " Deleted: " &amp; $displayID  &amp; " " &amp; $description ]</li>
<li>#</li>
<li>#6 subtract record's time from grandtotal</li>
<li>Perform Script [ &ldquo;CHUNK_recalculateGrandTotal&rdquo; ]</li>
<li>#</li>
<li>#7 delete the record chosen to be deleted</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_lockBrainstateID; $$deleteID ]</li>
<li>Perform Find [  ]</li>
<li>If [ brainstate::_lockBrainstateID = $$deleteID ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Else If [ brainstate::_lockBrainstateID  &ne;  $$deleteID ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Error peforming A7 of the CHUNK_deleteTotalOrGrandtotalRecord script."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#8 if user was on the viewGrandtotal layout find only those records that are part of the grandtotal being viewed prior to deleting and show the user those records on that layout.</li>
<li>If [ Left ( $$deletelayout ; 5 ) = "viewG" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupOfGroupID; $brainstateID ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Layout [ &ldquo;GrandTotal&rdquo; (brainstate) ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#9 if user was not on the viewgrandotal layout go back to the layout user was on and show records that users was looking at</li>
<li>Perform Script [ &ldquo;goBackButton&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>#9 delete total record</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Set Variable [ $$deleteID; Value:"total" ]</li>
<li>Perform Script [ &ldquo;goBackButton&rdquo; ]</li>
<li>Halt Script</li>
<li>#</li>
<li>#A END delete total record</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#B BEGIN delete grandtotal record</li>
<li>#</li>
<li>#1 if grand total record find all linked records so that they can be cleared of their link</li>
<li>Else If [ brainstate::groupType = "mergeGrand" ]</li>
<li>Set Variable [ $mergeID; Value:brainstate::groupOfGroupID ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupOfGroupID; $mergeID ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#BEGIN find error 2</li>
<li>If [ Get ( LastError )   &ne; 0 ]</li>
<li>#tell user the error number.
</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming delete script part C8."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#Find all records user had showing when they clicked the merge button</li>
<li>Perform Script [ &ldquo;goBackButton&rdquo; ]</li>
<li>End If</li>
<li>#END find error 2
</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#2 clear all the linked record's linked to the old grand total record</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::groupOfGroupID; "" ]</li>
<li>Set Field [ brainstate::groupOfGroupDisplayID; "" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#3 sort the grandtotal record to the top and delete it</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupType; based on value list: &ldquo;MergeSort&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $$deleteID; Value:brainstate::_lockBrainstateID ]</li>
<li>If [ brainstate::_lockBrainstateID = $$deleteID ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Else If [ brainstate::_lockBrainstateID  &ne;  $$deleteID ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Error peforming B2 of the CHUNK_deleteTotalOrGrandtotalRecord script."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#4 return user to previous layout and halt the script</li>
<li>Set Variable [ $$deleteID; Value:"grandtotal" ]</li>
<li>Perform Script [ &ldquo;goBackButton&rdquo; ]</li>
<li>Halt Script</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#B END delete grandtotal record</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>brainstate</em>::groupDisplayID</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::groupOfGroupID</li>
<li>
<em>brainstate</em>::_Number</li>
<li>
<em>brainstate</em>::groupAddCheckbox</li>
<li>
<em>brainstate</em>::linkinfo</li>
<li>
<em>brainstate</em>::groupOfGroupDisplayID</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32934ScriptAnchor_">goBackButton</a></li>
<li><a href="#32939ScriptAnchor_">CHUNK_recalculateGrandTotal</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>calcBrainstateTable</li>
<li>GrandTotal</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32940ScriptAnchor_"></a><td class="script_navbar"><a href="#32942ScriptAnchor_"><span>Previous Script: [CHUNK_deleteTotalOrGrandtotalRecord]</span></a></td><td class="script_navbar"><a href="#32881ScriptAnchor_"><span>Parent Folder: [action buttons]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNK_deleteRecordsTimeFromTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#110ScriptAnchor_">deleteBrainstate</a></li>
<li><a href="#33023ScriptAnchor_">deleteBrainstateFromTotal</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE find the to-be-deleted record's total record, omit the to-be-deleted record and then start the process of updating the total records day records (subtracting the to-be-deleted record's time from these records).  By omitting the to-be-deleted at this stage if the computer crashes or loses power and is then re-booted the program will show that the to-be-deleted still in need of deleting and the process can be done again becuase the delete takes place as the final part of the script.</li>
<li>#CHUNK USED BY DeleteBrainstate Script</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 capture total record's ID number from the record to be deleted and then omit this soon to be deleted record</li>
<li>Set Variable [ $brainstateID; Value:brainstate::groupID ]</li>
<li>Set Variable [ $$deleteID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $displayID; Value:brainstate::_Number ]</li>
<li>Set Variable [ $totaldisplayID; Value:brainstate::groupDisplayID ]</li>
<li>Set Variable [ $description; Value:brainstate::description ]</li>
<li>Set Field [ brainstate::description; "   delete interrupted!  click here for info:  This record is fine, the bad news is the record that totaled its time may have been corrupted.  So this total record ID number -- "  &amp; $totaldisplayID  &amp; " -- should be deleted and rebuilt if you still want it.  //  "  &amp; $description ]</li>
<li>Set Field [ brainstate::groupID; "" ]</li>
<li>Set Field [ brainstate::groupDisplayID; "" ]</li>
<li>#</li>
<li>#2 find all records linked to this total record</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupID; $brainstateID ]</li>
<li>Perform Find [  ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::description: &ldquo;"   delete inter"&rdquo; ]
[ Restore ]</li>
<li>#</li>
<li>#DISABLED: I thought these next steps where a good idea: to delete total records with nothing to total.  But after thinking about it, I now think I should allow the user to do this.  There is no harm in having a non-working total record.  It can always be used again by adding records to it to total, or by turning it into a regular record.)</li>
<li>//  #3 determine if user has deleted all records to total</li>
<li>//  If [ Get ( FoundCount )  = 1 and brainstate::_lockBrainstateID = brainstate::groupID ]</li>
<li>//  #</li>
<li>//  #4 capture total record's mergeID</li>
<li>//  Set Variable [ $brainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>//  #</li>
<li>//  #5 flag for grand total update</li>
<li>//  If [ brainstate::groupOfGroupID &ne; "" ]</li>
<li>//  Set Field [ brainstate::groupOfGroupUpdate; "u" ]</li>
<li>//  End If</li>
<li>//  #</li>
<li>//  #6 tell user this record is being deleted and why.  </li>
<li>//  Go to Layout [ &lt;unknown&gt; ]</li>
<li>//  Show Custom Dialog [ Title: "!"; Message: "This total record has no more records to total and so it is being deleted.  You can always re-create it by clicking the total button."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>//  Delete Record/Request
[ No dialog ]</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ brainstate::_lockBrainstateID; $$deleteID ]</li>
<li>//  Perform Find [  ]</li>
<li>//  Delete Record/Request
[ No dialog ]</li>
<li>//  Perform Script [ &ldquo;goBackButton&rdquo; ]</li>
<li>//  Halt Script</li>
<li>//  End If</li>
<li>#</li>
<li>#4 capture total record's mergeID and remove the t from its merge field</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupType; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ Last ]</li>
<li>Set Variable [ $brainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Field [ brainstate::linkinfo; brainstate::linkinfo &amp; "&para;&para;"  &amp; Get ( CurrentTimeStamp ) &amp; " Deleted: " &amp; $displayID  &amp; " " &amp; $description ]</li>
<li>#</li>
<li>#5 flag for grand total update</li>
<li>Set Field [ brainstate::groupOfGroupUpdate; If ( brainstate::groupOfGroupID &ne; "" ; "u" ; "" ) ]</li>
<li>#</li>
<li>Perform Script [ &ldquo;CHUNK_recalculateTotal&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::_Number</li>
<li>
<em>brainstate</em>::groupDisplayID</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>brainstate</em>::groupOfGroupID</li>
<li>
<em>brainstate</em>::groupOfGroupUpdate</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::linkinfo</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32934ScriptAnchor_">goBackButton</a></li>
<li><a href="#32941ScriptAnchor_">CHUNK_recalculateTotal</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Layout&gt;</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="32883ScriptAnchor_"></a><a href="#32883ScriptAnchor_toc">show/hide buttons and checkboxes</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32865ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#32883ScriptAnchor_"><span>Parent Folder: [show/hide buttons and checkboxes]</span></a></td><td class="script_navbar"><a href="#33060ScriptAnchor_"><span>Next Script: [CHUNK_retire]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">retireButton</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33105ScriptAnchor_">editTimePart1</a></li>
<li><a href="#32836ScriptAnchor_">HideButton</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE set the status for whether or not to show retired records and then show or hide them.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#2 set the retired status to blank</li>
<li>#</li>
<li>//  If [ Left ( $$loglayout ; 5 ) = "total" ]</li>
<li>//  Perform Script [ &ldquo;retireButtonOnViewLayout&rdquo; ]</li>
<li>//  End If</li>
<li>#</li>
<li>#4 set the retired status to r (not blank because it now has an r in it)</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>Set Variable [ $mergeID; Value:brainstate::groupID ]</li>
<li>#</li>
<li>#2 toggle the retired status field</li>
<li>If [ steward::retiredStatus = "" ]</li>
<li>Set Field [ steward::retiredStatus; "r" ]</li>
<li>Else If [ steward::retiredStatus &ne; "" ]</li>
<li>Set Field [ steward::retiredStatus; "" ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#1 set the current find status to hide.  The show and hide scripts use the showORhide field to determine if the user wants to hide or show marked records.  This field also is used to format the hide and show buttons to visually tell the user which of the two is currently selected, or if neither of the two is selected (this field is blank).</li>
<li>#</li>
<li>#2 if the hide status is blank and the user clicks the hide button then they want to hide records records marked hide (hide=t), so find only blank records, will have the effect of omitting all non-blank records.</li>
<li>If [ steward::hideStatus   &ne;  "" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupType; "merge" ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#BEGIN find error 1</li>
<li>If [ Get ( LastError ) &ne; 0 ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming HideButton script part 1."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Go to Layout [ original layout ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END find error 1</li>
<li>#</li>
<li>#4 it the user wants retired records hidden then hide these records if any</li>
<li>//  If [ steward::retiredStatus &ne; "" ]</li>
<li>//  Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>//  Extend Found Set [ Specified Find Requests: Find Records; Criteria: brainstate::hide: &ldquo;t&rdquo; AND brainstate::sortRetired: &ldquo;=&rdquo; AND brainstate::groupDisplayID: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>//  Else If [ steward::retiredStatus = "" ]</li>
<li>//  Extend Found Set [ Specified Find Requests: Find Records; Criteria: brainstate::hide: &ldquo;t&rdquo; AND brainstate::groupDisplayID: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>//  End If</li>
<li>Perform Script [ &ldquo;CHUNK_retire&rdquo; ]</li>
<li>#</li>
<li>#3 set the hide status to blank, remove the focus from any field, and resort the records according the user's current sort status</li>
<li>Perform Script [ &ldquo;DaySelectSortThenSort&rdquo; ]</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#6 if the hide status is not blank and the user clicks the hide button then they want to show all records, so find all records</li>
<li>If [ steward::hideStatus = "" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Set Field [ brainstate::hide; "t" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#BEGIN find error 2</li>
<li>If [ Get ( LastError ) &ne; 0 ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming HideButton script part 6."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Go to Layout [ original layout ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END find error 2</li>
<li>#</li>
<li>#8 it the user wants retired records hidden then hide these records if any</li>
<li>//  If [ steward::retiredStatus &ne; "" ]</li>
<li>//  Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>//  Extend Found Set [ Specified Find Requests: Find Records; Criteria: brainstate::hide: &ldquo;t&rdquo; AND brainstate::sortRetired: &ldquo;=&rdquo; AND brainstate::groupDisplayID: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>//  Else If [ steward::retiredStatus = "" ]</li>
<li>//  Extend Found Set [ Specified Find Requests: Find Records; Criteria: brainstate::hide: &ldquo;t&rdquo; AND brainstate::groupDisplayID: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>//  End If</li>
<li>Perform Script [ &ldquo;CHUNK_retire&rdquo; ]</li>
<li>#</li>
<li>#7 set the hide status to t (not blank), remove the focus from any field, and resort the records according the user's current sort status</li>
<li>//  Perform Script [ &ldquo;DaySelectSortThenSort&rdquo; ]</li>
<li>#</li>
<li>End If</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>steward</em>::retiredStatus</li>
<li>
<em>steward</em>::hideStatus</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::_keyUser</li>
<li>
<em>brainstate</em>::sortRetired</li>
<li>
<em>brainstate</em>::hide</li>
<li>
<em>brainstate</em>::groupDisplayID</li>
<li>
<em>brainstate</em>::sortNumber</li>
<li>
<em>brainstate</em>::sortAlpha</li>
<li>
<em>brainstate</em>::sortSubNumber</li>
<li>
<em>brainstate</em>::sortCategory</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33024ScriptAnchor_">retireButtonOnViewLayout</a></li>
<li><a href="#33060ScriptAnchor_">CHUNK_retire</a></li>
<li><a href="#32902ScriptAnchor_">DaySelectSortThenSort</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33060ScriptAnchor_"></a><td class="script_navbar"><a href="#32865ScriptAnchor_"><span>Previous Script: [retireButton]</span></a></td><td class="script_navbar"><a href="#32883ScriptAnchor_"><span>Parent Folder: [show/hide buttons and checkboxes]</span></a></td><td class="script_navbar"><a href="#33024ScriptAnchor_"><span>Next Script: [retireButtonOnViewLayout]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNK_retire</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32903ScriptAnchor_">goToFarmer</a></li>
<li><a href="#33023ScriptAnchor_">deleteBrainstateFromTotal</a></li>
<li><a href="#32865ScriptAnchor_">retireButton</a></li>
<li><a href="#33030ScriptAnchor_">goBackButton_FindRecordsChunk</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE set the status for whether or not to show retired records and then show or hide them.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#2 set the retired status to blank</li>
<li>#8 it the user wants retired records hidden then hide these records if any</li>
<li>If [ steward::retiredStatus &ne; "" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::hide; "t" ]</li>
<li>Set Field [ brainstate::sortRetired; "=" ]</li>
<li>Set Field [ brainstate::groupDisplayID; "=" ]</li>
<li>Set Field [ brainstate::_keyUser; reference::farmerID ]</li>
<li>Extend Found Set [  ]</li>
<li>Else If [ steward::retiredStatus = "" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::hide; "t" ]</li>
<li>Set Field [ brainstate::groupDisplayID; "=" ]</li>
<li>Set Field [ brainstate::_keyUser; reference::farmerID ]</li>
<li>Extend Found Set [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::retiredStatus</li>
<li>
<em>brainstate</em>::sortRetired</li>
<li>
<em>brainstate</em>::hide</li>
<li>
<em>brainstate</em>::groupDisplayID</li>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>brainstate</em>::_keyUser</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33024ScriptAnchor_"></a><td class="script_navbar"><a href="#33060ScriptAnchor_"><span>Previous Script: [CHUNK_retire]</span></a></td><td class="script_navbar"><a href="#32883ScriptAnchor_"><span>Parent Folder: [show/hide buttons and checkboxes]</span></a></td><td class="script_navbar"><a href="#32806ScriptAnchor_"><span>Next Script: [retireCheckbox]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">retireButtonOnViewLayout</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32865ScriptAnchor_">retireButton</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE set the status for whether or not to show retired records and then show or hide them.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>Set Variable [ $layoutname; Value:Get ( LayoutName ) ]</li>
<li>Set Variable [ $totalRecord; Value:brainstate::groupID ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 if the retired status is not blank and the user clicks the retired button then they want to show all retired records, so find all records</li>
<li>If [ steward::retiredStatus  &ne;  "" ]</li>
<li>#future developement: omit retired records if the retired button is on</li>
<li>//  If [ Get ( LayoutName ) = "viewTotal" or Get ( LayoutName ) = "viewGrandtotal" ]</li>
<li>//  Extend Found Set [ Specified Find Requests: Find Records; Criteria: brainstate::hide: &ldquo;t&rdquo; ]
[ Restore ]</li>
<li>//  Halt Script</li>
<li>//  End If</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Set Field [ brainstate::groupID; $totalRecord ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#BEGIN find error 1</li>
<li>If [ Get ( LastError ) &ne; 0 ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming RetireButton script part 1."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Go to Layout [ $layoutname ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END find error 1</li>
<li>#</li>
<li>#2 set the retired status to blank</li>
<li>Set Field [ steward::retiredStatus; "" ]</li>
<li>#</li>
<li>#3 if the retired status is blank and the user clicks the retired button then they want to hide all retired records, so omit retired records from the users set of records</li>
<li>Else If [ steward::retiredStatus  =   "" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Set Field [ brainstate::sortRetired; "=" ]</li>
<li>Set Field [ brainstate::groupID; $totalRecord ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#BEGIN find error 2</li>
<li>If [ Get ( LastError ) &ne; 0 ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming RetireButton script part 3."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Go to Layout [ $layoutname ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END find error 2</li>
<li>#</li>
<li>#4 set the retired status to r (not blank because it now has an r in it)</li>
<li>Set Field [ steward::retiredStatus; "r" ]</li>
<li>End If</li>
<li>Perform Script [ &ldquo;DaySelectSortThenSort&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>steward</em>::retiredStatus</li>
<li>
<em>brainstate</em>::hide</li>
<li>
<em>brainstate</em>::_keyUser</li>
<li>
<em>brainstate</em>::sortRetired</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32902ScriptAnchor_">DaySelectSortThenSort</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Layout&gt;</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32806ScriptAnchor_"></a><td class="script_navbar"><a href="#33024ScriptAnchor_"><span>Previous Script: [retireButtonOnViewLayout]</span></a></td><td class="script_navbar"><a href="#32883ScriptAnchor_"><span>Parent Folder: [show/hide buttons and checkboxes]</span></a></td><td class="script_navbar"><a href="#32836ScriptAnchor_"><span>Next Script: [HideButton]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">retireCheckbox</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE change the user's retired status and note this change in the records info box</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 retire the record and note this change in status. (The if test says to look for a non-blank record and this is because the checkbox has inserted the letter r before this script is activated.  So the record will not be blank when the user wants it retired.)</li>
<li>If [ brainstate::sortRetired  &ne;  "" ]</li>
<li>Set Field [ brainstate::linkinfo; brainstate::linkinfo &amp; "&para;&para;retired: " &amp; Get ( CurrentTimeStamp ) ]</li>
<li>End If</li>
<li>#neccessary step to remove focus from checkbox</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#2 if the user current has elected to hide all retired records hide this newly retired record and also tell user why it is being hidden/omitted.</li>
<li>If [ brainstate::sortRetired  &ne;  ""  and steward::retiredStatus &ne; "" ]</li>
<li>Show Custom Dialog [ Title: "retired"; Message: "You currently have the hide retired or r button on.  So this record will now be hidden.  &para;&para;To see this record again, click the r button."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Omit Record</li>
<li>End If</li>
<li>#</li>
<li>#3 un- retire the record and note this change in status. (The if test says to look for a  record and this is because the checkbox has deleted the letter r before this script is activated.  So the record will be blank when the user wants the record un-retired.)</li>
<li>If [ brainstate::sortRetired   =  "" ]</li>
<li>Set Field [ brainstate::sortRetired; "" ]</li>
<li>Set Field [ brainstate::linkinfo; brainstate::linkinfo &amp; "&para;&para;un-retired: " &amp; Get ( CurrentTimeStamp ) ]</li>
<li>End If</li>
<li>#neccessary step to remove focus from checkbox</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::sortRetired</li>
<li>
<em>brainstate</em>::linkinfo</li>
<li>
<em>steward</em>::retiredStatus</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32836ScriptAnchor_"></a><td class="script_navbar"><a href="#32806ScriptAnchor_"><span>Previous Script: [retireCheckbox]</span></a></td><td class="script_navbar"><a href="#32883ScriptAnchor_"><span>Parent Folder: [show/hide buttons and checkboxes]</span></a></td><td class="script_navbar"><a href="#33030ScriptAnchor_"><span>Next Script: [goBackButton_FindRecordsChunk]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">HideButton</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE set the status for whether or not to show or hide records marked hide and then show or hide them.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>//  #1 set the current find status to hide.  The show and hide scripts use the showORhide field to determine if the user wants to hide or show marked records.  This field also is used to format the hide and show buttons to visually tell the user which of the two is currently selected, or if neither of the two is selected (this field is blank).</li>
<li>//  Set Field [ steward::showORhide; "hide" ]</li>
<li>//  If [ Left ( $$loglayout ; 5 ) = "total" ]</li>
<li>//  Perform Script [ &ldquo;retireButton&rdquo; ]</li>
<li>//  End If</li>
<li>#</li>
<li>#2 if the hide status is blank and the user clicks the hide button then they want to hide records records marked hide (hide=t), so find only blank records, will have the effect of omitting all non-blank records.</li>
<li>If [ steward::hideStatus  =  "" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupType; "merge" ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>#FIX COMMENT</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::hide; "t" ]</li>
<li>Set Field [ brainstate::groupID; "=" ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Extend Found Set [  ]</li>
<li>#</li>
<li>#BEGIN find error 1</li>
<li>If [ Get ( LastError ) &ne; 0 ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming HideButton script part 1."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Go to Layout [ original layout ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END find error 1</li>
<li>#</li>
<li>#3 set the hide status to blank, remove the focus from any field, and resort the records according the user's current sort status</li>
<li>Set Field [ steward::showORhide; "hide" ]</li>
<li>Set Field [ steward::hideStatus; "t" ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#4 it the user wants retired records hidden then hide these records if any</li>
<li>If [ steward::retiredStatus  &ne;  "" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>#</li>
<li>#5 go to the first record and halt the script</li>
<li>Perform Script [ &ldquo;DaySelectSortThenSort&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#6 if the hide status is not blank and the user clicks the hide button then they want to show all records, so find all records</li>
<li>If [ steward::hideStatus &ne; "" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Set Field [ brainstate::hide; "t" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#BEGIN find error 2</li>
<li>If [ Get ( LastError ) &ne; 0 ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming HideButton script part 6."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Go to Layout [ original layout ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END find error 2</li>
<li>#</li>
<li>#7 set the hide status to t (not blank), remove the focus from any field, and resort the records according the user's current sort status</li>
<li>Set Field [ steward::showORhide; "show" ]</li>
<li>Set Field [ steward::hideStatus; "" ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#8 it the user wants retired records hidden then hide these records if any</li>
<li>If [ steward::retiredStatus  &ne;  "" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>#</li>
<li>#9 go to the first record and halt the script</li>
<li>Perform Script [ &ldquo;DaySelectSortThenSort&rdquo; ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>steward</em>::showORhide</li>
<li>
<em>steward</em>::hideStatus</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::_keyUser</li>
<li>
<em>brainstate</em>::hide</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>steward</em>::retiredStatus</li>
<li>
<em>brainstate</em>::sortRetired</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32865ScriptAnchor_">retireButton</a></li>
<li><a href="#32902ScriptAnchor_">DaySelectSortThenSort</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33030ScriptAnchor_"></a><td class="script_navbar"><a href="#32836ScriptAnchor_"><span>Previous Script: [HideButton]</span></a></td><td class="script_navbar"><a href="#32883ScriptAnchor_"><span>Parent Folder: [show/hide buttons and checkboxes]</span></a></td><td class="script_navbar"><a href="#32862ScriptAnchor_"><span>Next Script: [ShowButton]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">goBackButton_FindRecordsChunk</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32934ScriptAnchor_">goBackButton</a></li>
<li><a href="#32829ScriptAnchor_">updateTime</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE set the status for whether or not to show or hide records marked hide and then show or hide them.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>//  #1 set the current find status to hide.  The show and hide scripts use the showORhide field to determine if the user wants to hide or show marked records.  This field also is used to format the hide and show buttons to visually tell the user which of the two is currently selected, or if neither of the two is selected (this field is blank).</li>
<li>//  Set Field [ steward::showORhide; "hide" ]</li>
<li>#</li>
<li>#2 if the hide status is blank and the user clicks the hide button then they want to hide records records marked hide (hide=t), so find only blank records, will have the effect of omitting all non-blank records.</li>
<li>If [ steward::hideStatus   &ne;  ""  or $$hide &ne; "" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::groupType; "merge" ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Perform Find [  ]</li>
<li>#FIX COMMENT</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::hide; "t" ]</li>
<li>Set Field [ brainstate::groupID; "=" ]</li>
<li>Extend Found Set [  ]</li>
<li>#</li>
<li>#BEGIN find error 1</li>
<li>If [ Get ( LastError ) &ne; 0 ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming HideButton script part 1."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Go to Layout [ original layout ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END find error 1</li>
<li>#</li>
<li>#3 set the hide status to blank, remove the focus from any field, and resort the records according the user's current sort status</li>
<li>//  Perform Script [ &ldquo;sortRestoreAfterScript&rdquo; ]</li>
<li>#</li>
<li>#4 it the user wants retired records hidden then hide these records if any</li>
<li>//  If [ steward::retiredStatus &ne; "" ]</li>
<li>//  Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>//  Extend Found Set [ Specified Find Requests: Find Records; Criteria: brainstate::hide: &ldquo;t&rdquo; AND brainstate::sortRetired: &ldquo;=&rdquo; AND brainstate::groupDisplayID: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>//  Else If [ steward::retiredStatus = "" ]</li>
<li>//  Extend Found Set [ Specified Find Requests: Find Records; Criteria: brainstate::hide: &ldquo;t&rdquo; AND brainstate::groupDisplayID: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>//  End If</li>
<li>Perform Script [ &ldquo;CHUNK_retire&rdquo; ]</li>
<li>#</li>
<li>#5 go to the first record and halt the script</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>#</li>
<li>#6 if the hide status is not blank and the user clicks the hide button then they want to show all records, so find all records</li>
<li>If [ steward::hideStatus = "" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $userID ]</li>
<li>Set Field [ brainstate::hide; "t" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#BEGIN find error 2</li>
<li>If [ Get ( LastError ) &ne; 0 ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error " &amp; Get  ( LastError )   &amp;  " peforming HideButton script part 6."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Go to Layout [ original layout ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>#END find error 2</li>
<li>#</li>
<li>#7 set the hide status to t (not blank), remove the focus from any field, and resort the records according the user's current sort status</li>
<li>//  Perform Script [ &ldquo;sortRestoreAfterScript&rdquo; ]</li>
<li>#</li>
<li>#8 it the user wants retired records hidden then hide these records if any</li>
<li>//  If [ steward::retiredStatus &ne; "" ]</li>
<li>//  Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>//  Extend Found Set [ Specified Find Requests: Find Records; Criteria: brainstate::hide: &ldquo;t&rdquo; AND brainstate::sortRetired: &ldquo;=&rdquo; AND brainstate::groupDisplayID: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>//  Else If [ steward::retiredStatus = "" ]</li>
<li>//  Extend Found Set [ Specified Find Requests: Find Records; Criteria: brainstate::hide: &ldquo;t&rdquo; AND brainstate::groupDisplayID: &ldquo;=&rdquo; ]
[ Restore ]</li>
<li>//  End If</li>
<li>Perform Script [ &ldquo;CHUNK_retire&rdquo; ]</li>
<li>#</li>
<li>#9 go to original record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ brainstate::_lockBrainstateID = $$record ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>steward</em>::showORhide</li>
<li>
<em>steward</em>::hideStatus</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::_keyUser</li>
<li>
<em>brainstate</em>::hide</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>steward</em>::retiredStatus</li>
<li>
<em>brainstate</em>::sortRetired</li>
<li>
<em>brainstate</em>::groupDisplayID</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32830ScriptAnchor_">sortRestoreAfterScript</a></li>
<li><a href="#33060ScriptAnchor_">CHUNK_retire</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32862ScriptAnchor_"></a><td class="script_navbar"><a href="#33030ScriptAnchor_"><span>Previous Script: [goBackButton_FindRecordsChunk]</span></a></td><td class="script_navbar"><a href="#32883ScriptAnchor_"><span>Parent Folder: [show/hide buttons and checkboxes]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">ShowButton</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Freeze Window</li>
<li>Set Field [ steward::showORhide; "show" ]</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>If [ steward::showStatus     =    "" ]</li>
<li>#This script is activited by the hide button.  When clicked the script performs a find of all the user records where the user has not clicked the view checkbox putting a 't' into the view field.   Thus it finds the users brainstate records with blank view fields.</li>
<li>Set Variable [ $user; Value:reference::farmerID ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::Show; "t" ]</li>
<li>Set Field [ brainstate::_keyUser; $user ]</li>
<li>#If the user wants to hide brainstate records than they want find only brainstate records where show = t; and if they want to show all brainstate records then they just perform a find for all their records regardless of show status.</li>
<li>Perform Find [  ]</li>
<li>#why?</li>
<li>If [ Get ( LastError ) = 401 ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $user ]</li>
<li>Perform Find [  ]</li>
<li>Else If [ Get ( LastError ) &ne; 0 ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error performing hide script"; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Set Field [ steward::showStatus; "t" ]</li>
<li>Go to Field [  ]</li>
<li>If [ steward::retiredStatus  &ne;  "" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::showStatus   &ne;   "" ]</li>
<li>#This script is activited by the hide button.  When clicked the script performs a find of all the user records where the user has not clicked the view checkbox putting a 't' into the view field.   Thus it finds the users brainstate records with blank view fields.</li>
<li>Set Variable [ $user; Value:reference::farmerID ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_keyUser; $user ]</li>
<li>#If the user wants to hide brainstate records than they want find only brainstate records where show = t; and if they want to show all brainstate records then they just perform a find for all their records regardless of show status.</li>
<li>Perform Find [  ]</li>
<li>If [ Get ( LastError ) = 401 ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error performing view script"; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Else If [ Get ( LastError ) &ne; 0 ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Unexpected error performing view script"; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Set Field [ steward::showStatus; "" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
<li>If [ steward::retiredStatus  &ne;  "" ]</li>
<li>Constrain Found Set [ Specified Find Requests: Omit Records; Criteria: brainstate::sortRetired: &ldquo;r&rdquo; ]
[ Restore ]</li>
<li>End If</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Halt Script</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::showORhide</li>
<li>
<em>steward</em>::showStatus</li>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>brainstate</em>::Show</li>
<li>
<em>brainstate</em>::_keyUser</li>
<li>
<em>steward</em>::retiredStatus</li>
<li>
<em>brainstate</em>::sortRetired</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="33214ScriptAnchor_"></a><a href="#33214ScriptAnchor_toc">action sort checkboxes</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33203ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#33214ScriptAnchor_"><span>Parent Folder: [action sort checkboxes]</span></a></td><td class="script_navbar"><a href="#33204ScriptAnchor_"><span>Next Script: [orderTagsB]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">orderTagsA</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Field [ steward::chosenTagOrderSort; 1 ]</li>
<li>Go to Object [ Object Name: "A" ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenTagOrderSort</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33204ScriptAnchor_"></a><td class="script_navbar"><a href="#33203ScriptAnchor_"><span>Previous Script: [orderTagsA]</span></a></td><td class="script_navbar"><a href="#33214ScriptAnchor_"><span>Parent Folder: [action sort checkboxes]</span></a></td><td class="script_navbar"><a href="#33205ScriptAnchor_"><span>Next Script: [orderTagsC]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">orderTagsB</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Field [ steward::chosenTagOrderSort; 2 ]</li>
<li>//  Go to Object [ Object Name: "B" ]</li>
<li>Go to Object [ Object Name: "A" ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenTagOrderSort</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33205ScriptAnchor_"></a><td class="script_navbar"><a href="#33204ScriptAnchor_"><span>Previous Script: [orderTagsB]</span></a></td><td class="script_navbar"><a href="#33214ScriptAnchor_"><span>Parent Folder: [action sort checkboxes]</span></a></td><td class="script_navbar"><a href="#33206ScriptAnchor_"><span>Next Script: [orderTagsD]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">orderTagsC</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Field [ steward::chosenTagOrderSort; 3 ]</li>
<li>Go to Object [ Object Name: "c" ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenTagOrderSort</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33206ScriptAnchor_"></a><td class="script_navbar"><a href="#33205ScriptAnchor_"><span>Previous Script: [orderTagsC]</span></a></td><td class="script_navbar"><a href="#33214ScriptAnchor_"><span>Parent Folder: [action sort checkboxes]</span></a></td><td class="script_navbar"><a href="#33020ScriptAnchor_"><span>Next Script: [checkRepeatDates]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">orderTagsD</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Field [ steward::chosenTagOrderSort; 4 ]</li>
<li>Go to Object [ Object Name: "D" ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenTagOrderSort</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33020ScriptAnchor_"></a><td class="script_navbar"><a href="#33206ScriptAnchor_"><span>Previous Script: [orderTagsD]</span></a></td><td class="script_navbar"><a href="#33214ScriptAnchor_"><span>Parent Folder: [action sort checkboxes]</span></a></td><td class="script_navbar"><a href="#33021ScriptAnchor_"><span>Next Script: [checkRepeatDatesMonth]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">checkRepeatDates</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ brainstate::scheduleRepeatEventYear &ne; "" ]</li>
<li>Show Custom Dialog [ Title: "pick one"; Message: "Choose to repeat item on specific weeks of the month OR every so many weeks, but not both."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Set Field [ brainstate::scheduleRepeatEventMonth; "" ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::scheduleRepeatEventYear</li>
<li>
<em>brainstate</em>::scheduleRepeatEventMonth</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33021ScriptAnchor_"></a><td class="script_navbar"><a href="#33020ScriptAnchor_"><span>Previous Script: [checkRepeatDates]</span></a></td><td class="script_navbar"><a href="#33214ScriptAnchor_"><span>Parent Folder: [action sort checkboxes]</span></a></td><td class="script_navbar"><a href="#33022ScriptAnchor_"><span>Next Script: [markAllDays]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">checkRepeatDatesMonth</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ brainstate::scheduleRepeatEventMonth &ne; "" ]</li>
<li>Show Custom Dialog [ Title: "pick one"; Message: "Choose to repeat item on specific weeks of the month OR every so many weeks, but not both."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Set Field [ brainstate::scheduleRepeatEventYear; "" ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::scheduleRepeatEventMonth</li>
<li>
<em>brainstate</em>::scheduleRepeatEventYear</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33022ScriptAnchor_"></a><td class="script_navbar"><a href="#33021ScriptAnchor_"><span>Previous Script: [checkRepeatDatesMonth]</span></a></td><td class="script_navbar"><a href="#33214ScriptAnchor_"><span>Parent Folder: [action sort checkboxes]</span></a></td><td class="script_navbar"><a href="#33028ScriptAnchor_"><span>Next Script: [hideCheckbox]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">markAllDays</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Field [ brainstate::schedule; "" ]</li>
<li>Set Field [ brainstate::schedule; "Sunday&para;Monday&para;Tuesday&para;Wednesday&para;Thursday&para;Friday&para;Saturday" ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::schedule</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33028ScriptAnchor_"></a><td class="script_navbar"><a href="#33022ScriptAnchor_"><span>Previous Script: [markAllDays]</span></a></td><td class="script_navbar"><a href="#33214ScriptAnchor_"><span>Parent Folder: [action sort checkboxes]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">hideCheckbox</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ brainstate::groupType &ne; "" ]</li>
<li>Set Field [ brainstate::hide; "t" ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::hide</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="32778ScriptAnchor_"></a><a href="#32778ScriptAnchor_toc">sorts</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32830ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#32902ScriptAnchor_"><span>Next Script: [DaySelectSortThenSort]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortRestoreAfterScript</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32932ScriptAnchor_">updateTimeAfterSeperate (OLD)</a></li>
<li><a href="#104ScriptAnchor_">goDay</a></li>
<li><a href="#33056ScriptAnchor_">goDayLastDayUsed</a></li>
<li><a href="#33018ScriptAnchor_">goPlus1</a></li>
<li><a href="#33033ScriptAnchor_">goPlus1iphone</a></li>
<li><a href="#33019ScriptAnchor_">goMinus1</a></li>
<li><a href="#33032ScriptAnchor_">goMinus1iphone</a></li>
<li><a href="#32921ScriptAnchor_">calendarDayCalc</a></li>
<li><a href="#33034ScriptAnchor_">calendarDayCalciphone</a></li>
<li><a href="#32994ScriptAnchor_">goDayTotal</a></li>
<li><a href="#32987ScriptAnchor_">calendarDayCalcTotal</a></li>
<li><a href="#33049ScriptAnchor_">clear (old: opens windows to perform)</a></li>
<li><a href="#33030ScriptAnchor_">goBackButton_FindRecordsChunk</a></li>
<li><a href="#33013ScriptAnchor_">moveToNewDayPart2</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE after another script is run that may change time values this script is run to re-sort the records according time unless the user has them sorted another way, in which case this script is halted and no sort is performed.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 check if the sort status field to see if the user is currently sorting by time and if so sort the records</li>
<li>If [ steward::chosenSort = "wact"  or 
steward::chosenSort = "wtca"  or 
steward::chosenSort = "act"  or 
steward::chosenSort = "tca"  or 
steward::chosenSort = "veto"  or 
steward::chosenSort = "etov"  or 
steward::chosenSort = "allow"  or 
steward::chosenSort = "wolla"   or 
steward::chosenSort = "Brainstates A-Z" or 
steward::chosenSort = "Brainstates Z-A" ]</li>
<li>Sort Records [ Specified Sort Order: day1::swStart; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#not sure why I put this in here.  So I'm leaving it for now until its use become apparent or I'm satisified it is not needed.</li>
<li>//  If [ day1::_keyDay = "" ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  End If</li>
<li>End If</li>
<li>//  If [ steward::chosenSort = "act"  or 
steward::chosenSort = "tca"  or 
steward::chosenSort = "veto"  or 
steward::chosenSort = "etov"  or 
steward::chosenSort = "allow"  or 
steward::chosenSort = "wolla" ]</li>
<li>//  Show Custom Dialog [ Title: "!"; Message: "Your list of records has been resorted based on time: total time, start time, or f-stop time."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>//  End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSort</li>
<li>
<em>day1</em>::swStart</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>day1</em>::_keyDay</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32902ScriptAnchor_"></a><td class="script_navbar"><a href="#32830ScriptAnchor_"><span>Previous Script: [sortRestoreAfterScript]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#33052ScriptAnchor_"><span>Next Script: [CHUNK_DaySelectSortThenSort]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">DaySelectSortThenSort</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32811ScriptAnchor_">showLinkedRecords</a></li>
<li><a href="#32929ScriptAnchor_">addToTotalPart2</a></li>
<li><a href="#32832ScriptAnchor_">seperateFromTotal</a></li>
<li><a href="#32919ScriptAnchor_">to 1 chart</a></li>
<li><a href="#32934ScriptAnchor_">goBackButton</a></li>
<li><a href="#32981ScriptAnchor_">to 1 Total</a></li>
<li><a href="#32982ScriptAnchor_">to 1 chart Total</a></li>
<li><a href="#102ScriptAnchor_">note veto view</a></li>
<li><a href="#33047ScriptAnchor_">note veto view (old: opened things in new windows)</a></li>
<li><a href="#32829ScriptAnchor_">updateTime</a></li>
<li><a href="#33048ScriptAnchor_">updateTime (old: opened things in new windows)</a></li>
<li><a href="#32865ScriptAnchor_">retireButton</a></li>
<li><a href="#33024ScriptAnchor_">retireButtonOnViewLayout</a></li>
<li><a href="#32836ScriptAnchor_">HideButton</a></li>
<li><a href="#33219ScriptAnchor_">startTimerAssignTimeSegmentToSpecificAction</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE sort the user's records according to the sort specified in the sort status field</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 find the sort the user wants and sort the user's records with it</li>
<li>If [ Left ( Get ( LayoutName ) ; 5 ) &ne; "total" ]</li>
<li>If [ steward::chosenSort  =  "Brainstates A-Z" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "number" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "number" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$recordFIXTOMANYVARIABLES = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$record ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>Set Variable [ $$recordFIXTOMANYVARIABLES ]</li>
<li>Set Variable [ $$record ]</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "ms" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortMergeToBlanksToBottom; descending
brainstate::groupID; ascending
brainstate::sortNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "abc" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "sub" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "cat" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "allow" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>//  Sort Records [ Specified Sort Order: day1::swStart; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>//  Sort Records [ Specified Sort Order: day1::_keyDay; ascending
brainstate::groupType; ascending
day1::swStart; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
brainstate::groupType; ascending
day1::swStart; ascending
brainstate::sortNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$recordFIXTOMANYVARIABLES = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Variable [ $$recordFIXTOMANYVARIABLES ]</li>
<li>//  If [ $$recordnumber &ne; "" ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Scroll Window
[ Home ]</li>
<li>//  Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>//  Set Variable [ $$recordnumber ]</li>
<li>//  End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "veto" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::swStop; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "act" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
day1::swTotalActivity; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "id" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSort    =    "Brainstates Z-A" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
brainstate::description; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSort  =  "rebmun" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortNumber; descending
brainstate::sortAlpha; descending
brainstate::sortSubNumber; descending
brainstate::sortCategory; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSort  =  "sm" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupID; descending
brainstate::groupOfGroupID; descending
brainstate::sortNumber; descending
brainstate::sortAlpha; descending
brainstate::sortSubNumber; descending
brainstate::description; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSort  =  "cba" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortAlpha; descending
brainstate::sortSubNumber; descending
brainstate::sortCategory; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSort  =  "bus" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortSubNumber; descending
brainstate::sortCategory; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSort  =  "tac" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortCategory; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSort  =  "wolla" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
day1::swStart; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "etov" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
day1::swStop; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSort  =  "tca" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
day1::swTotalActivity; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>End If</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>If [ steward::chosenSortTotal  =  "Brainstates A-Z" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSortTotal = "number" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSortTotal = "ms" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortMergeToBlanksToBottom; descending
brainstate::groupID; ascending
brainstate::sortNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSortTotal = "abc" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSortTotal = "sub" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSortTotal = "cat" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSortTotal = "allow" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::swStart; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSortTotal = "veto" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::swStop; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSortTotal = "act" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
day1::swTotalActivity; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSortTotal = "id" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSortTotal    =    "Brainstates Z-A" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
brainstate::description; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSortTotal  =  "rebmun" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortNumber; descending
brainstate::sortAlpha; descending
brainstate::sortSubNumber; descending
brainstate::sortCategory; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSortTotal  =  "sm" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupID; descending
brainstate::groupOfGroupID; descending
brainstate::sortNumber; descending
brainstate::sortAlpha; descending
brainstate::sortSubNumber; descending
brainstate::description; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSortTotal  =  "cba" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortAlpha; descending
brainstate::sortSubNumber; descending
brainstate::sortCategory; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSortTotal  =  "bus" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortSubNumber; descending
brainstate::sortCategory; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSortTotal  =  "tac" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortCategory; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSortTotal  =  "wolla" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
day1::swStart; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSortTotal = "etov" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
day1::swStop; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>Else If [ steward::chosenSortTotal  =  "tca" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
day1::swTotalActivity; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
<li>#Allows specific action script to continue.</li>
<li>If [ $$specificActionTimer = 1 ]</li>
<li>Exit Script [ Result: "note veto view" ]</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Halt Script</li>
<li>End If</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>#</li>
<li>Set Variable [ $$record ]</li>
<li>If [ $$recordnumber &ne; "" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page [ $$recordnumber ]
[ No dialog ]</li>
<li>Set Variable [ $$recordnumber ]</li>
<li>End If</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSort</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>brainstate</em>::sortNumber</li>
<li>
<em>brainstate</em>::sortAlpha</li>
<li>
<em>brainstate</em>::sortSubNumber</li>
<li>
<em>brainstate</em>::sortCategory</li>
<li>
<em>brainstate</em>::sortMergeToBlanksToBottom</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>day1</em>::swStart</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>day1</em>::swStop</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::groupOfGroupID</li>
<li>
<em>steward</em>::chosenSortTotal</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33052ScriptAnchor_"></a><td class="script_navbar"><a href="#32902ScriptAnchor_"><span>Previous Script: [DaySelectSortThenSort]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#32909ScriptAnchor_"><span>Next Script: [WeekMonthSelectSortThenSort]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNK_DaySelectSortThenSort</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33023ScriptAnchor_">deleteBrainstateFromTotal</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE sort the user's records according to the sort specified in the sort status field (had to create this script for scripts that need this sort but should not halt after doing the sort but go on to other sorts)</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 find the sort the user wants and sort the user's records with it</li>
<li>If [ steward::chosenSort  =  "Brainstates A-Z" ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Set Variable [ $$record ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "number" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Set Variable [ $$record ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "ms" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortMergeToBlanksToBottom; descending
brainstate::groupID; ascending
brainstate::sortNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Set Variable [ $$record ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Set Variable [ $$record ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "sub" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Set Variable [ $$record ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "cat" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Set Variable [ $$record ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "allow" ]</li>
<li>Sort Records [ Specified Sort Order: day1::swStart; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Set Variable [ $$record ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "veto" ]</li>
<li>Sort Records [ Specified Sort Order: day1::swStop; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Set Variable [ $$record ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "act" ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
day1::swTotalActivity; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Set Variable [ $$record ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "id" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Set Variable [ $$record ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>Else If [ steward::chosenSort    =    "Brainstates Z-A" ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
brainstate::description; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Set Variable [ $$record ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>Else If [ steward::chosenSort  =  "rebnum" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortNumber; descending
brainstate::sortAlpha; descending
brainstate::sortSubNumber; descending
brainstate::sortCategory; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Set Variable [ $$record ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>Else If [ steward::chosenSort  =  "sm" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupID; descending
brainstate::groupOfGroupID; descending
brainstate::sortNumber; descending
brainstate::sortAlpha; descending
brainstate::sortSubNumber; descending
brainstate::description; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Set Variable [ $$record ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>Else If [ steward::chosenSort  =  "cba" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortAlpha; descending
brainstate::sortSubNumber; descending
brainstate::sortCategory; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Set Variable [ $$record ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>Else If [ steward::chosenSort  =  "bus" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortSubNumber; descending
brainstate::sortCategory; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Set Variable [ $$record ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>Else If [ steward::chosenSort  =  "tac" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortCategory; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Set Variable [ $$record ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>Else If [ steward::chosenSort  =  "wolla" ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
day1::swStart; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Set Variable [ $$record ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "etov" ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
day1::swStop; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Set Variable [ $$record ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>Else If [ steward::chosenSort  =  "tca" ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
day1::swTotalActivity; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Set Variable [ $$record ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>End If</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page [ $$record ]
[ No dialog ]</li>
<li>Set Variable [ $$record ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSort</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>brainstate</em>::sortNumber</li>
<li>
<em>brainstate</em>::sortAlpha</li>
<li>
<em>brainstate</em>::sortSubNumber</li>
<li>
<em>brainstate</em>::sortCategory</li>
<li>
<em>brainstate</em>::sortMergeToBlanksToBottom</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>day1</em>::swStart</li>
<li>
<em>day1</em>::swStop</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::groupOfGroupID</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32909ScriptAnchor_"></a><td class="script_navbar"><a href="#33052ScriptAnchor_"><span>Previous Script: [CHUNK_DaySelectSortThenSort]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#105ScriptAnchor_"><span>Next Script: [sortBrainstate]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">WeekMonthSelectSortThenSort</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32918ScriptAnchor_">to 7 chart</a></li>
<li><a href="#32910ScriptAnchor_">to 31</a></li>
<li><a href="#32913ScriptAnchor_">to 31 chart</a></li>
<li><a href="#32983ScriptAnchor_">to 7 Total</a></li>
<li><a href="#32984ScriptAnchor_">to 7 chart Total</a></li>
<li><a href="#32985ScriptAnchor_">to 32 Total</a></li>
<li><a href="#32986ScriptAnchor_">to 31 chart Total</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE sort the user's records according to the sort specified in the sort status field</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 find the sort the user wants and sort the user's records with it</li>
<li>If [ steward::chosenSort  =  "Brainstates A-Z" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortBlanksToBottom; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Halt Script</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "number" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Halt Script</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "ms" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortMergeToBlanksToBottom; descending
brainstate::groupID; ascending
brainstate::sortNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Halt Script</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "abc" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Halt Script</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "sub" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Halt Script</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "cat" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Halt Script</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "allow" ]</li>
<li>Sort Records [ Specified Sort Order: day1::swStart; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Halt Script</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "veto" ]</li>
<li>Sort Records [ Specified Sort Order: day1::swStop; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Halt Script</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "act" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortBlanksToBottom; descending
brainstate::monthsum; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Halt Script</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "id" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Halt Script</li>
<li>#</li>
<li>Else If [ steward::chosenSort    =    "Brainstates Z-A" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortBlanksToBottom; descending
brainstate::description; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Halt Script</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "rebmun" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortNumber; descending
brainstate::sortAlpha; descending
brainstate::sortSubNumber; descending
brainstate::sortCategory; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Halt Script</li>
<li>#</li>
<li>Else If [ steward::chosenSort  =  "sm" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupID; descending
brainstate::groupOfGroupID; descending
brainstate::sortNumber; descending
brainstate::sortAlpha; descending
brainstate::sortSubNumber; descending
brainstate::description; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Halt Script</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "cba" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortAlpha; descending
brainstate::sortSubNumber; descending
brainstate::sortCategory; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Halt Script</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "bus" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortSubNumber; descending
brainstate::sortCategory; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Halt Script</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "tac" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortCategory; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Halt Script</li>
<li>#</li>
<li>Else If [ steward::chosenSort  =  "wolla" ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
day1::swStart; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Halt Script</li>
<li>#</li>
<li>Else If [ steward::chosenSort = "etov" ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
day1::swStop; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Halt Script</li>
<li>#</li>
<li>Else If [ steward::chosenSort  =  "tca" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::monthsum; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Halt Script</li>
<li>#</li>
<li>End If</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSort</li>
<li>
<em>brainstate</em>::sortBlanksToBottom</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>brainstate</em>::sortNumber</li>
<li>
<em>brainstate</em>::sortAlpha</li>
<li>
<em>brainstate</em>::sortSubNumber</li>
<li>
<em>brainstate</em>::sortCategory</li>
<li>
<em>brainstate</em>::sortMergeToBlanksToBottom</li>
<li>
<em>brainstate</em>::groupID</li>
<li>
<em>day1</em>::swStart</li>
<li>
<em>day1</em>::swStop</li>
<li>
<em>brainstate</em>::monthsum</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::groupOfGroupID</li>
<li>
<em>day1</em>::_keyDay</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="105ScriptAnchor_"></a><td class="script_navbar"><a href="#32909ScriptAnchor_"><span>Previous Script: [WeekMonthSelectSortThenSort]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#32906ScriptAnchor_"><span>Next Script: [sortBrainstateWeekMonth]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortBrainstate</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE sort by record title</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ steward::chosenSort  = "Brainstates A-Z" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
brainstate::description; descending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "Brainstates Z-A" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::chosenSort &ne; "Brainstates A-Z" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "Brainstates A-Z" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Halt Script</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSort</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32906ScriptAnchor_"></a><td class="script_navbar"><a href="#105ScriptAnchor_"><span>Previous Script: [sortBrainstate]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#32791ScriptAnchor_"><span>Next Script: [sortNumbers]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortBrainstateWeekMonth</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE by record title on week or month layouts</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ steward::chosenSort  = "Brainstates A-Z" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortBlanksToBottom; descending
brainstate::description; descending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "Brainstates Z-A" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::chosenSort &ne; "Brainstates A-Z" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortBlanksToBottom; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "Brainstates A-Z" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSort</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::sortBlanksToBottom</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32791ScriptAnchor_"></a><td class="script_navbar"><a href="#32906ScriptAnchor_"><span>Previous Script: [sortBrainstateWeekMonth]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#32867ScriptAnchor_"><span>Next Script: [sortMergeTo]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortNumbers</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32903ScriptAnchor_">goToFarmer</a></li>
<li><a href="#32839ScriptAnchor_">to 1</a></li>
<li><a href="#33106ScriptAnchor_">editTimePart2</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE of the 4 number and alpha fields, sort by the first one</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>//  If [ steward::chosenSort  = "number" ]</li>
<li>//  Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>//  Sort Records [ Specified Sort Order: brainstate::sortNumber; descending
brainstate::sortAlpha; descending
brainstate::sortSubNumber; descending
brainstate::sortCategory; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>//  Sort Records [ Specified Sort Order: brainstate::sortNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>//  Set Field [ steward::chosenSort; "rebmun" ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Loop</li>
<li>//  Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>//  Go to Record/Request/Page
[ Next ]</li>
<li>//  End Loop</li>
<li>//  Set Variable [ $$record ]</li>
<li>//  Go to Field [  ]</li>
<li>//  Halt Script</li>
<li>//  End If</li>
<li>//  If [ steward::chosenSort   &ne;  "number" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "number" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>//  End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSort</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::sortNumber</li>
<li>
<em>brainstate</em>::sortAlpha</li>
<li>
<em>brainstate</em>::sortSubNumber</li>
<li>
<em>brainstate</em>::sortCategory</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32867ScriptAnchor_"></a><td class="script_navbar"><a href="#32791ScriptAnchor_"><span>Previous Script: [sortNumbers]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#32795ScriptAnchor_"><span>Next Script: [sortAlpha]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortMergeTo</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE sort by link ID number (records part of a total or grand total record)</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ steward::chosenSort  = "ms" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::groupDisplayID; descending
brainstate::groupOfGroupDisplayID; descending
brainstate::groupType; descending
brainstate::sortNumber; descending
brainstate::sortAlpha; descending
brainstate::sortSubNumber; descending
brainstate::description; descending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "sm" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::chosenSort   &ne;  "ms" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortMergeToBlanksToBottom; descending
brainstate::groupDisplayID; ascending
brainstate::groupOfGroupDisplayID; ascending
brainstate::groupType; descending
brainstate::sortNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "ms" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSort</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::groupDisplayID</li>
<li>
<em>brainstate</em>::groupOfGroupDisplayID</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::sortNumber</li>
<li>
<em>brainstate</em>::sortAlpha</li>
<li>
<em>brainstate</em>::sortSubNumber</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>brainstate</em>::sortMergeToBlanksToBottom</li>
<li>
<em>brainstate</em>::sortCategory</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32795ScriptAnchor_"></a><td class="script_navbar"><a href="#32867ScriptAnchor_"><span>Previous Script: [sortMergeTo]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#32869ScriptAnchor_"><span>Next Script: [sortSubNumbers]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortAlpha</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE of the 4 number and alpha fields, sort by the second one</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ steward::chosenSort  = "abc" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortAlpha; descending
brainstate::sortSubNumber; descending
brainstate::sortCategory; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "cba" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::chosenSort   &ne;  "abc" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "abc" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSort</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::sortAlpha</li>
<li>
<em>brainstate</em>::sortSubNumber</li>
<li>
<em>brainstate</em>::sortCategory</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32869ScriptAnchor_"></a><td class="script_navbar"><a href="#32795ScriptAnchor_"><span>Previous Script: [sortAlpha]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#32796ScriptAnchor_"><span>Next Script: [sortSubAlpha]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortSubNumbers</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE of the 4 number and alpha fields, sort by the second to last one</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ steward::chosenSort  = "sub" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortSubNumber; descending
brainstate::sortCategory; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "bus" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::chosenSort   &ne;  "sub" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "sub" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSort</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::sortSubNumber</li>
<li>
<em>brainstate</em>::sortCategory</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32796ScriptAnchor_"></a><td class="script_navbar"><a href="#32869ScriptAnchor_"><span>Previous Script: [sortSubNumbers]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#32799ScriptAnchor_"><span>Next Script: [sortStart]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortSubAlpha</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE of the 4 number and alpha fields, sort by the last one</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ steward::chosenSort  = "cat" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortCategory; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "tac" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::chosenSort   &ne;  "cat" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "cat" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSort</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::sortCategory</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32799ScriptAnchor_"></a><td class="script_navbar"><a href="#32796ScriptAnchor_"><span>Previous Script: [sortSubAlpha]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#32800ScriptAnchor_"><span>Next Script: [sortStop]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortStart</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE sort by start time</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ steward::chosenSort  = "allow" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>//  Sort Records [ Specified Sort Order: day1::_keyDay; ascending
day1::swStart; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
brainstate::groupType; ascending
day1::swStart; ascending
brainstate::sortNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "wolla" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::chosenSort   &ne;  "allow" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>//  Sort Records [ Specified Sort Order: day1::swStart; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>//  Sort Records [ Specified Sort Order: day1::_keyDay; ascending
brainstate::groupType; ascending
day1::swStart; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
brainstate::groupType; ascending
day1::swStart; descending
brainstate::sortNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "allow" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSort</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>day1</em>::swStart</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>brainstate</em>::groupType</li>
<li>
<em>brainstate</em>::sortNumber</li>
<li>
<em>brainstate</em>::sortAlpha</li>
<li>
<em>brainstate</em>::sortSubNumber</li>
<li>
<em>brainstate</em>::sortCategory</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32800ScriptAnchor_"></a><td class="script_navbar"><a href="#32799ScriptAnchor_"><span>Previous Script: [sortStart]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#32803ScriptAnchor_"><span>Next Script: [sortActivity]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortStop</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE sort by stop time</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ steward::chosenSort  = "veto" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
day1::swStop; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "etov" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::chosenSort   &ne;  "veto" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::swStop; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "veto" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSort</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>day1</em>::swStop</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32803ScriptAnchor_"></a><td class="script_navbar"><a href="#32800ScriptAnchor_"><span>Previous Script: [sortStop]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#32840ScriptAnchor_"><span>Next Script: [sortActivityWeek]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortActivity</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE sort by total time on the day layouts</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ steward::chosenSort  = "act" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
day1::swTotalActivity; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "tca" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::chosenSort   &ne;  "act" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
day1::swTotalActivity; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "act" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSort</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32840ScriptAnchor_"></a><td class="script_navbar"><a href="#32803ScriptAnchor_"><span>Previous Script: [sortActivity]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#32805ScriptAnchor_"><span>Next Script: [sortID]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortActivityWeek</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32908ScriptAnchor_">to 7</a></li>
<li><a href="#32910ScriptAnchor_">to 31</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE sort by total time on week or month layouts</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ steward::chosenSort  = "act" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::monthsum; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "tca" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::chosenSort   &ne;  "atc" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortBlanksToBottom; descending
brainstate::monthsum; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "act" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSort</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::monthsum</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>brainstate</em>::sortBlanksToBottom</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32805ScriptAnchor_"></a><td class="script_navbar"><a href="#32840ScriptAnchor_"><span>Previous Script: [sortActivityWeek]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#33085ScriptAnchor_"><span>Next Script: [sortBrainstateTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortID</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE sort by ID</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ steward::chosenSort  = "id" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; descending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "di" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::chosenSort   &ne;  "id" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSort; "id" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSort</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33085ScriptAnchor_"></a><td class="script_navbar"><a href="#32805ScriptAnchor_"><span>Previous Script: [sortID]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#33087ScriptAnchor_"><span>Next Script: [sortNumbersTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortBrainstateTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE sort by record title</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ steward::chosenSortTotal  = "Brainstates A-Z" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
brainstate::description; descending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSortTotal; "Brainstates Z-A" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::chosenSortTotal &ne; "Brainstates A-Z" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSortTotal; "Brainstates A-Z" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSortTotal</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33087ScriptAnchor_"></a><td class="script_navbar"><a href="#33085ScriptAnchor_"><span>Previous Script: [sortBrainstateTotal]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#33089ScriptAnchor_"><span>Next Script: [sortAlphaTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortNumbersTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE of the 4 number and alpha fields, sort by the first one</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ steward::chosenSortTotal  = "number" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortNumber; descending
brainstate::sortAlpha; descending
brainstate::sortSubNumber; descending
brainstate::sortCategory; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSortTotal; "rebmun" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::chosenSortTotal   &ne;  "number" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSortTotal; "number" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSortTotal</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::sortNumber</li>
<li>
<em>brainstate</em>::sortAlpha</li>
<li>
<em>brainstate</em>::sortSubNumber</li>
<li>
<em>brainstate</em>::sortCategory</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33089ScriptAnchor_"></a><td class="script_navbar"><a href="#33087ScriptAnchor_"><span>Previous Script: [sortNumbersTotal]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#33090ScriptAnchor_"><span>Next Script: [sortSubNumbersTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortAlphaTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE of the 4 number and alpha fields, sort by the second one</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ steward::chosenSortTotal  = "abc" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortAlpha; descending
brainstate::sortSubNumber; descending
brainstate::sortCategory; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSortTotal; "cba" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::chosenSortTotal   &ne;  "abc" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSortTotal; "abc" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSortTotal</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::sortAlpha</li>
<li>
<em>brainstate</em>::sortSubNumber</li>
<li>
<em>brainstate</em>::sortCategory</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33090ScriptAnchor_"></a><td class="script_navbar"><a href="#33089ScriptAnchor_"><span>Previous Script: [sortAlphaTotal]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#33091ScriptAnchor_"><span>Next Script: [sortSubAlphaTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortSubNumbersTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE of the 4 number and alpha fields, sort by the second to last one</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ steward::chosenSortTotal  = "sub" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortSubNumber; descending
brainstate::sortCategory; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSortTotal; "bus" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::chosenSortTotal   &ne;  "sub" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSortTotal; "sub" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSortTotal</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::sortSubNumber</li>
<li>
<em>brainstate</em>::sortCategory</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33091ScriptAnchor_"></a><td class="script_navbar"><a href="#33090ScriptAnchor_"><span>Previous Script: [sortSubNumbersTotal]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#33092ScriptAnchor_"><span>Next Script: [sortStartTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortSubAlphaTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE of the 4 number and alpha fields, sort by the last one</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ steward::chosenSortTotal  = "cat" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortCategory; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSortTotal; "tac" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::chosenSortTotal   &ne;  "cat" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSortTotal; "cat" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSortTotal</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::sortCategory</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33092ScriptAnchor_"></a><td class="script_navbar"><a href="#33091ScriptAnchor_"><span>Previous Script: [sortSubAlphaTotal]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#33093ScriptAnchor_"><span>Next Script: [sortStopTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortStartTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE sort by start time</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ steward::chosenSortTotal  = "allow" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
day1::swStart; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSortTotal; "wolla" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::chosenSortTotal   &ne;  "allow" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::swStart; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSortTotal; "allow" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSortTotal</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>day1</em>::swStart</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33093ScriptAnchor_"></a><td class="script_navbar"><a href="#33092ScriptAnchor_"><span>Previous Script: [sortStartTotal]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#33094ScriptAnchor_"><span>Next Script: [sortActivityTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortStopTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE sort by stop time</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ steward::chosenSortTotal  = "veto" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
day1::swStop; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSortTotal; "etov" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::chosenSortTotal   &ne;  "veto" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::swStop; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSortTotal; "veto" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSortTotal</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>day1</em>::swStop</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33094ScriptAnchor_"></a><td class="script_navbar"><a href="#33093ScriptAnchor_"><span>Previous Script: [sortStopTotal]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#33095ScriptAnchor_"><span>Next Script: [sortActivityWeekTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortActivityTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE sort by total time on the day layouts</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ steward::chosenSortTotal  = "act" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
day1::swTotalActivity; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSortTotal; "tca" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::chosenSortTotal   &ne;  "act" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: day1::_keyDay; ascending
day1::swTotalActivity; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSortTotal; "act" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSortTotal</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33095ScriptAnchor_"></a><td class="script_navbar"><a href="#33094ScriptAnchor_"><span>Previous Script: [sortActivityTotal]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#33096ScriptAnchor_"><span>Next Script: [sortIDTotal]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortActivityWeekTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE sort by total time on week or month layouts</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ steward::chosenSortTotal  = "act" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::monthsum; descending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSortTotal; "tca" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::chosenSortTotal   &ne;  "atc" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::sortBlanksToBottom; descending
brainstate::monthsum; ascending
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSortTotal; "act" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSortTotal</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::monthsum</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>brainstate</em>::sortBlanksToBottom</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33096ScriptAnchor_"></a><td class="script_navbar"><a href="#33095ScriptAnchor_"><span>Previous Script: [sortActivityWeekTotal]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#33159ScriptAnchor_"><span>Next Script: [issueSortCategory]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortIDTotal</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE sort by ID</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ steward::chosenSortTotal  = "id" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; descending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSortTotal; "di" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>If [ steward::chosenSortTotal   &ne;  "id" ]</li>
<li>Set Variable [ $$record; Value:brainstate::_lockBrainstateID ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::_lockBrainstateID; ascending ]
[ Restore; No dialog ]</li>
<li>Set Field [ steward::chosenSortTotal; "id" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $$record = brainstate::_lockBrainstateID ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>End Loop</li>
<li>Set Variable [ $$record ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenSortTotal</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33159ScriptAnchor_"></a><td class="script_navbar"><a href="#33096ScriptAnchor_"><span>Previous Script: [sortIDTotal]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#33160ScriptAnchor_"><span>Next Script: [issueSortStatus]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">issueSortCategory</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issueCategory::order; ascending
issueCategory::text; ascending
issueStatus::order; ascending
issueStatus::text; ascending
issue::order; based on value list: &ldquo;1-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>Set Variable [ $$issueSort; Value:"category" ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::description</li>
<li>
<em>issueCategory</em>::order</li>
<li>
<em>issueCategory</em>::text</li>
<li>
<em>issueStatus</em>::order</li>
<li>
<em>issueStatus</em>::text</li>
<li>
<em>issue</em>::order</li>
<li>
<em>issue</em>::text</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33160ScriptAnchor_"></a><td class="script_navbar"><a href="#33159ScriptAnchor_"><span>Previous Script: [issueSortCategory]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#33164ScriptAnchor_"><span>Next Script: [issueSortOrderNumber]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">issueSortStatus</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33173ScriptAnchor_">TsubtotalTimeByGroupForStatus</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>//  If [ $$issueSort = "status" ]</li>
<li>//  Sort Records [ Specified Sort Order: brainstate::description; ascending
issueStatus::order; descending
issueStatus::text; descending
issueCategory::order; ascending
issueCategory::text; ascending
issue::order; based on value list: &ldquo;__-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>//  Set Variable [ $$issueSort; Value:"sutats" ]</li>
<li>//  Exit Script [  ]</li>
<li>//  End If</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issueStatus::order; ascending
issueStatus::text; ascending
issueCategory::order; ascending
issueCategory::text; ascending
issue::order; based on value list: &ldquo;1-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>Set Variable [ $$issueSort; Value:"status" ]</li>
<li>Set Variable [ $$stopSubtotal; Value:1 ]</li>
<li>Perform Script [ &ldquo;TsubtotalTimeByGroup&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::description</li>
<li>
<em>issueStatus</em>::order</li>
<li>
<em>issueStatus</em>::text</li>
<li>
<em>issueCategory</em>::order</li>
<li>
<em>issueCategory</em>::text</li>
<li>
<em>issue</em>::order</li>
<li>
<em>issue</em>::text</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33112ScriptAnchor_">TsubtotalTimeByGroup</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33164ScriptAnchor_"></a><td class="script_navbar"><a href="#33160ScriptAnchor_"><span>Previous Script: [issueSortStatus]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"><a href="#33161ScriptAnchor_"><span>Next Script: [issueSortDate]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">issueSortOrderNumber</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>//  If [ $$issueSort = "status" ]</li>
<li>//  Sort Records [ Specified Sort Order: brainstate::description; ascending
issueStatus::order; descending
issueStatus::text; descending
issueCategory::order; ascending
issueCategory::text; ascending
issue::order; based on value list: &ldquo;__-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>//  Set Variable [ $$issueSort; Value:"sutats" ]</li>
<li>//  Exit Script [  ]</li>
<li>//  End If</li>
<li>If [ Get ( FoundCount ) = 0 ]</li>
<li>Set Variable [ $$issueSort; Value:"order" ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issue::order; based on value list: &ldquo;1-99&rdquo;
issueStatus::order; based on value list: &ldquo;__-99&rdquo;
issueStatus::text; ascending
issueCategory::order; ascending
issueCategory::text; ascending
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>Set Variable [ $$issueSort; Value:"order" ]</li>
<li>Set Variable [ $$stopSubtotal; Value:1 ]</li>
<li>Perform Script [ &ldquo;TsubtotalTimeByOrder&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::description</li>
<li>
<em>issueStatus</em>::order</li>
<li>
<em>issueStatus</em>::text</li>
<li>
<em>issueCategory</em>::order</li>
<li>
<em>issueCategory</em>::text</li>
<li>
<em>issue</em>::order</li>
<li>
<em>issue</em>::text</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33166ScriptAnchor_">TsubtotalTimeByOrder</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33161ScriptAnchor_"></a><td class="script_navbar"><a href="#33164ScriptAnchor_"><span>Previous Script: [issueSortOrderNumber]</span></a></td><td class="script_navbar"><a href="#32778ScriptAnchor_"><span>Parent Folder: [sorts]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">issueSortDate</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ $$issueSort = "date" ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issue::date; ascending
issueStatus::order; ascending
issueStatus::text; ascending
issueCategory::order; ascending
issueCategory::text; ascending
issue::order; based on value list: &ldquo;1-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>Set Variable [ $$issueSort; Value:"date" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Show Custom Dialog [ Message: "Sort by date created or modified?"; Buttons: &ldquo;created&rdquo;, &ldquo;modified&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 1 ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issue::date; descending
issueStatus::order; ascending
issueStatus::text; ascending
issueCategory::order; ascending
issueCategory::text; ascending
issue::order; based on value list: &ldquo;1-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>Else</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issue::DisplayDateDone; descending
issueStatus::order; ascending
issueStatus::text; ascending
issueCategory::order; ascending
issueCategory::text; ascending
issue::order; based on value list: &ldquo;1-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>Set Variable [ $$issueSort; Value:"etad" ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::description</li>
<li>
<em>issue</em>::date</li>
<li>
<em>issueStatus</em>::order</li>
<li>
<em>issueStatus</em>::text</li>
<li>
<em>issueCategory</em>::order</li>
<li>
<em>issueCategory</em>::text</li>
<li>
<em>issue</em>::order</li>
<li>
<em>issue</em>::text</li>
<li>
<em>issue</em>::DisplayDateDone</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="32960ScriptAnchor_"></a><a href="#32960ScriptAnchor_toc">backup</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32946ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#32960ScriptAnchor_"><span>Parent Folder: [backup]</span></a></td><td class="script_navbar"><a href="#32947ScriptAnchor_"><span>Next Script: [restoreBackup]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">backup</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE remove focus from field (activited by a layout trigger)</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 set the flag for backups to "backup" then open the BFData file</li>
<li>Set Field [ backup::backup; "backup" ]</li>
<li>Open File [ &ldquo;MyData&rdquo; ]
[ Open hidden ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>backup</em>::backup</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32947ScriptAnchor_"></a><td class="script_navbar"><a href="#32946ScriptAnchor_"><span>Previous Script: [backup]</span></a></td><td class="script_navbar"><a href="#32960ScriptAnchor_"><span>Parent Folder: [backup]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">restoreBackup</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE determine if file was opened by admin or by script, and then depending on who opened it: admin = remain open, backup script = save a copy of itself, or restore script = delete all its files and import backup files to replace them</li>
<li>#</li>
<li>#Errors will be generated when opening up backup file</li>
<li>#as there is a dependency on the reference file and it</li>
<li>#will probably not be located in the same folder as the</li>
<li>#backup file.  This dependency is not needed for backup.</li>
<li>#So we have the system ignore this error message.</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>#1 set the backup flag to restore (this is used by the open script in the main file to determine if it should make a copy of itself or replace all its current files with a backup</li>
<li>Set Field [ backup::backup; "restore" ]</li>
<li>#</li>
<li>#2 open file and determine its location (path) then close it after its location has been pasted using that file's open script into the main data file</li>
<li>#file is unknown so user is given the opportunity to point the database to the backup copy of their choice</li>
<li>Open File [ &lt;unknown&gt; ]</li>
<li>Close Window [ Name: "backup" ]</li>
<li>#</li>
<li>#3 open main data file and then using its open script restore the backup file just located in step 2</li>
<li>Open File [ &ldquo;MyData&rdquo; ]
[ Open hidden ]</li>
<li>#</li>
<li>#4 go to user layout and show all records</li>
<li>Go to Layout [ &ldquo;users&rdquo; (steward) ]</li>
<li>Show All Records</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>backup</em>::backup</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>users</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="32962ScriptAnchor_"></a><a href="#32962ScriptAnchor_toc">triggered scripts</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="121ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#32962ScriptAnchor_"><span>Parent Folder: [triggered scripts]</span></a></td><td class="script_navbar"><a href="#32895ScriptAnchor_"><span>Next Script: [layoutStatus]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">clear</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE clear field (activated by a layout trigger)</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 clear field</li>
<li>Clear [  ]
[ Select ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32895ScriptAnchor_"></a><td class="script_navbar"><a href="#121ScriptAnchor_"><span>Previous Script: [clear]</span></a></td><td class="script_navbar"><a href="#32962ScriptAnchor_"><span>Parent Folder: [triggered scripts]</span></a></td><td class="script_navbar"><a href="#33186ScriptAnchor_"><span>Next Script: [sortByNumber]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">layoutStatus</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE set the layout status field with the layout that triggers this script when it loads</li>
<li>#</li>
<li>#</li>
<li>If [ Get (LayoutName)  = $$loglayout or $$otherApps = 1 or $$specificActionTimer = 1 or $$newTimer = 1 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#1 set the layout status field</li>
<li>Set Field [ steward::chosenLayout; Get ( LayoutName ) ]</li>
<li>#</li>
<li>#2 set the layout variable (I think I created this and then didn't end up using it, I think.  I can't find it being used in any scripts, but due to paranoia I'm leaving it here.  I'm just to tired at this point to look for it.)</li>
<li>Set Variable [ $$layout; Value:Get ( LayoutName ) ]</li>
<li>#</li>
<li>Set Field [ steward::windowSizeAndPlace; Get ( WindowHeight ) ]</li>
<li>Set Field [ steward::windowSizeAndPlace[2]; Get ( WindowWidth ) ]</li>
<li>Set Field [ steward::windowSizeAndPlace[3]; Get ( WindowTop ) ]</li>
<li>Set Field [ steward::windowSizeAndPlace[4]; Get ( WindowLeft ) ]</li>
<li>Set Field [ steward::windowZoom; Get ( WindowZoomLevel ) ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::chosenLayout</li>
<li>
<em>steward</em>::windowSizeAndPlace</li>
<li>
<em>steward</em>::windowZoom</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33186ScriptAnchor_"></a><td class="script_navbar"><a href="#32895ScriptAnchor_"><span>Previous Script: [layoutStatus]</span></a></td><td class="script_navbar"><a href="#32962ScriptAnchor_"><span>Parent Folder: [triggered scripts]</span></a></td><td class="script_navbar"><a href="#33103ScriptAnchor_"><span>Next Script: [layoutExit]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">sortByNumber</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Sort Records [ Specified Sort Order: brainstate::sortNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortAlpha; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::sortSubNumber; based on value list: &ldquo;__-99&rdquo;
brainstate::sortCategory; based on value list: &ldquo;sortAlpha&rdquo;
brainstate::description; ascending ]
[ Restore; No dialog ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::sortNumber</li>
<li>
<em>brainstate</em>::sortAlpha</li>
<li>
<em>brainstate</em>::sortSubNumber</li>
<li>
<em>brainstate</em>::sortCategory</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33103ScriptAnchor_"></a><td class="script_navbar"><a href="#33186ScriptAnchor_"><span>Previous Script: [sortByNumber]</span></a></td><td class="script_navbar"><a href="#32962ScriptAnchor_"><span>Parent Folder: [triggered scripts]</span></a></td><td class="script_navbar"><a href="#33059ScriptAnchor_"><span>Next Script: [xpLayout]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">layoutExit</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE set the layout status field with the layout that triggers this script when it loads</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 set the layout status field</li>
<li>Set Field [ steward::windowSizeAndPlace; Get ( WindowWidth ) ]</li>
<li>Set Field [ steward::windowSizeAndPlace[2]; Get ( WindowHeight ) ]</li>
<li>Set Field [ steward::windowSizeAndPlace[3]; Get ( WindowLeft ) ]</li>
<li>Set Field [ steward::windowSizeAndPlace[4]; Get ( WindowTop ) ]</li>
<li>#</li>
<li>#2 set the layout variable (I think I created this and then didn't end up using it, I think.  I can't find it being used in any scripts, but due to paranoia I'm leaving it here.  I'm just to tired at this point to look for it.)</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>steward</em>::windowSizeAndPlace</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33059ScriptAnchor_"></a><td class="script_navbar"><a href="#33103ScriptAnchor_"><span>Previous Script: [layoutExit]</span></a></td><td class="script_navbar"><a href="#32962ScriptAnchor_"><span>Parent Folder: [triggered scripts]</span></a></td><td class="script_navbar"><a href="#124ScriptAnchor_"><span>Next Script: [exitField]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">xpLayout</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE set the layout status field with the layout that triggers this script when it loads</li>
<li>#</li>
<li>#</li>
<li>If [ Get ( SystemPlatform ) = -2 ]</li>
<li>Go to Layout [ &ldquo;01SortAndScheduleXP&rdquo; (brainstate) ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Go to Layout [ &ldquo;01SortAndSchedule&rdquo; (brainstate) ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>01SortAndScheduleXP</li>
<li>01SortAndSchedule</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="124ScriptAnchor_"></a><td class="script_navbar"><a href="#33059ScriptAnchor_"><span>Previous Script: [xpLayout]</span></a></td><td class="script_navbar"><a href="#32962ScriptAnchor_"><span>Parent Folder: [triggered scripts]</span></a></td><td class="script_navbar"><a href="#33228ScriptAnchor_"><span>Next Script: [exitFieldSortCatTags]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">exitField</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE remove focus from field (activited by a layout trigger)</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 remove focus from a field</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33228ScriptAnchor_"></a><td class="script_navbar"><a href="#124ScriptAnchor_"><span>Previous Script: [exitField]</span></a></td><td class="script_navbar"><a href="#32962ScriptAnchor_"><span>Parent Folder: [triggered scripts]</span></a></td><td class="script_navbar"><a href="#32855ScriptAnchor_"><span>Next Script: [goToField]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">exitFieldSortCatTags</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE remove focus from field (activited by a layout trigger)</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 remove focus from a field</li>
<li>Go to Field [  ]</li>
<li>Sort Records [ Specified Sort Order: group::text; ascending
category::sortTime; ascending
category::text; ascending ]
[ Restore; No dialog ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>group</em>::text</li>
<li>
<em>category</em>::sortTime</li>
<li>
<em>category</em>::text</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32855ScriptAnchor_"></a><td class="script_navbar"><a href="#33228ScriptAnchor_"><span>Previous Script: [exitFieldSortCatTags]</span></a></td><td class="script_navbar"><a href="#32962ScriptAnchor_"><span>Parent Folder: [triggered scripts]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">goToField</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE remove focus from field (activited by a layout trigger)</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 remove focus from a field</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="32782ScriptAnchor_"></a><a href="#32782ScriptAnchor_toc">not sure if these are being used</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32868ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#32782ScriptAnchor_"><span>Parent Folder: [not sure if these are being used]</span></a></td><td class="script_navbar"><a href="#78ScriptAnchor_"><span>Next Script: [showInactiveToo????]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">clearAndExit</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#not sure if this is being used somewhere as layout trigger</li>
<li>Set Field [ "" ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="78ScriptAnchor_"></a><td class="script_navbar"><a href="#32868ScriptAnchor_"><span>Previous Script: [clearAndExit]</span></a></td><td class="script_navbar"><a href="#32782ScriptAnchor_"><span>Parent Folder: [not sure if these are being used]</span></a></td><td class="script_navbar"><a href="#32819ScriptAnchor_"><span>Next Script: [chartTime???]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">showInactiveToo????</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#not sure if this is being used somewhere</li>
<li>Copy [ brainstate::_keyUser ]
[ Select ]</li>
<li>Enter Find Mode [  ]</li>
<li>Paste [ brainstate::_keyUser ]
[ Select ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [ brainstate::description ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::_keyUser</li>
<li>
<em>brainstate</em>::description</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="32819ScriptAnchor_"></a><td class="script_navbar"><a href="#78ScriptAnchor_"><span>Previous Script: [showInactiveToo????]</span></a></td><td class="script_navbar"><a href="#32782ScriptAnchor_"><span>Parent Folder: [not sure if these are being used]</span></a></td><td class="script_navbar"><a href="#33000ScriptAnchor_"><span>Next Script: [to 31 Copy]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">chartTime???</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#not sure if this is being used somewhere</li>
<li>Set Field [ steward::chartTime1; reference::chartTime ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::chartTime</li>
<li>
<em>steward</em>::chartTime1</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33000ScriptAnchor_"></a><td class="script_navbar"><a href="#32819ScriptAnchor_"><span>Previous Script: [chartTime???]</span></a></td><td class="script_navbar"><a href="#32782ScriptAnchor_"><span>Parent Folder: [not sure if these are being used]</span></a></td><td class="script_navbar"><a href="#33016ScriptAnchor_"><span>Next Script: [zoom150]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">to 31 Copy</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#PURPOSE go to time layout 31</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#4 freeze window to speed up the calculation by  refreshing the window after all records have been calcuated rather than after each record is calcuated. (This must be done after flushing the cache (step 2) otherwise the flush unfreezes the window.)</li>
<li>Freeze Window</li>
<li>#</li>
<li>#5 go to a different layout to perform this script, which prevents user from seeing the current window refresh.</li>
<li>Go to Layout [ &ldquo;calcBrainstateTable&rdquo; (brainstate) ]</li>
<li>#</li>
<li>#6 total 7 days of time for each record displayed, along with the average time, and number of days contributing time the this average</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ brainstate::monthsum; day1::swTotalActivity + 
day2::swTotalActivity + 
day3::swTotalActivity + 
day4::swTotalActivity + 
day5::swTotalActivity + 
day6::swTotalActivity + 
day7::swTotalActivity +
day8::swTotalActivity + 
day9::swTotalActivity + 
day10::swTotalActivity +
day11::swTotalActivity +
day12::swTotalActivity +
day13::swTotalActivity +
day14::swTotalActivity +
day15::swTotalActivity +
day16::swTotalActivity +
day17::swTotalActivity +
day18::swTotalActivity +
day19::swTotalActivity +
day20::swTotalActivity +
day21::swTotalActivity +
day22::swTotalActivity +
day23::swTotalActivity +
day24::swTotalActivity +
day25::swTotalActivity +
day26::swTotalActivity +
day27::swTotalActivity +
day28::swTotalActivity +
day29::swTotalActivity +
day30::swTotalActivity +
day31::swTotalActivity ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#7 go back to layout time 7, sort records (neccessary because the week and month view usually show more active records that need to be sorted to the top of list), and go to the first record.</li>
<li>Go to Layout [ original layout ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>day2</em>::swTotalActivity</li>
<li>
<em>day3</em>::swTotalActivity</li>
<li>
<em>day4</em>::swTotalActivity</li>
<li>
<em>day5</em>::swTotalActivity</li>
<li>
<em>day6</em>::swTotalActivity</li>
<li>
<em>day7</em>::swTotalActivity</li>
<li>
<em>day8</em>::swTotalActivity</li>
<li>
<em>day9</em>::swTotalActivity</li>
<li>
<em>day10</em>::swTotalActivity</li>
<li>
<em>day11</em>::swTotalActivity</li>
<li>
<em>day12</em>::swTotalActivity</li>
<li>
<em>day13</em>::swTotalActivity</li>
<li>
<em>day14</em>::swTotalActivity</li>
<li>
<em>day15</em>::swTotalActivity</li>
<li>
<em>day16</em>::swTotalActivity</li>
<li>
<em>day17</em>::swTotalActivity</li>
<li>
<em>day18</em>::swTotalActivity</li>
<li>
<em>day19</em>::swTotalActivity</li>
<li>
<em>day20</em>::swTotalActivity</li>
<li>
<em>day21</em>::swTotalActivity</li>
<li>
<em>day22</em>::swTotalActivity</li>
<li>
<em>day23</em>::swTotalActivity</li>
<li>
<em>day24</em>::swTotalActivity</li>
<li>
<em>day25</em>::swTotalActivity</li>
<li>
<em>day26</em>::swTotalActivity</li>
<li>
<em>day27</em>::swTotalActivity</li>
<li>
<em>day28</em>::swTotalActivity</li>
<li>
<em>day29</em>::swTotalActivity</li>
<li>
<em>day30</em>::swTotalActivity</li>
<li>
<em>day31</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::monthsum</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>calcBrainstateTable</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33016ScriptAnchor_"></a><td class="script_navbar"><a href="#33000ScriptAnchor_"><span>Previous Script: [to 31 Copy]</span></a></td><td class="script_navbar"><a href="#32782ScriptAnchor_"><span>Parent Folder: [not sure if these are being used]</span></a></td><td class="script_navbar"><a href="#33013ScriptAnchor_"><span>Next Script: [moveToNewDayPart2]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">zoom150</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Zoom Level
[ 150% ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33013ScriptAnchor_"></a><td class="script_navbar"><a href="#33016ScriptAnchor_"><span>Previous Script: [zoom150]</span></a></td><td class="script_navbar"><a href="#32782ScriptAnchor_"><span>Parent Folder: [not sure if these are being used]</span></a></td><td class="script_navbar"><a href="#33027ScriptAnchor_"><span>Next Script: [folderStopwatchCheck]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">moveToNewDayPart2</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $date; Value:reference::gDate ]</li>
<li>#make sure date selected has no information in it.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ day1::_keyDay; $date ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#PURPOSE go back or forwards the number of days specified in the number field to the right the go button on the 1 day layouts</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 capture desired number of days and add to the current date.  (User picks days from a drop down list that includes negative and positive numbers.)</li>
<li>Set Field [ reference::day1; $date ]</li>
<li>#</li>
<li>#2 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#3 capture user's current date perference</li>
<li>Set Field [ steward::chosenDay; reference::day1 ]</li>
<li>#</li>
<li>#4 sort the records if the current sort is based on time so if any time is changed it goes up or down the current set of records according to its time value.  The point is to keep the focus where the user expects it to be so the sort, which removes the focus from the current record is only done if the user wants the records sorted by time, in which case after the sort the focus is returned to the first record.</li>
<li>Perform Script [ &ldquo;sortRestoreAfterScript&rdquo; ]</li>
<li>Close Window [ Current Window ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::gDate</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenDay</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#32830ScriptAnchor_">sortRestoreAfterScript</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33027ScriptAnchor_"></a><td class="script_navbar"><a href="#33013ScriptAnchor_"><span>Previous Script: [moveToNewDayPart2]</span></a></td><td class="script_navbar"><a href="#32782ScriptAnchor_"><span>Parent Folder: [not sure if these are being used]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">folderStopwatchCheck</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32978ScriptAnchor_">close</a></li>
<li><a href="#102ScriptAnchor_">note veto view</a></li>
<li><a href="#32829ScriptAnchor_">updateTime</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>If [ $$folderon = brainstate::_lockBrainstateID ]</li>
<li>#no other stopwatch is running and one is turned on = 1 one stopwatch running
</li>
<li>If [ brainstate::FolderOn = ""  and $$stopwatchON = "t" ]</li>
<li>Set Field [ brainstate::FolderOn; "1" ]</li>
<li>Set Variable [ $$stopwatchON; Value:"" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#x number of stopwatchs are already running and another one is turned on = x + 1 more stopwatch running
</li>
<li>If [ brainstate::FolderOn &ne; ""  and $$stopwatchON = "t" ]</li>
<li>Set Field [ brainstate::FolderOn; brainstate::FolderOn + 1 ]</li>
<li>Set Variable [ $$stopwatchON; Value:"" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#x number of stopwatchs are already running and another one is turned off = x - 1 one less stopwatch running</li>
<li>If [ brainstate::FolderOn &gt; 1  and $$stopwatchON = "f" ]</li>
<li>Set Field [ brainstate::FolderOn; brainstate::FolderOn - 1 ]</li>
<li>Set Variable [ $$stopwatchON; Value:"" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#1 stopwatch is running and one is turned off = 0  stopwatchs running</li>
<li>If [ brainstate::FolderOn = 1  and $$stopwatchON = "f" ]</li>
<li>Set Field [ brainstate::FolderOn; "" ]</li>
<li>Set Variable [ $$stopwatchON; Value:"" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Exit Script [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::FolderOn</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="33208ScriptAnchor_"></a><a href="#33208ScriptAnchor_toc">specific action log</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33035ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33115ScriptAnchor_"><span>Next Script: [loadIssuerecordID]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">recordLoad</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32903ScriptAnchor_">goToFarmer</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ $$stopRecordLoad = 1 or $$otherApps = 1 or $$specificActionTimer = 1 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>If [ reference::CurrentRecord = Get (RecordID) ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Field [ reference::CurrentRecord; Get ( RecordID ) ]</li>
<li>Set Variable [ $$timerIDnumber; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $$day1BugField; Value:day1::swBugField ]</li>
<li>If [ Get ( WindowTop ) &lt; 0 ]</li>
<li>Move/Resize Window [ Current Window; Top: 0 ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::CurrentRecord</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>day1</em>::swBugField</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33115ScriptAnchor_"></a><td class="script_navbar"><a href="#33035ScriptAnchor_"><span>Previous Script: [recordLoad]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33124ScriptAnchor_"><span>Next Script: [loadLogrecordID]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">loadIssuerecordID</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33171ScriptAnchor_">gotoLogs</a></li>
<li><a href="#33168ScriptAnchor_">changeLogs Copy</a></li>
<li><a href="#33131ScriptAnchor_">viewLogIssues</a></li>
<li><a href="#33132ScriptAnchor_">viewAllLogIssues</a></li>
<li><a href="#33136ScriptAnchor_">addTimeSegmentToIssue</a></li>
<li><a href="#33138ScriptAnchor_">CHUNK_updateIssueCategoryTime</a></li>
<li><a href="#33172ScriptAnchor_">newActPart2</a></li>
<li><a href="#33194ScriptAnchor_">newActPart2cancel</a></li>
<li><a href="#33169ScriptAnchor_">findGroupPart2</a></li>
<li><a href="#33220ScriptAnchor_">stopTimerAssignedToSpecificAction</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ $$stopRecordLoad = 1 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Variable [ $$issueRecordID; Value:Get ( RecordID ) ]</li>
<li>Set Variable [ $$group; Value:issue::_keyCategory ]</li>
<li>Set Variable [ $$status; Value:issue::_keyStatus ]</li>
<li>Set Field [ brainstate::pulldownBrainstate; issue::_keyBrainstate ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#If user clicked on the pulldown when the focus</li>
<li>#of the system was on another record, this</li>
<li>#variable prevents the pulldown menu from</li>
<li>#flashing and going away.  It needs to be reset</li>
<li>#when the user navigates to the record other than</li>
<li>#by click on the pulldown menus so the user</li>
<li>#doesn't get bumped out of the menu field</li>
<li>#if the database is focused on the record whose</li>
<li>#menus the user is trying to access.</li>
<li>Set Variable [ $$pulldownCheck; Value:Get (RecordID) ]</li>
<li>#</li>
<li>#disabled go to field takes a user view out of a</li>
<li>#a the text field if they entered it to go to this</li>
<li>#record, which I don't like as a user, so it is off.</li>
<li>//  Go to Field [  ]</li>
<li>Set Variable [ $$stopIssuePulldownMenus; Value:1 ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#For attaching issue record IDs to log records, and</li>
<li>#for conditionally formatting log records related to an issue,</li>
<li>#system needs to know what IDs are associated with a log record.</li>
<li>Set Variable [ $$issue; Value:issue::_LockList ]</li>
<li>Set Variable [ $$issueLogs; Value:issue::_keyLogs ]</li>
<li>Set Variable [ $$timeAll; Value:issue::timeSegmentKeyList ]</li>
<li>Set Variable [ $$stopGroup; Value:1 ]</li>
<li>Select Window [ Name: "Tag"; Current file ]</li>
<li>//  Go to Object [ Object Name: "group" ]</li>
<li>Scroll Window
[ Home ]</li>
<li>//  Go to Portal Row
[ Last ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ category::_LockList = $$group ]</li>
<li>//  Go to Portal Row
[ Previous; Exit after last ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ category::_LockList  &ne;  $$group ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $$stopGroup ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>issue</em>::_keyCategory</li>
<li>
<em>issue</em>::_keyStatus</li>
<li>
<em>issue</em>::_keyBrainstate</li>
<li>
<em>brainstate</em>::pulldownBrainstate</li>
<li>
<em>issue</em>::_LockList</li>
<li>
<em>issue</em>::_keyLogs</li>
<li>
<em>issue</em>::timeSegmentKeyList</li>
<li>
<em>category</em>::_LockList</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33124ScriptAnchor_"></a><td class="script_navbar"><a href="#33115ScriptAnchor_"><span>Previous Script: [loadIssuerecordID]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33050ScriptAnchor_"><span>Next Script: [checkForChanges]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">loadLogrecordID</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33171ScriptAnchor_">gotoLogs</a></li>
<li><a href="#33168ScriptAnchor_">changeLogs Copy</a></li>
<li><a href="#33058ScriptAnchor_">clearPart2</a></li>
<li><a href="#33125ScriptAnchor_">PHASEDOUTgotoIssueResolution</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ $$stopRecordLoad = 1 ]</li>
<li>Exit Script [  ]</li>
<li>Else If [ $$stoprecordload &ne; 1 ]</li>
<li>Set Variable [ $$logrecordID; Value:Get ( RecordID ) ]</li>
<li>Refresh Window</li>
<li>End If</li>
<li>#</li>
<li>#For attaching issue record IDs to log records, and</li>
<li>#for conditionally formatting log records related to an issue,</li>
<li>#system needs to know what IDs are associated with a log record.</li>
<li>Set Variable [ $$logissues; Value:logs::_keyLogIssues ]</li>
<li>Set Variable [ $$log; Value:logs::_lockDay ]</li>
<li>Set Variable [ $$day1BugField; Value:logs::swBugField ]</li>
<li>Set Field [ reference::ActivityLogDay; logs::_keyDay ]</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
<li>If [ daylog::swActivityLength[11] &ne; "" ]</li>
<li>Go to Layout [ &ldquo;logs3rows&rdquo; (logs) ]</li>
<li>Else If [ daylog::swActivityLength[6] &ne; "" ]</li>
<li>Go to Layout [ &ldquo;logs2rows&rdquo; (logs) ]</li>
<li>Else If [ daylog::swActivityLength[6] = "" ]</li>
<li>Go to Layout [ &ldquo;logs1row&rdquo; (logs) ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>//  Perform Script [ &ldquo;viewLogIssues&rdquo; ]</li>
<li>#</li>
<li>#A window showing set of all issues addressed on this</li>
<li>#needs to be show to the user in a new window.</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>logs</em>::_keyLogIssues</li>
<li>
<em>logs</em>::_lockDay</li>
<li>
<em>logs</em>::swBugField</li>
<li>
<em>logs</em>::_keyDay</li>
<li>
<em>reference</em>::ActivityLogDay</li>
<li>
<em>daylog</em>::swActivityLength</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33131ScriptAnchor_">viewLogIssues</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>logs3rows</li>
<li>logs2rows</li>
<li>logs1row</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33050ScriptAnchor_"></a><td class="script_navbar"><a href="#33124ScriptAnchor_"><span>Previous Script: [loadLogrecordID]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33123ScriptAnchor_"><span>Next Script: [deleteIssue]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">checkForChanges</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ brainstate::_lockBrainstateID = brainstate::groupID or Filter ( Get ( ApplicationVersion ) ; "go" ) = "go" ]</li>
<li>Go to Field [  ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Set Variable [ $$fieldValue; Value:Get ( ActiveFieldContents ) ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>brainstate</em>::groupID</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33123ScriptAnchor_"></a><td class="script_navbar"><a href="#33050ScriptAnchor_"><span>Previous Script: [checkForChanges]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33129ScriptAnchor_"><span>Next Script: [deletePrefix]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">deleteIssue</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $delete; Value:issue::_LockList ]</li>
<li>Set Variable [ $$stopCategoryRequest; Value:1 ]</li>
<li>Set Variable [ $name; Value:issue::text ]</li>
<li>Go to Object [ Object Name: 5 ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Delete, " &amp; Case ( Length ($name) &lt; 26 ; $name ; Left ($name ; 30) ) &amp; " ... ?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Delete, " &amp; Case ( Length ($name) &lt; 26 ; $name ; Left ($name ; 30) ) &amp; " ... ?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>#</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>#</li>
<li>If [ issue::issueTotalTime &ne; "" ]</li>
<li>#</li>
<li>#Prevent windows from flashing and script from slowing</li>
<li>#by stopping strobe effect caused by going back and </li>
<li>#forth from each window upon loading each records </li>
<li>#information throughout the script, rather than just </li>
<li>#at the end.</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>#</li>
<li>New Window [ Name: "temp" ]</li>
<li>#</li>
<li>#Exit issue field so conditional formatting can be applied.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Prepare to remove issue time for category.</li>
<li>Set Variable [ $categoryKey; Value:issue::_keyCategory ]</li>
<li>Set Field [ issue::issueTotalTime; "" ]</li>
<li>#</li>
<li>#Eliminate this issue's time from the all the time</li>
<li>#assigned to its category.</li>
<li>Go to Layout [ &ldquo;issueTime&rdquo; (issueTime) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issueTime::_keyIssue; $$issue ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Perform Find [  ]</li>
<li>Delete All Records
[ No dialog ]</li>
<li>#</li>
<li>#Add up total time for category it was in.</li>
<li>Go to Layout [ &ldquo;Issues&rdquo; (issue) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyCategory; $categoryKey ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: issue::sortTime; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ issue::timeTotalSumByCat; issue::timeTotalSummaryByCategory ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Find all day records linked to this issue.</li>
<li>Go to Layout [ &ldquo;logs2rows&rdquo; (logs) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ logs::_keyLogIssues; $$issue ]</li>
<li>Perform Find [  ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>#</li>
<li>#Remove issue key from an activity log (day) records.</li>
<li>Set Variable [ $logIssues; Value:logs::_keyLogIssues ]</li>
<li>Set Field [ logs::_keyLogIssues; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used. 

If ( ValueCount ( $logIssues ) &ne; ValueCount ( Substitute ( $logIssues ; $$issue &amp; "&para;"  ; "" ) ) ; 

Substitute ( $logIssues ; $$issue &amp; "&para;"  ; "" ) ; 

Substitute ( $logIssues ; $$issue ; "" ) 

) ]</li>
<li>#</li>
<li>#Remove issue key from repetitions for each record.</li>
<li>Set Variable [ $repetition; Value:1 ]</li>
<li>Loop</li>
<li>If [ logs::swLogTimeAccounting[$repetition] = $$issue ]</li>
<li>Set Field [ logs::swLogTimeAccounting[$repetition]; "" ]</li>
<li>End If</li>
<li>Set Variable [ $repetition; Value:$repetition + 1 ]</li>
<li>Exit Loop If [ $repetition = 31 ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Go to next day record.</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>#</li>
<li>Close Window [ Name: "temp"; Current file ]</li>
<li>End If</li>
<li>#</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>Set Variable [ $delete ]</li>
<li>Set Variable [ $$stopCategoryRequest ]</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>Go to Field [ issue::text ]</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>issue</em>::_LockList</li>
<li>
<em>issue</em>::text</li>
<li>
<em>issue</em>::issueTotalTime</li>
<li>
<em>issue</em>::_keyCategory</li>
<li>
<em>issueTime</em>::_keyIssue</li>
<li>
<em>issue</em>::sortTime</li>
<li>
<em>issue</em>::timeTotalSummaryByCategory</li>
<li>
<em>issue</em>::timeTotalSumByCat</li>
<li>
<em>logs</em>::_keyLogIssues</li>
<li>
<em>logs</em>::swLogTimeAccounting</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>issueTime</li>
<li>Issues</li>
<li>logs2rows</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33129ScriptAnchor_"></a><td class="script_navbar"><a href="#33123ScriptAnchor_"><span>Previous Script: [deleteIssue]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33118ScriptAnchor_"><span>Next Script: [deleteStatus]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">deletePrefix</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $delete; Value:prefix::_LockList ]</li>
<li>Set Variable [ $name; Value:prefix::text ]</li>
<li>Go to Object [ Object Name: 5 ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Delete " &amp; $name &amp; "?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>End If</li>
<li>Set Variable [ $delete ]</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>prefix</em>::_LockList</li>
<li>
<em>prefix</em>::text</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33118ScriptAnchor_"></a><td class="script_navbar"><a href="#33129ScriptAnchor_"><span>Previous Script: [deletePrefix]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33119ScriptAnchor_"><span>Next Script: [deleteTag]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">deleteStatus</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ status::_LockList = "" ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Variable [ $delete; Value:status::_LockList ]</li>
<li>Set Variable [ $name; Value:status::text ]</li>
<li>Go to Layout [ &ldquo;IssuesAndObservations Copy&rdquo; (issue) ]</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyStatus; $delete ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $error; Value:Get (LastError) ]</li>
<li>Go to Layout [ original layout ]</li>
<li>If [ $error &ne; 401 ]</li>
<li>Set Variable [ $delete ]</li>
<li>Show Custom Dialog [ Message: "'" &amp; $name &amp; "'"  &amp; " can be deleted once all Specific Actions tagged with it are switched to a different status tag.  NOTE: Status tags are global, so this tag may be applied to other Timer's Specific Actions not currently showing."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Delete " &amp; $name &amp; "?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>End If</li>
<li>Set Variable [ $delete ]</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>status</em>::_LockList</li>
<li>
<em>status</em>::text</li>
<li>
<em>issue</em>::_keyStatus</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>IssuesAndObservations Copy</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33119ScriptAnchor_"></a><td class="script_navbar"><a href="#33118ScriptAnchor_"><span>Previous Script: [deleteStatus]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33125ScriptAnchor_"><span>Next Script: [PHASEDOUTgotoIssueResolution]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">deleteTag</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>#Stop script if user is process of picking a specific action group.</li>
<li>If [ $$pick = 1 ]</li>
<li>Show Custom Dialog [ Message: "Pick a specific-action group.  After you do this you can delete tags.  "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Not sure about this step, but would guess </li>
<li>#that if the record is not a tag then don't delete it.</li>
<li>If [ category::_LockList = "" ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Capture essential information.</li>
<li>Go to Field [  ]</li>
<li>Set Variable [ $group; Value:category::_keyCategory ]</li>
<li>Set Variable [ $delete; Value:category::_LockList ]</li>
<li>Set Variable [ $name; Value:category::text ]</li>
<li>#</li>
<li>#See if any specific actions are tagged with this tag.</li>
<li>New Window [  ]</li>
<li>Go to Layout [ &ldquo;IssuesAndObservations Copy&rdquo; (issue) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyCategory; $delete ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $error; Value:Get (LastError) ]</li>
<li>Set Variable [ $foundcount; Value:Get ( FoundCount ) ]</li>
<li>#</li>
<li>#If it tags nothing, then check if it is the last tag</li>
<li>#in its group.</li>
<li>If [ $foundcount = 0 ]</li>
<li>Go to Layout [ &ldquo;category data&rdquo; (category) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ category::_keyCategory; $group ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $tagsingroup; Value:Get (FoundCount) ]</li>
<li>End If</li>
<li>#</li>
<li>#Close the find window.</li>
<li>Close Window [ Current Window ]</li>
<li>#</li>
<li>#If specific items are found tagged with tag</li>
<li>#inform user of how many there are and exit script.</li>
<li>If [ $error &ne; 401 ]</li>
<li>Set Variable [ $delete ]</li>
<li>Show Custom Dialog [ Message: Case ( $foundcount  &ne;  1 ; 

"'" &amp; $name &amp; "'"  &amp; " can be deleted once the " &amp; $foundcount &amp; " specific issues tagged with it are tagged with a different tag.  To find these " &amp; $foundcount &amp; ", click the 'find' button (above) and then this tag's button." ;

"'" &amp; $name &amp; "'"  &amp; " can be deleted once the 1 specific issue tagged with it is tagged with a different tag.  To find it, click the 'find' button above and then this tag's button." ); Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If none are found then ask user if they really want</li>
<li>#to delete this tag.</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Delete " &amp; $name &amp; "?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>#</li>
<li>#If the user says yes, first make sure the record</li>
<li>#is not the last record in a group.  If it is and</li>
<li>#the system deleted the record without deleting</li>
<li>#the group too, this group would become</li>
<li>#an orphan as only categories that have records</li>
<li>#attached to them show up for the user to add</li>
<li>#more records uner them.  So the group</li>
<li>#record must also be deleted if this is the last</li>
<li>#record under it.</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>#</li>
<li>#If it is the last tag in the group inform the user</li>
<li>#and make sure they still want to delete tag and group.</li>
<li>If [ $tagsingroup = 1 ]</li>
<li>Set Variable [ $groupName; Value:group::text ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Message: "The tag group &mdash; " &amp; $groupName &amp; " &mdash; will also be deleted because tag " &amp; $name &amp; " is the last tag in it."; Buttons: &ldquo;OK&rdquo;, &ldquo;cancel&rdquo; ]</li>
<li>#</li>
<li>#If they don't, then stop the script.</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Set Variable [ $groupName ]</li>
<li>Set Variable [ $delete ]</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#If they do the first find and delete the group.</li>
<li>New Window [  ]</li>
<li>Go to Layout [ &ldquo;category data&rdquo; (category) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ category::_LockList; $group ]</li>
<li>Perform Find [  ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Close Window [ Current Window ]</li>
<li>End If</li>
<li>#</li>
<li>#Delete the tag.</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#If the user clicks 'cancel' then clear the conditional </li>
<li>#formatting and exit.</li>
<li>Set Variable [ $delete ]</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>category</em>::_LockList</li>
<li>
<em>category</em>::_keyCategory</li>
<li>
<em>category</em>::text</li>
<li>
<em>issue</em>::_keyCategory</li>
<li>
<em>group</em>::text</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>IssuesAndObservations Copy</li>
<li>category data</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33125ScriptAnchor_"></a><td class="script_navbar"><a href="#33119ScriptAnchor_"><span>Previous Script: [deleteTag]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33126ScriptAnchor_"><span>Next Script: [gotoDayOnMainScreen]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">PHASEDOUTgotoIssueResolution</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ issueStatus::order &gt; 79 and $$stopgotoIssueResolution &ne; 1 ]</li>
<li>Set Variable [ $resolutionDate; Value:GetAsDate ( issue::dateModified ) ]</li>
<li>Set Variable [ $$stoploadrecord; Value:1 ]</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
<li>Freeze Window</li>
<li>Loop</li>
<li>Exit Loop If [ logs::_keyDay =  $resolutionDate ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>If [ logs::_keyDay &ne; $resolutionDate ]</li>
<li>Set Variable [ $$stoploadrecord ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Show Custom Dialog [ Message: "No activity log record matches the date for this issue's resolution.  "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Variable [ $$stoploadrecord ]</li>
<li>Perform Script [ &ldquo;loadLogrecordID&rdquo; ]</li>
<li>Go to Field [ logs::log ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>issueStatus</em>::order</li>
<li>
<em>issue</em>::dateModified</li>
<li>
<em>logs</em>::_keyDay</li>
<li>
<em>logs</em>::log</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33124ScriptAnchor_">loadLogrecordID</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33126ScriptAnchor_"></a><td class="script_navbar"><a href="#33125ScriptAnchor_"><span>Previous Script: [PHASEDOUTgotoIssueResolution]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33130ScriptAnchor_"><span>Next Script: [linkActionToDay]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoDayOnMainScreen</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $date; Value:logs::_keyDay ]</li>
<li>Select Window [ Name: "Timer"; Current file ]</li>
<li>#PURPOSE go back or forwards the number of days specified in the number field to the right the go button on the 1 day layouts</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#1 capture desired number of days and add to the current date.  (User picks days from a drop down list that includes negative and positive numbers.)</li>
<li>Set Field [ reference::day1; $date ]</li>
<li>#</li>
<li>#2 refresh the layout so that the key fields for each record will be recalculated based on the new day selected.  The date and times shown for each record are in a table related to each brainstate record by their dates.  The key date fields for all brainstate records are calculations where the value equals the reference field date shown at the top of the screen in the green, red, or yellow box.  So when the user changes the date in the reference field (top colored box) and then this script refreshes the database, all the brainstate records including the ones not shown recalculate their key fields, the result being they all take in the new date.  This means that the related day records now change too to show the user the day records that match the updated brainstate record keys.  (These day fields are locked to their related brainstate records by the brainstate records ID number.  Using these to keys, the database is able to return the desired day fields for brainstate record the user elects to view at any one time.)  </li>
<li>Refresh Window
[ Flush cached join results ]</li>
<li>#</li>
<li>#3 capture user's current date perference</li>
<li>Set Field [ steward::chosenDay; reference::day1 ]</li>
<li>#</li>
<li>#4 sort the records</li>
<li>Sort Records [  ]
[ No dialog ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>logs</em>::_keyDay</li>
<li>
<em>reference</em>::day1</li>
<li>
<em>steward</em>::chosenDay</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33130ScriptAnchor_"></a><td class="script_navbar"><a href="#33126ScriptAnchor_"><span>Previous Script: [gotoDayOnMainScreen]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33131ScriptAnchor_"><span>Next Script: [viewLogIssues]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">linkActionToDay</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33136ScriptAnchor_">addTimeSegmentToIssue</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Prevent windows from flashing and script from slowing</li>
<li>#by stopping strobe effect caused by going back and </li>
<li>#forth from each window upon loading each records </li>
<li>#information throughout the script, rather than just </li>
<li>#at the end.</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>#</li>
<li>#Exit issue field so conditional formatting can be applied.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#If tag has not yet been selected, then add it.</li>
<li>If [ issue::_LockList &amp; "&para;"  &ne;  FilterValues ( $$logIssues ; issue::_LockList &amp; "&para;" ) ]</li>
<li>#</li>
<li>Set Variable [ $newIssue; Value:issue::_LockList ]</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>Exit Script [  ]</li>
<li>New Window [ Name: "Day"; Height: Get (ScreenHeight); Width: 608; Top: 0; Left: 441 ]</li>
<li>End If</li>
<li>#</li>
<li>#prepare to add log ID to issueLogs so that the issue</li>
<li>#will have a record of all days logged to deal with it.</li>
<li>Set Variable [ $newlog; Value:logs::_lockDay ]</li>
<li>Set Variable [ $$logIssue; Value:logs::_keyLogIssues ]</li>
<li>#</li>
<li>Set Field [ logs::_keyLogIssues; $newIssue &amp; "&para;" &amp; $$logIssues ]</li>
<li>Set Variable [ $$logIssues; Value:logs::_keyLogIssues ]</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>#</li>
<li>#Add log ID to issueLogs.</li>
<li>Set Field [ issue::_keyLogs; $newlog &amp; "&para;" &amp; $$IssueLogs ]</li>
<li>Set Variable [ $$IssueLogs; Value:issue::_keyLogs ]</li>
<li>#</li>
<li>#For some reason if system does not re-go to this</li>
<li>#same record, other scripts trying to set fields for this</li>
<li>#record in a different window (so same layout </li>
<li>#different window will get an error 301 (record in use </li>
<li>#by another user).  So it is neccessary.  </li>
<li>#addTimeSegmentToIssue is the other scirpt that </li>
<li>#gets that error message when this step is left out. </li>
<li>Go to Record/Request/Page [ Get (RecordNumber) ]
[ No dialog ]</li>
<li>Refresh Window</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ $$log &amp; "&para;" = FilterValues ( issue::_keyLogs ; $$log &amp; "&para;" ) and $$issueRecordID = Get (RecordID)
 and 1 &amp; $$log &amp; "&para;" = FilterValues ( $$timeAll ; 1 &amp; $$log &amp; "&para;" )
 or 
$$log &amp; "&para;" = FilterValues ( issue::_keyLogs ; $$log &amp; "&para;" ) and $$issueRecordID = Get (RecordID)
 and 2 &amp; $$log &amp; "&para;" = FilterValues ( $$timeAll ; 2 &amp; $$log &amp; "&para;" )
 or 
$$log &amp; "&para;" = FilterValues ( issue::_keyLogs ; $$log &amp; "&para;" ) and $$issueRecordID = Get (RecordID)
 and 3 &amp; $$log &amp; "&para;" = FilterValues ( $$timeAll ; 3 &amp; $$log &amp; "&para;" )
 or 
$$log &amp; "&para;" = FilterValues ( issue::_keyLogs ; $$log &amp; "&para;" ) and $$issueRecordID = Get (RecordID)
 and 4 &amp; $$log &amp; "&para;" = FilterValues ( $$timeAll ; 4 &amp; $$log &amp; "&para;" )
 or 
$$log &amp; "&para;" = FilterValues ( issue::_keyLogs ; $$log &amp; "&para;" ) and $$issueRecordID = Get (RecordID)
 and 5 &amp; $$log &amp; "&para;" = FilterValues ( $$timeAll ; 5 &amp; $$log &amp; "&para;" )
 or 
$$log &amp; "&para;" = FilterValues ( issue::_keyLogs ; $$log &amp; "&para;" ) and $$issueRecordID = Get (RecordID)
 and 6 &amp; $$log &amp; "&para;" = FilterValues ( $$timeAll ; 6 &amp; $$log &amp; "&para;" )
 or 
$$log &amp; "&para;" = FilterValues ( issue::_keyLogs ; $$log &amp; "&para;" ) and $$issueRecordID = Get (RecordID)
 and 7 &amp; $$log &amp; "&para;" = FilterValues ( $$timeAll ; 7 &amp; $$log &amp; "&para;" )
 or 
$$log &amp; "&para;" = FilterValues ( issue::_keyLogs ; $$log &amp; "&para;" ) and $$issueRecordID = Get (RecordID)
 and 8 &amp; $$log &amp; "&para;" = FilterValues ( $$timeAll ; 8 &amp; $$log &amp; "&para;" )
 or 
$$log &amp; "&para;" = FilterValues ( issue::_keyLogs ; $$log &amp; "&para;" ) and $$issueRecordID = Get (RecordID)
 and 9 &amp; $$log &amp; "&para;" = FilterValues ( $$timeAll ; 9 &amp; $$log &amp; "&para;" )
 or 
$$log &amp; "&para;" = FilterValues ( issue::_keyLogs ; $$log &amp; "&para;" ) and $$issueRecordID = Get (RecordID)
 and 10 &amp; $$log &amp; "&para;" = FilterValues ( $$timeAll ; 10 &amp; $$log &amp; "&para;" )
 or 
$$log &amp; "&para;" = FilterValues ( issue::_keyLogs ; $$log &amp; "&para;" ) and $$issueRecordID = Get (RecordID)
 and 11 &amp; $$log &amp; "&para;" = FilterValues ( $$timeAll ; 11 &amp; $$log &amp; "&para;" )
 or 
$$log &amp; "&para;" = FilterValues ( issue::_keyLogs ; $$log &amp; "&para;" ) and $$issueRecordID = Get (RecordID)
 and 12 &amp; $$log &amp; "&para;" = FilterValues ( $$timeAll ; 12 &amp; $$log &amp; "&para;" )
 or 
$$log &amp; "&para;" = FilterValues ( issue::_keyLogs ; $$log &amp; "&para;" ) and $$issueRecordID = Get (RecordID)
 and 13 &amp; $$log &amp; "&para;" = FilterValues ( $$timeAll ; 13 &amp; $$log &amp; "&para;" )
 or 
$$log &amp; "&para;" = FilterValues ( issue::_keyLogs ; $$log &amp; "&para;" ) and $$issueRecordID = Get (RecordID)
 and 14 &amp; $$log &amp; "&para;" = FilterValues ( $$timeAll ; 14 &amp; $$log &amp; "&para;" )
 or 
$$log &amp; "&para;" = FilterValues ( issue::_keyLogs ; $$log &amp; "&para;" ) and $$issueRecordID = Get (RecordID)
 and 15 &amp; $$log &amp; "&para;" = FilterValues ( $$timeAll ; 15 &amp; $$log &amp; "&para;" ) ]</li>
<li>Show Custom Dialog [ Message: "This action has time from the selected day record assigned to it.  Before you can unlink it, click on all green time segments in the Day window and remove them from this action."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#If issue is assigned to log, then remove it when user</li>
<li>#clicks the link button.</li>
<li>Set Variable [ $removeIssue; Value:issue::_LockList ]</li>
<li>#</li>
<li>#See if any time segements belong to this log record.</li>
<li>If [ issue::timeSegmentKeyList &ne; "" ]</li>
<li>#</li>
<li>New Window [ Name: "temp" ]</li>
<li>#</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
<li>Set Variable [ $day; Value:daylog::_lockDay ]</li>
<li>Select Window [ Name: "temp"; Current file ]</li>
<li>If [ 1 &amp; $day  &amp; "&para;"  = FilterValues ( $$timeAll ; 1 &amp; $day &amp; "&para;" ) or 
2 &amp; $day  &amp; "&para;"  = FilterValues ( $$timeAll ; 2 &amp; $day &amp; "&para;" ) or 
3 &amp; $day  &amp; "&para;"  = FilterValues ( $$timeAll ; 3 &amp; $day &amp; "&para;" ) or 
4 &amp; $day  &amp; "&para;"  = FilterValues ( $$timeAll ; 4 &amp; $day &amp; "&para;" ) or 
5 &amp; $day  &amp; "&para;"  = FilterValues ( $$timeAll ; 5 &amp; $day &amp; "&para;" ) or 

6 &amp; $day  &amp; "&para;"  = FilterValues ( $$timeAll ; 6 &amp; $day &amp; "&para;" ) or 
7 &amp; $day  &amp; "&para;"  = FilterValues ( $$timeAll ; 7 &amp; $day &amp; "&para;" ) or 
8 &amp; $day  &amp; "&para;"  = FilterValues ( $$timeAll ; 8 &amp; $day &amp; "&para;" ) or 
9 &amp; $day  &amp; "&para;"  = FilterValues ( $$timeAll ; 9 &amp; $day &amp; "&para;" ) or 
10 &amp; $day  &amp; "&para;"  = FilterValues ( $$timeAll ; 10 &amp; $day &amp; "&para;" ) or 

11 &amp; $day  &amp; "&para;"  = FilterValues ( $$timeAll ; 10 &amp; $day &amp; "&para;" ) or 
12 &amp; $day  &amp; "&para;"  = FilterValues ( $$timeAll ; 10 &amp; $day &amp; "&para;" ) or 
13 &amp; $day  &amp; "&para;"  = FilterValues ( $$timeAll ; 10 &amp; $day &amp; "&para;" ) or 
14 &amp; $day  &amp; "&para;"  = FilterValues ( $$timeAll ; 10 &amp; $day &amp; "&para;" ) or 
15 &amp; $day  &amp; "&para;"  = FilterValues ( $$timeAll ; 10 &amp; $day &amp; "&para;" ) ]</li>
<li>Go to Layout [ &ldquo;issueTime&rdquo; (issueTime) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issueTime::_keyDay; $day ]</li>
<li>Set Field [ issueTime::_keyIssue; $$issue ]</li>
<li>Perform Find [  ]</li>
<li>Delete All Records
[ No dialog ]</li>
<li>#</li>
<li>#Rebuild issue timeAll list of time segments assigned</li>
<li>#to this issue.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issueTime::_keyIssue; $$issue ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get (LastError) &ne; 401 ]</li>
<li>#</li>
<li>#Get total time for this issue.</li>
<li>Set Variable [ $totalTime; Value:issueTime::sum ]</li>
<li>#</li>
<li>#Make a list of found day and repetition keys.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $RepAndDay; Value:issueTime::_keyRepetition &amp; issueTime::_keyDay ]</li>
<li>Loop</li>
<li>Set Variable [ $list; Value:issueTime::_keyRepetition &amp; issueTime::_keyDay &amp; "&para;" &amp; $RepAndDay ]</li>
<li>Set Variable [ $RepAndDay; Value:$list ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Replace timeAll list with updated list.</li>
<li>Go to Layout [ &ldquo;Issues&rdquo; (issue) ]</li>
<li>Set Field [ issue::issueTotalTime; $TotalTime ]</li>
<li>Set Field [ issue::timeSegmentKeyList; $list ]</li>
<li>Set Variable [ $$timeAll; Value:$list ]</li>
<li>#</li>
<li>Else If [ Get (LastError) = 401 ]</li>
<li>#</li>
<li>#Erase timeAll list.</li>
<li>Go to Layout [ &ldquo;Issues&rdquo; (issue) ]</li>
<li>Set Field [ issue::issueTotalTime; "" ]</li>
<li>Set Field [ issue::timeSegmentKeyList; "" ]</li>
<li>Set Variable [ $$timeAll ]</li>
<li>End If</li>
<li>#</li>
<li>#Add up total time for category it is in.</li>
<li>Set Variable [ $categoryKey; Value:issue::_keyCategory ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyCategory; $categoryKey ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: issue::sortTime; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ issue::timeTotalSumByCat; issue::timeTotalSummaryByCategory ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>Close Window [ Name: "temp"; Current file ]</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#prepare to remove log ID from issueLogs so that the issue</li>
<li>#will have a record of all days logged to deal with it.</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
<li>Set Variable [ $$logIssues; Value:logs::_keyLogIssues ]</li>
<li>Set Variable [ $removelog; Value:logs::_lockDay ]</li>
<li>#</li>
<li>Set Field [ logs::_keyLogIssues; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

If ( ValueCount ( $$logIssues ) &ne; ValueCount ( Substitute ( $$logIssues ; $removeIssue &amp; "&para;"  ; "" ) ) ; 

Substitute ( $$logIssues ; $removeIssue &amp; "&para;"  ; "" ) ; 

Substitute ( $$logIssues ; $removeIssue ; "" ) 

) ]</li>
<li>Set Variable [ $$logIssues; Value:logs::_keyLogIssues ]</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>#</li>
<li>#Remove log ID from issueLogs.</li>
<li>Set Field [ issue::_keyLogs; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

If ( ValueCount ( $$IssueLogs ) &ne; ValueCount ( Substitute ( $$IssueLogs ; $removeLog &amp; "&para;"  ; "" ) ) ; 

Substitute ( $$IssueLogs ; $removeLog &amp; "&para;"  ; "" ) ; 

Substitute ( $$IssueLogs ; $removeLog ; "" ) 

) ]</li>
<li>Set Variable [ $$IssueLogs; Value:issue::_keyLogs ]</li>
<li>#</li>
<li>#For some reason if system does not re-go to this</li>
<li>#same record, other scripts trying to set fields for this</li>
<li>#record in a different window (so same layout </li>
<li>#different window will get an error 301 (record in use </li>
<li>#by another user).  So it is neccessary.  </li>
<li>#addTimeSegmentToIssue is the other scirpt that </li>
<li>#gets that error message when this step is left out. </li>
<li>Go to Record/Request/Page [ Get (RecordNumber) ]
[ No dialog ]</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>issue</em>::_LockList</li>
<li>
<em>logs</em>::_lockDay</li>
<li>
<em>logs</em>::_keyLogIssues</li>
<li>
<em>issue</em>::_keyLogs</li>
<li>
<em>issue</em>::timeSegmentKeyList</li>
<li>
<em>daylog</em>::_lockDay</li>
<li>
<em>issueTime</em>::_keyDay</li>
<li>
<em>issueTime</em>::_keyIssue</li>
<li>
<em>issueTime</em>::sum</li>
<li>
<em>issueTime</em>::_keyRepetition</li>
<li>
<em>issue</em>::issueTotalTime</li>
<li>
<em>issue</em>::_keyCategory</li>
<li>
<em>issue</em>::sortTime</li>
<li>
<em>issue</em>::timeTotalSummaryByCategory</li>
<li>
<em>issue</em>::timeTotalSumByCat</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>issueTime</li>
<li>Issues</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33131ScriptAnchor_"></a><td class="script_navbar"><a href="#33130ScriptAnchor_"><span>Previous Script: [linkActionToDay]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33132ScriptAnchor_"><span>Next Script: [viewAllLogIssues]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">viewLogIssues</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33124ScriptAnchor_">loadLogrecordID</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Prevent windows from flashing and script from slowing</li>
<li>#by stopping strobe effect caused by going back and </li>
<li>#forth from each window upon loading each records </li>
<li>#information throughout the script, rather than just </li>
<li>#at the end.</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>#</li>
<li>#Clear tag find variables and go to category layout.</li>
<li>Select Window [ Name: "Tag"; Current file ]</li>
<li>Set Variable [ $$found ]</li>
<li>Set Variable [ $$foundStatus ]</li>
<li>Go to Layout [ &ldquo;IssuesAndObservationsTag&rdquo; (category) ]</li>
<li>#</li>
<li>#Find all issues linked to this day.</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>New Window [ Name: "Specific Action"; Height: Get (ScreenHeight); Width: 441; Top: 0; Left: 0 ]</li>
<li>If [ Get ( WindowZoomLevel ) &gt; 150 ]</li>
<li>Move/Resize Window [ Current Window; Width: Get (ScreenWidth) / 2; Left: 0 ]</li>
<li>End If</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;Issues&rdquo; (issue) ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyLogs; $$log ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get (FoundCount) = 0 ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Field [ issue::lock; "issue" ]</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issueStatus::order; ascending
issueStatus::text; ascending
issueCategory::order; ascending
issueCategory::text; ascending
issue::order; based on value list: &ldquo;__-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Set Variable [ $$issueSort; Value:"status" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Perform Script [ &ldquo;loadIssuerecordID&rdquo; ]</li>
<li>Set Variable [ $$stopSubtotal; Value:1 ]</li>
<li>Perform Script [ &ldquo;TsubtotalTimeByGroup&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>issue</em>::_keyLogs</li>
<li>
<em>issue</em>::_keyBrainstate</li>
<li>
<em>issue</em>::lock</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>issueStatus</em>::order</li>
<li>
<em>issueStatus</em>::text</li>
<li>
<em>issueCategory</em>::order</li>
<li>
<em>issueCategory</em>::text</li>
<li>
<em>issue</em>::order</li>
<li>
<em>issue</em>::text</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33115ScriptAnchor_">loadIssuerecordID</a></li>
<li><a href="#33112ScriptAnchor_">TsubtotalTimeByGroup</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>IssuesAndObservationsTag</li>
<li>Issues</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33132ScriptAnchor_"></a><td class="script_navbar"><a href="#33131ScriptAnchor_"><span>Previous Script: [viewLogIssues]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33133ScriptAnchor_"><span>Next Script: [dateStampIssue]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">viewAllLogIssues</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33134ScriptAnchor_">activityLog!!!!findAllBrainstateLogs</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>#</li>
<li>#</li>
<li>#Clear tag find variables and go to category layout.</li>
<li>Select Window [ Name: "Tag"; Current file ]</li>
<li>Set Variable [ $$found ]</li>
<li>Set Variable [ $$foundStatus ]</li>
<li>Go to Layout [ &ldquo;IssuesAndObservationsTag&rdquo; (category) ]</li>
<li>#</li>
<li>#neccessary step when two monitors are used as this</li>
<li>#window can be opened in smaller monitor and then </li>
<li>#move over to larger monitor but not adjust its height</li>
<li>#unless this step is included.</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>New Window [ Name: "Specific Action"; Height: Get (ScreenHeight); Width: 441; Top: 0; Left: 0 ]</li>
<li>If [ Get ( WindowZoomLevel ) &gt; 150 ]</li>
<li>Move/Resize Window [ Current Window; Width: Get (ScreenWidth) / 2; Left: 0 ]</li>
<li>End If</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;Issues&rdquo; (issue) ]</li>
<li>#</li>
<li>#remember record user was looking at before </li>
<li>#find all issue records.</li>
<li>Set Variable [ $issueRecord; Value:issue::_LockList ]</li>
<li>#</li>
<li>#Find all issue records.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Field [ issue::lock; "issue" ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Set Variable [ $$issueSort; Value:"status" ]</li>
<li>#</li>
<li>#Now go the record the user was looking at.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Loop</li>
<li>Exit Loop If [ issue::_LockList = $issueRecord ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#If the user was not looking at any records then </li>
<li>#go to the first record.</li>
<li>If [ issue::_LockList  &ne;  $issueRecord ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>End If</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Perform Script [ &ldquo;loadIssuerecordID&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>issue</em>::_LockList</li>
<li>
<em>issue</em>::_keyBrainstate</li>
<li>
<em>issue</em>::lock</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33115ScriptAnchor_">loadIssuerecordID</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>IssuesAndObservationsTag</li>
<li>Issues</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33133ScriptAnchor_"></a><td class="script_navbar"><a href="#33132ScriptAnchor_"><span>Previous Script: [viewAllLogIssues]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33135ScriptAnchor_"><span>Next Script: [timeStampIssue]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">dateStampIssue</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Insert Calculated Result [ "[" &amp; Get ( CurrentDate )  &amp;  "] "

//TextSize ( "["; 12 )  &amp; TextSize ( Get ( CurrentDate ) ; 12 ) &amp;  TextSize ( "] "; 12 ) ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33135ScriptAnchor_"></a><td class="script_navbar"><a href="#33133ScriptAnchor_"><span>Previous Script: [dateStampIssue]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33136ScriptAnchor_"><span>Next Script: [addTimeSegmentToIssue]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">timeStampIssue</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $time; Value:daylog::_lockDay ]</li>
<li>Go to Field [  ]</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>Set Variable [ $timeAll; Value:issue::timeSegmentKeyList ]</li>
<li>If [ $time &amp; "&para;"  &ne;  FilterValues ( $timeAll ; $time &amp; "&para;" ) ]</li>
<li>Set Field [ issue::timeSegmentKeyList; $time &amp; &para; &amp; $timeAll ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Field [ issue::timeSegmentKeyList; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

If ( ValueCount ( $timeAll ) &ne; ValueCount ( Substitute ( $timeAll ; $time &amp; "&para;"  ; "" ) ) ; 

Substitute ( $timeAll ; $time &amp; "&para;"  ; "" ) ; 

Substitute ( $timeAll ; $time ; "" ) 

) ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>daylog</em>::_lockDay</li>
<li>
<em>issue</em>::timeSegmentKeyList</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33136ScriptAnchor_"></a><td class="script_navbar"><a href="#33135ScriptAnchor_"><span>Previous Script: [timeStampIssue]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33134ScriptAnchor_"><span>Next Script: [activityLog!!!!findAllBrainstateLogs]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addTimeSegmentToIssue</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>If [ Get ( ActiveFieldContents ) = "" ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Variable [ $timeSegment; Value:Get ( ActiveRepetitionNumber ) &amp; logs::_lockDay ]</li>
<li>#</li>
<li>#Prevent windows from flashing and script from slowing</li>
<li>#by stopping strobe effect caused by going back and </li>
<li>#forth from each window upon loading each records </li>
<li>#information throughout the script, rather than just </li>
<li>#at the end.</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>#</li>
<li>#If the user activated Specific Action timer by </li>
<li>#dragging time from another timer then the </li>
<li>#update the $$day1BugField to reflect it's </li>
<li>#active.  The dragging method of activiation </li>
<li>#fails to update variables.</li>
<li>If [ logs::swBugField = "veto" ]</li>
<li>Set Variable [ $$day1BugField; Value:"veto" ]</li>
<li>End If</li>
<li>#</li>
<li>#Get category key for adding up total category time</li>
<li>#later in the script.</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>Set Variable [ $categoryKey; Value:issue::_keyCategory ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#For some reason if system does not re-go to same</li>
<li>#issue record, record in a different window (so same </li>
<li>#layout different window will get an error 301 (record </li>
<li>#in use by another user). </li>
<li>Go to Record/Request/Page [ Get (RecordNumber) ]
[ No dialog ]</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
<li>#</li>
<li>#Capture repetition number and _lockDay when  </li>
<li>#segment is clicked in log window.</li>
<li>Set Variable [ $day; Value:daylog::_lockDay ]</li>
<li>Set Variable [ $repetition; Value:Get (ActiveRepetitionNumber) ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#See if time segment is already in use by ANY segment.</li>
<li>Go to Layout [ &ldquo;issueTime&rdquo; (issueTime) ]</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issueTime::_keyDay; $day ]</li>
<li>Set Field [ issueTime::_keyRepetition; $repetition ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If it is not in use create a new record in issueTime </li>
<li>#window and give it issue, day, and repetition keys.</li>
<li>#to add their time to the total of all time spent on </li>
<li>#this issue.</li>
<li>If [ Get (LastError) = 401 ]</li>
<li>New Record/Request</li>
<li>Set Field [ issueTime::_keyDay; $day ]</li>
<li>Set Field [ issueTime::_keyRepetition; $repetition ]</li>
<li>Set Field [ issueTime::_keyIssue; $$issue ]</li>
<li>#</li>
<li>#Add up total time for this issue.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issueTime::_keyIssue; $$issue ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $totalTime; Value:issueTime::sum ]</li>
<li>#</li>
<li>#Set new total time for this issue.</li>
<li>Go to Layout [ &ldquo;IssuesLayoutForScripts&rdquo; (issue) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_LockList; $$issue ]</li>
<li>Perform Find [  ]</li>
<li>Set Field [ issue::issueTotalTime; $totalTime ]</li>
<li>#</li>
<li>#Add day and repetition keys to the list of all day</li>
<li>#and repetition keys for this issue.</li>
<li>Set Variable [ $$timeAll; Value:issue::timeSegmentKeyList ]</li>
<li>Set Variable [ $time; Value:$repetition &amp; $day ]</li>
<li>Set Field [ issue::timeSegmentKeyList; $time &amp; &para; &amp; $$timeAll ]</li>
<li>Set Variable [ $$timeAll; Value:issue::timeSegmentKeyList ]</li>
<li>#</li>
<li>#Add up total time for category it is in.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyCategory; $categoryKey ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: issue::_keyCategory; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Stop doing this modification of all records tagged</li>
<li>#with the same catetory so the MODIFY DATE </li>
<li>#only gets changed when something unique in</li>
<li>#an issue record is changed.  And besides,</li>
<li>#category tag's total time is now displayed in the</li>
<li>#tag window rather than the Specific Action window.  </li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Loop</li>
<li>//  Set Field [ issue::timeTotalSumByCat; issue::timeTotalSummaryByCategory ]</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  End Loop</li>
<li>#</li>
<li>#Set new total time for category tag.</li>
<li>//  Set Field [ issueCategory::issueTotalTime; issue::timeTotalSummaryByCategory ]</li>
<li>Set Field [ issueCategory::issueTotalTime; GetSummary ( issue::timeSummary ; issue::_keyCategory ) ]</li>
<li>#</li>
<li>Go to Layout [ original layout ]</li>
<li>#</li>
<li>#Conditionally format segment to show that it is assigned.</li>
<li>Set Field [ daylog::swLogTimeAccounting[$repetition]; $$issue ]</li>
<li>#</li>
<li>#Capture Day window time segment timer that is on.</li>
<li>Set Variable [ $$ActiveTimeSegment; Value:logs::swOccurances &amp; logs::_lockDay ]</li>
<li>#</li>
<li>#If issue is not linked to day whose time has just </li>
<li>#been added to it, then link it.</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>If [ issue::_LockList &amp; "&para;"  &ne;  FilterValues ( $$logIssues ; issue::_LockList &amp; "&para;" ) ]</li>
<li>Perform Script [ &ldquo;linkActionToDay&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>#Inform user the timer is running for this specific</li>
<li>#action record with conditional formatting.</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Else If [ Get (LastError) &ne; 401 ]</li>
<li>Go to Layout [ original layout ]</li>
<li>If [ $$specificActionTimer = "" ]</li>
<li>Show Custom Dialog [ Message: "Subtract time from act currently credited with it, so that it can be credited to a different act?&para;&para;Go to act credited with this time?"; Buttons: &ldquo;GoToAct&rdquo;, &ldquo;Subtract&rdquo; ]</li>
<li>End If</li>
<li>If [ Get ( LastMessageChoice ) = 1 and $$specificActionTimer = "" ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Go to record time to which time will be added.</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ FilterValues (issue::timeSegmentKeyList  ; $timeSegment  &amp; "&para;")  =  $timeSegment &amp; "&para;" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#If record is not showing then find and add it to</li>
<li>#list of records being shown. </li>
<li>If [ FilterValues (issue::timeSegmentKeyList  ; $timeSegment  &amp; "&para;")  &ne; $timeSegment &amp; "&para;" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::timeSegmentKeyList; $timeSegment &amp; "&para;" ]</li>
<li>Extend Found Set [  ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ FilterValues (issue::timeSegmentKeyList  ; $timeSegment  &amp; "&para;")  =  $timeSegment &amp; "&para;" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Perform Script [ &ldquo;loadIssuerecordID&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Conditionally format segment so it shows as unassigned.</li>
<li>Set Field [ daylog::swLogTimeAccounting[$repetition]; "" ]</li>
<li>#</li>
<li>#If it is in use then subtract its time from the total</li>
<li>#time of all time segements attributed to this issue.</li>
<li>#BUT first set a new issue ID variable as the user</li>
<li>#may be removing the time from an issue not currently</li>
<li>#selected, meaning the time was part of a different</li>
<li>#issue and when the user clicked on this time to assign</li>
<li>#to a new issue, the time first had to be deleted from</li>
<li>#the issue to which it is currently assigned.</li>
<li>Go to Layout [ &ldquo;issueTime&rdquo; (issueTime) ]</li>
<li>Set Variable [ $issueTimeDelete; Value:issueTime::_keyIssue ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>#</li>
<li>#Add up total time for issue.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issueTime::_keyIssue; $issueTimeDelete ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $totalTime; Value:issueTime::sum ]</li>
<li>#</li>
<li>#Then subtract day and repetition keys from the list </li>
<li>#of all day and repetition keys for this issue.</li>
<li>Go to Layout [ &ldquo;Issues&rdquo; (issue) ]</li>
<li>Set Variable [ $time; Value:$repetition &amp; $day ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::timeSegmentKeyList; $time ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $$timeAll; Value:issue::timeSegmentKeyList ]</li>
<li>Set Field [ issue::timeSegmentKeyList; //last item in list has no paragraph mark, so a valuecount test needs to be done and if item is not removed, then the removal calc without the paragraph mark is used

If ( ValueCount ( $$timeAll ) &ne; ValueCount ( Substitute ( $$timeAll ; $time &amp; "&para;"  ; "" ) ) ; 

Substitute ( $$timeAll ; $time &amp; "&para;"  ; "" ) ; 

Substitute ( $$timeAll ; $time ; "" ) 

) ]</li>
<li>Set Variable [ $$timeAll; Value:issue::timeSegmentKeyList ]</li>
<li>Set Field [ issue::issueTotalTime; $totalTime ]</li>
<li>#</li>
<li>#Add up total time for category it is in.</li>
<li>Go to Layout [ &ldquo;Issues&rdquo; (issue) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyCategory; $categoryKey ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: issue::_keyCategory; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Stop doing this modification of all records tagged</li>
<li>#with the same catetory so the MODIFY DATE </li>
<li>#only gets changed when something unique in</li>
<li>#an issue record is changed.  And besides,</li>
<li>#category tag's total time is now displayed in the</li>
<li>#tag window rather than the Specific Action window.  </li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Loop</li>
<li>//  Set Field [ issue::timeTotalSumByCat; issue::timeTotalSummaryByCategory ]</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  End Loop</li>
<li>#</li>
<li>#Set new total time for category tag.</li>
<li>//  Set Field [ issueCategory::issueTotalTime; issue::timeTotalSummaryByCategory ]</li>
<li>Set Field [ issueCategory::issueTotalTime; GetSummary ( issue::timeSummary ; issue::_keyCategory ) ]</li>
<li>#</li>
<li>Go to Layout [ original layout ]</li>
<li>Go to Layout [ original layout ]</li>
<li>Go to Field [  ]</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>#</li>
<li>#Inform user timer stopped running for this specific</li>
<li>#action record with conditional formatting.</li>
<li>Set Variable [ $$TimeAssignedToSpecificAction ]</li>
<li>End If</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>Perform Script [ &ldquo;loadIssuerecordID&rdquo; ]</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>logs</em>::_lockDay</li>
<li>
<em>logs</em>::swBugField</li>
<li>
<em>issue</em>::_keyCategory</li>
<li>
<em>daylog</em>::_lockDay</li>
<li>
<em>issueTime</em>::_keyDay</li>
<li>
<em>issueTime</em>::_keyRepetition</li>
<li>
<em>issueTime</em>::_keyIssue</li>
<li>
<em>issueTime</em>::sum</li>
<li>
<em>issue</em>::_LockList</li>
<li>
<em>issue</em>::issueTotalTime</li>
<li>
<em>issue</em>::timeSegmentKeyList</li>
<li>
<em>issue</em>::timeTotalSummaryByCategory</li>
<li>
<em>issue</em>::timeTotalSumByCat</li>
<li>
<em>issueCategory</em>::issueTotalTime</li>
<li>
<em>issue</em>::timeSummary</li>
<li>
<em>daylog</em>::swLogTimeAccounting</li>
<li>
<em>logs</em>::swOccurances</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33130ScriptAnchor_">linkActionToDay</a></li>
<li><a href="#33115ScriptAnchor_">loadIssuerecordID</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>issueTime</li>
<li>IssuesLayoutForScripts</li>
<li>Issues</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33134ScriptAnchor_"></a><td class="script_navbar"><a href="#33136ScriptAnchor_"><span>Previous Script: [addTimeSegmentToIssue]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33138ScriptAnchor_"><span>Next Script: [CHUNK_updateIssueCategoryTime]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">activityLog!!!!findAllBrainstateLogs</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ logs::_keyBrainstate; $$LogBrainstate ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: logs::_keyBrainstate; descending
logs::_keyDay; descending ]
[ Restore; No dialog ]</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $$logrecordID; Value:Get ( RecordID ) ]</li>
<li>Set Variable [ $$logissues; Value:logs::_keyLogIssues ]</li>
<li>Set Variable [ $$log; Value:logs::_lockDay ]</li>
<li>If [ daylog::swActivityLength[11] &ne; "" ]</li>
<li>Go to Layout [ &ldquo;logs3rows&rdquo; (logs) ]</li>
<li>Else If [ daylog::swActivityLength[6] &ne; "" ]</li>
<li>Go to Layout [ &ldquo;logs2rows&rdquo; (logs) ]</li>
<li>Else If [ daylog::swActivityLength[6] = "" ]</li>
<li>Go to Layout [ &ldquo;logs1row&rdquo; (logs) ]</li>
<li>End If</li>
<li>Refresh Window</li>
<li>Scroll Window
[ Home ]</li>
<li>//  Perform Script [ &ldquo;viewAllLogIssues&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>logs</em>::_keyBrainstate</li>
<li>
<em>logs</em>::_keyDay</li>
<li>
<em>logs</em>::_keyLogIssues</li>
<li>
<em>logs</em>::_lockDay</li>
<li>
<em>daylog</em>::swActivityLength</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33132ScriptAnchor_">viewAllLogIssues</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>logs3rows</li>
<li>logs2rows</li>
<li>logs1row</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33138ScriptAnchor_"></a><td class="script_navbar"><a href="#33134ScriptAnchor_"><span>Previous Script: [activityLog!!!!findAllBrainstateLogs]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33146ScriptAnchor_"><span>Next Script: [gotoIssuesLog]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">CHUNK_updateIssueCategoryTime</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#32829ScriptAnchor_">updateTime</a></li>
<li><a href="#33058ScriptAnchor_">clearPart2</a></li>
<li><a href="#33220ScriptAnchor_">stopTimerAssignedToSpecificAction</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#This script is used by the updateTime script</li>
<li>#and the clear script and the script </li>
<li>#stopTimerAssignedToSpecificAction.</li>
<li>#</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#FIRST capture current window so system can go</li>
<li>#to it after finished, otherwise</li>
<li>#UpdateTime script tries to continue in the wrong</li>
<li>#window, which is showing the wrong layout!</li>
<li>Set Variable [ $UpdateTimewindowName; Value:Get ( WindowName ) ]</li>
<li>#</li>
<li>#Find all issues with this day record's time attributed</li>
<li>#to them.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>New Window [ Name: "temp"; Height: 1; Width: 1; Top: -1000; Left: -1000 ]</li>
<li>//  New Window [ Name: "temp" ]</li>
<li>Go to Layout [ &ldquo;IssuesLayoutForScripts&rdquo; (issue) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::timeSegmentKeyList; "*" &amp; Replace ( Quote("1")  ; 2 ; 1 ; $$updateDay  ) ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get (LastError) = 401 ]</li>
<li>Close Window [ Name: "temp"; Current file ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Make sure user is not in any fields before updating</li>
<li>#as this prevents update of time for the record</li>
<li>#the user is in (have not tested how yet).</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>If [ Get (LastError) &ne; 112 ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>#</li>
<li>Select Window [ Name: "temp"; Current file ]</li>
<li>#</li>
<li>#Make a list of them.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Variable [ $AllIssueRecordsNeedingUpdate; Value:issue::_LockList &amp; "&para;" &amp; $issueList ]</li>
<li>Set Variable [ $issueList; Value:$AllIssueRecordsNeedingUpdate ]</li>
<li>If [ $$clear = 1 ]</li>
<li>#</li>
<li>#Remove link to log from issue record and update</li>
<li>#the variable containing these links if any.</li>
<li>Set Field [ issue::_keyLogs; If ( ValueCount ( issue::_keyLogs ) &ne; ValueCount ( Substitute ( issue::_keyLogs ; $$updateDay &amp; "&para;"  ; "" ) ) ; 

Substitute ( issue::_keyLogs ; $$updateDay &amp; "&para;"  ; "" ) ; 

Substitute ( issue::_keyLogs ; $$updateDay ; "" ) ) ]</li>
<li>Set Variable [ $$logissues; Value:logs::_keyLogIssues ]</li>
<li>#</li>
<li>#Remove time segment key from list.</li>
<li>#(the teen numbers must come first otherwise</li>
<li>#the singly digits will delete 3 in 13 and leave </li>
<li>#behind an orphaned 1 for example)</li>
<li>Set Field [ issue::timeSegmentKeyList; Substitute ( issue::timeSegmentKeyList ; 11 &amp; $$updateday &amp; "&para;"  ; "" ) ]</li>
<li>Set Field [ issue::timeSegmentKeyList; Substitute ( issue::timeSegmentKeyList ; 12 &amp; $$updateday &amp; "&para;"  ; "" ) ]</li>
<li>Set Field [ issue::timeSegmentKeyList; Substitute ( issue::timeSegmentKeyList ; 13 &amp; $$updateday &amp; "&para;"  ; "" ) ]</li>
<li>Set Field [ issue::timeSegmentKeyList; Substitute ( issue::timeSegmentKeyList ; 14 &amp; $$updateday &amp; "&para;"  ; "" ) ]</li>
<li>Set Field [ issue::timeSegmentKeyList; Substitute ( issue::timeSegmentKeyList ; 15 &amp; $$updateday &amp; "&para;"  ; "" ) ]</li>
<li>#</li>
<li>Set Field [ issue::timeSegmentKeyList; Substitute ( issue::timeSegmentKeyList ; 1 &amp; $$updateday &amp; "&para;"  ; "" ) ]</li>
<li>Set Field [ issue::timeSegmentKeyList; Substitute ( issue::timeSegmentKeyList ; 2 &amp; $$updateday &amp; "&para;"  ; "" ) ]</li>
<li>Set Field [ issue::timeSegmentKeyList; Substitute ( issue::timeSegmentKeyList ; 3 &amp; $$updateday &amp; "&para;"  ; "" ) ]</li>
<li>Set Field [ issue::timeSegmentKeyList; Substitute ( issue::timeSegmentKeyList ; 4 &amp; $$updateday &amp; "&para;"  ; "" ) ]</li>
<li>Set Field [ issue::timeSegmentKeyList; Substitute ( issue::timeSegmentKeyList ; 5 &amp; $$updateday &amp; "&para;"  ; "" ) ]</li>
<li>#</li>
<li>Set Field [ issue::timeSegmentKeyList; Substitute ( issue::timeSegmentKeyList ; 6 &amp; $$updateday &amp; "&para;"  ; "" ) ]</li>
<li>Set Field [ issue::timeSegmentKeyList; Substitute ( issue::timeSegmentKeyList ; 7 &amp; $$updateday &amp; "&para;"  ; "" ) ]</li>
<li>Set Field [ issue::timeSegmentKeyList; Substitute ( issue::timeSegmentKeyList ; 8 &amp; $$updateday &amp; "&para;"  ; "" ) ]</li>
<li>Set Field [ issue::timeSegmentKeyList; Substitute ( issue::timeSegmentKeyList ; 9 &amp; $$updateday &amp; "&para;"  ; "" ) ]</li>
<li>Set Field [ issue::timeSegmentKeyList; Substitute ( issue::timeSegmentKeyList ; 10 &amp; $$updateday &amp; "&para;"  ; "" ) ]</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#Update the time for each issueTime record in the list.</li>
<li>Loop</li>
<li>Set Variable [ $issue; Value:GetValue ( $AllIssueRecordsNeedingUpdate ; 1 ) ]</li>
<li>Set Variable [ $AllIssueRecordsNeedingUpdate; Value:If ( ValueCount ( $AllIssueRecordsNeedingUpdate ) &ne; ValueCount ( Substitute ( $AllIssueRecordsNeedingUpdate ; $issue &amp; "&para;"  ; "" ) ) ; 

Substitute ( $AllIssueRecordsNeedingUpdate ; $issue &amp; "&para;"  ; "" ) ; 

Substitute ( $AllIssueRecordsNeedingUpdate ; $issue ; "" ) ) ]</li>
<li>#</li>
<li>#Find all time segments attributed to this issue.</li>
<li>Go to Layout [ &ldquo;issueTime&rdquo; (issueTime) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issueTime::_keyIssue; $issue ]</li>
<li>Perform Find [  ]</li>
<li>Exit Loop If [ Get (LastError) = 400 ]</li>
<li>#</li>
<li>#Get total time for this issue.</li>
<li>Set Variable [ $totalTime; Value:issueTime::sum ]</li>
<li>#</li>
<li>#And update this issue's total time.</li>
<li>Go to Layout [ &ldquo;IssuesLayoutForScripts&rdquo; (issue) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_LockList; $issue ]</li>
<li>Perform Find [  ]</li>
<li>Set Field [ issue::issueTotalTime; $totalTime ]</li>
<li>#</li>
<li>#Add up total time for all actions with this category tag.</li>
<li>Set Variable [ $categoryKey; Value:issue::_keyCategory ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyCategory; $categoryKey ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: issue::_keyCategory; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Stop doing this modification of all records tagged</li>
<li>#with the same catetory so the MODIFY DATE </li>
<li>#only gets changed when something unique in</li>
<li>#an issue record is changed.  And besides,</li>
<li>#category tag's total time is now displayed in the</li>
<li>#tag window rather than the Specific Action window.  </li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Loop</li>
<li>//  Set Field [ issue::timeTotalSumByCat; issue::timeTotalSummaryByCategory ]</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  End Loop</li>
<li>#</li>
<li>#Set new total time for category tag.</li>
<li>//  Set Field [ issueCategory::issueTotalTime; issue::timeTotalSummaryByCategory ]</li>
<li>Set Field [ issueCategory::issueTotalTime; GetSummary ( issue::timeSummary ; issue::_keyCategory ) ]</li>
<li>#</li>
<li>#</li>
<li>#Disabled the next chunk after deciding it was </li>
<li>#better to use filemaker's subtotal calc rather</li>
<li>#doing it with this script chunk whose benefit</li>
<li>#was subtotaling items in a category even when</li>
<li>#items where divided by status.  Filemaker's</li>
<li>#subtotal calc subtotals at the status and category</li>
<li>#breaks (essentially all breaks caused by a sort)</li>
<li>#but I decided to show issue the time by status</li>
<li>#and category too, so that is why this script chunk</li>
<li>#is now disabled.  The other reason was that it</li>
<li>#bogged down the system taking a long time to run.</li>
<li>//  #To reset all the category subtotal times, first find</li>
<li>//  #and sort all this issues records.</li>
<li>//  Set Variable [ $brainstateIssues; Value:issue::_keyBrainstate ]</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ issue::_keyBrainstate; $brainstateIssues ]</li>
<li>//  Perform Find [  ]</li>
<li>//  Sort Records [ Specified Sort Order: brainstate::description; ascending
issueStatus::order; ascending
issueStatus::text; ascending
issueCategory::order; ascending
issue::timeTotalSummaryByCategory; ascending
issue::order; based on value list: &ldquo;__-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #AddUp total time showing for this subset of</li>
<li>//  #a cateogory broken up into subsets by different</li>
<li>//  #statuses, like the subset of some category's</li>
<li>//  #record that are pending, or completed, etc.</li>
<li>//  Loop</li>
<li>//  Set Variable [ $category; Value:issue::_keyCategory ]</li>
<li>//  Set Variable [ $status; Value:issue::_keyStatus ]</li>
<li>//  Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>//  Set Variable [ $subsetTotal ]</li>
<li>//  Set Variable [ $oldTotal ]</li>
<li>//  #</li>
<li>//  Loop</li>
<li>//  Set Variable [ $subsetTotal; Value:issue::issueTotalTime + $oldTotal ]</li>
<li>//  Set Variable [ $oldTotal; Value:$subsetTotal ]</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  Exit Loop If [ issue::_keyCategory &ne; $category 

//This next step I thought could happen, but then realized it can nevery happen
//or 
//issue::_keyCategory = $category and issue::_keyStatus &ne; $status ]</li>
<li>//  End Loop</li>
<li>//  #</li>
<li>//  #Return the first record in this subset and give it</li>
<li>//  #the subset total, then give the subtotal to all </li>
<li>//  #records in this subset.</li>
<li>//  Go to Record/Request/Page [ $recordNumber ]
[ No dialog ]</li>
<li>//  #</li>
<li>//  Loop</li>
<li>//  Set Field [ issue::timeTotalSumByCatSortedByStatus; $subsetTotal ]</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  Exit Loop If [ issue::_keyCategory &ne; $category 

//This next step I thought could happen, but then realized it can nevery happen
//or 
//issue::_keyCategory = $category and issue::_keyStatus &ne; $status ]</li>
<li>//  End Loop</li>
<li>//  #</li>
<li>//  Exit Loop If [ Get (LastError)  = 101 ]</li>
<li>//  End Loop</li>
<li>End Loop</li>
<li>#</li>
<li>Close Window [ Name: "temp"; Current file ]</li>
<li>#</li>
<li>#Conditionally format Specific Action record if</li>
<li>#the current time segement is active and assigned to it.</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>If [ FilterValues (issue::timeSegmentKeyList  ; $$activeTimeSegment &amp; "&para;")   &ne;   $$activeTimeSegment &amp; "&para;" and 
$$timerIDnumber = $$logBrainstate and 
$$activeTimeSegment &ne; "" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ FilterValues (issue::timeSegmentKeyList  ; $$activeTimeSegment &amp; "&para;")  =  $$activeTimeSegment &amp; "&para;" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#If record is not showing then find and add it to</li>
<li>#list of records being shown. </li>
<li>If [ FilterValues (issue::timeSegmentKeyList  ; $$activeTimeSegment  &amp; "&para;")  &ne; $$activeTimeSegment  &amp; "&para;" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::timeSegmentKeyList; $$activeTimeSegment &amp; "&para;" ]</li>
<li>Extend Found Set [  ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ FilterValues (issue::timeSegmentKeyList  ; $$activeTimeSegment &amp; "&para;")  =  $$activeTimeSegment &amp; "&para;" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Perform Script [ &ldquo;loadIssuerecordID&rdquo; ]</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>If [ $$timerIDnumber = $$logBrainstate ]</li>
<li>If [ FilterValues (issue::timeSegmentKeyList  ; day1::swOccurances &amp; day1::_lockDay &amp; "&para;" ) = day1::swOccurances &amp; $$log &amp; "&para;" and day1::swBugField = "veto" ]</li>
<li>Set Variable [ $$ActiveTimeSegment; Value:day1::swOccurances &amp; day1::_lockDay ]</li>
<li>Else If [ day1::swBugField = "note" or day1::swBugField = "" ]</li>
<li>Set Variable [ $$ActiveTimeSegment ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>If [ FilterValues (issue::timeSegmentKeyList  ; day1::swOccurances &amp; day1::_lockDay &amp; "&para;" ) = day1::swOccurances &amp; $$log &amp; "&para;" and day1::swBugField = "veto" ]</li>
<li>Set Variable [ $$day1BugField; Value:day1::swBugField ]</li>
<li>Else If [ day1::swBugField = "note" or day1::swBugField = "" ]</li>
<li>Set Variable [ $$day1BugField ]</li>
<li>End If</li>
<li>#</li>
<li>#Update totals for category tags.</li>
<li>Select Window [ Name: "Tag"; Current file ]</li>
<li>Set Variable [ $tagLayoutName; Value:Get (LayoutName) ]</li>
<li>If [ Get ( LayoutName ) = "IssuesAndObservationsTag" ]</li>
<li>Sort Records [ Specified Sort Order: group::text; ascending
category::sortTime; ascending
category::text; ascending ]
[ Restore; No dialog ]</li>
<li>Else</li>
<li>Go to Layout [ &ldquo;IssuesAndObservationsTag&rdquo; (category) ]</li>
<li>Sort Records [ Specified Sort Order: group::text; ascending
category::sortTime; ascending
category::text; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Layout [ $tagLayoutName ]</li>
<li>End If</li>
<li>#</li>
<li>Select Window [ Name: $UpdateTimewindowName; Current file ]</li>
<li>Exit Script [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>issue</em>::timeSegmentKeyList</li>
<li>
<em>issue</em>::_LockList</li>
<li>
<em>issue</em>::_keyLogs</li>
<li>
<em>logs</em>::_keyLogIssues</li>
<li>
<em>issueTime</em>::_keyIssue</li>
<li>
<em>issueTime</em>::sum</li>
<li>
<em>issue</em>::issueTotalTime</li>
<li>
<em>issue</em>::_keyCategory</li>
<li>
<em>issue</em>::timeTotalSummaryByCategory</li>
<li>
<em>issue</em>::timeTotalSumByCat</li>
<li>
<em>issueCategory</em>::issueTotalTime</li>
<li>
<em>issue</em>::timeSummary</li>
<li>
<em>issue</em>::_keyBrainstate</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>issueStatus</em>::order</li>
<li>
<em>issueStatus</em>::text</li>
<li>
<em>issueCategory</em>::order</li>
<li>
<em>issue</em>::order</li>
<li>
<em>issue</em>::text</li>
<li>
<em>issue</em>::_keyStatus</li>
<li>
<em>issue</em>::timeTotalSumByCatSortedByStatus</li>
<li>
<em>day1</em>::swOccurances</li>
<li>
<em>day1</em>::_lockDay</li>
<li>
<em>day1</em>::swBugField</li>
<li>
<em>group</em>::text</li>
<li>
<em>category</em>::sortTime</li>
<li>
<em>category</em>::text</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33115ScriptAnchor_">loadIssuerecordID</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>IssuesLayoutForScripts</li>
<li>issueTime</li>
<li>IssuesAndObservationsTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33146ScriptAnchor_"></a><td class="script_navbar"><a href="#33138ScriptAnchor_"><span>Previous Script: [CHUNK_updateIssueCategoryTime]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33147ScriptAnchor_"><span>Next Script: [gotoTagMenus]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoIssuesLog</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>New Window [ Name: "Specific Action" ]</li>
<li>If [ Get ( WindowZoomLevel ) &gt; 150 ]</li>
<li>Move/Resize Window [ Current Window; Width: Get (ScreenWidth) / 2; Left: 0 ]</li>
<li>Else If [ Get ( WindowZoomLevel ) = 150 ]</li>
<li>Move/Resize Window [ Current Window; Height: Get (ScreenHeight); Width: 441; Left: 0 ]</li>
<li>End If</li>
<li>Go to Layout [ &ldquo;Issues&rdquo; (issue) ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyBrainstate; $$logbrainstate ]</li>
<li>Set Field [ issue::lock; "issue" ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issueStatus::order; ascending
issueStatus::text; ascending
issueCategory::order; ascending
issueCategory::text; ascending
issue::order; based on value list: &ldquo;__-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $$issueRecordID; Value:Get ( RecordID ) ]</li>
<li>Set Variable [ $$issue; Value:issue::_LockList ]</li>
<li>Set Variable [ $$issueLogs; Value:issue::_keyLogs ]</li>
<li>Refresh Window</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>issue</em>::_keyBrainstate</li>
<li>
<em>issue</em>::lock</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>issueStatus</em>::order</li>
<li>
<em>issueStatus</em>::text</li>
<li>
<em>issueCategory</em>::order</li>
<li>
<em>issueCategory</em>::text</li>
<li>
<em>issue</em>::order</li>
<li>
<em>issue</em>::text</li>
<li>
<em>issue</em>::_LockList</li>
<li>
<em>issue</em>::_keyLogs</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>Issues</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33147ScriptAnchor_"></a><td class="script_navbar"><a href="#33146ScriptAnchor_"><span>Previous Script: [gotoIssuesLog]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33148ScriptAnchor_"><span>Next Script: [zoomLogIN_DELETE!!!!!!]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoTagMenus</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Select Window [ Name: "Tag"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>New Window [ Name: "Tag" ]</li>
<li>If [ Get ( WindowZoomLevel ) = 200 ]</li>
<li>Move/Resize Window [ Current Window; Width: 550; Left: If (Get (ScreenWidth) / 2 + 550 &le; Get (ScreenWidth) ; Get (ScreenWidth)/2 ; Get (ScreenWidth)  - 550 ) ]</li>
<li>Else If [ Get ( WindowZoomLevel ) = 300 ]</li>
<li>Move/Resize Window [ Current Window; Width: 830; Left: If (Get (ScreenWidth) / 2 + 830 &le; Get (ScreenWidth) ; Get (ScreenWidth)/2 ; Get (ScreenWidth)  - 830 ) ]</li>
<li>Else If [ Get ( WindowZoomLevel ) = 400 ]</li>
<li>Move/Resize Window [ Current Window; Width: 1100; Left: If (Get (ScreenWidth) / 2 + 1100 &le; Get (ScreenWidth) ; Get (ScreenWidth)/2 ; Get (ScreenWidth)  - 1100 ) ]</li>
<li>Else If [ Get ( WindowZoomLevel ) = 150 ]</li>
<li>Move/Resize Window [ Current Window; Height: Get (ScreenHeight); Width: 441; Top: 0; Left: If (Get (ScreenWidth) / 2 + 1100 &le; Get (ScreenWidth) ; Get (ScreenWidth)/2 ; Get (ScreenWidth)  - 1100 ) ]</li>
<li>End If</li>
<li>Go to Layout [ &lt;unknown&gt; ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_lockBrainstateID; $$logBrainstate ]</li>
<li>Perform Find [  ]</li>
<li>Select Window [ Name: "Tag"; Current file ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Layout&gt;</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33148ScriptAnchor_"></a><td class="script_navbar"><a href="#33147ScriptAnchor_"><span>Previous Script: [gotoTagMenus]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33150ScriptAnchor_"><span>Next Script: [zoomMainIN]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">zoomLogIN_DELETE!!!!!!</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Select Window [ Name: "Tag"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>New Window [ Name: "Tag"; Height: Get (ScreenHeight); Width: 441; Top: 0; Left: Get (ScreenWidth) - 441 ]</li>
<li>Go to Layout [ &lt;unknown&gt; ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_lockBrainstateID; $$logBrainstate ]</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>If [ Get ( WindowZoomLevel ) = 150 ]</li>
<li>Set Zoom Level
[ 200% ]</li>
<li>Move/Resize Window [ Current Window; Width: 550; Left: If (Get (ScreenWidth) / 2 + 550 &le; Get (ScreenWidth) ; Get (ScreenWidth)/2 ; Get (ScreenWidth)  - 550 ) ]</li>
<li>Else If [ Get ( WindowZoomLevel ) = 200 ]</li>
<li>Move/Resize Window [ Current Window; Width: 830; Left: If (Get (ScreenWidth) / 2 + 830 &le; Get (ScreenWidth) ; Get (ScreenWidth)/2 ; Get (ScreenWidth)  - 830 ) ]</li>
<li>Set Zoom Level
[ 300% ]</li>
<li>Else If [ Get ( WindowZoomLevel ) = 300 ]</li>
<li>Move/Resize Window [ Current Window; Width: 1100; Left: If (Get (ScreenWidth) / 2 + 1100 &le; Get (ScreenWidth) ; Get (ScreenWidth)/2 ; Get (ScreenWidth)  - 1100 ) ]</li>
<li>Set Zoom Level
[ 400% ]</li>
<li>End If</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>New Window [ Name: "Specific Action"; Height: Get (ScreenHeight); Width: 441; Top: 0; Left: 0 ]</li>
<li>Go to Layout [ &ldquo;Issues&rdquo; (issue) ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyBrainstate; $$logbrainstate ]</li>
<li>Set Field [ issue::lock; "issue" ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issueStatus::order; ascending
issueStatus::text; ascending
issueCategory::order; ascending
issueCategory::text; ascending
issue::order; based on value list: &ldquo;__-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $$issueRecordID; Value:Get ( RecordID ) ]</li>
<li>Set Variable [ $$issue; Value:issue::_LockList ]</li>
<li>Set Variable [ $$issueLogs; Value:issue::_keyLogs ]</li>
<li>Refresh Window</li>
<li>End If</li>
<li>If [ Get ( WindowZoomLevel ) = 150 ]</li>
<li>Set Zoom Level
[ 200% ]</li>
<li>Move/Resize Window [ Current Window; Width: Get (ScreenWidth) / 2; Left: 0 ]</li>
<li>Else If [ Get ( WindowZoomLevel ) = 200 ]</li>
<li>Move/Resize Window [ Current Window; Width: Get (ScreenWidth) / 2; Left: 0 ]</li>
<li>Set Zoom Level
[ 300% ]</li>
<li>Else If [ Get ( WindowZoomLevel ) = 300 ]</li>
<li>Move/Resize Window [ Current Window; Width: Get (ScreenWidth) / 2; Left: 0 ]</li>
<li>Set Zoom Level
[ 400% ]</li>
<li>End If</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
<li>If [ Get ( WindowZoomLevel ) = 150 ]</li>
<li>Set Zoom Level
[ 200% ]</li>
<li>Move/Resize Window [ Current Window; Width: Get (ScreenWidth) / 2; Left: Get (ScreenWidth) / 2 ]</li>
<li>Else If [ Get ( WindowZoomLevel ) = 200 ]</li>
<li>Move/Resize Window [ Current Window; Width: Get (ScreenWidth) / 2; Left: Get (ScreenWidth) / 2 ]</li>
<li>Set Zoom Level
[ 300% ]</li>
<li>Else If [ Get ( WindowZoomLevel ) = 300 ]</li>
<li>Move/Resize Window [ Current Window; Width: Get (ScreenWidth) / 2; Left: Get (ScreenWidth) / 2 ]</li>
<li>Set Zoom Level
[ 400% ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>issue</em>::_keyBrainstate</li>
<li>
<em>issue</em>::lock</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>issueStatus</em>::order</li>
<li>
<em>issueStatus</em>::text</li>
<li>
<em>issueCategory</em>::order</li>
<li>
<em>issueCategory</em>::text</li>
<li>
<em>issue</em>::order</li>
<li>
<em>issue</em>::text</li>
<li>
<em>issue</em>::_LockList</li>
<li>
<em>issue</em>::_keyLogs</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Layout&gt;</li>
<li>Issues</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33150ScriptAnchor_"></a><td class="script_navbar"><a href="#33148ScriptAnchor_"><span>Previous Script: [zoomLogIN_DELETE!!!!!!]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33149ScriptAnchor_"><span>Next Script: [zoomLogOUT_DELETE!!!!!!]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">zoomMainIN</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ Get ( WindowZoomLevel )  &le; 150 ]</li>
<li>Set Zoom Level
[ 200% ]</li>
<li>Else If [ Get ( WindowZoomLevel ) = 200 ]</li>
<li>Set Zoom Level
[ 300% ]</li>
<li>Else If [ Get ( WindowZoomLevel ) = 300 ]</li>
<li>Set Zoom Level
[ 400% ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33149ScriptAnchor_"></a><td class="script_navbar"><a href="#33150ScriptAnchor_"><span>Previous Script: [zoomMainIN]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33151ScriptAnchor_"><span>Next Script: [zoomMainOUT]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">zoomLogOUT_DELETE!!!!!!</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Select Window [ Name: "Tag"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>New Window [ Name: "Tag"; Height: Get (ScreenHeight); Width: 441; Top: 0; Left: Get (ScreenWidth) - 441 ]</li>
<li>Go to Layout [ &lt;unknown&gt; ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_lockBrainstateID; $$logBrainstate ]</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>If [ Get ( WindowZoomLevel ) = 400 ]</li>
<li>Move/Resize Window [ Current Window; Width: 830; Left: If (Get (ScreenWidth) / 2 + 830 &le; Get (ScreenWidth) ; Get (ScreenWidth)/2 ; Get (ScreenWidth)  - 830 ) ]</li>
<li>Set Zoom Level
[ 300% ]</li>
<li>Else If [ Get ( WindowZoomLevel ) = 300 ]</li>
<li>Set Zoom Level
[ 200% ]</li>
<li>Move/Resize Window [ Current Window; Width: 550; Left: If (Get (ScreenWidth) / 2 + 550 &le; Get (ScreenWidth) ; Get (ScreenWidth)/2 ; Get (ScreenWidth)  - 550 ) ]</li>
<li>Else If [ Get ( WindowZoomLevel ) = 200 ]</li>
<li>Move/Resize Window [ Current Window; Width: 441; Left: If (Get (ScreenWidth)  &ge; 441 + 608 + 441; 441 + 608  ; Get (ScreenWidth)  - 441 ) ]</li>
<li>Set Zoom Level
[ 150% ]</li>
<li>End If</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>If [ Get (LastError)  = 112 ]</li>
<li>New Window [ Name: "Specific Action"; Height: Get (ScreenHeight); Width: 441; Top: 0; Left: 0 ]</li>
<li>Go to Layout [ &ldquo;Issues&rdquo; (issue) ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyBrainstate; $$logbrainstate ]</li>
<li>Set Field [ issue::lock; "issue" ]</li>
<li>Perform Find [  ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issueStatus::order; ascending
issueStatus::text; ascending
issueCategory::order; ascending
issueCategory::text; ascending
issue::order; based on value list: &ldquo;__-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $$issueRecordID; Value:Get ( RecordID ) ]</li>
<li>Set Variable [ $$issue; Value:issue::_LockList ]</li>
<li>Set Variable [ $$issueLogs; Value:issue::_keyLogs ]</li>
<li>Refresh Window</li>
<li>End If</li>
<li>If [ Get ( WindowZoomLevel ) = 400 ]</li>
<li>Move/Resize Window [ Current Window; Width: Get (ScreenWidth) / 2; Left: 0 ]</li>
<li>Set Zoom Level
[ 300% ]</li>
<li>Else If [ Get ( WindowZoomLevel ) = 300 ]</li>
<li>Set Zoom Level
[ 200% ]</li>
<li>Move/Resize Window [ Current Window; Width: Get (ScreenWidth) / 2; Left: 0 ]</li>
<li>Else If [ Get ( WindowZoomLevel ) = 200 ]</li>
<li>Move/Resize Window [ Current Window; Width: 441; Left: 0 ]</li>
<li>Set Zoom Level
[ 150% ]</li>
<li>End If</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
<li>If [ Get ( WindowZoomLevel ) = 400 ]</li>
<li>Move/Resize Window [ Current Window; Width: Get (ScreenWidth) / 2; Left: Get (ScreenWidth) / 2 ]</li>
<li>Set Zoom Level
[ 300% ]</li>
<li>Else If [ Get ( WindowZoomLevel ) = 300 ]</li>
<li>Set Zoom Level
[ 200% ]</li>
<li>Move/Resize Window [ Current Window; Width: Get (ScreenWidth) / 2; Left: Get (ScreenWidth) / 2 ]</li>
<li>Else If [ Get ( WindowZoomLevel ) = 200 ]</li>
<li>Move/Resize Window [ Current Window; Width: 608; Left: 441 ]</li>
<li>Set Zoom Level
[ 150% ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>issue</em>::_keyBrainstate</li>
<li>
<em>issue</em>::lock</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>issueStatus</em>::order</li>
<li>
<em>issueStatus</em>::text</li>
<li>
<em>issueCategory</em>::order</li>
<li>
<em>issueCategory</em>::text</li>
<li>
<em>issue</em>::order</li>
<li>
<em>issue</em>::text</li>
<li>
<em>issue</em>::_LockList</li>
<li>
<em>issue</em>::_keyLogs</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>&lt;Missing Layout&gt;</li>
<li>Issues</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33151ScriptAnchor_"></a><td class="script_navbar"><a href="#33149ScriptAnchor_"><span>Previous Script: [zoomLogOUT_DELETE!!!!!!]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33163ScriptAnchor_"><span>Next Script: [goToIssueFromAssignedTimeSegment]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">zoomMainOUT</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ Get ( WindowZoomLevel ) = 400 ]</li>
<li>Set Zoom Level
[ 300% ]</li>
<li>Else If [ Get ( WindowZoomLevel ) = 300 ]</li>
<li>Set Zoom Level
[ 200% ]</li>
<li>Else If [ Get ( WindowZoomLevel ) = 200 ]</li>
<li>Set Zoom Level
[ 150% ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33163ScriptAnchor_"></a><td class="script_navbar"><a href="#33151ScriptAnchor_"><span>Previous Script: [zoomMainOUT]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33174ScriptAnchor_"><span>Next Script: [stopSortWhileReviewChangingStatusAndGroup]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">goToIssueFromAssignedTimeSegment</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $timeSegment; Value:Get ( ActiveRepetitionNumber ) &amp; logs::_lockDay ]</li>
<li>Go to Field [  ]</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ FilterValues (issue::timeSegmentKeyList  ; $timeSegment  &amp; "&para;")  =  $timeSegment &amp; "&para;" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>logs</em>::_lockDay</li>
<li>
<em>issue</em>::timeSegmentKeyList</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33174ScriptAnchor_"></a><td class="script_navbar"><a href="#33163ScriptAnchor_"><span>Previous Script: [goToIssueFromAssignedTimeSegment]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33109ScriptAnchor_"><span>Next Script: [newActPart1]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">stopSortWhileReviewChangingStatusAndGroup</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ $$stopSort = "" ]</li>
<li>Set Variable [ $$stopSort; Value:1 ]</li>
<li>Else</li>
<li>Set Variable [ $$stopSort ]</li>
<li>End If</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33109ScriptAnchor_"></a><td class="script_navbar"><a href="#33174ScriptAnchor_"><span>Previous Script: [stopSortWhileReviewChangingStatusAndGroup]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33172ScriptAnchor_"><span>Next Script: [newActPart2]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newActPart1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>#</li>
<li>New Record/Request</li>
<li>Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Field [ issue::date; Get ( CurrentTimeStamp ) ]</li>
<li>Set Field [ issue::lock; "issue" ]</li>
<li>Set Field [ issue::_keyStatus; 7152011154818554 ]</li>
<li>Set Variable [ $$issueRecordID; Value:Get ( RecordID ) ]</li>
<li>Set Field [ brainstate::pulldownBrainstate; issue::_keyBrainstate ]</li>
<li>#</li>
<li>#Set variable to remove background color and allow</li>
<li>#message explaining assigning group to show.</li>
<li>Set Variable [ $newAct; Value:issue::_LockList ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>Set Variable [ $recordNumber; Value:Get ( RecordNumber ) ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Go to Record/Request/Page [ $recordNumber ]
[ No dialog ]</li>
<li>#</li>
<li>#Set variable to remove background color and allow</li>
<li>#message explaining assigning group to show.</li>
<li>Set Variable [ $newAct; Value:issue::_LockList ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>Select Window [ Name: "Tag"; Current file ]</li>
<li>Go to Layout [ &ldquo;IssuesAndObservationsTag&rdquo; (category) ]</li>
<li>Set Variable [ $$pick; Value:1 ]</li>
<li>Refresh Window</li>
<li>Pause/Resume Script [ Indefinitely ]</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>issue</em>::_keyBrainstate</li>
<li>
<em>issue</em>::date</li>
<li>
<em>issue</em>::lock</li>
<li>
<em>issue</em>::_keyStatus</li>
<li>
<em>brainstate</em>::pulldownBrainstate</li>
<li>
<em>issue</em>::_LockList</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>IssuesAndObservationsTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33172ScriptAnchor_"></a><td class="script_navbar"><a href="#33109ScriptAnchor_"><span>Previous Script: [newActPart1]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33194ScriptAnchor_"><span>Next Script: [newActPart2cancel]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newActPart2</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33112ScriptAnchor_">TsubtotalTimeByGroup</a></li>
<li><a href="#33239ScriptAnchor_">addTagToSpecificActionRecord</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#Make key to fit this group's lock.</li>
<li>Set Variable [ $$group; Value:category::_LockList ]</li>
<li>Set Variable [ $$pick ]</li>
<li>Go to Field [  ]</li>
<li>//  Move/Resize Window [ Current Window; Height: Get (ScreenHeight); Top: 0; Left: Get (ScreenWidth) - 344 ]</li>
<li>//  Go to Layout [ &ldquo;IssuesAndObservationsTag&rdquo; (category) ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Give key to current specific action.</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>Set Field [ issue::_keyCategory; $$group ]</li>
<li>Set Field [ issue::oldCategorykey; $$group ]</li>
<li>#</li>
<li>#These two keys are essential for the subtotal to work.</li>
<li>Set Variable [ $$status; Value:issue::_keyStatus ]</li>
<li>Set Field [ issue::sortTime; issueCategory::text ]</li>
<li>#</li>
<li>//  #If user selected the same category that was already</li>
<li>//  #selected then stop this script.</li>
<li>//  If [ issue::_keyCategory = issue::oldCategorykey and $$stopSubtotal = "" ]</li>
<li>//  Go to Field [  ]</li>
<li>//  Exit Script [  ]</li>
<li>//  End If</li>
<li>#</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Refresh Window</li>
<li>Perform Script [ &ldquo;loadIssuerecordID&rdquo; ]</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>Set Variable [ $recordNumber; Value:Get ( RecordNumber ) ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>Go to Record/Request/Page
[ Next ]</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Go to Record/Request/Page [ $recordNumber ]
[ No dialog ]</li>
<li>Go to Field [ issue::text ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>category</em>::_LockList</li>
<li>
<em>issue</em>::_keyCategory</li>
<li>
<em>issue</em>::oldCategorykey</li>
<li>
<em>issue</em>::_keyStatus</li>
<li>
<em>issueCategory</em>::text</li>
<li>
<em>issue</em>::sortTime</li>
<li>
<em>issue</em>::text</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33115ScriptAnchor_">loadIssuerecordID</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>IssuesAndObservationsTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33194ScriptAnchor_"></a><td class="script_navbar"><a href="#33172ScriptAnchor_"><span>Previous Script: [newActPart2]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33121ScriptAnchor_"><span>Next Script: [newTag]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newActPart2cancel</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#Stop script if user is NOT in the process of picking a specific action group.</li>
<li>If [ $$pick  &ne;  1 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#If user cancels and decides not create a new action...</li>
<li>Set Variable [ $$pick ]</li>
<li>Go to Field [  ]</li>
<li>//  Move/Resize Window [ Current Window; Height: Get (ScreenHeight); Top: 0; Left: Get (ScreenWidth) - 344 ]</li>
<li>//  Go to Layout [ &ldquo;IssuesAndObservationsTag&rdquo; (category) ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Give key to current specific action.</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>#</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Refresh Window</li>
<li>Perform Script [ &ldquo;loadIssuerecordID&rdquo; ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33115ScriptAnchor_">loadIssuerecordID</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>IssuesAndObservationsTag</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33121ScriptAnchor_"></a><td class="script_navbar"><a href="#33194ScriptAnchor_"><span>Previous Script: [newActPart2cancel]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33120ScriptAnchor_"><span>Next Script: [newItem]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newTag</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#When a new record is created the text field is blank.  </li>
<li>#If the user clicks the new button before giving </li>
<li>#their current new record a name these steps will</li>
<li>#name it for them.  </li>
<li>If [ category::text = "" and Get ( LayoutTableName ) &ne; "Status" ]</li>
<li>Set Field [ category::text; "tag" &amp; category::_LockList ]</li>
<li>Else If [ status::text = "" and Get ( LayoutTableName ) = "Status" ]</li>
<li>Set Field [ status::text; "status" &amp; status::_LockList ]</li>
<li>End If</li>
<li>#</li>
<li>#Create a new tag record and assign it the group</li>
<li>#the user is in right now.</li>
<li>Set Variable [ $group; Value:category::_keyCategory ]</li>
<li>#</li>
<li>Set Variable [ $$TagNameRequired; Value:1 ]</li>
<li>#</li>
<li>New Record/Request</li>
<li>If [ Get ( LayoutTableName ) &ne; "Status" ]</li>
<li>Set Field [ category::lock; "location" ]</li>
<li>Set Field [ category::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Field [ category::_keyCategory; $group ]</li>
<li>Else If [ Get ( LayoutTableName ) = "Status" ]</li>
<li>Set Field [ status::lock; "status" ]</li>
<li>End If</li>
<li>#</li>
<li>#Sort only if you want to bring new tag to the top</li>
<li>#of the group list of tags.  I found it to be less</li>
<li>#disruptive if the tags don't sort.</li>
<li>//  Sort Records [ Specified Sort Order: group::text; ascending
category::text; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Make it easy for user to type new name for tag.</li>
<li>If [ category::text = "" and Get ( LayoutTableName ) &ne; "Status" ]</li>
<li>Go to Field [ category::text ]</li>
<li>Else</li>
<li>Go to Field [ status::text ]</li>
<li>End If</li>
<li>#</li>
<li>#Turn off variable set at start of script.  </li>
<li>Set Variable [ $$TagNameRequired ]</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>category</em>::text</li>
<li>
<em>category</em>::_LockList</li>
<li>
<em>status</em>::text</li>
<li>
<em>status</em>::_LockList</li>
<li>
<em>category</em>::_keyCategory</li>
<li>
<em>category</em>::lock</li>
<li>
<em>category</em>::_keyBrainstate</li>
<li>
<em>status</em>::lock</li>
<li>
<em>group</em>::text</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33120ScriptAnchor_"></a><td class="script_navbar"><a href="#33121ScriptAnchor_"><span>Previous Script: [newTag]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33144ScriptAnchor_"><span>Next Script: [uniqueTagNameRequired]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newItem</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Layout [ &ldquo;IssuesAndObservations Copy&rdquo; (issue) ]</li>
<li>New Record/Request</li>
<li>Set Field [ issue::lock; "status" ]</li>
<li>Go to Layout [ original layout ]</li>
<li>Go to Field [ status::text ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>issue</em>::lock</li>
<li>
<em>status</em>::text</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>IssuesAndObservations Copy</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33144ScriptAnchor_"></a><td class="script_navbar"><a href="#33120ScriptAnchor_"><span>Previous Script: [newItem]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33145ScriptAnchor_"><span>Next Script: [uniqueStatusNameRequired]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">uniqueTagNameRequired</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Capture text, remove spaces, and then recapture </li>
<li>#the text to prevent user from creating a group</li>
<li>#with spaces that would put it above the 10 space</li>
<li>#group assigned to new issues to keep new issues</li>
<li>#sorted to the top of the list of issues in the isssues</li>
<li>#log window.</li>
<li>Set Variable [ $name; Value:category::text ]</li>
<li>Set Field [ category::text; Trim ( $name ) ]</li>
<li>Set Variable [ $name; Value:category::text ]</li>
<li>Set Variable [ $recordNumber; Value:Get ( RecordNumber ) ]</li>
<li>#</li>
<li>#Make a key to later in script loop</li>
<li>#to the correct portal row.</li>
<li>Set Variable [ $key; Value:category::_LockList ]</li>
<li>#</li>
<li>#If the user left the field blank...</li>
<li>If [ category::text = "" ]</li>
<li>Show Custom Dialog [ Message: "All tag names must be unique, and must not be blank."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#</li>
<li>#Go to the blank field and fill it in with a unique</li>
<li>#name.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $key = category::_LockList ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Field [ category::text; $key &amp; category::_LockList ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Determine if user used a spelling already in use.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>Loop</li>
<li>#If the user used a spelling alread in use ...</li>
<li>If [ $name =category::text and category::_LockList &ne; $key ]</li>
<li>Show Custom Dialog [ Message: "Each category in this list must have a unique name."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#</li>
<li>#Make name unique.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $key = category::_LockList ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Field [ category::text; category::text &amp; " " &amp; $key ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>Scroll Window
[ Home ]</li>
<li>#Go to current record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>#</li>
<li>Exit Loop If [ $key = category::_LockList ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>category</em>::text</li>
<li>
<em>category</em>::_LockList</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33145ScriptAnchor_"></a><td class="script_navbar"><a href="#33144ScriptAnchor_"><span>Previous Script: [uniqueTagNameRequired]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33226ScriptAnchor_"><span>Next Script: [uniqueTagGroupNameRequired]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">uniqueStatusNameRequired</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Capture text, remove spaces, and then recapture </li>
<li>#the text to prevent user from creating a group</li>
<li>#with spaces that would put it above the 10 space</li>
<li>#status assigned to new issues to keep new issues</li>
<li>#sorted to the top of the list of issues in the isssues</li>
<li>#log window.</li>
<li>Set Variable [ $name; Value:status::text ]</li>
<li>Set Field [ status::text; Trim ( $name ) ]</li>
<li>Set Variable [ $name; Value:status::text ]</li>
<li>#</li>
<li>#Make a key to later in script loop</li>
<li>#to the correct portal row.</li>
<li>Set Variable [ $key; Value:status::_LockList ]</li>
<li>#</li>
<li>#If the user left the field blank...</li>
<li>If [ status::text = "" ]</li>
<li>Show Custom Dialog [ Message: "All status names must be unique.  Blanks are not allowed."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#</li>
<li>#Go to the blank field and fill it in with a unique</li>
<li>#name.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $key = status::_LockList ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Field [ status::text; "status" &amp; status::_LockList ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Determine if user used a spelling already in use.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>Loop</li>
<li>#If the user used a spelling alread in use ...</li>
<li>If [ $name =status::text and status::_LockList &ne; $key ]</li>
<li>Show Custom Dialog [ Message: "Each status in this list must have a unique name."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#</li>
<li>#Make name unique.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ $key = status::_LockList ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Field [ status::text; $name &amp; status::_LockList ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#</li>
<li>Scroll Window
[ Home ]</li>
<li>#Go to current record.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>#</li>
<li>Exit Loop If [ $key = category::_LockList ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>status</em>::text</li>
<li>
<em>status</em>::_LockList</li>
<li>
<em>category</em>::_LockList</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33226ScriptAnchor_"></a><td class="script_navbar"><a href="#33145ScriptAnchor_"><span>Previous Script: [uniqueStatusNameRequired]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33234ScriptAnchor_"><span>Next Script: [TagNameRequired]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">uniqueTagGroupNameRequired</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>//  If [ category::_LockList = "" ]</li>
<li>//  Go to Field [  ]</li>
<li>//  Exit Script [  ]</li>
<li>//  End If</li>
<li>#</li>
<li>Set Variable [ $brainstate; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $name; Value:group::text ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>New Window [  ]</li>
<li>Go to Layout [ &ldquo;IssuesAndObservationsTagUniqueNameCheck&rdquo; (group) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ group::_keyBrainstate; $brainstate ]</li>
<li>Set Field [ group::lock; "group" ]</li>
<li>Set Field [ group::text; "==" &amp; $name ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>Set Variable [ $found; Value:Get (FoundCount) ]</li>
<li>#</li>
<li>If [ $found &ne; 1 ]</li>
<li>Close Window [ Current Window ]</li>
<li>Set Field [ group::text; $name &amp; group::_LockList ]</li>
<li>Show Custom Dialog [ Message: "All tag names must be unique, and must not be blank."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Close Window [ Current Window ]</li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Delete " &amp; $name &amp; "?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>#</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Go to Layout [ &ldquo;menuGroups&rdquo; (issueCategory) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issueCategory::_LockList; $delete ]</li>
<li>Perform Find [  ]</li>
<li>Delete Record/Request
[ No dialog ]</li>
<li>Go to Layout [ original layout ]</li>
<li>End If</li>
<li>#</li>
<li>Set Variable [ $delete ]</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>category</em>::_LockList</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>group</em>::text</li>
<li>
<em>group</em>::_keyBrainstate</li>
<li>
<em>group</em>::lock</li>
<li>
<em>group</em>::_LockList</li>
<li>
<em>issueCategory</em>::_LockList</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>IssuesAndObservationsTagUniqueNameCheck</li>
<li>menuGroups</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33234ScriptAnchor_"></a><td class="script_navbar"><a href="#33226ScriptAnchor_"><span>Previous Script: [uniqueTagGroupNameRequired]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33114ScriptAnchor_"><span>Next Script: [issueCancelNewIssueScript]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">TagNameRequired</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>If [ category::text = "" and $$TagNameRequired = "" ]</li>
<li>Set Field [ category::text; "tag" &amp; category::_LockList ]</li>
<li>End If</li>
<li>#</li>
<li>If [ status::text = "" and $$TagNameRequired = "" ]</li>
<li>Set Field [ status::text; "status" &amp; status::_LockList ]</li>
<li>End If</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>category</em>::text</li>
<li>
<em>category</em>::_LockList</li>
<li>
<em>status</em>::text</li>
<li>
<em>status</em>::_LockList</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33114ScriptAnchor_"></a><td class="script_navbar"><a href="#33234ScriptAnchor_"><span>Previous Script: [TagNameRequired]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33107ScriptAnchor_"><span>Next Script: [statusChangeDate]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">issueCancelNewIssueScript</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>//  Halt Script</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33107ScriptAnchor_"></a><td class="script_navbar"><a href="#33114ScriptAnchor_"><span>Previous Script: [issueCancelNewIssueScript]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33112ScriptAnchor_"><span>Next Script: [TsubtotalTimeByGroup]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">statusChangeDate</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Go to Field [ issue::dateModified ]</li>
<li>Set Field [ issue::dateModified; Get ( CurrentTimeStamp ) ]</li>
<li>Go to Field [  ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>issue</em>::dateModified</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33112ScriptAnchor_"></a><td class="script_navbar"><a href="#33107ScriptAnchor_"><span>Previous Script: [statusChangeDate]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33239ScriptAnchor_"><span>Next Script: [addTagToSpecificActionRecord]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">TsubtotalTimeByGroup</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33167ScriptAnchor_">openSpecificAction</a></li>
<li><a href="#33171ScriptAnchor_">gotoLogs</a></li>
<li><a href="#33168ScriptAnchor_">changeLogs Copy</a></li>
<li><a href="#33160ScriptAnchor_">issueSortStatus</a></li>
<li><a href="#33131ScriptAnchor_">viewLogIssues</a></li>
<li><a href="#33173ScriptAnchor_">TsubtotalTimeByGroupForStatus</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Decided for now that this information is too much</li>
<li>#clutter, especially now the user can see total time</li>
<li>#per category tag in the tag window.  </li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#</li>
<li>If [ $$pick = 1 ]</li>
<li>Perform Script [ &ldquo;newActPart2&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>If [ Get (WindowName) = "Tag" ]</li>
<li>#Make key to fit this group's lock.</li>
<li>Set Variable [ $$group; Value:category::_LockList ]</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Give key to current specific action.</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>#</li>
<li>If [ Get (FoundCount) = 0 ]</li>
<li>Select Window [ Name: "Tag"; Current file ]</li>
<li>Set Variable [ $$group ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Field [ issue::_keyCategory; $$group ]</li>
<li>#</li>
<li>#This field is for sorting the records by category</li>
<li>#to get the subtotal of each categories time.</li>
<li>#  (The subtotal calculation depends on this "break"</li>
<li>#  field to know which set of records should be</li>
<li>#  treated as a subset of the total records shown.)</li>
<li>#This sort must be done on a field in the table</li>
<li>#where the time is located: list table.</li>
<li>#The system is using the text field from the list</li>
<li>#table for the text of each issue.  Another occurance</li>
<li>#of the list table is used to supply the categories</li>
<li>#which are located in a different list table record.</li>
<li>#This allows the system to use the list table for</li>
<li>#Text and for tags: category and issue tags.  </li>
<li>#However, in order to sort on the text of the </li>
<li>#category a copy of the text must be made </li>
<li>#part of each list record shown as an issue   </li>
<li>#  (instead of being shown as a category or status)</li>
<li>#This next field holds the copy of the cateogry</li>
<li>#tag text for each list record holding issue data.</li>
<li>Set Field [ issue::sortTime; issueCategory::text ]</li>
<li>If [ $$stopSort &ne; "" ]</li>
<li>#</li>
<li>#Set make the old and current category keys</li>
<li>#identical, so system will will be able to update</li>
<li>#the time in this issue records current category</li>
<li>#if the user decided to reassign it to a different</li>
<li>#category.</li>
<li>Set Field [ issue::oldCategorykey; issue::_keyCategory ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#If user selected the same category that was already</li>
<li>#selected then stop this script.</li>
<li>If [ issue::_keyCategory = issue::oldCategorykey and $$stopSubtotal = "" ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Variable [ $$stopSubtotal ]</li>
<li>#</li>
<li>#Set the old category key variable for use later</li>
<li>#in this script finding all the issue records that</li>
<li>#still belong to this record's former category.</li>
<li>Set Variable [ $OLDcategoryKey; Value:issue::oldCategorykey ]</li>
<li>#</li>
<li>#Prevent windows from flashing and script from slowing</li>
<li>#by stopping strobe effect caused by going back and </li>
<li>#forth from each window upon loading each records </li>
<li>#information throughout the script, rather than just </li>
<li>#at the end.</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>#</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#This field is for sorting the records by category</li>
<li>#to get the subtotal of each categories time.</li>
<li>#  (The subtotal calculation depends on this "break"</li>
<li>#  field to know which set of records should be</li>
<li>#  treated as a subset of the total records shown.)</li>
<li>#This sort must be done on a field in the table</li>
<li>#where the time is located: list table.</li>
<li>#The system is using the text field from the list</li>
<li>#table for the text of each issue.  Another occurance</li>
<li>#of the list table is used to supply the categories</li>
<li>#which are located in a different list table record.</li>
<li>#This allows the system to use the list table for</li>
<li>#Text and for tags: category and issue tags.  </li>
<li>#However, in order to sort on the text of the </li>
<li>#category a copy of the text must be made </li>
<li>#part of each list record shown as an issue   </li>
<li>#  (instead of being shown as a category or status)</li>
<li>#This next field holds the copy of the cateogry</li>
<li>#tag text for each list record holding issue data.</li>
<li>Set Field [ issue::sortTime; issueCategory::text ]</li>
<li>#</li>
<li>#If the focus is in the text field, remove it.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Open a new window so these next steps can</li>
<li>#be done without disturbing the current view</li>
<li>#and scroll position of the issue window.</li>
<li>New Window [ Name: "temp" ]</li>
<li>#</li>
<li>#This duplicate layout has no script triggers or conditional</li>
<li>#formatting and so speeds up the script steps.</li>
<li>Go to Layout [ &ldquo;IssuesLayoutForScripts&rdquo; (issue) ]</li>
<li>#</li>
<li>#Add up total time for category the issue is now in.</li>
<li>#</li>
<li>#First find all the issues in this category.</li>
<li>Set Variable [ $categoryKey; Value:issue::_keyCategory ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyCategory; $categoryKey ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Sort them to trigger the calcuation of their </li>
<li>#total time.</li>
<li>Sort Records [ Specified Sort Order: issue::sortTime; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#Go to each record including the newly recatorgized</li>
<li># and update thier total cateogry time.</li>
<li>#</li>
<li>Loop</li>
<li>Set Field [ issue::timeTotalSumByCat; issue::timeTotalSummaryByCategory ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Add up total time for category it was in.</li>
<li>#</li>
<li>#First find all the issues still part of the category</li>
<li>#it was in, if any.</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyCategory; $OLDcategoryKey ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If records remain in this category then continue</li>
<li>#reassigning updated total time to member records.</li>
<li>If [ Get (LastError)  &ne; 401 ]</li>
<li>#</li>
<li>#Sort them to trigger the calcuation of their </li>
<li>#total time.</li>
<li>Sort Records [ Specified Sort Order: issue::sortTime; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Go to each record including the newly recatorgized</li>
<li># and update thier total cateogry time.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ issue::timeTotalSumByCat; issue::timeTotalSummaryByCategory ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Disabled the next chunk after deciding it was </li>
<li>#better to use filemaker's subtotal calc rather</li>
<li>#doing it with this script chunk whose benefit</li>
<li>#was subtotaling items in a category even when</li>
<li>#items where divided by status.  Filemaker's</li>
<li>#subtotal calc subtotals at the status and category</li>
<li>#breaks (essentially all breaks caused by a sort)</li>
<li>#but I decided to show issue the time by status</li>
<li>#and category too, so that is why this script chunk</li>
<li>#is now disabled.  The other reason was that it</li>
<li>#bogged down the system taking a long time to run.</li>
<li>//  #To reset all the category subtotal times, first find</li>
<li>//  #and sort all this issues records.</li>
<li>//  Set Variable [ $brainstateIssues; Value:issue::_keyBrainstate ]</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ issue::_keyBrainstate; $brainstateIssues ]</li>
<li>//  Perform Find [  ]</li>
<li>//  Sort Records [ Specified Sort Order: brainstate::description; ascending
issueStatus::order; ascending
issueStatus::text; ascending
issueCategory::order; ascending
issue::timeTotalSummaryByCategory; ascending
issue::order; based on value list: &ldquo;__-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #AddUp total time showing for this subset of</li>
<li>//  #a cateogory broken up into subsets by different</li>
<li>//  #statuses, like the subset of some category's</li>
<li>//  #record that are pending, or completed, etc.</li>
<li>//  Loop</li>
<li>//  Set Variable [ $category; Value:issue::_keyCategory ]</li>
<li>//  Set Variable [ $status; Value:issue::_keyStatus ]</li>
<li>//  Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>//  Set Variable [ $subsetTotal ]</li>
<li>//  Set Variable [ $oldTotal ]</li>
<li>//  #</li>
<li>//  Loop</li>
<li>//  Set Variable [ $subsetTotal; Value:issue::issueTotalTime + $oldTotal ]</li>
<li>//  Set Variable [ $oldTotal; Value:$subsetTotal ]</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  Exit Loop If [ issue::_keyCategory &ne; $category 

//This next step I thought could happen, but then realized it can nevery happen
//or 
//issue::_keyCategory = $category and issue::_keyStatus &ne; $status ]</li>
<li>//  End Loop</li>
<li>//  #</li>
<li>//  #Return the first record in this subset and give it</li>
<li>//  #the subset total, then give the subtotal to all </li>
<li>//  #records in this subset.</li>
<li>//  Go to Record/Request/Page [ $recordNumber ]
[ No dialog ]</li>
<li>//  #</li>
<li>//  Loop</li>
<li>//  Set Field [ issue::timeTotalSumByCatSortedByStatus; $subsetTotal ]</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  Exit Loop If [ issue::_keyCategory &ne; $category 

//This next step I thought could happen, but then realized it can nevery happen
//or 
//issue::_keyCategory = $category and issue::_keyStatus &ne; $status ]</li>
<li>//  End Loop</li>
<li>//  #</li>
<li>//  Exit Loop If [ Get (LastError)  = 101 ]</li>
<li>//  End Loop</li>
<li>#</li>
<li>#</li>
<li>Close Window [ Name: "temp"; Current file ]</li>
<li>#</li>
<li>#</li>
<li>#Set make the old and current category keys</li>
<li>#identical, so system will will be able to update</li>
<li>#the time in this issue records current category</li>
<li>#if the user decided to reassign it to a different</li>
<li>#category.</li>
<li>Set Field [ issue::oldCategorykey; issue::_keyCategory ]</li>
<li>#</li>
<li>#In order to show the newly updapted time the</li>
<li>#system must resort the records.  This takes</li>
<li>Set Variable [ $currentRecord; Value:issue::_LockList ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issueStatus::order; ascending
issueStatus::text; ascending
issueCategory::order; ascending
issue::timeTotalSummaryByCategory; ascending
issue::order; based on value list: &ldquo;__-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#In order to show the newly updapted time the</li>
<li>#The previous script step takes the </li>
<li>#the focus to the last record.  To get the</li>
<li>#to the current record, and to show it not as</li>
<li>#as the top record, but if possible show</li>
<li>#all records above it, requires two sorts, and</li>
<li>#two scrolls.  For some reason Filemaker will not</li>
<li>#scroll home (the top record) and then scroll </li>
<li>#down to the current record without a sort being</li>
<li>#between the sort steps.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ issue::_LockList = $currentRecord ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Scroll Window
[ Home ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issueStatus::order; based on value list: &ldquo;__-99&rdquo;
issueStatus::text; ascending
issueCategory::order; ascending
issueCategory::text; ascending
issue::sortTime; ascending
issue::order; based on value list: &ldquo;1-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>Scroll Window
[ To Selection ]</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>#</li>
<li>//  #The halt script is neccessary in case the user</li>
<li>//  #clicks somewhere other than the in the pulldown</li>
<li>//  #menu.  This halt script stops the pause script</li>
<li>//  #that is currently in play.</li>
<li>//  Halt Script</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>category</em>::_LockList</li>
<li>
<em>issue</em>::_keyCategory</li>
<li>
<em>issueCategory</em>::text</li>
<li>
<em>issue</em>::sortTime</li>
<li>
<em>issue</em>::oldCategorykey</li>
<li>
<em>issue</em>::timeTotalSummaryByCategory</li>
<li>
<em>issue</em>::timeTotalSumByCat</li>
<li>
<em>issue</em>::_keyBrainstate</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>issueStatus</em>::order</li>
<li>
<em>issueStatus</em>::text</li>
<li>
<em>issueCategory</em>::order</li>
<li>
<em>issue</em>::order</li>
<li>
<em>issue</em>::text</li>
<li>
<em>issue</em>::_keyStatus</li>
<li>
<em>issue</em>::issueTotalTime</li>
<li>
<em>issue</em>::timeTotalSumByCatSortedByStatus</li>
<li>
<em>issue</em>::_LockList</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33172ScriptAnchor_">newActPart2</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>IssuesLayoutForScripts</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33239ScriptAnchor_"></a><td class="script_navbar"><a href="#33112ScriptAnchor_"><span>Previous Script: [TsubtotalTimeByGroup]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33173ScriptAnchor_"><span>Next Script: [TsubtotalTimeByGroupForStatus]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">addTagToSpecificActionRecord</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#</li>
<li>If [ $$pick = 1 ]</li>
<li>Perform Script [ &ldquo;newActPart2&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Make key to fit this group's lock.</li>
<li>Set Variable [ $$group; Value:category::_LockList ]</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Give key to current specific action.</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>#</li>
<li>#</li>
<li>If [ Get (FoundCount) = 0 ]</li>
<li>Select Window [ Name: "Tag"; Current file ]</li>
<li>Set Variable [ $$group ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Set Variable [ $categoryOLD; Value:issue::oldCategorykey ]</li>
<li>Set Field [ issue::_keyCategory; $$group ]</li>
<li>Commit Records/Requests
[ Skip data entry validation; No dialog ]</li>
<li>#</li>
<li>#</li>
<li>#If user selected the same category that was already</li>
<li>#selected then stop this script.</li>
<li>If [ issue::_keyCategory = issue::oldCategorykey and $$stopSubtotal = "" ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#This field is for sorting the records by category</li>
<li>#to get the subtotal of each categories time.</li>
<li>#  (The subtotal calculation depends on this "break"</li>
<li>#  field to know which set of records should be</li>
<li>#  treated as a subset of the total records shown.)</li>
<li>#This sort must be done on a field in the table</li>
<li>#where the time is located: list table.</li>
<li>#The system is using the text field from the list</li>
<li>#table for the text of each issue.  Another occurance</li>
<li>#of the list table is used to supply the categories</li>
<li>#which are located in a different list table record.</li>
<li>#This allows the system to use the list table for</li>
<li>#Text and for tags: category and issue tags.  </li>
<li>#However, in order to sort on the text of the </li>
<li>#category a copy of the text must be made </li>
<li>#part of each list record shown as an issue   </li>
<li>#  (instead of being shown as a category or status)</li>
<li>#This next field holds the copy of the cateogry</li>
<li>#tag text for each list record holding issue data.</li>
<li>Set Field [ issue::sortTime; issueCategory::text ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Prevent windows from flashing and script from slowing</li>
<li>#by stopping strobe effect caused by going back and </li>
<li>#forth from each window upon loading each records </li>
<li>#information throughout the script, rather than just </li>
<li>#at the end.</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>#</li>
<li>#Open a new window so these next steps can</li>
<li>#be done without disturbing the current view</li>
<li>#and scroll position of the issue window.</li>
<li>//  New Window [ Name: "temp"; Height: 1; Width: 1; Top: -10000; Left: -10000 ]</li>
<li>New Window [ Name: "temp" ]</li>
<li>#</li>
<li>#This duplicate layout has no script triggers or conditional</li>
<li>#formatting and so speeds up the script steps.</li>
<li>Go to Layout [ &ldquo;IssuesLayoutForScripts&rdquo; (issue) ]</li>
<li>#</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>#</li>
<li>#Add up total time for category the issue is now in.</li>
<li>#</li>
<li>//  #First find all the issues in this category.</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>//  Set Field [ issue::lock; "issue" ]</li>
<li>//  Perform Find [  ]</li>
<li>#</li>
<li>#First find all the issues in this category.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Field [ issue::_keyCategory; $$group ]</li>
<li>Set Field [ issue::lock; "issue" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Sort them to trigger the calcuation of their </li>
<li>#total time.</li>
<li>Sort Records [ Specified Sort Order: issue::_keyCategory; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#</li>
<li>Set Field [ issueCategory::issueTotalTime; GetSummary ( issue::timeSummary ; issue::_keyCategory ) ]</li>
<li>#</li>
<li>#</li>
<li>#First find all the issues in this category.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Field [ issue::_keyCategory; $categoryOLD ]</li>
<li>Set Field [ issue::lock; "issue" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#</li>
<li>#Sort them to trigger the calcuation of their </li>
<li>#total time.</li>
<li>Sort Records [ Specified Sort Order: issue::_keyCategory; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>Set Field [ issueCategory::issueTotalTime; GetSummary ( issue::timeSummary ; issue::_keyCategory ) ]</li>
<li>#</li>
<li>#</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Set Variable [ $category; Value:issue::_keyCategory ]</li>
<li>//  Set Field [ issueCategory::issueTotalTime; GetSummary ( issue::timeSummary ; issue::_keyCategory ) ]</li>
<li>//  Loop</li>
<li>//  If [ $category  &ne;  issue::_keyCategory ]</li>
<li>//  Set Field [ issueCategory::issueTotalTime; GetSummary ( issue::timeSummary ; issue::_keyCategory ) ]</li>
<li>//  Set Variable [ $category; Value:issue::_keyCategory ]</li>
<li>//  End If</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  End Loop</li>
<li>#</li>
<li>#</li>
<li>Close Window [ Name: "temp"; Current file ]</li>
<li>#</li>
<li>//  Set Variable [ $currentRecord; Value:issue::_LockList ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issueStatus::order; ascending
issueStatus::text; ascending
issueCategory::order; ascending
issue::timeTotalSummaryByCategory; ascending
issue::order; based on value list: &ldquo;__-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#In order to show the newly updapted time the</li>
<li>#The previous script step takes the </li>
<li>#the focus to the last record.  To get the</li>
<li>#to the current record, and to show it not as</li>
<li>#as the top record, but if possible show</li>
<li>#all records above it, requires two sorts, and</li>
<li>#two scrolls.  For some reason Filemaker will not</li>
<li>#scroll home (the top record) and then scroll </li>
<li>#down to the current record without a sort being</li>
<li>#between the sort steps.</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Loop</li>
<li>//  Exit Loop If [ issue::_LockList = $currentRecord ]</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  End Loop</li>
<li>Scroll Window
[ Home ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issueStatus::order; based on value list: &ldquo;__-99&rdquo;
issueStatus::text; ascending
issueCategory::order; ascending
issueCategory::text; ascending
issue::sortTime; ascending
issue::order; based on value list: &ldquo;1-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>Scroll Window
[ To Selection ]</li>
<li>#</li>
<li>#Set make the old and current category keys</li>
<li>#identical, so system will will be able to update</li>
<li>#the time in this issue records current category</li>
<li>#if the user decided to reassign it to a different</li>
<li>#category.</li>
<li>Set Field [ issue::oldCategorykey; $$group ]</li>
<li>#</li>
<li>Select Window [ Name: "Tag"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>category</em>::_LockList</li>
<li>
<em>issue</em>::oldCategorykey</li>
<li>
<em>issue</em>::_keyCategory</li>
<li>
<em>issueCategory</em>::text</li>
<li>
<em>issue</em>::sortTime</li>
<li>
<em>issue</em>::_keyBrainstate</li>
<li>
<em>issue</em>::lock</li>
<li>
<em>issue</em>::timeSummary</li>
<li>
<em>issueCategory</em>::issueTotalTime</li>
<li>
<em>issue</em>::_LockList</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>issueStatus</em>::order</li>
<li>
<em>issueStatus</em>::text</li>
<li>
<em>issueCategory</em>::order</li>
<li>
<em>issue</em>::timeTotalSummaryByCategory</li>
<li>
<em>issue</em>::order</li>
<li>
<em>issue</em>::text</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33172ScriptAnchor_">newActPart2</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>IssuesLayoutForScripts</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33173ScriptAnchor_"></a><td class="script_navbar"><a href="#33239ScriptAnchor_"><span>Previous Script: [addTagToSpecificActionRecord]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33166ScriptAnchor_"><span>Next Script: [TsubtotalTimeByOrder]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">TsubtotalTimeByGroupForStatus</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#Stop script if user is process of picking a specific action group.</li>
<li>If [ $$pick = 1 ]</li>
<li>Show Custom Dialog [ Message: "Pick a specific-action group.  After you do this you can assign other tags.  "; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>If [ Get (WindowName) = "Tag" ]</li>
<li>#Make key to fit this group's lock.</li>
<li>Set Variable [ $$status; Value:status::_LockList ]</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#Give key to current specific action.</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>Set Field [ issue::_keyStatus; $$status ]</li>
<li>End If</li>
<li>#</li>
<li>//  Perform Script [ &ldquo;issueSortStatus&rdquo; ]</li>
<li>Perform Script [ &ldquo;Tstatus&rdquo; ]</li>
<li>//  Perform Script [ &ldquo;TsubtotalTimeByGroup&rdquo; ]</li>
<li>Select Window [ Name: "Tag"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>status</em>::_LockList</li>
<li>
<em>issue</em>::_keyStatus</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33160ScriptAnchor_">issueSortStatus</a></li>
<li><a href="#33113ScriptAnchor_">Tstatus</a></li>
<li><a href="#33112ScriptAnchor_">TsubtotalTimeByGroup</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33166ScriptAnchor_"></a><td class="script_navbar"><a href="#33173ScriptAnchor_"><span>Previous Script: [TsubtotalTimeByGroupForStatus]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33113ScriptAnchor_"><span>Next Script: [Tstatus]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">TsubtotalTimeByOrder</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33164ScriptAnchor_">issueSortOrderNumber</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Decided for now that this information is too much</li>
<li>#clutter, especially now the user can see total time</li>
<li>#per category tag in the tag window.  </li>
<li>Exit Script [  ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#If user selected the same category that was already</li>
<li>#selected then stop this script.</li>
<li>If [ issue::_keyCategory = issue::oldCategorykey and $$stopSubtotal = "" ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Set Variable [ $$stopSubtotal ]</li>
<li>#</li>
<li>#Set the old category key variable for use later</li>
<li>#in this script finding all the issue records that</li>
<li>#still belong to this record's former category.</li>
<li>Set Variable [ $OLDcategoryKey; Value:issue::oldCategorykey ]</li>
<li>#</li>
<li>#Prevent windows from flashing and script from slowing</li>
<li>#by stopping strobe effect caused by going back and </li>
<li>#forth from each window upon loading each records </li>
<li>#information throughout the script, rather than just </li>
<li>#at the end.</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>#</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#This field is for sorting the records by category</li>
<li>#to get the subtotal of each categories time.</li>
<li>#  (The subtotal calculation depends on this "break"</li>
<li>#  field to know which set of records should be</li>
<li>#  treated as a subset of the total records shown.)</li>
<li>#This sort must be done on a field in the table</li>
<li>#where the time is located: list table.</li>
<li>#The system is using the text field from the list</li>
<li>#table for the text of each issue.  Another occurance</li>
<li>#of the list table is used to supply the categories</li>
<li>#which are located in a different list table record.</li>
<li>#This allows the system to use the list table for</li>
<li>#Text and for tags: category and issue tags.  </li>
<li>#However, in order to sort on the text of the </li>
<li>#category a copy of the text must be made </li>
<li>#part of each list record shown as an issue   </li>
<li>#  (instead of being shown as a category or status)</li>
<li>#This next field holds the copy of the cateogry</li>
<li>#tag text for each list record holding issue data.</li>
<li>Set Field [ issue::sortTime; issueCategory::text ]</li>
<li>#</li>
<li>#In the focus in the text field, remove it.</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Open a new window so these next steps can</li>
<li>#be done without disturbing the current view</li>
<li>#and scroll position of the issue window.</li>
<li>New Window [ Name: "temp" ]</li>
<li>#</li>
<li>#This duplicate layout has no script triggers or conditional</li>
<li>#formatting and so speeds up the script steps.</li>
<li>Go to Layout [ &ldquo;IssuesLayoutForScripts&rdquo; (issue) ]</li>
<li>#</li>
<li>#Add up total time for category the issue is now in.</li>
<li>#</li>
<li>#First find all the issues in this category.</li>
<li>Set Variable [ $categoryKey; Value:issue::_keyCategory ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyCategory; $categoryKey ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Sort them to trigger the calcuation of their </li>
<li>#total time.</li>
<li>Sort Records [ Specified Sort Order: issue::sortTime; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#Go to each record including the newly recatorgized</li>
<li># and update thier total cateogry time.</li>
<li>#</li>
<li>Loop</li>
<li>Set Field [ issue::timeTotalSumByCat; issue::timeTotalSummaryByCategory ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Add up total time for category it was in.</li>
<li>#</li>
<li>#First find all the issues still part of the category</li>
<li>#it was in, if any.</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyCategory; $OLDcategoryKey ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#If records remain in this category then continue</li>
<li>#reassigning updated total time to member records.</li>
<li>If [ Get (LastError)  &ne; 401 ]</li>
<li>#</li>
<li>#Sort them to trigger the calcuation of their </li>
<li>#total time.</li>
<li>Sort Records [ Specified Sort Order: issue::sortTime; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Go to each record including the newly recatorgized</li>
<li># and update thier total cateogry time.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Field [ issue::timeTotalSumByCat; issue::timeTotalSummaryByCategory ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Disabled the next chunk after deciding it was </li>
<li>#better to use filemaker's subtotal calc rather</li>
<li>#doing it with this script chunk whose benefit</li>
<li>#was subtotaling items in a category even when</li>
<li>#items where divided by status.  Filemaker's</li>
<li>#subtotal calc subtotals at the status and category</li>
<li>#breaks (essentially all breaks caused by a sort)</li>
<li>#but I decided to show issue the time by status</li>
<li>#and category too, so that is why this script chunk</li>
<li>#is now disabled.  The other reason was that it</li>
<li>#bogged down the system taking a long time to run.</li>
<li>//  #To reset all the category subtotal times, first find</li>
<li>//  #and sort all this issues records.</li>
<li>//  Set Variable [ $brainstateIssues; Value:issue::_keyBrainstate ]</li>
<li>//  Enter Find Mode [  ]</li>
<li>//  Set Field [ issue::_keyBrainstate; $brainstateIssues ]</li>
<li>//  Perform Find [  ]</li>
<li>//  Sort Records [ Specified Sort Order: brainstate::description; ascending
issueStatus::order; ascending
issueStatus::text; ascending
issueCategory::order; ascending
issue::timeTotalSummaryByCategory; ascending
issue::order; based on value list: &ldquo;__-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  #</li>
<li>//  #</li>
<li>//  #AddUp total time showing for this subset of</li>
<li>//  #a cateogory broken up into subsets by different</li>
<li>//  #statuses, like the subset of some category's</li>
<li>//  #record that are pending, or completed, etc.</li>
<li>//  Loop</li>
<li>//  Set Variable [ $category; Value:issue::_keyCategory ]</li>
<li>//  Set Variable [ $status; Value:issue::_keyStatus ]</li>
<li>//  Set Variable [ $recordNumber; Value:Get (RecordNumber) ]</li>
<li>//  Set Variable [ $subsetTotal ]</li>
<li>//  Set Variable [ $oldTotal ]</li>
<li>//  #</li>
<li>//  Loop</li>
<li>//  Set Variable [ $subsetTotal; Value:issue::issueTotalTime + $oldTotal ]</li>
<li>//  Set Variable [ $oldTotal; Value:$subsetTotal ]</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  Exit Loop If [ issue::_keyCategory &ne; $category 

//This next step I thought could happen, but then realized it can nevery happen
//or 
//issue::_keyCategory = $category and issue::_keyStatus &ne; $status ]</li>
<li>//  End Loop</li>
<li>//  #</li>
<li>//  #Return the first record in this subset and give it</li>
<li>//  #the subset total, then give the subtotal to all </li>
<li>//  #records in this subset.</li>
<li>//  Go to Record/Request/Page [ $recordNumber ]
[ No dialog ]</li>
<li>//  #</li>
<li>//  Loop</li>
<li>//  Set Field [ issue::timeTotalSumByCatSortedByStatus; $subsetTotal ]</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  Exit Loop If [ issue::_keyCategory &ne; $category 

//This next step I thought could happen, but then realized it can nevery happen
//or 
//issue::_keyCategory = $category and issue::_keyStatus &ne; $status ]</li>
<li>//  End Loop</li>
<li>//  #</li>
<li>//  Exit Loop If [ Get (LastError)  = 101 ]</li>
<li>//  End Loop</li>
<li>#</li>
<li>#</li>
<li>Close Window [ Name: "temp"; Current file ]</li>
<li>#</li>
<li>#</li>
<li>#Set make the old and current category keys</li>
<li>#identical, so system will will be able to update</li>
<li>#the time in this issue records current category</li>
<li>#if the user decided to reassign it to a different</li>
<li>#category.</li>
<li>Set Field [ issue::oldCategorykey; issue::_keyCategory ]</li>
<li>#</li>
<li>#In order to show the newly updapted time the</li>
<li>#system must resort the records.  This takes</li>
<li>Set Variable [ $currentRecord; Value:issue::_LockList ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issue::order; based on value list: &ldquo;__-99&rdquo;
issueStatus::order; ascending
issueStatus::text; ascending
issueCategory::order; ascending
issue::timeTotalSummaryByCategory; ascending
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>//  Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>#In order to show the newly updapted time the</li>
<li>#The previous script step takes the </li>
<li>#the focus to the last record.  To get the</li>
<li>#to the current record, and to show it not as</li>
<li>#as the top record, but if possible show</li>
<li>#all records above it, requires two sorts, and</li>
<li>#two scrolls.  For some reason Filemaker will not</li>
<li>#scroll home (the top record) and then scroll </li>
<li>#down to the current record without a sort being</li>
<li>#between the sort steps.</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ issue::_LockList = $currentRecord ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Scroll Window
[ Home ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issue::order; based on value list: &ldquo;1-99&rdquo;
issueStatus::order; based on value list: &ldquo;__-99&rdquo;
issueStatus::text; ascending
issueCategory::order; ascending
issue::sortTime; ascending
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>//  Sort Records [  ]
[ No dialog ]</li>
<li>Scroll Window
[ To Selection ]</li>
<li>//  Refresh Window</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>#</li>
<li>//  #The halt script is neccessary in case the user</li>
<li>//  #clicks somewhere other than the in the pulldown</li>
<li>//  #menu.  This halt script stops the pause script</li>
<li>//  #that is currently in play.</li>
<li>//  Halt Script</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>issue</em>::_keyCategory</li>
<li>
<em>issue</em>::oldCategorykey</li>
<li>
<em>issueCategory</em>::text</li>
<li>
<em>issue</em>::sortTime</li>
<li>
<em>issue</em>::timeTotalSummaryByCategory</li>
<li>
<em>issue</em>::timeTotalSumByCat</li>
<li>
<em>issue</em>::_keyBrainstate</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>issueStatus</em>::order</li>
<li>
<em>issueStatus</em>::text</li>
<li>
<em>issueCategory</em>::order</li>
<li>
<em>issue</em>::order</li>
<li>
<em>issue</em>::text</li>
<li>
<em>issue</em>::_keyStatus</li>
<li>
<em>issue</em>::issueTotalTime</li>
<li>
<em>issue</em>::timeTotalSumByCatSortedByStatus</li>
<li>
<em>issue</em>::_LockList</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>IssuesLayoutForScripts</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33113ScriptAnchor_"></a><td class="script_navbar"><a href="#33166ScriptAnchor_"><span>Previous Script: [TsubtotalTimeByOrder]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33170ScriptAnchor_"><span>Next Script: [findGroupPart1]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">Tstatus</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33173ScriptAnchor_">TsubtotalTimeByGroupForStatus</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ issueStatus::order &gt; 79 ]</li>
<li>Set Variable [ $$stopgotoIssueResolution; Value:1 ]</li>
<li>Set Field [ issue::order; "" ]</li>
<li>End If</li>
<li>Go to Field [  ]</li>
<li>If [ issue::_keyCategory &ne; "" ]</li>
<li>Go to Field [ issue::dateModified ]</li>
<li>Set Field [ issue::dateModified; Get ( CurrentTimeStamp ) ]</li>
<li>Go to Field [  ]</li>
<li>End If</li>
<li>Set Variable [ $$stopgotoIssueResolution ]</li>
<li>#</li>
<li>#if over 90, do not take user to record when status is changed.</li>
<li>If [ issueStatus::order &gt; 79 or $$stopSort &ne; "" ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issueStatus::order; based on value list: &ldquo;__-99&rdquo;
issueStatus::text; ascending
issueCategory::order; ascending
issue::sortTime; ascending
issue::order; based on value list: &ldquo;1-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>Scroll Window
[ To Selection ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>issueStatus</em>::order</li>
<li>
<em>issue</em>::order</li>
<li>
<em>issue</em>::_keyCategory</li>
<li>
<em>issue</em>::dateModified</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>issueStatus</em>::text</li>
<li>
<em>issueCategory</em>::order</li>
<li>
<em>issue</em>::sortTime</li>
<li>
<em>issue</em>::text</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33170ScriptAnchor_"></a><td class="script_navbar"><a href="#33113ScriptAnchor_"><span>Previous Script: [Tstatus]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33169ScriptAnchor_"><span>Next Script: [findGroupPart2]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">findGroupPart1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Stop script if user is process of picking a specific action group.</li>
<li>If [ $$pick = 1 ]</li>
<li>Show Custom Dialog [ Message: "Pick a specific-action tag or click the cancel button in the Tag window.  After you do this you can find specific-actions tagged with specific tags."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#Go to the find layout for category tags.</li>
<li>Go to Layout [ &ldquo;IssuesAndObservationsFIND&rdquo; (category) ]</li>
<li>Scroll Window
[ Home ]</li>
<li>Set Variable [ $$found ]</li>
<li>#</li>
<li>#Clear all specific actions records.</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyCategory; "nothing" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Return to tag window.</li>
<li>Select Window [ Name: "Tag"; Current file ]</li>
<li>Go to Layout [ &ldquo;IssuesAndObservationsFIND&rdquo; (category) ]</li>
<li>Set Field [ reference::tagCatSort; "group" ]</li>
<li>Sort Records [ Specified Sort Order: group::text; ascending
category::sortTime; ascending
category::text; ascending ]
[ Restore; No dialog ]</li>
<li>Scroll Window
[ Home ]</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>issue</em>::_keyCategory</li>
<li>
<em>reference</em>::tagCatSort</li>
<li>
<em>group</em>::text</li>
<li>
<em>category</em>::sortTime</li>
<li>
<em>category</em>::text</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>IssuesAndObservationsFIND</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33169ScriptAnchor_"></a><td class="script_navbar"><a href="#33170ScriptAnchor_"><span>Previous Script: [findGroupPart1]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33152ScriptAnchor_"><span>Next Script: [gotoIssueOrder]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">findGroupPart2</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#</li>
<li>If [ Get (LayoutTableName) = "category" ]</li>
<li>#</li>
<li>#Make key to fit this group's lock.</li>
<li>Set Variable [ $$group; Value:category::_LockList ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Remove found specific actions with this key if</li>
<li>#user already found them and now wants to </li>
<li>#hide them. </li>
<li>If [ FilterValues ( $$found ; $$group ) = $$group &amp; &para; ]</li>
<li>#</li>
<li>#Remove the find request the user just clicked on,</li>
<li>#and then determine the number of find requests remaining.</li>
<li>Set Variable [ $$found; Value:Substitute ( $$found ; $$group &amp; &para; ; "" ) ]</li>
<li>Set Variable [ $valueNumber; Value:ValueCount ( $$found ) ]</li>
<li>#</li>
<li>#Go the specific action window and begin the process</li>
<li>#of finding requested records minus the ones</li>
<li>#the user no longer wants to see.</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>#</li>
<li>#Find last request first and if their zero requests</li>
<li>#then find no records.</li>
<li>Enter Find Mode [  ]</li>
<li>If [ $valueNumber = 0 ]</li>
<li>Set Field [ issue::_keyCategory; "none" ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Select Window [ Name: "Tag"; Current file ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Set Field [ issue::_keyCategory; GetValue ( $$found ; $valueNumber ) ]</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Find aditional records until all requests have </li>
<li>#been satisfied.</li>
<li>Enter Find Mode [  ]</li>
<li>Loop</li>
<li>Set Variable [ $valueNumber; Value:$valueNumber - 1 ]</li>
<li>Exit Loop If [ $valueNumber = 0 ]</li>
<li>Set Field [ issue::_keyCategory; GetValue ( $$found ; $valueNumber ) ]</li>
<li>Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>Extend Found Set [  ]</li>
<li>End Loop</li>
<li>#</li>
<li>#</li>
<li>#STOP USING this loop which omitted records.</li>
<li>#This method is really slow when their are 500 +</li>
<li>#records.  Replaced with the above method for</li>
<li>#finding records user wants to view.  </li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Loop</li>
<li>//  If [ issue::_keyCategory = $$group ]</li>
<li>//  Omit Record</li>
<li>//  Else</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  End If</li>
<li>//  End Loop</li>
<li>#</li>
<li>#</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issueStatus::order; based on value list: &ldquo;__-99&rdquo;
issueStatus::text; ascending
issueCategory::order; ascending
issue::sortTime; ascending
issue::order; based on value list: &ldquo;1-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Else</li>
<li>#</li>
<li>#Find all specific actions with this key.</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyCategory; $$group ]</li>
<li>Extend Found Set [  ]</li>
<li>If [ Get (LastError) &ne; 401 ]</li>
<li>Set Variable [ $$found; Value:$$group &amp; &para; &amp; $$found ]</li>
<li>Else</li>
<li>Show Custom Dialog [ Message: "There are no specific actions tagged with this category."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>End If</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issueStatus::order; based on value list: &ldquo;__-99&rdquo;
issueStatus::text; ascending
issueCategory::order; ascending
issue::sortTime; ascending
issue::order; based on value list: &ldquo;1-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>Perform Script [ &ldquo;loadIssuerecordID&rdquo; ]</li>
<li>#</li>
<li>#If user selected the same category that was already</li>
<li>#selected then stop this script.</li>
<li>Select Window [ Name: "Tag"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Else</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Make key to fit this group's lock.</li>
<li>Set Variable [ $$findStatus; Value:status::_LockList ]</li>
<li>Go to Field [  ]</li>
<li>#</li>
<li>#Remove found specific actions with this key if</li>
<li>#user already found them and now wants to </li>
<li>#hide them. </li>
<li>If [ FilterValues ( $$foundStatus ; $$findStatus ) = $$findStatus &amp; &para; ]</li>
<li>#</li>
<li>#Remove the find request the user just clicked on,</li>
<li>#and then determine the number of find requests remaining.</li>
<li>Set Variable [ $$foundStatus; Value:Substitute ( $$foundStatus ; $$findStatus &amp; &para; ; "" ) ]</li>
<li>Set Variable [ $valueNumber; Value:ValueCount ( $$foundStatus ) ]</li>
<li>#</li>
<li>#Go the specific action window and begin the process</li>
<li>#of finding requested records minus the ones</li>
<li>#the user no longer wants to see.</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>#</li>
<li>#Find last request first and if their zero requests</li>
<li>#then find no records.</li>
<li>Enter Find Mode [  ]</li>
<li>If [ $valueNumber = 0 ]</li>
<li>Set Field [ issue::_keyStatus; "none" ]</li>
<li>Perform Find [  ]</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Select Window [ Name: "Tag"; Current file ]</li>
<li>Refresh Window</li>
<li>Exit Script [  ]</li>
<li>Else</li>
<li>Set Field [ issue::_keyStatus; GetValue ( $$foundStatus ; $valueNumber ) ]</li>
<li>Perform Find [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Find aditional records until all requests have </li>
<li>#been satisfied.</li>
<li>Loop</li>
<li>Set Variable [ $valueNumber; Value:$valueNumber - 1 ]</li>
<li>Exit Loop If [ $valueNumber = 0 ]</li>
<li>Set Field [ issue::_keyStatus; GetValue ( $$foundStatus ; $valueNumber ) ]</li>
<li>Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>Extend Found Set [  ]</li>
<li>End Loop</li>
<li>#</li>
<li>#</li>
<li>#STOP USING this loop which omitted records.</li>
<li>#This method is really slow when their are 500 +</li>
<li>#records.  Replaced with the above method for</li>
<li>#finding records user wants to view.  </li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Loop</li>
<li>//  If [ issue::_keyStatus = $$findStatus ]</li>
<li>//  Omit Record</li>
<li>//  Else</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  End If</li>
<li>//  End Loop</li>
<li>//  Set Variable [ $$foundStatus; Value:Substitute ( $$foundStatus ; $$findStatus &amp; &para; ; "" ) ]</li>
<li>#</li>
<li>#</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issueStatus::order; based on value list: &ldquo;__-99&rdquo;
issueStatus::text; ascending
issueCategory::order; ascending
issue::sortTime; ascending
issue::order; based on value list: &ldquo;1-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Else</li>
<li>#</li>
<li>#Find all specific actions with this key.</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyStatus; $$findStatus ]</li>
<li>Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>Extend Found Set [  ]</li>
<li>If [ Get (LastError) &ne; 401 ]</li>
<li>Set Variable [ $$foundStatus; Value:$$findStatus &amp; &para; &amp; $$foundStatus ]</li>
<li>Else</li>
<li>Show Custom Dialog [ Message: "There are no specific actions tagged with this status."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>End If</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Sort Records [ Specified Sort Order: brainstate::description; ascending
issueStatus::order; based on value list: &ldquo;__-99&rdquo;
issueStatus::text; ascending
issueCategory::order; ascending
issue::sortTime; ascending
issue::order; based on value list: &ldquo;1-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>Perform Script [ &ldquo;loadIssuerecordID&rdquo; ]</li>
<li>#</li>
<li>#If user selected the same category that was already</li>
<li>#selected then stop this script.</li>
<li>Select Window [ Name: "Tag"; Current file ]</li>
<li>Refresh Window</li>
<li>#</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>category</em>::_LockList</li>
<li>
<em>issue</em>::_keyCategory</li>
<li>
<em>issue</em>::_keyBrainstate</li>
<li>
<em>brainstate</em>::description</li>
<li>
<em>issueStatus</em>::order</li>
<li>
<em>issueStatus</em>::text</li>
<li>
<em>issueCategory</em>::order</li>
<li>
<em>issue</em>::sortTime</li>
<li>
<em>issue</em>::order</li>
<li>
<em>issue</em>::text</li>
<li>
<em>status</em>::_LockList</li>
<li>
<em>issue</em>::_keyStatus</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33115ScriptAnchor_">loadIssuerecordID</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33152ScriptAnchor_"></a><td class="script_navbar"><a href="#33169ScriptAnchor_"><span>Previous Script: [findGroupPart2]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33143ScriptAnchor_"><span>Next Script: [gotoFieldItemPart3a]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoIssueOrder</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If user clicked on the pulldown when the focus</li>
<li>#of the system was on another record, stop this</li>
<li>#script so user wont' get a useless flash of the menu.</li>
<li>If [ $$pulldownCheck  &ne; Get (RecordID) ]</li>
<li>Set Variable [ $$pulldownCheck; Value:Get (RecordID) ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Go to Object [ Object Name: "order" ]</li>
<li>//  Go to Field [ issue::order ]
[ Select/perform ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>issue</em>::order</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33143ScriptAnchor_"></a><td class="script_navbar"><a href="#33152ScriptAnchor_"><span>Previous Script: [gotoIssueOrder]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33110ScriptAnchor_"><span>Next Script: [gotoIssues]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoFieldItemPart3a</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#If user clicked on the pulldown when the focus</li>
<li>#of the system was on another record, stop this</li>
<li>#script so user wont' get a useless flash of the menu.</li>
<li>If [ $$pulldownCheck  &ne; Get (RecordID) ]</li>
<li>Set Variable [ $$pulldownCheck; Value:Get (RecordID) ]</li>
<li>Go to Field [  ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>Go to Object [ Object Name: 2 ]</li>
<li>//  Go to Field [ issue::_keyCategory ]
[ Select/perform ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>issue</em>::_keyCategory</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33110ScriptAnchor_"></a><td class="script_navbar"><a href="#33143ScriptAnchor_"><span>Previous Script: [gotoFieldItemPart3a]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33235ScriptAnchor_"><span>Next Script: [gotoStatus]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoIssues</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $brainstate; Value:brainstate::_lockBrainstateID ]</li>
<li>New Window [  ]</li>
<li>Go to Layout [ &ldquo;Issues&rdquo; (issue) ]</li>
<li>Sort Records [ Specified Sort Order: issue::_keyBrainstate; ascending
issue::_keyStatus; ascending
issueCategory::text; ascending
issue::order; based on value list: &ldquo;__-99&rdquo;
issue::text; ascending ]
[ Restore; No dialog ]</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyBrainstate; $brainstate ]</li>
<li>Set Field [ issue::lock; "issue" ]</li>
<li>Perform Find [  ]</li>
<li>If [ Get ( LastError ) = 401 ]</li>
<li>New Record/Request</li>
<li>Set Field [ issue::_keyBrainstate; $brainstate ]</li>
<li>Set Field [ issue::date; Get ( CurrentTimeStamp ) ]</li>
<li>Set Field [ issue::lock; "issue" ]</li>
<li>Set Field [ issue::text; "issue" ]</li>
<li>Go to Field [  ]</li>
<li>Go to Field [ issue::text ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>issue</em>::_keyBrainstate</li>
<li>
<em>issue</em>::_keyStatus</li>
<li>
<em>issueCategory</em>::text</li>
<li>
<em>issue</em>::order</li>
<li>
<em>issue</em>::text</li>
<li>
<em>issue</em>::lock</li>
<li>
<em>issue</em>::date</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>Issues</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33235ScriptAnchor_"></a><td class="script_navbar"><a href="#33110ScriptAnchor_"><span>Previous Script: [gotoIssues]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33236ScriptAnchor_"><span>Next Script: [gotoStatusFIND]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoStatus</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>Set Variable [ $brainstateName; Value:brainstate::description ]</li>
<li>#</li>
<li>#Show all status tags.</li>
<li>Go to Layout [ &ldquo;IssuesAndObservationsStatus&rdquo; (status) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ status::lock; "status" ]</li>
<li>Perform Find [  ]</li>
<li>Set Field [ status::status; $brainstateName ]</li>
<li>Sort Records [ Specified Sort Order: status::order; ascending
status::text; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::description</li>
<li>
<em>status</em>::lock</li>
<li>
<em>status</em>::status</li>
<li>
<em>status</em>::order</li>
<li>
<em>status</em>::text</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>IssuesAndObservationsStatus</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33236ScriptAnchor_"></a><td class="script_navbar"><a href="#33235ScriptAnchor_"><span>Previous Script: [gotoStatus]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33230ScriptAnchor_"><span>Next Script: [gotoTimer]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoStatusFIND</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>Set Variable [ $brainstateName; Value:brainstate::description ]</li>
<li>Set Variable [ $$foundStatus ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Error Capture [ On ]</li>
<li>#</li>
<li>#Go to the find layout for category tags.</li>
<li>Go to Layout [ &ldquo;IssuesAndObservationsStatusFIND&rdquo; (status) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ status::lock; "status" ]</li>
<li>Perform Find [  ]</li>
<li>Set Field [ status::status; $brainstateName ]</li>
<li>Sort Records [ Specified Sort Order: status::order; ascending
status::text; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#Clear all specific actions records.</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyStatus; "nothing" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Return to tag window.</li>
<li>Select Window [ Name: "Tag"; Current file ]</li>
<li>Scroll Window
[ Home ]</li>
<li>#</li>
<li>#</li>
<li>#FOR NOW DO NOT find current statuses shown</li>
<li>#in the Specific Action window.</li>
<li>//  Select Window [ Name: "Specific Action"; Current file ]</li>
<li>//  Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Set Variable [ $$foundStatus; Value:issue::_keyStatus &amp; &para; ]</li>
<li>//  Loop</li>
<li>//  If [ FilterValues ( $$foundStatus ; issue::_keyStatus &amp; &para; ) &ne; issue::_keyStatus &amp; &para; ]</li>
<li>//  Set Variable [ $$foundStatus; Value:issue::_keyStatus &amp; &para; &amp; $$foundStatus ]</li>
<li>//  End If</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  End Loop</li>
<li>//  Set Variable [ $$stopRecordLoad ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  #</li>
<li>//  Select Window [ Name: "Tag"; Current file ]</li>
<li>//  Refresh Window</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::description</li>
<li>
<em>status</em>::lock</li>
<li>
<em>status</em>::status</li>
<li>
<em>status</em>::order</li>
<li>
<em>status</em>::text</li>
<li>
<em>issue</em>::_keyStatus</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>IssuesAndObservationsStatusFIND</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33230ScriptAnchor_"></a><td class="script_navbar"><a href="#33236ScriptAnchor_"><span>Previous Script: [gotoStatusFIND]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33233ScriptAnchor_"><span>Next Script: [tagSort]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoTimer</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Stop script if user is process of picking a specific action group.</li>
<li>If [ $$pick = 1 ]</li>
<li>Show Custom Dialog [ Message: "Pick a specific-action tag or click the cancel button in the Tag window.  After you do this you can go to the Timer window."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Select Window [ Name: "Timer"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33233ScriptAnchor_"></a><td class="script_navbar"><a href="#33230ScriptAnchor_"><span>Previous Script: [gotoTimer]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33231ScriptAnchor_"><span>Next Script: [gotoDay]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">tagSort</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Sort records and save sort state for future visits.</li>
<li>If [ Get (LayoutName) = "IssuesAndObservationsTag" or Get (LayoutName) = "IssuesAndObservationsFIND" ]</li>
<li>If [ reference::tagCatSort = "abc" ]</li>
<li>Set Field [ reference::tagCatSort; "group" ]</li>
<li>Sort Records [ Specified Sort Order: group::text; ascending
category::sortTime; ascending
category::text; ascending ]
[ Restore; No dialog ]</li>
<li>Else</li>
<li>Set Field [ reference::tagCatSort; "abc" ]</li>
<li>Sort Records [ Specified Sort Order: category::text; ascending
category::sortTime; ascending ]
[ Restore; No dialog ]</li>
<li>End If</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::tagCatSort</li>
<li>
<em>group</em>::text</li>
<li>
<em>category</em>::sortTime</li>
<li>
<em>category</em>::text</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33231ScriptAnchor_"></a><td class="script_navbar"><a href="#33233ScriptAnchor_"><span>Previous Script: [tagSort]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33237ScriptAnchor_"><span>Next Script: [updateModifyDate]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">gotoDay</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Stop script if user is process of picking a specific action group.</li>
<li>If [ $$pick = 1 ]</li>
<li>Show Custom Dialog [ Message: "Pick a specific-action tag or click the cancel button in the Tag window.  After you do this you can go to the Day window."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33237ScriptAnchor_"></a><td class="script_navbar"><a href="#33231ScriptAnchor_"><span>Previous Script: [gotoDay]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33116ScriptAnchor_"><span>Next Script: [keepblankstatusrecord]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">updateModifyDate</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>#Two script sections to change modify date.</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#This section updates records with no logged time.</li>
<li>//  Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>//  Go to Record/Request/Page
[ First ]</li>
<li>//  Loop</li>
<li>//  If [ issue::issueTotalTime  =  "" ]</li>
<li>//  Set Field [ issue::dateModified; issue::DisplayDate ]</li>
<li>//  End If</li>
<li>//  Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>//  End Loop</li>
<li>//  Set Variable [ $$stopRecordLoad ]</li>
<li>//  Exit Script [  ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#This section udpates modify date to last date</li>
<li>#time was logged for this specific action record. </li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>#</li>
<li>Loop</li>
<li>Set Variable [ $issue; Value:issue::_LockList ]</li>
<li>If [ issue::issueTotalTime &ne; "" ]</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>If [ $issue &amp; "&para;" = FilterValues ( logs::_keyLogIssues ; $issue &amp; "&para;" ) ]</li>
<li>Set Variable [ $modate; Value:logs::_keyDay &amp; " 12:00:00 PM" ]</li>
<li>End If</li>
<li>Exit Loop If [ $issue &amp; "&para;" = FilterValues ( logs::_keyLogIssues ; $issue &amp; "&para;" ) ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>Set Field [ issue::dateModified; $modate ]</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>issue</em>::issueTotalTime</li>
<li>
<em>issue</em>::DisplayDate</li>
<li>
<em>issue</em>::dateModified</li>
<li>
<em>issue</em>::_LockList</li>
<li>
<em>logs</em>::_keyLogIssues</li>
<li>
<em>logs</em>::_keyDay</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33116ScriptAnchor_"></a><td class="script_navbar"><a href="#33237ScriptAnchor_"><span>Previous Script: [updateModifyDate]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33165ScriptAnchor_"><span>Next Script: [keepBlankGroupRecord]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">keepblankstatusrecord</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ status::_LockList = 6302011014838316 ]</li>
<li>Go to Field [  ]</li>
<li>Show Custom Dialog [ Message: "This first record must remain blank, so that new issues are always sorted to the top in the Issues Log window."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>status</em>::_LockList</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33165ScriptAnchor_"></a><td class="script_navbar"><a href="#33116ScriptAnchor_"><span>Previous Script: [keepblankstatusrecord]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33223ScriptAnchor_"><span>Next Script: [newTagGroup]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">keepBlankGroupRecord</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ $$stopGroup &ne; "" ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>If [ category::text = "          " ]</li>
<li>Go to Field [  ]</li>
<li>Show Custom Dialog [ Message: "This first record must remain blank, so that new issues are always sorted to the top in the Issues Log window."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>category</em>::text</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33223ScriptAnchor_"></a><td class="script_navbar"><a href="#33165ScriptAnchor_"><span>Previous Script: [keepBlankGroupRecord]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33117ScriptAnchor_"><span>Next Script: [deleteObservation]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">newTagGroup</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33167ScriptAnchor_">openSpecificAction</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#When a new record is created the text field is blank.  </li>
<li>#If the user clicks the new button before giving </li>
<li>#their current new record a name these steps will</li>
<li>#name it for them.  </li>
<li>If [ category::text = "" ]</li>
<li>Set Field [ category::text; "tag" &amp; category::_LockList ]</li>
<li>End If</li>
<li>Set Variable [ $$TagNameRequired; Value:1 ]</li>
<li>#</li>
<li>#Create new group record.</li>
<li>New Record/Request</li>
<li>Set Field [ category::lock; "group" ]</li>
<li>Set Field [ category::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Field [ category::text; "group" &amp; category::_LockList ]</li>
<li>Set Variable [ $group; Value:category::_LockList ]</li>
<li>#</li>
<li>#Remove it so it only shows up as a header and</li>
<li>#and not as both a header and a tag.</li>
<li>Omit Record</li>
<li>#</li>
<li>#Create a new tag record and assign it to this new</li>
<li>#group so the group will show up as its header.</li>
<li>New Record/Request</li>
<li>Set Field [ category::lock; "location" ]</li>
<li>Set Field [ category::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Field [ category::_keyCategory; $group ]</li>
<li>#</li>
<li>#Sort records so new group header will show up.  </li>
<li>Sort Records [ Specified Sort Order: group::text; ascending
category::text; ascending ]
[ Restore; No dialog ]</li>
<li>Go to Field [ category::text ]</li>
<li>#</li>
<li>#Turn off variable set at start of script.  </li>
<li>Set Variable [ $$TagNameRequired ]</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>category</em>::text</li>
<li>
<em>category</em>::_LockList</li>
<li>
<em>category</em>::lock</li>
<li>
<em>category</em>::_keyBrainstate</li>
<li>
<em>category</em>::_keyCategory</li>
<li>
<em>group</em>::text</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33117ScriptAnchor_"></a><td class="script_navbar"><a href="#33223ScriptAnchor_"><span>Previous Script: [newTagGroup]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33219ScriptAnchor_"><span>Next Script: [startTimerAssignTimeSegmentToSpecificAction]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">deleteObservation</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Set Variable [ $row; Value:Get ( PortalRowNumber ) ]</li>
<li>Go to Field [  ]</li>
<li>Go to Portal Row [ $row ]
[ Select; No dialog ]</li>
<li>Set Variable [ $delete; Value:observation::_LockList ]</li>
<li>Set Variable [ $name; Value:observation::text ]</li>
<li>Refresh Window</li>
<li>Show Custom Dialog [ Title: "!"; Message: "Delete " &amp; $name &amp; "?"; Buttons: &ldquo;Cancel&rdquo;, &ldquo;Delete&rdquo; ]</li>
<li>If [ Get ( LastMessageChoice ) = 2 ]</li>
<li>Delete Portal Row
[ No dialog ]</li>
<li>End If</li>
<li>Set Variable [ $delete ]</li>
<li>Go to Field [  ]</li>
<li>Refresh Window</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>observation</em>::_LockList</li>
<li>
<em>observation</em>::text</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33219ScriptAnchor_"></a><td class="script_navbar"><a href="#33117ScriptAnchor_"><span>Previous Script: [deleteObservation]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33220ScriptAnchor_"><span>Next Script: [stopTimerAssignedToSpecificAction]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">startTimerAssignTimeSegmentToSpecificAction</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>If [ Get (FoundCount) = 0 ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>#Only allow timer to be started if it is for today</li>
<li>#or tomorrow (meaning today after midnight).</li>
<li>If [ reference::day1 = Get ( CurrentDate ) or reference::day1 = Get ( CurrentDate ) +  1 ]</li>
<li>#</li>
<li>If [ reference::day1 &ne; reference::ActivityLogDay ]</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>End If</li>
<li>#</li>
<li>If [ day1::swBugField = "note" ]</li>
<li>#</li>
<li>Set Variable [ $$specificActionTimer; Value:1 ]</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>#</li>
<li>New Window [ Height: 1; Width: 1; Top: -10000; Left: -10000 ]</li>
<li>Go to Layout [ &ldquo;01EditTime&rdquo; (brainstate) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_lockBrainstateID; $$logBrainstate ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#</li>
<li>#BEGIN: Script steps copied from script "note veto view."</li>
<li>#</li>
<li>#</li>
<li>#NOTE: Rather than run this script I thought it</li>
<li>#would be better to copy just the steps needed</li>
<li>#in the Specific Action window to start the timer.</li>
<li>#Since it cannot be edited from this screen, the</li>
<li>#sort is not needed in the Timer window unless</li>
<li>#the timer is being turned on for the first time </li>
<li>#in the currently selected day.</li>
<li>#</li>
<li>#6 if the note button is showing restart the </li>
<li>#timer by putting  a new start time in next </li>
<li>#available start field for this day record.</li>
<li>Set Variable [ $$stopwatchON; Value:"t" ]</li>
<li>Set Field [ day1::swStart[day1::swOccurances + 1]; Get ( CurrentTimeStamp ) ]</li>
<li>If [ day1::swOccurances = 29 ]</li>
<li>Set Field [ day1::swStart[29]; Get ( CurrentTimeStamp ) ]</li>
<li>End If</li>
<li>#</li>
<li>#7 recalculate the pause between stop and </li>
<li>#start times to show user the amount of time </li>
<li>#that has passed since the last time this </li>
<li>#brainstate was active.</li>
<li>Perform Script [ &ldquo;updatePauseTotals&rdquo; ]</li>
<li>#</li>
<li>#</li>
<li>#END: Script steps copied from script "note veto view."</li>
<li>#</li>
<li>#</li>
<li>Close Window [ Current Window ]</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>#</li>
<li>#Show user that Timer window timer has been started.</li>
<li>Move/Resize Window [ Name: "Timer"; Current file; Height: Get (ScreenHeight) - 276; Width: Get (ScreenWidth) - 344; Top: 251; Left: 344 ]</li>
<li>Move/Resize Window [ Name: "Specific Action"; Current file; Height: Get (ScreenHeight); Width: 344; Top: 0; Left: 0 ]</li>
<li>Move/Resize Window [ Name: "Tag"; Current file; Height: 266; Width: 344; Top: 0; Left: 688 ]</li>
<li>Move/Resize Window [ Name: "Day"; Current file; Height: 266; Width: 344; Top: 0; Left: 344 ]</li>
<li>#</li>
<li>#Conditionally format and set up timer to stop.</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
<li>Set Variable [ $$day1BugField; Value:logs::swBugField ]</li>
<li>Set Variable [ $$specificActionTimer ]</li>
<li>#</li>
<li>#Determine correct layout to show all time segments.</li>
<li>If [ daylog::swActivityLength[11] &ne; "" ]</li>
<li>Go to Layout [ &ldquo;logs3rows&rdquo; (logs) ]</li>
<li>Else If [ daylog::swActivityLength[6] &ne; "" ]</li>
<li>Go to Layout [ &ldquo;logs2rows&rdquo; (logs) ]</li>
<li>Else If [ daylog::swActivityLength[6] = "" ]</li>
<li>Go to Layout [ &ldquo;logs1row&rdquo; (logs) ]</li>
<li>End If</li>
<li>#</li>
<li>#Trigger scripts that add this new time </li>
<li>#segment to current action.</li>
<li>Go to Field [ daylog::swActivityLength[daylog::swOccurances] ]
[ Select/perform ]</li>
<li>#</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>#</li>
<li>#</li>
<li>//  #BEGIN: Script steps copied from script "linkActionToDay."</li>
<li>//  #</li>
<li>//  #Needed to be done for first timer segment of the day.</li>
<li>//  #</li>
<li>//  #If tag has not yet been selected, then add it.</li>
<li>//  If [ issue::_LockList &amp; "&para;"  &ne;  FilterValues ( $$logIssues ; issue::_LockList &amp; "&para;" ) ]</li>
<li>//  #</li>
<li>//  Set Variable [ $newIssue; Value:issue::_LockList ]</li>
<li>//  Select Window [ Name: "Day"; Current file ]</li>
<li>//  If [ Get (LastError)  = 112 ]</li>
<li>//  New Window [ Name: "Day"; Height: Get (ScreenHeight); Width: 608; Top: 0; Left: 441 ]</li>
<li>//  Go to Layout [ &ldquo;logs1row&rdquo; (logs) ]</li>
<li>//  End If</li>
<li>//  #</li>
<li>//  #prepare to add log ID to issueLogs so that the issue</li>
<li>//  #will have a record of all days logged to deal with it.</li>
<li>//  Set Variable [ $newlog; Value:logs::_lockDay ]</li>
<li>//  Set Variable [ $$logIssue; Value:logs::_keyLogIssues ]</li>
<li>//  #</li>
<li>//  Set Field [ logs::_keyLogIssues; $newIssue &amp; "&para;" &amp; $$logIssues ]</li>
<li>//  Set Variable [ $$logIssues; Value:logs::_keyLogIssues ]</li>
<li>//  Go to Field [  ]</li>
<li>//  Refresh Window</li>
<li>//  Select Window [ Name: "Specific Action"; Current file ]</li>
<li>//  #</li>
<li>//  #Add log ID to issueLogs.</li>
<li>//  Set Field [ issue::_keyLogs; $newlog &amp; "&para;" &amp; $$IssueLogs ]</li>
<li>//  Set Variable [ $$IssueLogs; Value:issue::_keyLogs ]</li>
<li>//  #</li>
<li>//  #For some reason if system does not re-go to this</li>
<li>//  #same record, other scripts trying to set fields for this</li>
<li>//  #record in a different window (so same layout </li>
<li>//  #different window will get an error 301 (record in use </li>
<li>//  #by another user).  So it is neccessary.  </li>
<li>//  #addTimeSegmentToIssue is the other scirpt that </li>
<li>//  #gets that error message when this step is left out. </li>
<li>//  Go to Record/Request/Page [ Get (RecordNumber) ]
[ No dialog ]</li>
<li>//  End If</li>
<li>//  #</li>
<li>//  #END: Script steps copied from script "linkActionToDay."</li>
<li>#</li>
<li>Refresh Window</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Else If [ day1::swBugField = "" ]</li>
<li>#</li>
<li>Set Variable [ $$specificActionTimer; Value:1 ]</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>#</li>
<li>New Window [ Height: 1; Width: 1; Top: -10000; Left: -10000 ]</li>
<li>Go to Layout [ &ldquo;01EditTime&rdquo; (brainstate) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_lockBrainstateID; $$logBrainstate ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>Set Variable [ $$stopwatchON; Value:"t" ]</li>
<li>Set Variable [ $$newTimer; Value:1 ]</li>
<li>#</li>
<li>#1 capture record number user is currently on</li>
<li>Set Variable [ $record; Value:Get ( RecordNumber ) ]</li>
<li>#</li>
<li>#2 if not create a new one for this brainstate record and do it a new window so the user's focus is maintained (just going to the day layout and back resest the scroll bar unfortunately and I can't find away around this, but I want too!)</li>
<li>Set Variable [ $kpnBrainstateID; Value:brainstate::_lockBrainstateID ]</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>Go to Layout [ &ldquo;calcDayTable&rdquo; (day1) ]</li>
<li>New Record/Request</li>
<li>Set Field [ day1::_keyBrainstate; $kpnBrainstateID ]</li>
<li>Set Field [ day1::_keyUser; $userID ]</li>
<li>Set Field [ day1::_keyDay; reference::day1 ]</li>
<li>#</li>
<li>#3 start the timer by inserting the current time in the start field</li>
<li>Set Field [ day1::swStart; Get ( CurrentTimeStamp ) ]</li>
<li>#</li>
<li>#This step sets a flag for the updateTime </li>
<li>#script telling it to ignore this stopwatches </li>
<li>#time for updates to total records because </li>
<li>#until it is stopped its time has not changed </li>
<li>#and does not need to be included in an update.</li>
<li>Set Field [ day1::updateTimeSymbol; day1::swSymbols ]</li>
<li>Set Field [ day1::updateTime; day1::updateTimeCurrentTimeCalc ]</li>
<li>Go to Layout [ original layout ]</li>
<li>Go to Record/Request/Page [ $record ]
[ No dialog ]</li>
<li>Perform Script [ &ldquo;CHUNK_lastDayUsed&rdquo; ]</li>
<li>#</li>
<li>Close Window [ Current Window ]</li>
<li>#</li>
<li>#Now find the new log record for this timer.</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
<li>Go to Layout [ &ldquo;logs2rows&rdquo; (logs) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ logs::_keyBrainstate; $$logBrainstate ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#Sort and go to first record.</li>
<li>Sort Records [ Specified Sort Order: logs::_keyBrainstate; descending
logs::_keyDay; descending ]
[ Restore; No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Scroll Window
[ Home ]</li>
<li>#</li>
<li>#For attaching issue record IDs to log records, and</li>
<li>#for conditionally formatting log records related to an issue,</li>
<li>#system needs to know what IDs are associated with a log record.</li>
<li>Set Variable [ $$logissues; Value:logs::_keyLogIssues ]</li>
<li>Set Variable [ $$log; Value:logs::_lockDay ]</li>
<li>#</li>
<li>#Attach new time segment to issue record.  </li>
<li>#(The daylog::swOccurances field tells the </li>
<li>#system which segment is new.)</li>
<li>Go to Field [ daylog::swActivityLength[daylog::swOccurances] ]
[ Select/perform ]</li>
<li>#</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Set Variable [ $$newTimer ]</li>
<li>#</li>
<li>Select Window [ Name: "Timer"; Current file ]</li>
<li>Set Variable [ $$recordFIXTOMANYVARIABLES; Value:brainstate::_lockBrainstateID ]</li>
<li>#</li>
<li>#4 sort the records if the current sort is based </li>
<li>#on time which will make this record with zero </li>
<li>#current time shoot to the top or bottom of the </li>
<li>#list depending on how the user is currently </li>
<li>#shorting time.  The point is to keep the focus </li>
<li>#where the user expects it to be so the sort, </li>
<li>#which removes the focus from the current </li>
<li>#record is only done if the user wants the </li>
<li>#records sorted by time, in which case after </li>
<li>#the sort the focus is returned to the first record.</li>
<li>Perform Script [ &ldquo;DaySelectSortThenSort&rdquo; ]</li>
<li>#</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
<li>#</li>
<li>#For attaching issue record IDs to log records, and</li>
<li>#for conditionally formatting log records related to an issue,</li>
<li>#system needs to know what IDs are associated with a log record.</li>
<li>Set Variable [ $$logrecordID; Value:Get ( RecordID ) ]</li>
<li>Set Variable [ $$logissues; Value:logs::_keyLogIssues ]</li>
<li>Set Variable [ $$log; Value:logs::_lockDay ]</li>
<li>Set Field [ reference::ActivityLogDay; logs::_keyDay ]</li>
<li>Set Variable [ $$day1BugField; Value:logs::swBugField ]</li>
<li>#</li>
<li>If [ daylog::swActivityLength[11] &ne; "" ]</li>
<li>Go to Layout [ &ldquo;logs3rows&rdquo; (logs) ]</li>
<li>Else If [ daylog::swActivityLength[6] &ne; "" ]</li>
<li>Go to Layout [ &ldquo;logs2rows&rdquo; (logs) ]</li>
<li>Else If [ daylog::swActivityLength[6] = "" ]</li>
<li>Go to Layout [ &ldquo;logs1row&rdquo; (logs) ]</li>
<li>End If</li>
<li>#</li>
<li>Move/Resize Window [ Name: "Day"; Current file; Height: 266; Width: 344; Top: 0; Left: 344 ]</li>
<li>//  Refresh Window</li>
<li>#</li>
<li>Select Window [ Name: "Tag"; Current file ]</li>
<li>Move/Resize Window [ Name: "Tag"; Current file; Height: 266; Width: 344; Top: 0; Left: 688 ]</li>
<li>#</li>
<li>Move/Resize Window [ Name: "Timer"; Current file; Height: Get (ScreenHeight) - 276; Width: Get (ScreenWidth) - 344; Top: 251; Left: 344 ]</li>
<li>#</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>Set Variable [ $$toggleSpecificActionView; Value:1 ]</li>
<li>Move/Resize Window [ Name: "Specific Action"; Current file; Height: Get (ScreenHeight); Width: 344; Top: 0; Left: 0 ]</li>
<li>#</li>
<li>#For attaching issue record IDs to log records, and</li>
<li>#for conditionally formatting log records related to an issue,</li>
<li>#system needs to know what IDs are associated with a log record.</li>
<li>Set Variable [ $$issue; Value:issue::_LockList ]</li>
<li>Set Variable [ $$issueLogs; Value:issue::_keyLogs ]</li>
<li>Set Variable [ $$timeAll; Value:issue::timeSegmentKeyList ]</li>
<li>Set Variable [ $$stopGroup; Value:1 ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>Refresh Window</li>
<li>#</li>
<li>#</li>
<li>Set Variable [ $$specificActionTimer ]</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>Else</li>
<li>#</li>
<li>Show Custom Dialog [ Message: "Go to the Timer window to start a timer for a specific action in the past.  This button can only be used for starting a timer in the present.   Timer window date is " &amp; reference::ActivityLogDay &amp; ".  Change this date in the timer window."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>End If</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day1</li>
<li>
<em>reference</em>::ActivityLogDay</li>
<li>
<em>day1</em>::swBugField</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>day1</em>::swStart</li>
<li>
<em>day1</em>::swOccurances</li>
<li>
<em>logs</em>::swBugField</li>
<li>
<em>daylog</em>::swActivityLength</li>
<li>
<em>daylog</em>::swOccurances</li>
<li>
<em>issue</em>::_LockList</li>
<li>
<em>logs</em>::_lockDay</li>
<li>
<em>logs</em>::_keyLogIssues</li>
<li>
<em>issue</em>::_keyLogs</li>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>day1</em>::_keyBrainstate</li>
<li>
<em>day1</em>::_keyUser</li>
<li>
<em>day1</em>::_keyDay</li>
<li>
<em>day1</em>::swSymbols</li>
<li>
<em>day1</em>::updateTimeSymbol</li>
<li>
<em>day1</em>::updateTimeCurrentTimeCalc</li>
<li>
<em>day1</em>::updateTime</li>
<li>
<em>logs</em>::_keyBrainstate</li>
<li>
<em>logs</em>::_keyDay</li>
<li>
<em>issue</em>::timeSegmentKeyList</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#117ScriptAnchor_">updatePauseTotals</a></li>
<li><a href="#33053ScriptAnchor_">CHUNK_lastDayUsed</a></li>
<li><a href="#32902ScriptAnchor_">DaySelectSortThenSort</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>01EditTime</li>
<li>logs3rows</li>
<li>logs2rows</li>
<li>logs1row</li>
<li>calcDayTable</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33220ScriptAnchor_"></a><td class="script_navbar"><a href="#33219ScriptAnchor_"><span>Previous Script: [startTimerAssignTimeSegmentToSpecificAction]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33221ScriptAnchor_"><span>Next Script: [toggleViewToSeeAllWindows]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">stopTimerAssignedToSpecificAction</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Only allow timer to be stopped if it is running today</li>
<li>#or tomorrow (meaning today after midnight).</li>
<li>If [ reference::day1 = Get ( CurrentDate ) or reference::day1 +  1 = Get ( CurrentDate ) ]</li>
<li>#</li>
<li>If [ reference::day1 &ne; reference::ActivityLogDay ]</li>
<li>Select Window [ Name: "Day"; Current file ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Go to Field [  ]</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>End If</li>
<li>#</li>
<li>If [ day1::swBugField = "veto" ]</li>
<li>#</li>
<li>Set Variable [ $$specificActionTimer; Value:1 ]</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>New Window [ Height: 1; Width: 1; Top: -10000; Left: -10000 ]</li>
<li>Go to Layout [ &ldquo;01EditTime&rdquo; (brainstate) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ brainstate::_lockBrainstateID; $$logBrainstate ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#basic administration tasks</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>Set Variable [ $userID; Value:reference::farmerID ]</li>
<li>Set Variable [ $$updateDay; Value:day1::_lockDay ]</li>
<li>Set Variable [ $$recordFIXTOMANYVARIABLES; Value:brainstate::_lockBrainstateID ]</li>
<li>#</li>
<li>#5 if the veto button is showing stop the </li>
<li>#stopwatch and put in the in the time stopped.</li>
<li>Set Variable [ $$stopwatchON; Value:"f" ]</li>
<li>Set Field [ day1::swPause[day1::swOccurances]; Get ( CurrentTimeStamp ) ]</li>
<li>#</li>
<li>#Remove the active green formating from the</li>
<li>#Specific Action and Day windows.</li>
<li>Set Variable [ $$day1BugField ]</li>
<li>#</li>
<li>#5 recalculate the time for this record.</li>
<li>#1 equalize these two times, thus unflagging this record as needing updating.</li>
<li>#</li>
<li>Set Field [ day1::updateTime; day1::updateTimeCurrentTimeCalc ]</li>
<li>#</li>
<li>#</li>
<li>Perform Script [ &ldquo;updatePauseTotals&rdquo; ]</li>
<li>#</li>
<li>#</li>
<li>Perform Script [ &ldquo;CHUNK_updateIssueCategoryTime&rdquo; ]</li>
<li>#</li>
<li>#</li>
<li>Close Window [ Current Window ]</li>
<li>#</li>
<li>#Go to record time to which time will be added.</li>
<li>Select Window [ Name: "Specific Action"; Current file ]</li>
<li>If [ FilterValues (issue::timeSegmentKeyList  ; $$activeTimeSegment &amp; "&para;")   &ne;   $$activeTimeSegment &amp; "&para;" ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ FilterValues (issue::timeSegmentKeyList  ; $$activeTimeSegment &amp; "&para;")  =  $$activeTimeSegment &amp; "&para;" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#If record is not showing then find and add it to</li>
<li>#list of records being shown. </li>
<li>If [ FilterValues (issue::timeSegmentKeyList  ; $$activeTimeSegment  &amp; "&para;")  &ne; $$activeTimeSegment  &amp; "&para;" ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::timeSegmentKeyList; $$activeTimeSegment &amp; "&para;" ]</li>
<li>Extend Found Set [  ]</li>
<li>Sort Records [  ]
[ No dialog ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Exit Loop If [ FilterValues (issue::timeSegmentKeyList  ; $$activeTimeSegment &amp; "&para;")  =  $$activeTimeSegment &amp; "&para;" ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>End If</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Set Variable [ $$TimeAssignedToSpecificAction ]</li>
<li>Perform Script [ &ldquo;loadIssuerecordID&rdquo; ]</li>
<li>End If</li>
<li>#</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>Set Variable [ $$specificActionTimer ]</li>
<li>Set Variable [ $$TimeAssignedToSpecificAction ]</li>
<li>#</li>
<li>Refresh Window</li>
<li>#</li>
<li>End If</li>
<li>#</li>
<li>#</li>
<li>Else</li>
<li>#</li>
<li>Show Custom Dialog [ Message: "Go to the Timer window to stop a timer for a specific action taking place in the past.  This button can only be used for stopping a timer running in the present.  Timer window date is " &amp; reference::ActivityLogDay &amp; ".  Change this date in the timer window."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>#</li>
<li>End If</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::day1</li>
<li>
<em>reference</em>::ActivityLogDay</li>
<li>
<em>day1</em>::swBugField</li>
<li>
<em>brainstate</em>::_lockBrainstateID</li>
<li>
<em>reference</em>::farmerID</li>
<li>
<em>day1</em>::_lockDay</li>
<li>
<em>day1</em>::swPause</li>
<li>
<em>day1</em>::swOccurances</li>
<li>
<em>day1</em>::updateTimeCurrentTimeCalc</li>
<li>
<em>day1</em>::updateTime</li>
<li>
<em>issue</em>::timeSegmentKeyList</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#117ScriptAnchor_">updatePauseTotals</a></li>
<li><a href="#33138ScriptAnchor_">CHUNK_updateIssueCategoryTime</a></li>
<li><a href="#33115ScriptAnchor_">loadIssuerecordID</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>01EditTime</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33221ScriptAnchor_"></a><td class="script_navbar"><a href="#33220ScriptAnchor_"><span>Previous Script: [stopTimerAssignedToSpecificAction]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33222ScriptAnchor_"><span>Next Script: [openSpecificActionWebLink]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">toggleViewToSeeAllWindows</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Only allow timer to be stopped if it is running today</li>
<li>#or tomorrow (meaning today after midnight).</li>
<li>#</li>
<li>#</li>
<li>If [ Get ( WindowName ) = "Specific Action" ]</li>
<li>#</li>
<li>If [ $$toggleSpecificActionView = "" ]</li>
<li>Set Variable [ $$toggleSpecificActionView; Value:1 ]</li>
<li>Move/Resize Window [ Name: "Tag"; Current file; Height: 266; Width: 344; Top: 0; Left: 688 ]</li>
<li>Move/Resize Window [ Name: "Day"; Current file; Height: 266; Width: 344; Top: 0; Left: 344 ]</li>
<li>Move/Resize Window [ Name: "Timer"; Current file; Height: Get (ScreenHeight) - 276; Width: Get (ScreenWidth) - 344; Top: 251; Left: 344 ]</li>
<li>Move/Resize Window [ Name: "Specific Action"; Current file; Height: Get (ScreenHeight); Width: 344; Top: 0; Left: 0 ]</li>
<li>#</li>
<li>Else</li>
<li>#</li>
<li>Set Variable [ $$toggleSpecificActionView ]</li>
<li>Move/Resize Window [ Name: "Timer"; Current file; Height: Get (ScreenHeight) - 2 * ( Get (ScreenHeight)  * .05 ); Width:  Get (ScreenWidth)  * .8; Top: Get (ScreenHeight)  * .05; Left:  Get (ScreenWidth)  * .1 ]</li>
<li>Move/Resize Window [ Name: "Tag"; Current file; Height: Get (ScreenHeight); Top: 0; Left: Get (ScreenWidth) - 344 ]</li>
<li>Move/Resize Window [ Name: "Day"; Current file; Height: Get (ScreenHeight); Width: 344; Top: 0; Left: Get (ScreenWidth) - 688 ]</li>
<li>Move/Resize Window [ Name: "Specific Action"; Current file; Height: Get (ScreenHeight); Width: Get (ScreenWidth) - 688; Top: 0; Left: 0 ]</li>
<li>End If</li>
<li>#</li>
<li>Else</li>
<li>#</li>
<li>If [ $$toggleSpecificActionView = "" ]</li>
<li>Set Variable [ $$toggleSpecificActionView; Value:1 ]</li>
<li>Move/Resize Window [ Name: "Tag"; Current file; Height: 266; Width: 344; Top: 0; Left: 688 ]</li>
<li>Move/Resize Window [ Name: "Day"; Current file; Height: 266; Width: 344; Top: 0; Left: 344 ]</li>
<li>Move/Resize Window [ Name: "Specific Action"; Current file; Height: Get (ScreenHeight); Width: 344; Top: 0; Left: 0 ]</li>
<li>Move/Resize Window [ Name: "Timer"; Current file; Height: Get (ScreenHeight) - 276; Width: Get (ScreenWidth) - 344; Top: 251; Left: 344 ]</li>
<li>#</li>
<li>Else</li>
<li>#</li>
<li>Set Variable [ $$toggleSpecificActionView ]</li>
<li>Move/Resize Window [ Name: "Tag"; Current file; Height: Get (ScreenHeight); Top: 0; Left: Get (ScreenWidth) - 344 ]</li>
<li>Move/Resize Window [ Name: "Day"; Current file; Height: Get (ScreenHeight); Width: 344; Top: 0; Left: Get (ScreenWidth) - 688 ]</li>
<li>Move/Resize Window [ Name: "Specific Action"; Current file; Height: Get (ScreenHeight); Width: Get (ScreenWidth) - 688; Top: 0; Left: 0 ]</li>
<li>Move/Resize Window [ Name: "Timer"; Current file; Height: Get (ScreenHeight) - 2 * ( Get (ScreenHeight)  * .05 ); Width:  Get (ScreenWidth); Top: Get (ScreenHeight)  * .05; Left: 0 ]</li>
<li>End If</li>
<li>End If</li>
<li>#</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33222ScriptAnchor_"></a><td class="script_navbar"><a href="#33221ScriptAnchor_"><span>Previous Script: [toggleViewToSeeAllWindows]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"><a href="#33229ScriptAnchor_"><span>Next Script: [updateTimerTotalTimeInTagWindow]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">openSpecificActionWebLink</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Only allow timer to be stopped if it is running today</li>
<li>#or tomorrow (meaning today after midnight).</li>
<li>#</li>
<li>#</li>
<li>If [ issue::weblink = "" ]</li>
<li>Go to Field [ issue::weblink ]</li>
<li>Else</li>
<li>Go to Field [ issue::weblink ]</li>
<li>Open URL [ issue::weblink ]
[ No dialog ]</li>
<li>End If</li>
<li>#</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>issue</em>::weblink</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33229ScriptAnchor_"></a><td class="script_navbar"><a href="#33222ScriptAnchor_"><span>Previous Script: [openSpecificActionWebLink]</span></a></td><td class="script_navbar"><a href="#33208ScriptAnchor_"><span>Parent Folder: [specific action log]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">updateTimerTotalTimeInTagWindow</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">Off</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33167ScriptAnchor_">openSpecificAction</a></li>
<li><a href="#33171ScriptAnchor_">gotoLogs</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#</li>
<li>#Stop script if user is NOT in the process of picking a specific action group.</li>
<li>If [ $$pick = 1 ]</li>
<li>Show Custom Dialog [ Message: "Pick a specific-action tag or click the cancel button in the Tag window.  After you do this you can re-calculate total time logged under each tag."; Buttons: &ldquo;OK&rdquo; ]</li>
<li>Exit Script [  ]</li>
<li>End If</li>
<li>#</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>#</li>
<li>#Prevent windows from flashing and script from slowing</li>
<li>Set Variable [ $$stopRecordLoad; Value:1 ]</li>
<li>#</li>
<li>New Window [ Height: 1; Width: 1; Top: -1000; Left: -1000 ]</li>
<li>#</li>
<li>#This duplicate layout has no script triggers or conditional</li>
<li>#formatting and so speeds up the script steps.</li>
<li>Go to Layout [ &ldquo;IssuesLayoutForScripts&rdquo; (issue) ]</li>
<li>#</li>
<li>Set Variable [ $$stopRecordLoad ]</li>
<li>#</li>
<li>#First find all the issues in this category.</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ issue::_keyBrainstate; $$logBrainstate ]</li>
<li>Set Field [ issue::lock; "issue" ]</li>
<li>Perform Find [  ]</li>
<li>#</li>
<li>#</li>
<li>#Sort them to trigger the calcuation of their </li>
<li>#total time.</li>
<li>Sort Records [ Specified Sort Order: issue::_keyCategory; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Set Variable [ $category; Value:issue::_keyCategory ]</li>
<li>Set Field [ issueCategory::issueTotalTime; GetSummary ( issue::timeSummary ; issue::_keyCategory ) ]</li>
<li>Loop</li>
<li>If [ $category  &ne;  issue::_keyCategory ]</li>
<li>Set Field [ issueCategory::issueTotalTime; GetSummary ( issue::timeSummary ; issue::_keyCategory ) ]</li>
<li>Set Variable [ $category; Value:issue::_keyCategory ]</li>
<li>End If</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#</li>
<li>#Add up total time for all actions with this category tag.</li>
<li>Go to Layout [ &ldquo;calcDayTable&rdquo; (day1) ]</li>
<li>Enter Find Mode [  ]</li>
<li>Set Field [ day1::_keyBrainstate; $$logbrainstate ]</li>
<li>Perform Find [  ]</li>
<li>Go to Record/Request/Page
[ First ]</li>
<li>Loop</li>
<li>Set Variable [ $totalTime; Value:$time + day1::swTotalActivity ]</li>
<li>Set Variable [ $time; Value:$totalTime ]</li>
<li>Go to Record/Request/Page
[ Next; Exit after last ]</li>
<li>End Loop</li>
<li>#</li>
<li>Close Window [ Current Window ]</li>
<li>Set Field [ brainstate::totalTimeLogged; $totalTime ]</li>
<li>Sort Records [ Specified Sort Order: group::text; ascending
category::sortTime; ascending
category::text; ascending ]
[ Restore; No dialog ]</li>
<li>#</li>
<li>#</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>issue</em>::_keyBrainstate</li>
<li>
<em>issue</em>::lock</li>
<li>
<em>issue</em>::_keyCategory</li>
<li>
<em>issue</em>::timeSummary</li>
<li>
<em>issueCategory</em>::issueTotalTime</li>
<li>
<em>day1</em>::_keyBrainstate</li>
<li>
<em>day1</em>::swTotalActivity</li>
<li>
<em>brainstate</em>::totalTimeLogged</li>
<li>
<em>group</em>::text</li>
<li>
<em>category</em>::sortTime</li>
<li>
<em>category</em>::text</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>IssuesLayoutForScripts</li>
<li>calcDayTable</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<p>
<span class="partheading"><a name="33212ScriptAnchor_"></a><a href="#33212ScriptAnchor_toc">alarm</a></span>
</p>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33012ScriptAnchor_"></a><td class="script_navbar"></td><td class="script_navbar"><a href="#33212ScriptAnchor_"><span>Parent Folder: [alarm]</span></a></td><td class="script_navbar"><a href="#33011ScriptAnchor_"><span>Next Script: [timerPart2]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">timerPart1</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">On</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>#basic administration tasks (required to prevent error message: record can't be modfied because it is open in another window)</li>
<li>Set Error Capture [ On ]</li>
<li>Allow User Abort [ Off ]</li>
<li>Set Variable [ $activity; Value:brainstate::description ]</li>
<li>Set Variable [ $$alarmLayout; Value:Get ( LayoutName ) ]</li>
<li>//  New Window [ Name: "Predict Activity Time"; Height: 420; Width: 630; Top: Get ( WindowHeight ) / 3; Left: Get ( WindowWidth ) / 3 ]</li>
<li>//  Show/Hide Status Area
[ Lock; Hide ]</li>
<li>//  Show/Hide Text Ruler
[ Hide ]</li>
<li>Go to Layout [ &ldquo;timerSetAlarm&rdquo; (steward) ]</li>
<li>Set Field [ reference::TimerDescription; $activity ]</li>
<li>Set Field [ reference::TimerSet; "" ]</li>
<li>Set Field [ reference::repeatAlarm; "" ]</li>
<li>//  Pause/Resume Script [ Indefinitely ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>brainstate</em>::description</li>
<li>
<em>reference</em>::TimerDescription</li>
<li>
<em>reference</em>::TimerSet</li>
<li>
<em>reference</em>::repeatAlarm</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>timerSetAlarm</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33011ScriptAnchor_"></a><td class="script_navbar"><a href="#33012ScriptAnchor_"><span>Previous Script: [timerPart1]</span></a></td><td class="script_navbar"><a href="#33212ScriptAnchor_"><span>Parent Folder: [alarm]</span></a></td><td class="script_navbar"><a href="#33014ScriptAnchor_"><span>Next Script: [timerRepeatAlarm]</span></a></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">timerPart2</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">On</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>If [ reference::repeatAlarm &ne; "" ]</li>
<li>Perform Script [ &ldquo;timerRepeatAlarm&rdquo; ]</li>
<li>Halt Script</li>
<li>End If</li>
<li>Insert Current Time [ reference::TimerSet ]
[ Select ]</li>
<li>Go to Layout [ &ldquo;timerAlarm&rdquo; (steward) ]</li>
<li>Go to Field [  ]</li>
<li>Pause/Resume Script [ Duration (seconds): 11 ]</li>
<li>Go to Layout [ &ldquo;timerSetAlarm&rdquo; (steward) ]</li>
<li>Go to Field [  ]</li>
<li>Pause/Resume Script [ Duration (seconds): reference::gDuration ]</li>
<li>Go to Layout [ &ldquo;timerAlarm&rdquo; (steward) ]</li>
<li>Adjust Window
[ Hide ]</li>
<li>Pause/Resume Script [ Duration (seconds): 11 ]</li>
<li>Go to Layout [ $$alarmLayout ]</li>
<li>//  Close Window [ Name: "Predict Activity Time"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::repeatAlarm</li>
<li>
<em>reference</em>::TimerSet</li>
<li>
<em>reference</em>::gDuration</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul>
<li><a href="#33014ScriptAnchor_">timerRepeatAlarm</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>timerAlarm</li>
<li>timerSetAlarm</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>
<table class="script_navbar">
<tbody>
<tr class="script_navbar">
<a name="33014ScriptAnchor_"></a><td class="script_navbar"><a href="#33011ScriptAnchor_"><span>Previous Script: [timerPart2]</span></a></td><td class="script_navbar"><a href="#33212ScriptAnchor_"><span>Parent Folder: [alarm]</span></a></td><td class="script_navbar"></td>
</tr>
</tbody>
</table>
<table width="100%" border="1">
<tbody>
<tr class="privsetfirst" vAlign="top">
<td width="35%">Script Name</td><td width="65%">timerRepeatAlarm</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Run script with full access privileges</td><td class="regularcharttext">On</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Include In Menu</td><td class="regularcharttext">Yes</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts that use this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts that use this script</td><td class="regularcharttext">
<ul>
<li><a href="#33011ScriptAnchor_">timerPart2</a></li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartsubheads" colSpan="2">Script Definition</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Script Steps</td><td class="regularcharttext">
<ul>
<li>Insert Current Time [ reference::TimerSet ]
[ Select ]</li>
<li>Go to Layout [ &ldquo;timerAlarm&rdquo; (steward) ]</li>
<li>Go to Field [  ]</li>
<li>Pause/Resume Script [ Duration (seconds): 11 ]</li>
<li>Go to Layout [ &ldquo;timerSetAlarm&rdquo; (steward) ]</li>
<li>Go to Field [  ]</li>
<li>Loop</li>
<li>Pause/Resume Script [ Duration (seconds): reference::gDuration ]</li>
<li>Go to Layout [ &ldquo;timerAlarm&rdquo; (steward) ]</li>
<li>//  Adjust Window
[ Hide ]</li>
<li>Pause/Resume Script [ Duration (seconds): 11 ]</li>
<li>Go to Layout [ &ldquo;timerSetAlarm&rdquo; (steward) ]</li>
<li>End Loop</li>
<li>//  Close Window [ Name: "Predict Activity Time"; Current file ]</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Fields used in this script</td><td class="regularcharttext">
<ul>
<li>
<em>reference</em>::TimerSet</li>
<li>
<em>reference</em>::gDuration</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Scripts used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Layouts used in this script</td><td class="regularcharttext">
<ul>
<li>timerAlarm</li>
<li>timerSetAlarm</li>
</ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Tables used in this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Table occurrences used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom Functions used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
<tr vAlign="top">
<td class="chartheadersnobg">Custom menu set used by this script</td><td class="regularcharttext">
<ul></ul>
</td>
</tr>
</tbody>
</table>
<br>


</body>
</html>
